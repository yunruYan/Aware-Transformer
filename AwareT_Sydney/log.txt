[INFO: 2022-04-05 15:10:15,938] Training with config:
[INFO: 2022-04-05 15:10:15,941] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mssydney/sent/sydney_train_input.pkl',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 8,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mssydney/sent/sydney_train_target.pkl',
                 'TEST_4W_ID': './mscoco/misc/ids2path_json/coco_test4w_ids2path.json',
                 'TEST_ATT_FEATS': './mssydney/feature/Sydney',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mssydney/misc/ids2path_json/sydney_test_ids2path.json',
                 'TRAIN_ATT_FEATS': './mssydney/feature/Sydney',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mssydney/misc/ids2path_json/sydney_train_ids2path.json',
                 'VAL_ATT_FEATS': './mssydney/feature/Sydney',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mssydney/misc/ids2path_json/sydney_val_ids2path.json'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 5,
               'CAP_KEY': 'caption',
               'COCO_PATH': './coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mssydney/misc/test_sydney.json',
               'VAL_ANNFILE': './mssydney/misc/val_sydney.json',
               'VOCAB': './mssydney/txt/Sydney_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'LabelSmoothing'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 1536,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 512,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 512,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [64, 32, 64],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 3,
                        'DIM': 512,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [64, 32, 64],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.1,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 3,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.1,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.1,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 1536,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 512,
           'SEQ_LEN': 24,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'PureT',
           'VOCAB_SIZE': 181,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 512,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments_PureT/PureT_XE_Sydney/',
 'SCORER': {'CIDER_CACHED': './mssydney/misc/sydney_train_cider.pkl',
            'GT_PATH': './mssydney/misc/sydney_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1234.0,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 0.0005,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 512,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Noam',
                          'WARMUP': 10000},
            'MAX_EPOCH': 20,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2022-04-05 15:11:04,899] Training with config:
[INFO: 2022-04-05 15:11:04,901] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mssydney/sent/sydney_train_input.pkl',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 8,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mssydney/sent/sydney_train_target.pkl',
                 'TEST_4W_ID': './mscoco/misc/ids2path_json/coco_test4w_ids2path.json',
                 'TEST_ATT_FEATS': './mssydney/feature/Sydney',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mssydney/misc/ids2path_json/sydney_test_ids2path.json',
                 'TRAIN_ATT_FEATS': './mssydney/feature/Sydney',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mssydney/misc/ids2path_json/sydney_train_ids2path.json',
                 'VAL_ATT_FEATS': './mssydney/feature/Sydney',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mssydney/misc/ids2path_json/sydney_val_ids2path.json'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 5,
               'CAP_KEY': 'caption',
               'COCO_PATH': './coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mssydney/misc/test_sydney.json',
               'VAL_ANNFILE': './mssydney/misc/val_sydney.json',
               'VOCAB': './mssydney/txt/Sydney_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'LabelSmoothing'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 1536,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 512,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 512,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [64, 32, 64],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 3,
                        'DIM': 512,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [64, 32, 64],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.1,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 3,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.1,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.1,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 1536,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 512,
           'SEQ_LEN': 24,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'PureT',
           'VOCAB_SIZE': 181,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 512,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments_PureT/PureT_XE_Sydney/',
 'SCORER': {'CIDER_CACHED': './mssydney/misc/sydney_train_cider.pkl',
            'GT_PATH': './mssydney/misc/sydney_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1234.0,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 0.0005,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 512,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Noam',
                          'WARMUP': 10000},
            'MAX_EPOCH': 20,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2022-04-05 16:31:23,309] Training with config:
[INFO: 2022-04-05 16:31:23,330] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mssydney/sent/sydney_train_input.pkl',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 8,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mssydney/sent/sydney_train_target.pkl',
                 'TEST_4W_ID': './mscoco/misc/ids2path_json/coco_test4w_ids2path.json',
                 'TEST_ATT_FEATS': './mssydney/feature/Sydney',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mssydney/misc/ids2path_json/sydney_test_ids2path.json',
                 'TRAIN_ATT_FEATS': './mssydney/feature/Sydney',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mssydney/misc/ids2path_json/sydney_train_ids2path.json',
                 'VAL_ATT_FEATS': './mssydney/feature/Sydney',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mssydney/misc/ids2path_json/sydney_val_ids2path.json'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 5,
               'CAP_KEY': 'caption',
               'COCO_PATH': './coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mssydney/misc/test_sydney.json',
               'VAL_ANNFILE': './mssydney/misc/val_sydney.json',
               'VOCAB': './mssydney/txt/Sydney_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'LabelSmoothing'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 1536,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 512,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 512,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [64, 32, 64],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 3,
                        'DIM': 512,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [64, 32, 64],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.1,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 3,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.1,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.1,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 1536,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 512,
           'SEQ_LEN': 24,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'PureT',
           'VOCAB_SIZE': 181,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 512,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments_PureT/PureT_XE_Sydney/',
 'SCORER': {'CIDER_CACHED': './mssydney/misc/sydney_train_cider.pkl',
            'GT_PATH': './mssydney/misc/sydney_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1234.0,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 0.0005,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 512,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Noam',
                          'WARMUP': 10000},
            'MAX_EPOCH': 20,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2022-04-05 16:32:16,398] ######## Epoch (VAL)1 ########
[INFO: 2022-04-05 16:32:16,398] {'Bleu_1': 0.00022844729390522574, 'Bleu_2': 7.014961521578228e-05, 'Bleu_3': 5.154128029455103e-10, 'Bleu_4': 1.4532304929236507e-12, 'METEOR': 0.005620066327245553, 'ROUGE_L': 0.026725988477722003, 'CIDEr': 0.0009707820385849132}
[INFO: 2022-04-05 16:32:28,502] ######## Epoch (TEST)1 ########
[INFO: 2022-04-05 16:32:28,503] {'Bleu_1': 9.643134097520709e-05, 'Bleu_2': 3.46483228284805e-05, 'Bleu_3': 2.2136578492192964e-05, 'Bleu_4': 3.510811881125499e-09, 'METEOR': 0.01208373990805047, 'ROUGE_L': 0.04146629116103258, 'CIDEr': 0.013237457575193567}
[INFO: 2022-04-05 16:33:01,030] ######## Epoch (VAL)2 ########
[INFO: 2022-04-05 16:33:01,030] {'Bleu_1': 0.0, 'Bleu_2': 0.0, 'Bleu_3': 0.0, 'Bleu_4': 0.0, 'METEOR': 0.0, 'ROUGE_L': 0.0, 'CIDEr': 0.0}
[INFO: 2022-04-05 16:33:12,130] ######## Epoch (TEST)2 ########
[INFO: 2022-04-05 16:33:12,130] {'Bleu_1': 0.0, 'Bleu_2': 0.0, 'Bleu_3': 0.0, 'Bleu_4': 0.0, 'METEOR': 0.0, 'ROUGE_L': 0.0, 'CIDEr': 0.0}
[INFO: 2022-04-05 16:33:44,921] ######## Epoch (VAL)3 ########
[INFO: 2022-04-05 16:33:44,921] {'Bleu_1': 0.006478435604136054, 'Bleu_2': 0.006190012756073199, 'Bleu_3': 0.006096754065990946, 'Bleu_4': 0.00020231577460684829, 'METEOR': 0.07365689292056775, 'ROUGE_L': 0.19492096447724333, 'CIDEr': 0.14135887614327833}
[INFO: 2022-04-05 16:33:56,683] ######## Epoch (TEST)3 ########
[INFO: 2022-04-05 16:33:56,683] {'Bleu_1': 0.002882814446985328, 'Bleu_2': 0.0028314842691049163, 'Bleu_3': 0.002927656924052296, 'Bleu_4': 9.652495794231113e-05, 'METEOR': 0.06033659367101964, 'ROUGE_L': 0.17246126295457145, 'CIDEr': 0.14544532600476934}
[INFO: 2022-04-05 16:34:29,727] ######## Epoch (VAL)4 ########
[INFO: 2022-04-05 16:34:29,727] {'Bleu_1': 0.07851890206583591, 'Bleu_2': 0.07362429095473458, 'Bleu_3': 0.07278501598599857, 'Bleu_4': 0.07823542614644596, 'METEOR': 0.11854410150057142, 'ROUGE_L': 0.3267605316737702, 'CIDEr': 0.4953372820767061}
[INFO: 2022-04-05 16:34:40,789] ######## Epoch (TEST)4 ########
[INFO: 2022-04-05 16:34:40,789] {'Bleu_1': 0.07474789877279558, 'Bleu_2': 0.07104929898423762, 'Bleu_3': 0.07224720721658334, 'Bleu_4': 0.07852991710488219, 'METEOR': 0.10493631271489198, 'ROUGE_L': 0.3080063582704671, 'CIDEr': 0.5048347170238534}
[INFO: 2022-04-05 16:35:13,072] ######## Epoch (VAL)5 ########
[INFO: 2022-04-05 16:35:13,073] {'Bleu_1': 0.1766552706311574, 'Bleu_2': 0.15956356765803875, 'Bleu_3': 0.14802386643719564, 'Bleu_4': 0.138521741252106, 'METEOR': 0.1588723685176284, 'ROUGE_L': 0.3788294922839562, 'CIDEr': 0.8217301459253634}
[INFO: 2022-04-05 16:35:25,338] ######## Epoch (TEST)5 ########
[INFO: 2022-04-05 16:35:25,338] {'Bleu_1': 0.161216652144189, 'Bleu_2': 0.14727826401422967, 'Bleu_3': 0.13963728676768858, 'Bleu_4': 0.13181185995244776, 'METEOR': 0.1490111223171786, 'ROUGE_L': 0.3862005098040382, 'CIDEr': 0.7453777815149202}
[INFO: 2022-04-05 16:35:59,435] ######## Epoch (VAL)6 ########
[INFO: 2022-04-05 16:35:59,435] {'Bleu_1': 0.3819080858816476, 'Bleu_2': 0.3611872681642069, 'Bleu_3': 0.3304473065796219, 'Bleu_4': 0.28841817739339587, 'METEOR': 0.22363358440522332, 'ROUGE_L': 0.4704788877867539, 'CIDEr': 1.1360349570702177}
[INFO: 2022-04-05 16:36:10,350] ######## Epoch (TEST)6 ########
[INFO: 2022-04-05 16:36:10,350] {'Bleu_1': 0.3240311821128955, 'Bleu_2': 0.2904989224507918, 'Bleu_3': 0.26513186433657565, 'Bleu_4': 0.24349326280451014, 'METEOR': 0.2063183213951481, 'ROUGE_L': 0.4523220682069574, 'CIDEr': 1.2067355725343276}
[INFO: 2022-04-05 16:36:43,763] ######## Epoch (VAL)7 ########
[INFO: 2022-04-05 16:36:43,763] {'Bleu_1': 0.5730013888395037, 'Bleu_2': 0.515512208309319, 'Bleu_3': 0.4561764608610252, 'Bleu_4': 0.38923550852006233, 'METEOR': 0.2886516295674621, 'ROUGE_L': 0.5868428751609618, 'CIDEr': 1.3280807111545685}
[INFO: 2022-04-05 16:36:55,484] ######## Epoch (TEST)7 ########
[INFO: 2022-04-05 16:36:55,484] {'Bleu_1': 0.5358470711189043, 'Bleu_2': 0.4815403956017802, 'Bleu_3': 0.43457545026600575, 'Bleu_4': 0.38842734041656496, 'METEOR': 0.2741629598045703, 'ROUGE_L': 0.5545243275515754, 'CIDEr': 1.4271615782752507}
[INFO: 2022-04-05 16:37:28,425] ######## Epoch (VAL)8 ########
[INFO: 2022-04-05 16:37:28,426] {'Bleu_1': 0.7825988423154118, 'Bleu_2': 0.7117514524623255, 'Bleu_3': 0.6357270452721322, 'Bleu_4': 0.5595607260405551, 'METEOR': 0.369277399750851, 'ROUGE_L': 0.6857377682363632, 'CIDEr': 2.080779607325129}
[INFO: 2022-04-05 16:37:39,741] ######## Epoch (TEST)8 ########
[INFO: 2022-04-05 16:37:39,741] {'Bleu_1': 0.7397633992101776, 'Bleu_2': 0.6656789854381779, 'Bleu_3': 0.5985139700787068, 'Bleu_4': 0.5330302792810246, 'METEOR': 0.3519897161764829, 'ROUGE_L': 0.6577562231970004, 'CIDEr': 1.9955308998646712}
[INFO: 2022-04-05 16:38:12,640] ######## Epoch (VAL)9 ########
[INFO: 2022-04-05 16:38:12,640] {'Bleu_1': 0.7747147648672489, 'Bleu_2': 0.7027153543614696, 'Bleu_3': 0.6223470861472575, 'Bleu_4': 0.5409859650402485, 'METEOR': 0.34943903776368324, 'ROUGE_L': 0.6882648981383699, 'CIDEr': 2.0284795117078804}
[INFO: 2022-04-05 16:38:24,469] ######## Epoch (TEST)9 ########
[INFO: 2022-04-05 16:38:24,469] {'Bleu_1': 0.705952957608269, 'Bleu_2': 0.6267140229992785, 'Bleu_3': 0.5478270659392558, 'Bleu_4': 0.4696176993052881, 'METEOR': 0.32085473289750877, 'ROUGE_L': 0.6424219102104181, 'CIDEr': 1.857985753869989}
[INFO: 2022-04-05 16:38:57,310] ######## Epoch (VAL)10 ########
[INFO: 2022-04-05 16:38:57,311] {'Bleu_1': 0.7531469966432776, 'Bleu_2': 0.6931282747625587, 'Bleu_3': 0.6235854120358242, 'Bleu_4': 0.5466245666285827, 'METEOR': 0.37393821378977316, 'ROUGE_L': 0.7045712458402803, 'CIDEr': 2.0488792313177866}
[INFO: 2022-04-05 16:39:09,275] ######## Epoch (TEST)10 ########
[INFO: 2022-04-05 16:39:09,275] {'Bleu_1': 0.7166179337859349, 'Bleu_2': 0.6449706512722451, 'Bleu_3': 0.5788900627164385, 'Bleu_4': 0.512771582553559, 'METEOR': 0.35415019923665825, 'ROUGE_L': 0.6825617967043842, 'CIDEr': 1.977655065246484}
[INFO: 2022-04-05 16:39:42,508] ######## Epoch (VAL)11 ########
[INFO: 2022-04-05 16:39:42,509] {'Bleu_1': 0.7858775432222356, 'Bleu_2': 0.7209781496159713, 'Bleu_3': 0.6491669046590638, 'Bleu_4': 0.5788800262657051, 'METEOR': 0.37703313126870275, 'ROUGE_L': 0.7024734879785782, 'CIDEr': 2.126941068457623}
[INFO: 2022-04-05 16:39:54,563] ######## Epoch (TEST)11 ########
[INFO: 2022-04-05 16:39:54,564] {'Bleu_1': 0.7693231470435052, 'Bleu_2': 0.692460895638039, 'Bleu_3': 0.622549669927956, 'Bleu_4': 0.5559860551168667, 'METEOR': 0.36226481702777286, 'ROUGE_L': 0.68456164824328, 'CIDEr': 2.0949699508335002}
[INFO: 2022-04-05 16:40:28,306] ######## Epoch (VAL)12 ########
[INFO: 2022-04-05 16:40:28,306] {'Bleu_1': 0.7605083622254654, 'Bleu_2': 0.6970695541023921, 'Bleu_3': 0.6240064343076133, 'Bleu_4': 0.5509403778465587, 'METEOR': 0.3625458377173987, 'ROUGE_L': 0.6958121462760849, 'CIDEr': 2.0857706489342567}
[INFO: 2022-04-05 16:40:39,485] ######## Epoch (TEST)12 ########
[INFO: 2022-04-05 16:40:39,485] {'Bleu_1': 0.7736152014973854, 'Bleu_2': 0.701647363823472, 'Bleu_3': 0.6296728505906092, 'Bleu_4': 0.5574665375825212, 'METEOR': 0.3755955448072095, 'ROUGE_L': 0.6912866777215965, 'CIDEr': 2.1291713290093615}
[INFO: 2022-04-05 16:41:12,457] ######## Epoch (VAL)13 ########
[INFO: 2022-04-05 16:41:12,458] {'Bleu_1': 0.8110957113129638, 'Bleu_2': 0.7288327620333063, 'Bleu_3': 0.6443120598415955, 'Bleu_4': 0.5640183820189195, 'METEOR': 0.39865673270521246, 'ROUGE_L': 0.7106428730876267, 'CIDEr': 2.203889583785466}
[INFO: 2022-04-05 16:41:23,988] ######## Epoch (TEST)13 ########
[INFO: 2022-04-05 16:41:23,988] {'Bleu_1': 0.7910947152901261, 'Bleu_2': 0.7074192670967725, 'Bleu_3': 0.6327805393418245, 'Bleu_4': 0.5613650709269025, 'METEOR': 0.382315465999879, 'ROUGE_L': 0.7093899798797307, 'CIDEr': 2.3195206563152944}
[INFO: 2022-04-05 16:41:57,074] ######## Epoch (VAL)14 ########
[INFO: 2022-04-05 16:41:57,074] {'Bleu_1': 0.7588762128886366, 'Bleu_2': 0.6632975865990033, 'Bleu_3': 0.5733582098311706, 'Bleu_4': 0.4801479168600882, 'METEOR': 0.37830726920646374, 'ROUGE_L': 0.6942365326820709, 'CIDEr': 2.032832500492106}
[INFO: 2022-04-05 16:42:08,137] ######## Epoch (TEST)14 ########
[INFO: 2022-04-05 16:42:08,137] {'Bleu_1': 0.6966487646201597, 'Bleu_2': 0.5956236437625804, 'Bleu_3': 0.5213864702838941, 'Bleu_4': 0.45293089707943185, 'METEOR': 0.35841642023677267, 'ROUGE_L': 0.6664842367912606, 'CIDEr': 1.9821076662485013}
[INFO: 2022-04-05 16:42:41,030] ######## Epoch (VAL)15 ########
[INFO: 2022-04-05 16:42:41,030] {'Bleu_1': 0.7687644567311447, 'Bleu_2': 0.6858977352724085, 'Bleu_3': 0.5994279916123798, 'Bleu_4': 0.5129091090799912, 'METEOR': 0.3921056309244689, 'ROUGE_L': 0.7056318276852026, 'CIDEr': 2.214753845031262}
[INFO: 2022-04-05 16:42:52,957] ######## Epoch (TEST)15 ########
[INFO: 2022-04-05 16:42:52,957] {'Bleu_1': 0.7566373527538898, 'Bleu_2': 0.6728564576968251, 'Bleu_3': 0.6014457261825381, 'Bleu_4': 0.5335494411198287, 'METEOR': 0.37728205056887837, 'ROUGE_L': 0.6980092095590157, 'CIDEr': 2.2232591353581563}
[INFO: 2022-04-05 16:43:25,219] ######## Epoch (VAL)16 ########
[INFO: 2022-04-05 16:43:25,219] {'Bleu_1': 0.8257790368260258, 'Bleu_2': 0.7462513716640788, 'Bleu_3': 0.6610179199616909, 'Bleu_4': 0.5810812211310666, 'METEOR': 0.4215320818451453, 'ROUGE_L': 0.7424161404775041, 'CIDEr': 2.444480468024997}
[INFO: 2022-04-05 16:43:37,002] ######## Epoch (TEST)16 ########
[INFO: 2022-04-05 16:43:37,002] {'Bleu_1': 0.7959852638964968, 'Bleu_2': 0.7117768563626724, 'Bleu_3': 0.6376812726055491, 'Bleu_4': 0.5679704646310696, 'METEOR': 0.3918725072061323, 'ROUGE_L': 0.7228314960469852, 'CIDEr': 2.4239511741007362}
[INFO: 2022-04-05 16:44:09,519] ######## Epoch (VAL)17 ########
[INFO: 2022-04-05 16:44:09,520] {'Bleu_1': 0.8265734265722705, 'Bleu_2': 0.7465517156816073, 'Bleu_3': 0.6614308606816465, 'Bleu_4': 0.5789203926601321, 'METEOR': 0.42388417907090004, 'ROUGE_L': 0.7520716942565989, 'CIDEr': 2.4701897961826944}
[INFO: 2022-04-05 16:44:20,824] ######## Epoch (TEST)17 ########
[INFO: 2022-04-05 16:44:20,824] {'Bleu_1': 0.7818181818170884, 'Bleu_2': 0.6959329557089621, 'Bleu_3': 0.6270987583862763, 'Bleu_4': 0.5659111736073443, 'METEOR': 0.3912725114426236, 'ROUGE_L': 0.7197290731619183, 'CIDEr': 2.5016188881954227}
[INFO: 2022-04-05 16:44:53,303] ######## Epoch (VAL)18 ########
[INFO: 2022-04-05 16:44:53,303] {'Bleu_1': 0.8251748251736711, 'Bleu_2': 0.7467612692602656, 'Bleu_3': 0.6657819294199406, 'Bleu_4': 0.5872375386319899, 'METEOR': 0.4249553924551833, 'ROUGE_L': 0.7482983908875018, 'CIDEr': 2.5072399732842303}
[INFO: 2022-04-05 16:45:04,331] ######## Epoch (TEST)18 ########
[INFO: 2022-04-05 16:45:04,331] {'Bleu_1': 0.7807262569810594, 'Bleu_2': 0.699173652366139, 'Bleu_3': 0.6266262734211039, 'Bleu_4': 0.5589413550829714, 'METEOR': 0.3898705930448476, 'ROUGE_L': 0.7212126791053027, 'CIDEr': 2.4446340091307124}
[INFO: 2022-04-05 16:45:37,094] ######## Epoch (VAL)19 ########
[INFO: 2022-04-05 16:45:37,095] {'Bleu_1': 0.7588152327210737, 'Bleu_2': 0.6567171954637449, 'Bleu_3': 0.5724979416066374, 'Bleu_4': 0.49268497943346123, 'METEOR': 0.4070230778227509, 'ROUGE_L': 0.7037569250370506, 'CIDEr': 2.2421052737176463}
[INFO: 2022-04-05 16:45:48,772] ######## Epoch (TEST)19 ########
[INFO: 2022-04-05 16:45:48,772] {'Bleu_1': 0.7116212338583765, 'Bleu_2': 0.6062210187615221, 'Bleu_3': 0.5319705637973793, 'Bleu_4': 0.4675384158388803, 'METEOR': 0.3716284907337214, 'ROUGE_L': 0.6592217232494042, 'CIDEr': 2.0967050662323463}
[INFO: 2022-04-05 16:46:21,747] ######## Epoch (VAL)20 ########
[INFO: 2022-04-05 16:46:21,747] {'Bleu_1': 0.7949438202236027, 'Bleu_2': 0.7033581906746813, 'Bleu_3': 0.6249108373569471, 'Bleu_4': 0.5501812880505218, 'METEOR': 0.42405108559809607, 'ROUGE_L': 0.7260464544625629, 'CIDEr': 2.4521198174303036}
[INFO: 2022-04-05 16:46:33,581] ######## Epoch (TEST)20 ########
[INFO: 2022-04-05 16:46:33,581] {'Bleu_1': 0.7326732673256964, 'Bleu_2': 0.6383905146217054, 'Bleu_3': 0.5688951227763162, 'Bleu_4': 0.5074785178662544, 'METEOR': 0.3898313100808226, 'ROUGE_L': 0.6882648738930324, 'CIDEr': 2.2713127779151154}
[INFO: 2022-09-24 15:03:04,961] Training with config:
[INFO: 2022-09-24 15:03:04,963] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_MULCLASS_LABEL': './mssydney/sent/mulcalss_train.pkl',
                 'INPUT_SEQ_PATH': './mssydney/sent/sydney_train_input.pkl',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 8,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mssydney/sent/sydney_train_target.pkl',
                 'TEST_4W_ID': './mscoco/misc/ids2path_json/coco_test4w_ids2path.json',
                 'TEST_ATT_FEATS': './mssydney/feature/Sydney',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mssydney/misc/ids2path_json/sydney_val_ids2path.json',
                 'TRAIN_ATT_FEATS': './mssydney/feature/Sydney',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mssydney/misc/ids2path_json/sydney_train_ids2path.json',
                 'VAL_ATT_FEATS': './mssydney/feature/Sydney',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mssydney/misc/ids2path_json/sydney_test_ids2path.json'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 5,
               'CAP_KEY': 'caption',
               'COCO_PATH': './coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mssydney/misc/val_sydney.json',
               'VAL_ANNFILE': './mssydney/misc/test_sydney.json',
               'VOCAB': './mssydney/txt/Sydney_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'CrossEntropy'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 1536,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 512,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 512,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [64, 32, 64],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 3,
                        'DIM': 512,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [64, 32, 64],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.1,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 3,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.1,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.1,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 1536,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 512,
           'SEQ_LEN': 24,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'PureT',
           'VOCAB_SIZE': 181,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 512,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'MAX_LEN': 'MAX_LEN',
           'MULCLASS': 'MULCLASS',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments_PureT/PureT_XE_Sydney/',
 'SCORER': {'CIDER_CACHED': './mssydney/misc/sydney_train_cider.pkl',
            'GT_PATH': './mssydney/misc/sydney_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1234.0,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 0.0005,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 512,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Noam',
                          'WARMUP': 10000},
            'MAX_EPOCH': 20,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2022-09-24 15:04:34,125] ######## Epoch (VAL)1 ########
[INFO: 2022-09-24 15:04:34,125] {'Bleu_1': 0.1259097525472155, 'Bleu_2': 0.021871911640184726, 'Bleu_3': 7.244875857095371e-08, 'Bleu_4': 1.3342213920645507e-10, 'METEOR': 0.07788170764536362, 'ROUGE_L': 0.15557862133743347, 'CIDEr': 0.010653396275800694}
[INFO: 2022-09-24 15:04:52,404] ######## Epoch (TEST)1 ########
[INFO: 2022-09-24 15:04:52,405] {'Bleu_1': 0.11350574712635524, 'Bleu_2': 0.0159768676806083, 'Bleu_3': 5.848496048440272e-08, 'Bleu_4': 1.1320649087496666e-10, 'METEOR': 0.06885172317357639, 'ROUGE_L': 0.14783274901779206, 'CIDEr': 0.005390342013681348}
[INFO: 2022-09-24 15:06:04,125] ######## Epoch (VAL)2 ########
[INFO: 2022-09-24 15:06:04,129] {'Bleu_1': 5.280705731480371e-05, 'Bleu_2': 2.9200173673136068e-05, 'Bleu_3': 1.5469024308102728e-10, 'Bleu_4': 3.630961240874507e-13, 'METEOR': 0.006223624903058968, 'ROUGE_L': 0.016904134907554803, 'CIDEr': 0.002450481309821711}
[INFO: 2022-09-24 15:06:22,092] ######## Epoch (TEST)2 ########
[INFO: 2022-09-24 15:06:22,092] {'Bleu_1': 0.012852382786436968, 'Bleu_2': 0.007745562288870024, 'Bleu_3': 0.0028420978709678565, 'Bleu_4': 3.1139362546878933e-07, 'METEOR': 0.02309746714829122, 'ROUGE_L': 0.04411044397193868, 'CIDEr': 0.008106730120573672}
[INFO: 2022-09-24 15:07:34,302] ######## Epoch (VAL)3 ########
[INFO: 2022-09-24 15:07:34,303] {'Bleu_1': 0.02112811124083576, 'Bleu_2': 0.01330115331096986, 'Bleu_3': 0.01261216219189411, 'Bleu_4': 0.0004618459823419969, 'METEOR': 0.07633810333022908, 'ROUGE_L': 0.28188066013226276, 'CIDEr': 0.2678420077062567}
[INFO: 2022-09-24 15:07:52,845] ######## Epoch (TEST)3 ########
[INFO: 2022-09-24 15:07:52,846] {'Bleu_1': 0.032186142676260236, 'Bleu_2': 0.026091486815507145, 'Bleu_3': 0.02555364223232851, 'Bleu_4': 0.0008767080855114699, 'METEOR': 0.09170634307691827, 'ROUGE_L': 0.2892043651391788, 'CIDEr': 0.2907959978662014}
[INFO: 2022-09-24 15:09:05,659] ######## Epoch (VAL)4 ########
[INFO: 2022-09-24 15:09:05,659] {'Bleu_1': 0.08934981746520346, 'Bleu_2': 0.0802711441790436, 'Bleu_3': 0.07591626396954018, 'Bleu_4': 1.063481191443229e-05, 'METEOR': 0.11656710009825254, 'ROUGE_L': 0.3389117814230064, 'CIDEr': 0.47575203071204736}
[INFO: 2022-09-24 15:09:24,014] ######## Epoch (TEST)4 ########
[INFO: 2022-09-24 15:09:24,014] {'Bleu_1': 0.07524232120848441, 'Bleu_2': 0.06756283100179158, 'Bleu_3': 0.06468113256577615, 'Bleu_4': 1.29168250606219e-05, 'METEOR': 0.11007897990254352, 'ROUGE_L': 0.30530877110594307, 'CIDEr': 0.428634782246478}
[INFO: 2022-09-24 15:10:37,450] ######## Epoch (VAL)5 ########
[INFO: 2022-09-24 15:10:37,451] {'Bleu_1': 0.13842611401459481, 'Bleu_2': 0.12557007232798, 'Bleu_3': 0.119271648222709, 'Bleu_4': 0.11438144484031361, 'METEOR': 0.12667988328914023, 'ROUGE_L': 0.37347675542489384, 'CIDEr': 0.7304309934457115}
[INFO: 2022-09-24 15:10:55,802] ######## Epoch (TEST)5 ########
[INFO: 2022-09-24 15:10:55,802] {'Bleu_1': 0.1291205979097986, 'Bleu_2': 0.11741234204907483, 'Bleu_3': 0.11054090020570388, 'Bleu_4': 0.10503853027392411, 'METEOR': 0.12253621885202899, 'ROUGE_L': 0.35181293629231675, 'CIDEr': 0.6735275755578892}
[INFO: 2022-09-24 15:12:09,467] ######## Epoch (VAL)6 ########
[INFO: 2022-09-24 15:12:09,467] {'Bleu_1': 0.22135986666627958, 'Bleu_2': 0.19633451538373697, 'Bleu_3': 0.17532607514515097, 'Bleu_4': 0.1488225396817264, 'METEOR': 0.14979223876332973, 'ROUGE_L': 0.39930023023385386, 'CIDEr': 0.8520821529813941}
[INFO: 2022-09-24 15:12:28,810] ######## Epoch (TEST)6 ########
[INFO: 2022-09-24 15:12:28,810] {'Bleu_1': 0.25311046563035305, 'Bleu_2': 0.23660109024546452, 'Bleu_3': 0.21533541049382457, 'Bleu_4': 0.17917939047080922, 'METEOR': 0.16792921967207894, 'ROUGE_L': 0.42908532650780573, 'CIDEr': 0.9320194580607863}
[INFO: 2022-09-24 15:13:41,555] ######## Epoch (VAL)7 ########
[INFO: 2022-09-24 15:13:41,555] {'Bleu_1': 0.5798132550686003, 'Bleu_2': 0.524539000972515, 'Bleu_3': 0.46694949006521974, 'Bleu_4': 0.4049291148434091, 'METEOR': 0.29445086365642964, 'ROUGE_L': 0.6053615709541142, 'CIDEr': 1.513020536542762}
[INFO: 2022-09-24 15:14:00,482] ######## Epoch (TEST)7 ########
[INFO: 2022-09-24 15:14:00,483] {'Bleu_1': 0.6113906511345036, 'Bleu_2': 0.5605925765142922, 'Bleu_3': 0.5034421172308671, 'Bleu_4': 0.43701534204386383, 'METEOR': 0.3093291690707837, 'ROUGE_L': 0.6358644784105434, 'CIDEr': 1.5227671718410027}
[INFO: 2022-09-24 15:15:13,613] ######## Epoch (VAL)8 ########
[INFO: 2022-09-24 15:15:13,614] {'Bleu_1': 0.5976710964623483, 'Bleu_2': 0.5356856863967988, 'Bleu_3': 0.4732916288354679, 'Bleu_4': 0.4081313605605519, 'METEOR': 0.3054554139403359, 'ROUGE_L': 0.6213370031251665, 'CIDEr': 1.5686583395314653}
[INFO: 2022-09-24 15:15:32,256] ######## Epoch (TEST)8 ########
[INFO: 2022-09-24 15:15:32,256] {'Bleu_1': 0.6932678780897495, 'Bleu_2': 0.6413111100738531, 'Bleu_3': 0.5784272774386067, 'Bleu_4': 0.5057933364064543, 'METEOR': 0.3473430526916505, 'ROUGE_L': 0.6865625768504222, 'CIDEr': 1.909800384293713}
[INFO: 2022-09-24 15:16:45,709] ######## Epoch (VAL)9 ########
[INFO: 2022-09-24 15:16:45,709] {'Bleu_1': 0.6721854277937982, 'Bleu_2': 0.6067119170847879, 'Bleu_3': 0.545958671458169, 'Bleu_4': 0.48222619299772634, 'METEOR': 0.339889454238844, 'ROUGE_L': 0.6688974811352686, 'CIDEr': 1.8232207129832594}
[INFO: 2022-09-24 15:17:04,046] ######## Epoch (TEST)9 ########
[INFO: 2022-09-24 15:17:04,046] {'Bleu_1': 0.6984106648049138, 'Bleu_2': 0.64813267274089, 'Bleu_3': 0.5866610289279158, 'Bleu_4': 0.517857999543348, 'METEOR': 0.35363098135308585, 'ROUGE_L': 0.7005660404293333, 'CIDEr': 1.9635345082125135}
[INFO: 2022-09-24 15:18:17,186] ######## Epoch (VAL)10 ########
[INFO: 2022-09-24 15:18:17,186] {'Bleu_1': 0.6419397036332356, 'Bleu_2': 0.5630257171870913, 'Bleu_3': 0.49148706898381234, 'Bleu_4': 0.4184563529370729, 'METEOR': 0.32186297165801786, 'ROUGE_L': 0.6397006629668517, 'CIDEr': 1.6857382255194595}
[INFO: 2022-09-24 15:18:35,549] ######## Epoch (TEST)10 ########
[INFO: 2022-09-24 15:18:35,549] {'Bleu_1': 0.7351877270691178, 'Bleu_2': 0.6734902734960782, 'Bleu_3': 0.6029684026933185, 'Bleu_4': 0.5274833250023558, 'METEOR': 0.36052576033694933, 'ROUGE_L': 0.7033986275752767, 'CIDEr': 2.036836892185192}
[INFO: 2022-09-24 15:19:48,978] ######## Epoch (VAL)11 ########
[INFO: 2022-09-24 15:19:48,978] {'Bleu_1': 0.643514398900309, 'Bleu_2': 0.5759604509122265, 'Bleu_3': 0.5130048589018419, 'Bleu_4': 0.4486309960969404, 'METEOR': 0.3265351257248639, 'ROUGE_L': 0.6663394046436825, 'CIDEr': 1.7658692727721088}
[INFO: 2022-09-24 15:20:07,390] ######## Epoch (TEST)11 ########
[INFO: 2022-09-24 15:20:07,390] {'Bleu_1': 0.6898729078103933, 'Bleu_2': 0.6302552798519703, 'Bleu_3': 0.5626410846691653, 'Bleu_4': 0.4919229108875528, 'METEOR': 0.34542934467992914, 'ROUGE_L': 0.7005968407476039, 'CIDEr': 1.9224949507490658}
[INFO: 2022-09-24 15:21:20,262] ######## Epoch (VAL)12 ########
[INFO: 2022-09-24 15:21:20,262] {'Bleu_1': 0.7637925844367086, 'Bleu_2': 0.676565217912684, 'Bleu_3': 0.6051540498310612, 'Bleu_4': 0.5398035968706878, 'METEOR': 0.36342091915370883, 'ROUGE_L': 0.6799730617269283, 'CIDEr': 2.218398745083223}
[INFO: 2022-09-24 15:21:38,391] ######## Epoch (TEST)12 ########
[INFO: 2022-09-24 15:21:38,391] {'Bleu_1': 0.8250728862961734, 'Bleu_2': 0.7392868838643898, 'Bleu_3': 0.6519530626264987, 'Bleu_4': 0.5685047325802395, 'METEOR': 0.40402219986749943, 'ROUGE_L': 0.7220382069360601, 'CIDEr': 2.2181800137030874}
[INFO: 2022-09-24 15:22:50,264] ######## Epoch (VAL)13 ########
[INFO: 2022-09-24 15:22:50,264] {'Bleu_1': 0.7706355360561306, 'Bleu_2': 0.6877251502061966, 'Bleu_3': 0.6144313609049896, 'Bleu_4': 0.5474674290795648, 'METEOR': 0.37442809266261917, 'ROUGE_L': 0.6963938193392809, 'CIDEr': 2.318825505136403}
[INFO: 2022-09-24 15:23:07,855] ######## Epoch (TEST)13 ########
[INFO: 2022-09-24 15:23:07,855] {'Bleu_1': 0.8176555716341278, 'Bleu_2': 0.7321623519959869, 'Bleu_3': 0.643632045014176, 'Bleu_4': 0.5616877280636692, 'METEOR': 0.4027115390187354, 'ROUGE_L': 0.7256593667057396, 'CIDEr': 2.2209308048233365}
[INFO: 2022-09-24 15:24:20,212] ######## Epoch (VAL)14 ########
[INFO: 2022-09-24 15:24:20,213] {'Bleu_1': 0.752550488286444, 'Bleu_2': 0.6772748856150819, 'Bleu_3': 0.6068291420902462, 'Bleu_4': 0.5387909694408103, 'METEOR': 0.3720931404234102, 'ROUGE_L': 0.6883130674409741, 'CIDEr': 2.238275745941291}
[INFO: 2022-09-24 15:24:37,964] ######## Epoch (TEST)14 ########
[INFO: 2022-09-24 15:24:37,964] {'Bleu_1': 0.8145506419389236, 'Bleu_2': 0.7276821126857311, 'Bleu_3': 0.6402877264256333, 'Bleu_4': 0.5603959997222979, 'METEOR': 0.4038244122328421, 'ROUGE_L': 0.7218415607401545, 'CIDEr': 2.279128140246954}
[INFO: 2022-09-24 15:25:50,511] ######## Epoch (VAL)15 ########
[INFO: 2022-09-24 15:25:50,511] {'Bleu_1': 0.7816420813996448, 'Bleu_2': 0.7003839457274267, 'Bleu_3': 0.6283760894187327, 'Bleu_4': 0.5614696076238628, 'METEOR': 0.3836205559274516, 'ROUGE_L': 0.7122252668292638, 'CIDEr': 2.410599750563656}
[INFO: 2022-09-24 15:26:07,718] ######## Epoch (TEST)15 ########
[INFO: 2022-09-24 15:26:07,718] {'Bleu_1': 0.8166431593782558, 'Bleu_2': 0.7284434686154213, 'Bleu_3': 0.6371058882259778, 'Bleu_4': 0.5519447107146644, 'METEOR': 0.4112325878798973, 'ROUGE_L': 0.7427632139747355, 'CIDEr': 2.377447721256025}
[INFO: 2022-09-24 15:27:19,671] ######## Epoch (VAL)16 ########
[INFO: 2022-09-24 15:27:19,671] {'Bleu_1': 0.7769985974743661, 'Bleu_2': 0.7024835077783131, 'Bleu_3': 0.6337960822220531, 'Bleu_4': 0.570966464603621, 'METEOR': 0.3927774889183502, 'ROUGE_L': 0.7103142791124535, 'CIDEr': 2.4798753060114476}
[INFO: 2022-09-24 15:27:37,163] ######## Epoch (TEST)16 ########
[INFO: 2022-09-24 15:27:37,164] {'Bleu_1': 0.8146611341620821, 'Bleu_2': 0.7291595040143508, 'Bleu_3': 0.6397974816805381, 'Bleu_4': 0.5571557937090323, 'METEOR': 0.418679239121346, 'ROUGE_L': 0.745515512332428, 'CIDEr': 2.4432110550648756}
[INFO: 2022-09-24 15:36:51,292] Training with config:
[INFO: 2022-09-24 15:36:51,298] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_MULCLASS_LABEL': './mssydney/sent/mulcalss_train.pkl',
                 'INPUT_SEQ_PATH': './mssydney/sent/sydney_train_input.pkl',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 8,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mssydney/sent/sydney_train_target.pkl',
                 'TEST_4W_ID': './mscoco/misc/ids2path_json/coco_test4w_ids2path.json',
                 'TEST_ATT_FEATS': './mssydney/feature/Sydney',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mssydney/misc/ids2path_json/sydney_val_ids2path.json',
                 'TRAIN_ATT_FEATS': './mssydney/feature/Sydney',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mssydney/misc/ids2path_json/sydney_train_ids2path.json',
                 'VAL_ATT_FEATS': './mssydney/feature/Sydney',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mssydney/misc/ids2path_json/sydney_test_ids2path.json'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 5,
               'CAP_KEY': 'caption',
               'COCO_PATH': './coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mssydney/misc/val_sydney.json',
               'VAL_ANNFILE': './mssydney/misc/test_sydney.json',
               'VOCAB': './mssydney/txt/Sydney_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'CrossEntropy'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 1536,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 512,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 512,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [64, 32, 64],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 3,
                        'DIM': 512,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [64, 32, 64],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.1,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 3,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.1,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.1,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 1536,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 512,
           'SEQ_LEN': 24,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'PureT',
           'VOCAB_SIZE': 181,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 512,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'MAX_LEN': 'MAX_LEN',
           'MULCLASS': 'MULCLASS',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments_PureT/PureT_XE_Sydney/',
 'SCORER': {'CIDER_CACHED': './mssydney/misc/sydney_train_cider.pkl',
            'GT_PATH': './mssydney/misc/sydney_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1234.0,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 0.0005,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 512,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Noam',
                          'WARMUP': 10000},
            'MAX_EPOCH': 20,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2022-09-24 15:38:06,198] ######## Epoch (VAL)1 ########
[INFO: 2022-09-24 15:38:06,199] {'Bleu_1': 0.1259097525472155, 'Bleu_2': 0.021871911640184726, 'Bleu_3': 7.244875857095371e-08, 'Bleu_4': 1.3342213920645507e-10, 'METEOR': 0.07788170764536362, 'ROUGE_L': 0.15557862133743347, 'CIDEr': 0.010653396275800694}
[INFO: 2022-09-24 15:38:21,633] ######## Epoch (TEST)1 ########
[INFO: 2022-09-24 15:38:21,634] {'Bleu_1': 0.11350574712635524, 'Bleu_2': 0.0159768676806083, 'Bleu_3': 5.848496048440272e-08, 'Bleu_4': 1.1320649087496666e-10, 'METEOR': 0.06885172317357639, 'ROUGE_L': 0.14783274901779206, 'CIDEr': 0.005390342013681348}
[INFO: 2022-09-24 15:39:30,412] ######## Epoch (VAL)2 ########
[INFO: 2022-09-24 15:39:30,413] {'Bleu_1': 5.280705731480371e-05, 'Bleu_2': 2.9200173673136068e-05, 'Bleu_3': 1.5469024308102728e-10, 'Bleu_4': 3.630961240874507e-13, 'METEOR': 0.006223624903058968, 'ROUGE_L': 0.016904134907554803, 'CIDEr': 0.002450481309821711}
[INFO: 2022-09-24 15:39:45,963] ######## Epoch (TEST)2 ########
[INFO: 2022-09-24 15:39:45,964] {'Bleu_1': 0.012852382786436968, 'Bleu_2': 0.007745562288870024, 'Bleu_3': 0.0028420978709678565, 'Bleu_4': 3.1139362546878933e-07, 'METEOR': 0.02309746714829122, 'ROUGE_L': 0.04411044397193868, 'CIDEr': 0.008106730120573672}
[INFO: 2022-09-24 15:40:55,899] ######## Epoch (VAL)3 ########
[INFO: 2022-09-24 15:40:55,899] {'Bleu_1': 0.02112811124083576, 'Bleu_2': 0.01330115331096986, 'Bleu_3': 0.01261216219189411, 'Bleu_4': 0.0004618459823419969, 'METEOR': 0.07633810333022908, 'ROUGE_L': 0.28188066013226276, 'CIDEr': 0.2678420077062567}
[INFO: 2022-09-24 15:41:11,785] ######## Epoch (TEST)3 ########
[INFO: 2022-09-24 15:41:11,786] {'Bleu_1': 0.032186142676260236, 'Bleu_2': 0.026091486815507145, 'Bleu_3': 0.02555364223232851, 'Bleu_4': 0.0008767080855114699, 'METEOR': 0.09170634307691827, 'ROUGE_L': 0.2892043651391788, 'CIDEr': 0.2907959978662014}
[INFO: 2022-09-24 15:42:21,639] ######## Epoch (VAL)4 ########
[INFO: 2022-09-24 15:42:21,640] {'Bleu_1': 0.08934981746520346, 'Bleu_2': 0.0802711441790436, 'Bleu_3': 0.07591626396954018, 'Bleu_4': 1.063481191443229e-05, 'METEOR': 0.11656710009825254, 'ROUGE_L': 0.3389117814230064, 'CIDEr': 0.47575203071204736}
[INFO: 2022-09-24 15:42:37,481] ######## Epoch (TEST)4 ########
[INFO: 2022-09-24 15:42:37,482] {'Bleu_1': 0.07524232120848441, 'Bleu_2': 0.06756283100179158, 'Bleu_3': 0.06468113256577615, 'Bleu_4': 1.29168250606219e-05, 'METEOR': 0.11007897990254352, 'ROUGE_L': 0.30530877110594307, 'CIDEr': 0.428634782246478}
[INFO: 2022-09-24 15:43:47,620] ######## Epoch (VAL)5 ########
[INFO: 2022-09-24 15:43:47,620] {'Bleu_1': 0.13842611401459481, 'Bleu_2': 0.12557007232798, 'Bleu_3': 0.119271648222709, 'Bleu_4': 0.11438144484031361, 'METEOR': 0.12667988328914023, 'ROUGE_L': 0.37347675542489384, 'CIDEr': 0.7304309934457115}
[INFO: 2022-09-24 15:44:03,404] ######## Epoch (TEST)5 ########
[INFO: 2022-09-24 15:44:03,404] {'Bleu_1': 0.1291205979097986, 'Bleu_2': 0.11741234204907483, 'Bleu_3': 0.11054090020570388, 'Bleu_4': 0.10503853027392411, 'METEOR': 0.12253621885202899, 'ROUGE_L': 0.35181293629231675, 'CIDEr': 0.6735275755578892}
[INFO: 2022-09-24 15:45:13,614] ######## Epoch (VAL)6 ########
[INFO: 2022-09-24 15:45:13,615] {'Bleu_1': 0.22135986666627958, 'Bleu_2': 0.19633451538373697, 'Bleu_3': 0.17532607514515097, 'Bleu_4': 0.1488225396817264, 'METEOR': 0.14979223876332973, 'ROUGE_L': 0.39930023023385386, 'CIDEr': 0.8520821529813941}
[INFO: 2022-09-24 15:45:29,376] ######## Epoch (TEST)6 ########
[INFO: 2022-09-24 15:45:29,377] {'Bleu_1': 0.25311046563035305, 'Bleu_2': 0.23660109024546452, 'Bleu_3': 0.21533541049382457, 'Bleu_4': 0.17917939047080922, 'METEOR': 0.16792921967207894, 'ROUGE_L': 0.42908532650780573, 'CIDEr': 0.9320194580607863}
[INFO: 2022-09-24 15:46:39,545] ######## Epoch (VAL)7 ########
[INFO: 2022-09-24 15:46:39,546] {'Bleu_1': 0.5798132550686003, 'Bleu_2': 0.524539000972515, 'Bleu_3': 0.46694949006521974, 'Bleu_4': 0.4049291148434091, 'METEOR': 0.29445086365642964, 'ROUGE_L': 0.6053615709541142, 'CIDEr': 1.513020536542762}
[INFO: 2022-09-24 15:46:55,527] ######## Epoch (TEST)7 ########
[INFO: 2022-09-24 15:46:55,528] {'Bleu_1': 0.6113906511345036, 'Bleu_2': 0.5605925765142922, 'Bleu_3': 0.5034421172308671, 'Bleu_4': 0.43701534204386383, 'METEOR': 0.3093291690707837, 'ROUGE_L': 0.6358644784105434, 'CIDEr': 1.5227671718410027}
[INFO: 2022-09-24 15:48:05,951] ######## Epoch (VAL)8 ########
[INFO: 2022-09-24 15:48:05,952] {'Bleu_1': 0.5976710964623483, 'Bleu_2': 0.5356856863967988, 'Bleu_3': 0.4732916288354679, 'Bleu_4': 0.4081313605605519, 'METEOR': 0.3054554139403359, 'ROUGE_L': 0.6213370031251665, 'CIDEr': 1.5686583395314653}
[INFO: 2022-09-24 15:48:21,954] ######## Epoch (TEST)8 ########
[INFO: 2022-09-24 15:48:21,955] {'Bleu_1': 0.6932678780897495, 'Bleu_2': 0.6413111100738531, 'Bleu_3': 0.5784272774386067, 'Bleu_4': 0.5057933364064543, 'METEOR': 0.3473430526916505, 'ROUGE_L': 0.6865625768504222, 'CIDEr': 1.909800384293713}
[INFO: 2022-09-24 15:49:32,157] ######## Epoch (VAL)9 ########
[INFO: 2022-09-24 15:49:32,157] {'Bleu_1': 0.6721854277937982, 'Bleu_2': 0.6067119170847879, 'Bleu_3': 0.545958671458169, 'Bleu_4': 0.48222619299772634, 'METEOR': 0.339889454238844, 'ROUGE_L': 0.6688974811352686, 'CIDEr': 1.8232207129832594}
[INFO: 2022-09-24 15:49:48,116] ######## Epoch (TEST)9 ########
[INFO: 2022-09-24 15:49:48,116] {'Bleu_1': 0.6984106648049138, 'Bleu_2': 0.64813267274089, 'Bleu_3': 0.5866610289279158, 'Bleu_4': 0.517857999543348, 'METEOR': 0.35363098135308585, 'ROUGE_L': 0.7005660404293333, 'CIDEr': 1.9635345082125135}
[INFO: 2022-09-24 15:50:58,734] ######## Epoch (VAL)10 ########
[INFO: 2022-09-24 15:50:58,734] {'Bleu_1': 0.6419397036332356, 'Bleu_2': 0.5630257171870913, 'Bleu_3': 0.49148706898381234, 'Bleu_4': 0.4184563529370729, 'METEOR': 0.32186297165801786, 'ROUGE_L': 0.6397006629668517, 'CIDEr': 1.6857382255194595}
[INFO: 2022-09-24 15:51:14,563] ######## Epoch (TEST)10 ########
[INFO: 2022-09-24 15:51:14,563] {'Bleu_1': 0.7351877270691178, 'Bleu_2': 0.6734902734960782, 'Bleu_3': 0.6029684026933185, 'Bleu_4': 0.5274833250023558, 'METEOR': 0.36052576033694933, 'ROUGE_L': 0.7033986275752767, 'CIDEr': 2.036836892185192}
[INFO: 2022-09-24 15:52:24,834] ######## Epoch (VAL)11 ########
[INFO: 2022-09-24 15:52:24,835] {'Bleu_1': 0.643514398900309, 'Bleu_2': 0.5759604509122265, 'Bleu_3': 0.5130048589018419, 'Bleu_4': 0.4486309960969404, 'METEOR': 0.3265351257248639, 'ROUGE_L': 0.6663394046436825, 'CIDEr': 1.7658692727721088}
[INFO: 2022-09-24 15:52:40,734] ######## Epoch (TEST)11 ########
[INFO: 2022-09-24 15:52:40,735] {'Bleu_1': 0.6898729078103933, 'Bleu_2': 0.6302552798519703, 'Bleu_3': 0.5626410846691653, 'Bleu_4': 0.4919229108875528, 'METEOR': 0.34542934467992914, 'ROUGE_L': 0.7005968407476039, 'CIDEr': 1.9224949507490658}
[INFO: 2022-09-24 15:53:50,732] ######## Epoch (VAL)12 ########
[INFO: 2022-09-24 15:53:50,733] {'Bleu_1': 0.7637925844367086, 'Bleu_2': 0.676565217912684, 'Bleu_3': 0.6051540498310612, 'Bleu_4': 0.5398035968706878, 'METEOR': 0.36342091915370883, 'ROUGE_L': 0.6799730617269283, 'CIDEr': 2.218398745083223}
[INFO: 2022-09-24 15:54:06,413] ######## Epoch (TEST)12 ########
[INFO: 2022-09-24 15:54:06,413] {'Bleu_1': 0.8250728862961734, 'Bleu_2': 0.7392868838643898, 'Bleu_3': 0.6519530626264987, 'Bleu_4': 0.5685047325802395, 'METEOR': 0.40402219986749943, 'ROUGE_L': 0.7220382069360601, 'CIDEr': 2.2181800137030874}
[INFO: 2022-09-24 15:55:16,868] ######## Epoch (VAL)13 ########
[INFO: 2022-09-24 15:55:16,869] {'Bleu_1': 0.7706355360561306, 'Bleu_2': 0.6877251502061966, 'Bleu_3': 0.6144313609049896, 'Bleu_4': 0.5474674290795648, 'METEOR': 0.37442809266261917, 'ROUGE_L': 0.6963938193392809, 'CIDEr': 2.318825505136403}
[INFO: 2022-09-24 15:55:32,926] ######## Epoch (TEST)13 ########
[INFO: 2022-09-24 15:55:32,927] {'Bleu_1': 0.8176555716341278, 'Bleu_2': 0.7321623519959869, 'Bleu_3': 0.643632045014176, 'Bleu_4': 0.5616877280636692, 'METEOR': 0.4027115390187354, 'ROUGE_L': 0.7256593667057396, 'CIDEr': 2.2209308048233365}
[INFO: 2022-09-24 15:56:43,159] ######## Epoch (VAL)14 ########
[INFO: 2022-09-24 15:56:43,160] {'Bleu_1': 0.752550488286444, 'Bleu_2': 0.6772748856150819, 'Bleu_3': 0.6068291420902462, 'Bleu_4': 0.5387909694408103, 'METEOR': 0.3720931404234102, 'ROUGE_L': 0.6883130674409741, 'CIDEr': 2.238275745941291}
[INFO: 2022-09-24 15:56:58,946] ######## Epoch (TEST)14 ########
[INFO: 2022-09-24 15:56:58,947] {'Bleu_1': 0.8145506419389236, 'Bleu_2': 0.7276821126857311, 'Bleu_3': 0.6402877264256333, 'Bleu_4': 0.5603959997222979, 'METEOR': 0.4038244122328421, 'ROUGE_L': 0.7218415607401545, 'CIDEr': 2.279128140246954}
[INFO: 2022-09-24 15:58:09,506] ######## Epoch (VAL)15 ########
[INFO: 2022-09-24 15:58:09,506] {'Bleu_1': 0.7816420813996448, 'Bleu_2': 0.7003839457274267, 'Bleu_3': 0.6283760894187327, 'Bleu_4': 0.5614696076238628, 'METEOR': 0.3836205559274516, 'ROUGE_L': 0.7122252668292638, 'CIDEr': 2.410599750563656}
[INFO: 2022-09-24 15:58:25,051] ######## Epoch (TEST)15 ########
[INFO: 2022-09-24 15:58:25,052] {'Bleu_1': 0.8166431593782558, 'Bleu_2': 0.7284434686154213, 'Bleu_3': 0.6371058882259778, 'Bleu_4': 0.5519447107146644, 'METEOR': 0.4112325878798973, 'ROUGE_L': 0.7427632139747355, 'CIDEr': 2.377447721256025}
[INFO: 2022-09-24 15:59:34,766] ######## Epoch (VAL)16 ########
[INFO: 2022-09-24 15:59:34,767] {'Bleu_1': 0.7769985974743661, 'Bleu_2': 0.7024835077783131, 'Bleu_3': 0.6337960822220531, 'Bleu_4': 0.570966464603621, 'METEOR': 0.3927774889183502, 'ROUGE_L': 0.7103142791124535, 'CIDEr': 2.4798753060114476}
[INFO: 2022-09-24 15:59:50,223] ######## Epoch (TEST)16 ########
[INFO: 2022-09-24 15:59:50,224] {'Bleu_1': 0.8146611341620821, 'Bleu_2': 0.7291595040143508, 'Bleu_3': 0.6397974816805381, 'Bleu_4': 0.5571557937090323, 'METEOR': 0.418679239121346, 'ROUGE_L': 0.745515512332428, 'CIDEr': 2.4432110550648756}
[INFO: 2022-09-24 16:01:00,566] ######## Epoch (VAL)17 ########
[INFO: 2022-09-24 16:01:00,566] {'Bleu_1': 0.7820163487727766, 'Bleu_2': 0.704471153384736, 'Bleu_3': 0.6364256312744418, 'Bleu_4': 0.5741055436492881, 'METEOR': 0.39492236449233953, 'ROUGE_L': 0.7239038772335529, 'CIDEr': 2.615451241293806}
[INFO: 2022-09-24 16:01:16,238] ######## Epoch (TEST)17 ########
[INFO: 2022-09-24 16:01:16,238] {'Bleu_1': 0.8312757201634687, 'Bleu_2': 0.7499619234782138, 'Bleu_3': 0.66325676957585, 'Bleu_4': 0.5825041870552197, 'METEOR': 0.4254616279268915, 'ROUGE_L': 0.759434642851829, 'CIDEr': 2.544456227767066}
[INFO: 2022-09-24 16:02:26,248] ######## Epoch (VAL)18 ########
[INFO: 2022-09-24 16:02:26,249] {'Bleu_1': 0.7514044943809671, 'Bleu_2': 0.6702493457496563, 'Bleu_3': 0.6009979747173464, 'Bleu_4': 0.5401691798877576, 'METEOR': 0.3732939917921562, 'ROUGE_L': 0.6918031403103069, 'CIDEr': 2.4369862271539042}
[INFO: 2022-09-24 16:02:42,163] ######## Epoch (TEST)18 ########
[INFO: 2022-09-24 16:02:42,163] {'Bleu_1': 0.8446866485002116, 'Bleu_2': 0.7679721415484689, 'Bleu_3': 0.6898483553679985, 'Bleu_4': 0.6130875243837351, 'METEOR': 0.43165412761817923, 'ROUGE_L': 0.7645310630970423, 'CIDEr': 2.776721378817215}
[INFO: 2022-09-24 16:03:52,482] ######## Epoch (VAL)19 ########
[INFO: 2022-09-24 16:03:52,482] {'Bleu_1': 0.7691256830590586, 'Bleu_2': 0.6922984413357101, 'Bleu_3': 0.6224759305513544, 'Bleu_4': 0.5590626546493245, 'METEOR': 0.3949991177520789, 'ROUGE_L': 0.7138968259152544, 'CIDEr': 2.523926138014717}
[INFO: 2022-09-24 16:04:08,188] ######## Epoch (TEST)19 ########
[INFO: 2022-09-24 16:04:08,189] {'Bleu_1': 0.8267394270111504, 'Bleu_2': 0.7465143091476855, 'Bleu_3': 0.6611708468471963, 'Bleu_4': 0.5820637641918563, 'METEOR': 0.43174890891844686, 'ROUGE_L': 0.7649314015975481, 'CIDEr': 2.5066648319896974}
[INFO: 2022-09-24 16:05:18,590] ######## Epoch (VAL)20 ########
[INFO: 2022-09-24 16:05:18,591] {'Bleu_1': 0.7325790758775358, 'Bleu_2': 0.6487515809220189, 'Bleu_3': 0.5794586932027611, 'Bleu_4': 0.5167416118624958, 'METEOR': 0.38332408435756665, 'ROUGE_L': 0.6828936935359704, 'CIDEr': 2.4006921314998526}
[INFO: 2022-09-24 16:05:34,621] ######## Epoch (TEST)20 ########
[INFO: 2022-09-24 16:05:34,622] {'Bleu_1': 0.8581765557151112, 'Bleu_2': 0.7845387414267311, 'Bleu_3': 0.7132693256210502, 'Bleu_4': 0.6478671433025069, 'METEOR': 0.4540950334384839, 'ROUGE_L': 0.7843397347238906, 'CIDEr': 2.7062578154321524}
[INFO: 2022-09-24 16:11:25,630] Training with config:
[INFO: 2022-09-24 16:11:25,633] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_MULCLASS_LABEL': './mssydney/sent/mulcalss_train.pkl',
                 'INPUT_SEQ_PATH': './mssydney/sent/sydney_train_input.pkl',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 8,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mssydney/sent/sydney_train_target.pkl',
                 'TEST_4W_ID': './mscoco/misc/ids2path_json/coco_test4w_ids2path.json',
                 'TEST_ATT_FEATS': './mssydney/feature/Sydney',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mssydney/misc/ids2path_json/sydney_val_ids2path.json',
                 'TRAIN_ATT_FEATS': './mssydney/feature/Sydney',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mssydney/misc/ids2path_json/sydney_train_ids2path.json',
                 'VAL_ATT_FEATS': './mssydney/feature/Sydney',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mssydney/misc/ids2path_json/sydney_test_ids2path.json'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 5,
               'CAP_KEY': 'caption',
               'COCO_PATH': './coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mssydney/misc/val_sydney.json',
               'VAL_ANNFILE': './mssydney/misc/test_sydney.json',
               'VOCAB': './mssydney/txt/Sydney_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'CrossEntropy'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 1536,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 512,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 512,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [64, 32, 64],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 3,
                        'DIM': 512,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [64, 32, 64],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.1,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 3,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.1,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.1,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 1536,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 512,
           'SEQ_LEN': 24,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'PureT',
           'VOCAB_SIZE': 181,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 512,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'MAX_LEN': 'MAX_LEN',
           'MULCLASS': 'MULCLASS',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments_PureT/PureT_XE_Sydney/',
 'SCORER': {'CIDER_CACHED': './mssydney/misc/sydney_train_cider.pkl',
            'GT_PATH': './mssydney/misc/sydney_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1234.0,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 0.0005,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 512,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Noam',
                          'WARMUP': 10000},
            'MAX_EPOCH': 20,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2022-09-24 16:12:43,458] ######## Epoch (VAL)1 ########
[INFO: 2022-09-24 16:12:43,459] {'Bleu_1': 0.1096491228069374, 'Bleu_2': 0.012933504925858512, 'Bleu_3': 5.109498896775414e-08, 'Bleu_4': 1.0274488128545249e-10, 'METEOR': 0.060814542211451585, 'ROUGE_L': 0.14477311963902742, 'CIDEr': 0.005610574533772671}
[INFO: 2022-09-24 16:12:59,279] ######## Epoch (TEST)1 ########
[INFO: 2022-09-24 16:12:59,280] {'Bleu_1': 0.10937499999991862, 'Bleu_2': 2.9140775257487654e-10, 'Bleu_3': 4.1001256406183024e-13, 'Bleu_4': 1.5559514560413374e-14, 'METEOR': 0.05444573410360416, 'ROUGE_L': 0.12981073690091452, 'CIDEr': 0.0035312000857714125}
[INFO: 2022-09-24 16:14:10,198] ######## Epoch (VAL)2 ########
[INFO: 2022-09-24 16:14:10,199] {'Bleu_1': 0.0, 'Bleu_2': 0.0, 'Bleu_3': 0.0, 'Bleu_4': 0.0, 'METEOR': 0.0, 'ROUGE_L': 0.0, 'CIDEr': 0.0}
[INFO: 2022-09-24 16:14:25,658] ######## Epoch (TEST)2 ########
[INFO: 2022-09-24 16:14:25,658] {'Bleu_1': 0.0, 'Bleu_2': 0.0, 'Bleu_3': 0.0, 'Bleu_4': 0.0, 'METEOR': 0.0, 'ROUGE_L': 0.0, 'CIDEr': 0.0}
[INFO: 2022-09-24 16:15:38,624] ######## Epoch (VAL)3 ########
[INFO: 2022-09-24 16:15:38,625] {'Bleu_1': 0.024653482836150653, 'Bleu_2': 0.017610485874185716, 'Bleu_3': 0.019172458293177805, 'Bleu_4': 0.0006640660149296369, 'METEOR': 0.08190940442449189, 'ROUGE_L': 0.28300131984167026, 'CIDEr': 0.35998511908299885}
[INFO: 2022-09-24 16:15:55,055] ######## Epoch (TEST)3 ########
[INFO: 2022-09-24 16:15:55,056] {'Bleu_1': 0.030528652698672436, 'Bleu_2': 0.025775515080802044, 'Bleu_3': 0.027054321137197034, 'Bleu_4': 0.0009225428679721827, 'METEOR': 0.08923661111147377, 'ROUGE_L': 0.2698797552733586, 'CIDEr': 0.36629407888520765}
[INFO: 2022-09-24 16:17:07,830] ######## Epoch (VAL)4 ########
[INFO: 2022-09-24 16:17:07,830] {'Bleu_1': 0.083151005933268, 'Bleu_2': 0.07492962598437243, 'Bleu_3': 0.07237394575124792, 'Bleu_4': 0.0025341246104547115, 'METEOR': 0.11553699079838638, 'ROUGE_L': 0.334243926122598, 'CIDEr': 0.4737761742748219}
[INFO: 2022-09-24 16:17:23,662] ######## Epoch (TEST)4 ########
[INFO: 2022-09-24 16:17:23,662] {'Bleu_1': 0.07310366033115405, 'Bleu_2': 0.06577395186204237, 'Bleu_3': 0.06349782855409648, 'Bleu_4': 0.002254751123107003, 'METEOR': 0.10912169263951893, 'ROUGE_L': 0.30118049635385946, 'CIDEr': 0.4283429671557784}
[INFO: 2022-09-24 16:18:37,097] ######## Epoch (VAL)5 ########
[INFO: 2022-09-24 16:18:37,098] {'Bleu_1': 0.11606448943335337, 'Bleu_2': 0.10629353291464344, 'Bleu_3': 0.10309069310907223, 'Bleu_4': 0.10478510601669934, 'METEOR': 0.12448729697390659, 'ROUGE_L': 0.36098275298229643, 'CIDEr': 0.6862941632855355}
[INFO: 2022-09-24 16:18:52,915] ######## Epoch (TEST)5 ########
[INFO: 2022-09-24 16:18:52,916] {'Bleu_1': 0.10522513231054381, 'Bleu_2': 0.09712228038027815, 'Bleu_3': 0.09499278501147332, 'Bleu_4': 0.09929563140232626, 'METEOR': 0.1194463199365877, 'ROUGE_L': 0.3349100979891912, 'CIDEr': 0.6429518850650923}
[INFO: 2022-09-24 16:20:04,774] ######## Epoch (VAL)6 ########
[INFO: 2022-09-24 16:20:04,775] {'Bleu_1': 0.2335149270059953, 'Bleu_2': 0.2060461412153352, 'Bleu_3': 0.18527974537947892, 'Bleu_4': 0.16191804888919076, 'METEOR': 0.1528211956520547, 'ROUGE_L': 0.3961791778491963, 'CIDEr': 0.8504562278175692}
[INFO: 2022-09-24 16:20:21,109] ######## Epoch (TEST)6 ########
[INFO: 2022-09-24 16:20:21,110] {'Bleu_1': 0.2815573005809159, 'Bleu_2': 0.26737600438763676, 'Bleu_3': 0.24697344318862058, 'Bleu_4': 0.21141742953523607, 'METEOR': 0.18683884760993294, 'ROUGE_L': 0.4337230832440271, 'CIDEr': 0.979360422529184}
[INFO: 2022-09-24 16:21:33,724] ######## Epoch (VAL)7 ########
[INFO: 2022-09-24 16:21:33,725] {'Bleu_1': 0.6242972015439401, 'Bleu_2': 0.5609459665142579, 'Bleu_3': 0.49366736834942826, 'Bleu_4': 0.4292556087659677, 'METEOR': 0.2922881413104622, 'ROUGE_L': 0.6027260538570002, 'CIDEr': 1.5745507326661106}
[INFO: 2022-09-24 16:21:49,341] ######## Epoch (TEST)7 ########
[INFO: 2022-09-24 16:21:49,342] {'Bleu_1': 0.7066290096411909, 'Bleu_2': 0.6430303580631463, 'Bleu_3': 0.5657679476064829, 'Bleu_4': 0.4786748523149605, 'METEOR': 0.31560408530428746, 'ROUGE_L': 0.6372094486036465, 'CIDEr': 1.6972655434279493}
[INFO: 2022-09-24 16:23:01,832] ######## Epoch (VAL)8 ########
[INFO: 2022-09-24 16:23:01,832] {'Bleu_1': 0.6634369062580594, 'Bleu_2': 0.6022384891939899, 'Bleu_3': 0.5445543391900873, 'Bleu_4': 0.4857430620040728, 'METEOR': 0.3314723451836852, 'ROUGE_L': 0.6544067247970466, 'CIDEr': 1.7325005002615228}
[INFO: 2022-09-24 16:23:17,674] ######## Epoch (TEST)8 ########
[INFO: 2022-09-24 16:23:17,675] {'Bleu_1': 0.6940407316869233, 'Bleu_2': 0.6362330003555395, 'Bleu_3': 0.5717526405949771, 'Bleu_4': 0.4959127008584106, 'METEOR': 0.3389373438746197, 'ROUGE_L': 0.6739723178466439, 'CIDEr': 1.8653228983240018}
[INFO: 2022-09-24 16:24:30,397] ######## Epoch (VAL)9 ########
[INFO: 2022-09-24 16:24:30,398] {'Bleu_1': 0.6797183700786719, 'Bleu_2': 0.6124548719437499, 'Bleu_3': 0.5500257792704062, 'Bleu_4': 0.4859451936141833, 'METEOR': 0.33950647515125854, 'ROUGE_L': 0.6637189505682709, 'CIDEr': 1.8348124838534812}
[INFO: 2022-09-24 16:24:46,393] ######## Epoch (TEST)9 ########
[INFO: 2022-09-24 16:24:46,394] {'Bleu_1': 0.7185537546269446, 'Bleu_2': 0.6615049878546101, 'Bleu_3': 0.5962202809136695, 'Bleu_4': 0.5260723299035626, 'METEOR': 0.34826120804942423, 'ROUGE_L': 0.6826088257945774, 'CIDEr': 1.9813704163545953}
[INFO: 2022-09-24 16:25:59,510] ######## Epoch (VAL)10 ########
[INFO: 2022-09-24 16:25:59,511] {'Bleu_1': 0.6376691172132943, 'Bleu_2': 0.5653469626127747, 'Bleu_3': 0.4986326451515441, 'Bleu_4': 0.4314934313888751, 'METEOR': 0.3211578051553203, 'ROUGE_L': 0.6423744398522253, 'CIDEr': 1.700169517563372}
[INFO: 2022-09-24 16:26:16,608] ######## Epoch (TEST)10 ########
[INFO: 2022-09-24 16:26:16,608] {'Bleu_1': 0.6916768254432814, 'Bleu_2': 0.632287725833505, 'Bleu_3': 0.5646171274047452, 'Bleu_4': 0.4883156407848519, 'METEOR': 0.3365876520985768, 'ROUGE_L': 0.6755392551791215, 'CIDEr': 1.8914447618385173}
[INFO: 2022-09-24 16:27:30,444] ######## Epoch (VAL)11 ########
[INFO: 2022-09-24 16:27:30,445] {'Bleu_1': 0.6514486155418907, 'Bleu_2': 0.5908462541905697, 'Bleu_3': 0.5320927448137608, 'Bleu_4': 0.4679037974618281, 'METEOR': 0.33615801939877565, 'ROUGE_L': 0.691177525190684, 'CIDEr': 1.8574256456632445}
[INFO: 2022-09-24 16:27:48,331] ######## Epoch (TEST)11 ########
[INFO: 2022-09-24 16:27:48,332] {'Bleu_1': 0.6548516397003811, 'Bleu_2': 0.5941835841196115, 'Bleu_3': 0.5316850066644776, 'Bleu_4': 0.4658529804757801, 'METEOR': 0.3303447762396878, 'ROUGE_L': 0.6699114121671784, 'CIDEr': 1.7748421020716598}
[INFO: 2022-09-24 16:29:01,466] ######## Epoch (VAL)12 ########
[INFO: 2022-09-24 16:29:01,466] {'Bleu_1': 0.7900069872533175, 'Bleu_2': 0.7105816281624314, 'Bleu_3': 0.638343934991125, 'Bleu_4': 0.5699082938145379, 'METEOR': 0.3779235853250341, 'ROUGE_L': 0.7040099848595838, 'CIDEr': 2.2757893197903623}
[INFO: 2022-09-24 16:29:18,587] ######## Epoch (TEST)12 ########
[INFO: 2022-09-24 16:29:18,587] {'Bleu_1': 0.816326530611055, 'Bleu_2': 0.7309253842396028, 'Bleu_3': 0.6440289124064476, 'Bleu_4': 0.5611124867863029, 'METEOR': 0.4038546003475794, 'ROUGE_L': 0.7174809947211086, 'CIDEr': 2.227016990670851}
[INFO: 2022-09-24 16:30:31,540] ######## Epoch (VAL)13 ########
[INFO: 2022-09-24 16:30:31,540] {'Bleu_1': 0.7887283443112327, 'Bleu_2': 0.7124090287333387, 'Bleu_3': 0.6417768254367329, 'Bleu_4': 0.5747690543809323, 'METEOR': 0.38129235140422874, 'ROUGE_L': 0.7041940194758488, 'CIDEr': 2.341023384709904}
[INFO: 2022-09-24 16:30:48,347] ######## Epoch (TEST)13 ########
[INFO: 2022-09-24 16:30:48,348] {'Bleu_1': 0.8086330935240164, 'Bleu_2': 0.7205559244556506, 'Bleu_3': 0.6346007206922722, 'Bleu_4': 0.553253705955561, 'METEOR': 0.4009195398805183, 'ROUGE_L': 0.7135052320706836, 'CIDEr': 2.2067408553771153}
[INFO: 2022-09-24 16:32:01,665] ######## Epoch (VAL)14 ########
[INFO: 2022-09-24 16:32:01,665] {'Bleu_1': 0.7774572176752265, 'Bleu_2': 0.6955725793638977, 'Bleu_3': 0.6235423001381067, 'Bleu_4': 0.5568154526560288, 'METEOR': 0.3761687549195978, 'ROUGE_L': 0.7033811940959324, 'CIDEr': 2.3441696458851675}
[INFO: 2022-09-24 16:32:18,743] ######## Epoch (TEST)14 ########
[INFO: 2022-09-24 16:32:18,743] {'Bleu_1': 0.8170028818432031, 'Bleu_2': 0.7327762370175586, 'Bleu_3': 0.642875659849271, 'Bleu_4': 0.5603814216403687, 'METEOR': 0.4058296106411109, 'ROUGE_L': 0.7288871890894899, 'CIDEr': 2.2661197203059453}
[INFO: 2022-09-24 16:33:31,975] ######## Epoch (VAL)15 ########
[INFO: 2022-09-24 16:33:31,975] {'Bleu_1': 0.7783351219318455, 'Bleu_2': 0.6986601275132855, 'Bleu_3': 0.6258820954274416, 'Bleu_4': 0.5566127676457233, 'METEOR': 0.38468881338002475, 'ROUGE_L': 0.7134129329772183, 'CIDEr': 2.3841267779585387}
[INFO: 2022-09-24 16:33:49,270] ######## Epoch (TEST)15 ########
[INFO: 2022-09-24 16:33:49,270] {'Bleu_1': 0.84425036389979, 'Bleu_2': 0.7561624465033749, 'Bleu_3': 0.6622124882857066, 'Bleu_4': 0.5711604748546478, 'METEOR': 0.41189525277032474, 'ROUGE_L': 0.7632920315342436, 'CIDEr': 2.5097066539927795}
[INFO: 2022-09-24 16:35:02,114] ######## Epoch (VAL)16 ########
[INFO: 2022-09-24 16:35:02,115] {'Bleu_1': 0.7887323943650864, 'Bleu_2': 0.7068317790779793, 'Bleu_3': 0.6360955713187478, 'Bleu_4': 0.5713981436465226, 'METEOR': 0.39329735952240735, 'ROUGE_L': 0.7177925986631327, 'CIDEr': 2.5095273001558476}
[INFO: 2022-09-24 16:35:19,421] ######## Epoch (TEST)16 ########
[INFO: 2022-09-24 16:35:19,422] {'Bleu_1': 0.8127600554773748, 'Bleu_2': 0.7260368088084185, 'Bleu_3': 0.6386717363179247, 'Bleu_4': 0.5583017424895126, 'METEOR': 0.41073615887304843, 'ROUGE_L': 0.7380172366503582, 'CIDEr': 2.4061534404735654}
[INFO: 2022-09-24 16:36:32,572] ######## Epoch (VAL)17 ########
[INFO: 2022-09-24 16:36:32,572] {'Bleu_1': 0.7960893854737485, 'Bleu_2': 0.7195978454967301, 'Bleu_3': 0.6539198029945408, 'Bleu_4': 0.5913309794636247, 'METEOR': 0.3982764564718416, 'ROUGE_L': 0.7223475197570777, 'CIDEr': 2.591893350669309}
[INFO: 2022-09-24 16:36:49,653] ######## Epoch (TEST)17 ########
[INFO: 2022-09-24 16:36:49,654] {'Bleu_1': 0.8403361344526046, 'Bleu_2': 0.7626100530744097, 'Bleu_3': 0.6783746858998554, 'Bleu_4': 0.5971857765389164, 'METEOR': 0.4286770796774778, 'ROUGE_L': 0.7572484521729217, 'CIDEr': 2.5573189124845044}
[INFO: 2022-09-24 16:38:02,689] ######## Epoch (VAL)18 ########
[INFO: 2022-09-24 16:38:02,689] {'Bleu_1': 0.7012280294152462, 'Bleu_2': 0.6062282532534929, 'Bleu_3': 0.5369444278314595, 'Bleu_4': 0.4765471159517556, 'METEOR': 0.3617662304117629, 'ROUGE_L': 0.6598041164431373, 'CIDEr': 2.179125878272149}
[INFO: 2022-09-24 16:38:19,927] ######## Epoch (TEST)18 ########
[INFO: 2022-09-24 16:38:19,928] {'Bleu_1': 0.7804532577892628, 'Bleu_2': 0.6862373071023992, 'Bleu_3': 0.6002819843550966, 'Bleu_4': 0.5142457199837462, 'METEOR': 0.39989120741532796, 'ROUGE_L': 0.7073200672789649, 'CIDEr': 2.2713656359590755}
[INFO: 2022-09-24 16:39:33,312] ######## Epoch (VAL)19 ########
[INFO: 2022-09-24 16:39:33,313] {'Bleu_1': 0.7806539509526149, 'Bleu_2': 0.6997434813201394, 'Bleu_3': 0.6275976092682775, 'Bleu_4': 0.5607586199275733, 'METEOR': 0.39881709662453674, 'ROUGE_L': 0.7243349994014372, 'CIDEr': 2.5313798270473082}
[INFO: 2022-09-24 16:39:50,223] ######## Epoch (TEST)19 ########
[INFO: 2022-09-24 16:39:50,223] {'Bleu_1': 0.835635359114868, 'Bleu_2': 0.7564038156739279, 'Bleu_3': 0.6744355914771449, 'Bleu_4': 0.5984758735517726, 'METEOR': 0.4337329030344265, 'ROUGE_L': 0.7658206255071182, 'CIDEr': 2.6119035999308626}
[INFO: 2022-09-24 16:41:03,330] ######## Epoch (VAL)20 ########
[INFO: 2022-09-24 16:41:03,330] {'Bleu_1': 0.7517630465433685, 'Bleu_2': 0.6615605470077106, 'Bleu_3': 0.5933218093773158, 'Bleu_4': 0.5331775751761375, 'METEOR': 0.3899851443146456, 'ROUGE_L': 0.6980229749725966, 'CIDEr': 2.4147022882317626}
[INFO: 2022-09-24 16:41:20,627] ######## Epoch (TEST)20 ########
[INFO: 2022-09-24 16:41:20,627] {'Bleu_1': 0.7733013713028825, 'Bleu_2': 0.6675104387339422, 'Bleu_3': 0.5760731525140557, 'Bleu_4': 0.48890091418583037, 'METEOR': 0.39567895534914577, 'ROUGE_L': 0.6992887591487545, 'CIDEr': 2.2483470945270527}
[INFO: 2022-09-28 19:09:57,898] Training with config:
[INFO: 2022-09-28 19:09:57,899] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mssydney/sent/sydney_train_input.pkl',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 8,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mssydney/sent/sydney_train_target.pkl',
                 'TEST_4W_ID': './mscoco/misc/ids2path_json/coco_test4w_ids2path.json',
                 'TEST_ATT_FEATS': './mssydney/feature/Sydney',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mssydney/misc/ids2path_json/sydney_val_ids2path.json',
                 'TRAIN_ATT_FEATS': './mssydney/feature/Sydney',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mssydney/misc/ids2path_json/sydney_train_ids2path.json',
                 'VAL_ATT_FEATS': './mssydney/feature/Sydney',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mssydney/misc/ids2path_json/sydney_test_ids2path.json'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 5,
               'CAP_KEY': 'caption',
               'COCO_PATH': './coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mssydney/misc/val_sydney.json',
               'VAL_ANNFILE': './mssydney/misc/test_sydney.json',
               'VOCAB': './mssydney/txt/Sydney_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'CrossEntropy'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 1536,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 512,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 512,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [64, 32, 64],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 3,
                        'DIM': 512,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [64, 32, 64],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.1,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 3,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.1,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.1,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 1536,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 512,
           'SEQ_LEN': 24,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'PureT',
           'VOCAB_SIZE': 181,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 512,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'MAX_LEN': 'MAX_LEN',
           'MULCLASS': 'MULCLASS',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments_PureT/PureT_XE_Sydney/',
 'SCORER': {'CIDER_CACHED': './mssydney/misc/sydney_train_cider.pkl',
            'GT_PATH': './mssydney/misc/sydney_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1234.0,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 0.0005,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 512,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Noam',
                          'WARMUP': 10000},
            'MAX_EPOCH': 20,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2022-09-28 19:10:36,838] Training with config:
[INFO: 2022-09-28 19:10:36,839] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mssydney/sent/sydney_train_input.pkl',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 8,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mssydney/sent/sydney_train_target.pkl',
                 'TEST_4W_ID': './mscoco/misc/ids2path_json/coco_test4w_ids2path.json',
                 'TEST_ATT_FEATS': './mssydney/feature/Sydney',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mssydney/misc/ids2path_json/sydney_val_ids2path.json',
                 'TRAIN_ATT_FEATS': './mssydney/feature/Sydney',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mssydney/misc/ids2path_json/sydney_train_ids2path.json',
                 'VAL_ATT_FEATS': './mssydney/feature/Sydney',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mssydney/misc/ids2path_json/sydney_test_ids2path.json'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 5,
               'CAP_KEY': 'caption',
               'COCO_PATH': './coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mssydney/misc/val_sydney.json',
               'VAL_ANNFILE': './mssydney/misc/test_sydney.json',
               'VOCAB': './mssydney/txt/Sydney_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'CrossEntropy'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 1536,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 512,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 512,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [64, 32, 64],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 3,
                        'DIM': 512,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [64, 32, 64],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.1,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 3,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.1,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.1,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 1536,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 512,
           'SEQ_LEN': 24,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'PureT',
           'VOCAB_SIZE': 181,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 512,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'MAX_LEN': 'MAX_LEN',
           'MULCLASS': 'MULCLASS',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments_PureT/PureT_XE_Sydney/',
 'SCORER': {'CIDER_CACHED': './mssydney/misc/sydney_train_cider.pkl',
            'GT_PATH': './mssydney/misc/sydney_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1234.0,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 0.0005,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 512,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Noam',
                          'WARMUP': 10000},
            'MAX_EPOCH': 20,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2022-09-28 19:12:19,291] ######## Epoch (VAL)1 ########
[INFO: 2022-09-28 19:12:19,292] {'Bleu_1': 0.1096491228069374, 'Bleu_2': 0.012933504925858512, 'Bleu_3': 5.109498896775414e-08, 'Bleu_4': 1.0274488128545249e-10, 'METEOR': 0.060814542211451585, 'ROUGE_L': 0.14477311963902742, 'CIDEr': 0.005610574533772671}
[INFO: 2022-09-28 19:12:38,928] ######## Epoch (TEST)1 ########
[INFO: 2022-09-28 19:12:38,928] {'Bleu_1': 0.10937499999991862, 'Bleu_2': 2.9140775257487654e-10, 'Bleu_3': 4.1001256406183024e-13, 'Bleu_4': 1.5559514560413374e-14, 'METEOR': 0.05444573410360416, 'ROUGE_L': 0.12981073690091452, 'CIDEr': 0.0035312000857714125}
[INFO: 2022-09-28 19:14:07,971] ######## Epoch (VAL)2 ########
[INFO: 2022-09-28 19:14:07,971] {'Bleu_1': 0.0, 'Bleu_2': 0.0, 'Bleu_3': 0.0, 'Bleu_4': 0.0, 'METEOR': 0.0, 'ROUGE_L': 0.0, 'CIDEr': 0.0}
[INFO: 2022-09-28 19:14:27,315] ######## Epoch (TEST)2 ########
[INFO: 2022-09-28 19:14:27,316] {'Bleu_1': 0.0, 'Bleu_2': 0.0, 'Bleu_3': 0.0, 'Bleu_4': 0.0, 'METEOR': 0.0, 'ROUGE_L': 0.0, 'CIDEr': 0.0}
[INFO: 2022-09-28 19:15:57,144] ######## Epoch (VAL)3 ########
[INFO: 2022-09-28 19:15:57,144] {'Bleu_1': 0.024653482836150653, 'Bleu_2': 0.017610485874185716, 'Bleu_3': 0.019172458293177805, 'Bleu_4': 0.0006640660149296369, 'METEOR': 0.08190940442449189, 'ROUGE_L': 0.28300131984167026, 'CIDEr': 0.35998511908299885}
[INFO: 2022-09-28 19:16:16,143] ######## Epoch (TEST)3 ########
[INFO: 2022-09-28 19:16:16,143] {'Bleu_1': 0.030528652698672436, 'Bleu_2': 0.025775515080802044, 'Bleu_3': 0.027054321137197034, 'Bleu_4': 0.0009225428679721827, 'METEOR': 0.08923661111147377, 'ROUGE_L': 0.2698797552733586, 'CIDEr': 0.36629407888520765}
[INFO: 2022-09-28 19:17:45,570] ######## Epoch (VAL)4 ########
[INFO: 2022-09-28 19:17:45,571] {'Bleu_1': 0.083151005933268, 'Bleu_2': 0.07492962598437243, 'Bleu_3': 0.07237394575124792, 'Bleu_4': 0.0025341246104547115, 'METEOR': 0.11553699079838638, 'ROUGE_L': 0.334243926122598, 'CIDEr': 0.4737761742748219}
[INFO: 2022-09-28 19:18:04,969] ######## Epoch (TEST)4 ########
[INFO: 2022-09-28 19:18:04,969] {'Bleu_1': 0.07310366033115405, 'Bleu_2': 0.06577395186204237, 'Bleu_3': 0.06349782855409648, 'Bleu_4': 0.002254751123107003, 'METEOR': 0.10912169263951893, 'ROUGE_L': 0.30118049635385946, 'CIDEr': 0.4283429671557784}
[INFO: 2022-09-28 19:19:33,600] ######## Epoch (VAL)5 ########
[INFO: 2022-09-28 19:19:33,600] {'Bleu_1': 0.11606448943335337, 'Bleu_2': 0.10629353291464344, 'Bleu_3': 0.10309069310907223, 'Bleu_4': 0.10478510601669934, 'METEOR': 0.12448729697390659, 'ROUGE_L': 0.36098275298229643, 'CIDEr': 0.6862941632855355}
[INFO: 2022-09-28 19:19:52,552] ######## Epoch (TEST)5 ########
[INFO: 2022-09-28 19:19:52,553] {'Bleu_1': 0.10522513231054381, 'Bleu_2': 0.09712228038027815, 'Bleu_3': 0.09499278501147332, 'Bleu_4': 0.09929563140232626, 'METEOR': 0.1194463199365877, 'ROUGE_L': 0.3349100979891912, 'CIDEr': 0.6429518850650923}
[INFO: 2022-09-28 19:21:21,690] ######## Epoch (VAL)6 ########
[INFO: 2022-09-28 19:21:21,690] {'Bleu_1': 0.2335149270059953, 'Bleu_2': 0.2060461412153352, 'Bleu_3': 0.18527974537947892, 'Bleu_4': 0.16191804888919076, 'METEOR': 0.1528211956520547, 'ROUGE_L': 0.3961791778491963, 'CIDEr': 0.8504562278175692}
[INFO: 2022-09-28 19:21:40,436] ######## Epoch (TEST)6 ########
[INFO: 2022-09-28 19:21:40,437] {'Bleu_1': 0.2815573005809159, 'Bleu_2': 0.26737600438763676, 'Bleu_3': 0.24697344318862058, 'Bleu_4': 0.21141742953523607, 'METEOR': 0.18683884760993294, 'ROUGE_L': 0.4337230832440271, 'CIDEr': 0.979360422529184}
[INFO: 2022-09-28 19:23:10,001] ######## Epoch (VAL)7 ########
[INFO: 2022-09-28 19:23:10,001] {'Bleu_1': 0.6242972015439401, 'Bleu_2': 0.5609459665142579, 'Bleu_3': 0.49366736834942826, 'Bleu_4': 0.4292556087659677, 'METEOR': 0.2922881413104622, 'ROUGE_L': 0.6027260538570002, 'CIDEr': 1.5745507326661106}
[INFO: 2022-09-28 19:23:29,008] ######## Epoch (TEST)7 ########
[INFO: 2022-09-28 19:23:29,008] {'Bleu_1': 0.7066290096411909, 'Bleu_2': 0.6430303580631463, 'Bleu_3': 0.5657679476064829, 'Bleu_4': 0.4786748523149605, 'METEOR': 0.31560408530428746, 'ROUGE_L': 0.6372094486036465, 'CIDEr': 1.6972655434279493}
[INFO: 2022-09-28 19:24:59,258] ######## Epoch (VAL)8 ########
[INFO: 2022-09-28 19:24:59,258] {'Bleu_1': 0.6634369062580594, 'Bleu_2': 0.6022384891939899, 'Bleu_3': 0.5445543391900873, 'Bleu_4': 0.4857430620040728, 'METEOR': 0.3314723451836852, 'ROUGE_L': 0.6544067247970466, 'CIDEr': 1.7325005002615228}
[INFO: 2022-09-28 19:25:18,775] ######## Epoch (TEST)8 ########
[INFO: 2022-09-28 19:25:18,776] {'Bleu_1': 0.6940407316869233, 'Bleu_2': 0.6362330003555395, 'Bleu_3': 0.5717526405949771, 'Bleu_4': 0.4959127008584106, 'METEOR': 0.3389373438746197, 'ROUGE_L': 0.6739723178466439, 'CIDEr': 1.8653228983240018}
[INFO: 2022-09-28 19:26:47,874] ######## Epoch (VAL)9 ########
[INFO: 2022-09-28 19:26:47,875] {'Bleu_1': 0.6797183700786719, 'Bleu_2': 0.6124548719437499, 'Bleu_3': 0.5500257792704062, 'Bleu_4': 0.4859451936141833, 'METEOR': 0.33950647515125854, 'ROUGE_L': 0.6637189505682709, 'CIDEr': 1.8348124838534812}
[INFO: 2022-09-28 19:27:07,066] ######## Epoch (TEST)9 ########
[INFO: 2022-09-28 19:27:07,067] {'Bleu_1': 0.7185537546269446, 'Bleu_2': 0.6615049878546101, 'Bleu_3': 0.5962202809136695, 'Bleu_4': 0.5260723299035626, 'METEOR': 0.34826120804942423, 'ROUGE_L': 0.6826088257945774, 'CIDEr': 1.9813704163545953}
[INFO: 2022-09-28 19:28:36,027] ######## Epoch (VAL)10 ########
[INFO: 2022-09-28 19:28:36,028] {'Bleu_1': 0.6376691172132943, 'Bleu_2': 0.5653469626127747, 'Bleu_3': 0.4986326451515441, 'Bleu_4': 0.4314934313888751, 'METEOR': 0.3211578051553203, 'ROUGE_L': 0.6423744398522253, 'CIDEr': 1.700169517563372}
[INFO: 2022-09-28 19:28:55,153] ######## Epoch (TEST)10 ########
[INFO: 2022-09-28 19:28:55,154] {'Bleu_1': 0.6916768254432814, 'Bleu_2': 0.632287725833505, 'Bleu_3': 0.5646171274047452, 'Bleu_4': 0.4883156407848519, 'METEOR': 0.3365876520985768, 'ROUGE_L': 0.6755392551791215, 'CIDEr': 1.8914447618385173}
[INFO: 2022-09-28 19:30:25,067] ######## Epoch (VAL)11 ########
[INFO: 2022-09-28 19:30:25,068] {'Bleu_1': 0.6514486155418907, 'Bleu_2': 0.5908462541905697, 'Bleu_3': 0.5320927448137608, 'Bleu_4': 0.4679037974618281, 'METEOR': 0.33615801939877565, 'ROUGE_L': 0.691177525190684, 'CIDEr': 1.8574256456632445}
[INFO: 2022-09-28 19:30:44,050] ######## Epoch (TEST)11 ########
[INFO: 2022-09-28 19:30:44,050] {'Bleu_1': 0.6548516397003811, 'Bleu_2': 0.5941835841196115, 'Bleu_3': 0.5316850066644776, 'Bleu_4': 0.4658529804757801, 'METEOR': 0.3303447762396878, 'ROUGE_L': 0.6699114121671784, 'CIDEr': 1.7748421020716598}
[INFO: 2022-09-28 19:32:13,886] ######## Epoch (VAL)12 ########
[INFO: 2022-09-28 19:32:13,886] {'Bleu_1': 0.7900069872533175, 'Bleu_2': 0.7105816281624314, 'Bleu_3': 0.638343934991125, 'Bleu_4': 0.5699082938145379, 'METEOR': 0.3779235853250341, 'ROUGE_L': 0.7040099848595838, 'CIDEr': 2.2757893197903623}
[INFO: 2022-09-28 19:32:33,024] ######## Epoch (TEST)12 ########
[INFO: 2022-09-28 19:32:33,024] {'Bleu_1': 0.816326530611055, 'Bleu_2': 0.7309253842396028, 'Bleu_3': 0.6440289124064476, 'Bleu_4': 0.5611124867863029, 'METEOR': 0.4038546003475794, 'ROUGE_L': 0.7174809947211086, 'CIDEr': 2.227016990670851}
[INFO: 2022-09-28 19:34:02,782] ######## Epoch (VAL)13 ########
[INFO: 2022-09-28 19:34:02,783] {'Bleu_1': 0.7887283443112327, 'Bleu_2': 0.7124090287333387, 'Bleu_3': 0.6417768254367329, 'Bleu_4': 0.5747690543809323, 'METEOR': 0.38129235140422874, 'ROUGE_L': 0.7041940194758488, 'CIDEr': 2.341023384709904}
[INFO: 2022-09-28 19:34:22,192] ######## Epoch (TEST)13 ########
[INFO: 2022-09-28 19:34:22,193] {'Bleu_1': 0.8086330935240164, 'Bleu_2': 0.7205559244556506, 'Bleu_3': 0.6346007206922722, 'Bleu_4': 0.553253705955561, 'METEOR': 0.4009195398805183, 'ROUGE_L': 0.7135052320706836, 'CIDEr': 2.2067408553771153}
[INFO: 2022-09-28 19:35:53,493] ######## Epoch (VAL)14 ########
[INFO: 2022-09-28 19:35:53,494] {'Bleu_1': 0.7774572176752265, 'Bleu_2': 0.6955725793638977, 'Bleu_3': 0.6235423001381067, 'Bleu_4': 0.5568154526560288, 'METEOR': 0.3761687549195978, 'ROUGE_L': 0.7033811940959324, 'CIDEr': 2.3441696458851675}
[INFO: 2022-09-28 19:36:14,123] ######## Epoch (TEST)14 ########
[INFO: 2022-09-28 19:36:14,123] {'Bleu_1': 0.8170028818432031, 'Bleu_2': 0.7327762370175586, 'Bleu_3': 0.642875659849271, 'Bleu_4': 0.5603814216403687, 'METEOR': 0.4058296106411109, 'ROUGE_L': 0.7288871890894899, 'CIDEr': 2.2661197203059453}
[INFO: 2022-09-28 19:37:44,881] ######## Epoch (VAL)15 ########
[INFO: 2022-09-28 19:37:44,882] {'Bleu_1': 0.7783351219318455, 'Bleu_2': 0.6986601275132855, 'Bleu_3': 0.6258820954274416, 'Bleu_4': 0.5566127676457233, 'METEOR': 0.38468881338002475, 'ROUGE_L': 0.7134129329772183, 'CIDEr': 2.3841267779585387}
[INFO: 2022-09-28 19:38:04,520] ######## Epoch (TEST)15 ########
[INFO: 2022-09-28 19:38:04,520] {'Bleu_1': 0.84425036389979, 'Bleu_2': 0.7561624465033749, 'Bleu_3': 0.6622124882857066, 'Bleu_4': 0.5711604748546478, 'METEOR': 0.41189525277032474, 'ROUGE_L': 0.7632920315342436, 'CIDEr': 2.5097066539927795}
[INFO: 2022-09-28 19:39:36,715] ######## Epoch (VAL)16 ########
[INFO: 2022-09-28 19:39:36,715] {'Bleu_1': 0.7887323943650864, 'Bleu_2': 0.7068317790779793, 'Bleu_3': 0.6360955713187478, 'Bleu_4': 0.5713981436465226, 'METEOR': 0.39329735952240735, 'ROUGE_L': 0.7177925986631327, 'CIDEr': 2.5095273001558476}
[INFO: 2022-09-28 19:39:56,131] ######## Epoch (TEST)16 ########
[INFO: 2022-09-28 19:39:56,132] {'Bleu_1': 0.8127600554773748, 'Bleu_2': 0.7260368088084185, 'Bleu_3': 0.6386717363179247, 'Bleu_4': 0.5583017424895126, 'METEOR': 0.41073615887304843, 'ROUGE_L': 0.7380172366503582, 'CIDEr': 2.4061534404735654}
[INFO: 2022-09-28 19:41:28,330] ######## Epoch (VAL)17 ########
[INFO: 2022-09-28 19:41:28,330] {'Bleu_1': 0.7960893854737485, 'Bleu_2': 0.7195978454967301, 'Bleu_3': 0.6539198029945408, 'Bleu_4': 0.5913309794636247, 'METEOR': 0.3982764564718416, 'ROUGE_L': 0.7223475197570777, 'CIDEr': 2.591893350669309}
[INFO: 2022-09-28 19:41:47,728] ######## Epoch (TEST)17 ########
[INFO: 2022-09-28 19:41:47,728] {'Bleu_1': 0.8403361344526046, 'Bleu_2': 0.7626100530744097, 'Bleu_3': 0.6783746858998554, 'Bleu_4': 0.5971857765389164, 'METEOR': 0.4286770796774778, 'ROUGE_L': 0.7572484521729217, 'CIDEr': 2.5573189124845044}
[INFO: 2022-09-28 19:43:18,675] ######## Epoch (VAL)18 ########
[INFO: 2022-09-28 19:43:18,675] {'Bleu_1': 0.7012280294152462, 'Bleu_2': 0.6062282532534929, 'Bleu_3': 0.5369444278314595, 'Bleu_4': 0.4765471159517556, 'METEOR': 0.3617662304117629, 'ROUGE_L': 0.6598041164431373, 'CIDEr': 2.179125878272149}
[INFO: 2022-09-28 19:43:37,652] ######## Epoch (TEST)18 ########
[INFO: 2022-09-28 19:43:37,652] {'Bleu_1': 0.7804532577892628, 'Bleu_2': 0.6862373071023992, 'Bleu_3': 0.6002819843550966, 'Bleu_4': 0.5142457199837462, 'METEOR': 0.39989120741532796, 'ROUGE_L': 0.7073200672789649, 'CIDEr': 2.2713656359590755}
[INFO: 2022-09-28 19:45:09,728] ######## Epoch (VAL)19 ########
[INFO: 2022-09-28 19:45:09,729] {'Bleu_1': 0.7806539509526149, 'Bleu_2': 0.6997434813201394, 'Bleu_3': 0.6275976092682775, 'Bleu_4': 0.5607586199275733, 'METEOR': 0.39881709662453674, 'ROUGE_L': 0.7243349994014372, 'CIDEr': 2.5313798270473082}
[INFO: 2022-09-28 19:45:29,299] ######## Epoch (TEST)19 ########
[INFO: 2022-09-28 19:45:29,300] {'Bleu_1': 0.835635359114868, 'Bleu_2': 0.7564038156739279, 'Bleu_3': 0.6744355914771449, 'Bleu_4': 0.5984758735517726, 'METEOR': 0.4337329030344265, 'ROUGE_L': 0.7658206255071182, 'CIDEr': 2.6119035999308626}
[INFO: 2022-09-28 19:47:01,414] ######## Epoch (VAL)20 ########
[INFO: 2022-09-28 19:47:01,414] {'Bleu_1': 0.7517630465433685, 'Bleu_2': 0.6615605470077106, 'Bleu_3': 0.5933218093773158, 'Bleu_4': 0.5331775751761375, 'METEOR': 0.3899851443146456, 'ROUGE_L': 0.6980229749725966, 'CIDEr': 2.4147022882317626}
[INFO: 2022-09-28 19:47:21,195] ######## Epoch (TEST)20 ########
[INFO: 2022-09-28 19:47:21,195] {'Bleu_1': 0.7733013713028825, 'Bleu_2': 0.6675104387339422, 'Bleu_3': 0.5760731525140557, 'Bleu_4': 0.48890091418583037, 'METEOR': 0.39567895534914577, 'ROUGE_L': 0.6992887591487545, 'CIDEr': 2.2483470945270527}
[INFO: 2022-09-28 20:41:49,708] Training with config:
[INFO: 2022-09-28 20:41:49,710] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mssydney/sent/sydney_train_input.pkl',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 8,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mssydney/sent/sydney_train_target.pkl',
                 'TEST_4W_ID': './mscoco/misc/ids2path_json/coco_test4w_ids2path.json',
                 'TEST_ATT_FEATS': './mssydney/feature/Sydney',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mssydney/misc/ids2path_json/sydney_val_ids2path.json',
                 'TRAIN_ATT_FEATS': './mssydney/feature/Sydney',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mssydney/misc/ids2path_json/sydney_train_ids2path.json',
                 'VAL_ATT_FEATS': './mssydney/feature/Sydney',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mssydney/misc/ids2path_json/sydney_test_ids2path.json'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 5,
               'CAP_KEY': 'caption',
               'COCO_PATH': './coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mssydney/misc/val_sydney.json',
               'VAL_ANNFILE': './mssydney/misc/test_sydney.json',
               'VOCAB': './mssydney/txt/Sydney_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'CrossEntropy'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 1536,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 512,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 512,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [64, 32, 64],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 3,
                        'DIM': 512,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [64, 32, 64],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.1,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 3,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.1,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.1,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 1536,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 512,
           'SEQ_LEN': 24,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'PureT',
           'VOCAB_SIZE': 181,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 512,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'MAX_LEN': 'MAX_LEN',
           'MULCLASS': 'MULCLASS',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments_PureT/PureT_XE_Sydney/',
 'SCORER': {'CIDER_CACHED': './mssydney/misc/sydney_train_cider.pkl',
            'GT_PATH': './mssydney/misc/sydney_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1234.0,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 0.0005,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 512,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Noam',
                          'WARMUP': 10000},
            'MAX_EPOCH': 20,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2022-09-28 20:49:57,965] Training with config:
[INFO: 2022-09-28 20:49:57,967] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mssydney/sent/sydney_train_input.pkl',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 8,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mssydney/sent/sydney_train_target.pkl',
                 'TEST_4W_ID': './mscoco/misc/ids2path_json/coco_test4w_ids2path.json',
                 'TEST_ATT_FEATS': './mssydney/feature/Sydney',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mssydney/misc/ids2path_json/sydney_val_ids2path.json',
                 'TRAIN_ATT_FEATS': './mssydney/feature/Sydney',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mssydney/misc/ids2path_json/sydney_train_ids2path.json',
                 'VAL_ATT_FEATS': './mssydney/feature/Sydney',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mssydney/misc/ids2path_json/sydney_test_ids2path.json'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 5,
               'CAP_KEY': 'caption',
               'COCO_PATH': './coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mssydney/misc/val_sydney.json',
               'VAL_ANNFILE': './mssydney/misc/test_sydney.json',
               'VOCAB': './mssydney/txt/Sydney_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'CrossEntropy'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 1536,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 512,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 512,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [64, 32, 64],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 3,
                        'DIM': 512,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [64, 32, 64],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.1,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 3,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.1,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.1,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 1536,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 512,
           'SEQ_LEN': 24,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'PureT',
           'VOCAB_SIZE': 181,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 512,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'MAX_LEN': 'MAX_LEN',
           'MULCLASS': 'MULCLASS',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments_PureT/PureT_XE_Sydney/',
 'SCORER': {'CIDER_CACHED': './mssydney/misc/sydney_train_cider.pkl',
            'GT_PATH': './mssydney/misc/sydney_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1234.0,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 0.0005,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 512,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Noam',
                          'WARMUP': 10000},
            'MAX_EPOCH': 20,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2022-09-28 20:51:40,365] ######## Epoch (VAL)1 ########
[INFO: 2022-09-28 20:51:40,366] {'Bleu_1': 0.15929799212753631, 'Bleu_2': 0.07163419265820647, 'Bleu_3': 2.1221916979049875e-07, 'Bleu_4': 3.7223727256810385e-10, 'METEOR': 0.06121871455981456, 'ROUGE_L': 0.15990528456859268, 'CIDEr': 0.06461513853961086}
[INFO: 2022-09-28 20:51:58,793] ######## Epoch (TEST)1 ########
[INFO: 2022-09-28 20:51:58,793] {'Bleu_1': 0.16087909320640528, 'Bleu_2': 0.07611935525929062, 'Bleu_3': 2.1722489458703126e-07, 'Bleu_4': 3.720613376888697e-10, 'METEOR': 0.051681314210905695, 'ROUGE_L': 0.13225117125757405, 'CIDEr': 0.03582465912870381}
[INFO: 2022-09-28 20:53:29,568] ######## Epoch (VAL)2 ########
[INFO: 2022-09-28 20:53:29,569] {'Bleu_1': 5.498492603306565e-05, 'Bleu_2': 5.6073842157594024e-05, 'Bleu_3': 5.644158545835759e-07, 'Bleu_4': 5.662636052249671e-08, 'METEOR': 0.03784235198185765, 'ROUGE_L': 0.1336566015572135, 'CIDEr': 0.0468494910785998}
[INFO: 2022-09-28 20:53:48,083] ######## Epoch (TEST)2 ########
[INFO: 2022-09-28 20:53:48,083] {'Bleu_1': 6.573998327363591e-05, 'Bleu_2': 6.635727365299969e-05, 'Bleu_3': 6.656432249944072e-07, 'Bleu_4': 6.666808906053272e-08, 'METEOR': 0.03795169810534038, 'ROUGE_L': 0.12906766753382465, 'CIDEr': 0.039297681838680605}
[INFO: 2022-09-28 20:55:18,317] ######## Epoch (VAL)3 ########
[INFO: 2022-09-28 20:55:18,318] {'Bleu_1': 0.06709645606852607, 'Bleu_2': 0.059120480578972706, 'Bleu_3': 0.05584742274556067, 'Bleu_4': 5.69537387866203e-06, 'METEOR': 0.11329082126420645, 'ROUGE_L': 0.33357180804716247, 'CIDEr': 0.3372417963279944}
[INFO: 2022-09-28 20:55:36,923] ######## Epoch (TEST)3 ########
[INFO: 2022-09-28 20:55:36,923] {'Bleu_1': 0.05493055275727486, 'Bleu_2': 0.04716783072240939, 'Bleu_3': 0.0456422903497837, 'Bleu_4': 5.414714065694861e-06, 'METEOR': 0.09864405735921025, 'ROUGE_L': 0.28576079277124, 'CIDEr': 0.2681859971095105}
[INFO: 2022-09-28 20:57:07,475] ######## Epoch (VAL)4 ########
[INFO: 2022-09-28 20:57:07,475] {'Bleu_1': 0.12940863818460746, 'Bleu_2': 0.1204585337469801, 'Bleu_3': 0.12023439286263198, 'Bleu_4': 0.12973625285393353, 'METEOR': 0.1484765479621056, 'ROUGE_L': 0.37469782120855644, 'CIDEr': 0.7938381628018649}
[INFO: 2022-09-28 20:57:26,548] ######## Epoch (TEST)4 ########
[INFO: 2022-09-28 20:57:26,549] {'Bleu_1': 0.1132383806840927, 'Bleu_2': 0.10524216885444118, 'Bleu_3': 0.10502782813906401, 'Bleu_4': 0.11369086748161801, 'METEOR': 0.13951724563345386, 'ROUGE_L': 0.34156732670957934, 'CIDEr': 0.7034875837440815}
[INFO: 2022-09-28 20:58:56,424] ######## Epoch (VAL)5 ########
[INFO: 2022-09-28 20:58:56,425] {'Bleu_1': 0.16234810204527805, 'Bleu_2': 0.15211841453435745, 'Bleu_3': 0.15137845033234712, 'Bleu_4': 0.157784523909056, 'METEOR': 0.16317024744673778, 'ROUGE_L': 0.3971285115364935, 'CIDEr': 0.9491155332869726}
[INFO: 2022-09-28 20:59:15,279] ######## Epoch (TEST)5 ########
[INFO: 2022-09-28 20:59:15,279] {'Bleu_1': 0.18942739450788734, 'Bleu_2': 0.17136191863308947, 'Bleu_3': 0.16227766249579495, 'Bleu_4': 0.1549311934089259, 'METEOR': 0.16293127172818941, 'ROUGE_L': 0.3875708686004079, 'CIDEr': 0.9048053885702407}
[INFO: 2022-09-28 21:00:45,345] ######## Epoch (VAL)6 ########
[INFO: 2022-09-28 21:00:45,346] {'Bleu_1': 0.47669538724750915, 'Bleu_2': 0.428955785187414, 'Bleu_3': 0.38111090362010946, 'Bleu_4': 0.3354544375027104, 'METEOR': 0.24678992173739245, 'ROUGE_L': 0.529168136190243, 'CIDEr': 1.3741601211496877}
[INFO: 2022-09-28 21:01:03,891] ######## Epoch (TEST)6 ########
[INFO: 2022-09-28 21:01:03,891] {'Bleu_1': 0.4575887659699269, 'Bleu_2': 0.41477960396916064, 'Bleu_3': 0.3707764081550077, 'Bleu_4': 0.32221325257807704, 'METEOR': 0.24077040801047808, 'ROUGE_L': 0.530905436893619, 'CIDEr': 1.2865106531856312}
[INFO: 2022-09-28 21:02:34,310] ######## Epoch (VAL)7 ########
[INFO: 2022-09-28 21:02:34,311] {'Bleu_1': 0.6064468608851369, 'Bleu_2': 0.5469864091647954, 'Bleu_3': 0.4898182096242188, 'Bleu_4': 0.4329685657327317, 'METEOR': 0.30724326492541454, 'ROUGE_L': 0.637489766342262, 'CIDEr': 1.6234925151018038}
[INFO: 2022-09-28 21:02:53,157] ######## Epoch (TEST)7 ########
[INFO: 2022-09-28 21:02:53,157] {'Bleu_1': 0.6470102393592125, 'Bleu_2': 0.5907116221554991, 'Bleu_3': 0.524068065480959, 'Bleu_4': 0.44761673465064256, 'METEOR': 0.31624866012943764, 'ROUGE_L': 0.6516397065600471, 'CIDEr': 1.6799017857522316}
[INFO: 2022-09-28 21:04:23,623] ######## Epoch (VAL)8 ########
[INFO: 2022-09-28 21:04:23,624] {'Bleu_1': 0.6087037823293604, 'Bleu_2': 0.5404470456022648, 'Bleu_3': 0.47260158165160604, 'Bleu_4': 0.40478320808126744, 'METEOR': 0.3040433007260771, 'ROUGE_L': 0.6269546718608354, 'CIDEr': 1.5445290431764798}
[INFO: 2022-09-28 21:04:42,513] ######## Epoch (TEST)8 ########
[INFO: 2022-09-28 21:04:42,513] {'Bleu_1': 0.6750118287285873, 'Bleu_2': 0.6198496693595351, 'Bleu_3': 0.5548473829901117, 'Bleu_4': 0.4750327641165692, 'METEOR': 0.3347352615927607, 'ROUGE_L': 0.6671349591724669, 'CIDEr': 1.770563572889808}
[INFO: 2022-09-28 21:06:13,371] ######## Epoch (VAL)9 ########
[INFO: 2022-09-28 21:06:13,372] {'Bleu_1': 0.7264398016273482, 'Bleu_2': 0.6525910587515386, 'Bleu_3': 0.5762304038617906, 'Bleu_4': 0.5001231848240426, 'METEOR': 0.325091019956637, 'ROUGE_L': 0.6565200482129, 'CIDEr': 1.8809155166394844}
[INFO: 2022-09-28 21:06:31,914] ######## Epoch (TEST)9 ########
[INFO: 2022-09-28 21:06:31,914] {'Bleu_1': 0.7760944049022264, 'Bleu_2': 0.7094030656513715, 'Bleu_3': 0.6340018599778142, 'Bleu_4': 0.5560758106193133, 'METEOR': 0.3503196197492139, 'ROUGE_L': 0.6953326195890044, 'CIDEr': 2.0165980150570175}
[INFO: 2022-09-28 21:08:01,206] ######## Epoch (VAL)10 ########
[INFO: 2022-09-28 21:08:01,207] {'Bleu_1': 0.7482153843655073, 'Bleu_2': 0.6662694211312418, 'Bleu_3': 0.5911912906945306, 'Bleu_4': 0.519244138579643, 'METEOR': 0.34966475117283896, 'ROUGE_L': 0.65675619240369, 'CIDEr': 1.9870741885857925}
[INFO: 2022-09-28 21:08:19,695] ######## Epoch (TEST)10 ########
[INFO: 2022-09-28 21:08:19,695] {'Bleu_1': 0.796680350695305, 'Bleu_2': 0.7334130320057908, 'Bleu_3': 0.6603784114380008, 'Bleu_4': 0.5848096321519949, 'METEOR': 0.387188588525629, 'ROUGE_L': 0.7042734471560149, 'CIDEr': 2.214545971950911}
[INFO: 2022-09-28 21:09:50,508] ######## Epoch (VAL)11 ########
[INFO: 2022-09-28 21:09:50,508] {'Bleu_1': 0.7790164323464235, 'Bleu_2': 0.6960465403800812, 'Bleu_3': 0.6173656042760799, 'Bleu_4': 0.5392057955290154, 'METEOR': 0.3622004595365468, 'ROUGE_L': 0.6720537857494499, 'CIDEr': 2.0369830660635717}
[INFO: 2022-09-28 21:10:09,105] ######## Epoch (TEST)11 ########
[INFO: 2022-09-28 21:10:09,106] {'Bleu_1': 0.8161159350808374, 'Bleu_2': 0.7475010741761945, 'Bleu_3': 0.6725050914529693, 'Bleu_4': 0.5967926788680471, 'METEOR': 0.38261894861563905, 'ROUGE_L': 0.7057178168811377, 'CIDEr': 2.218343850659472}
[INFO: 2022-09-28 21:11:39,596] ######## Epoch (VAL)12 ########
[INFO: 2022-09-28 21:11:39,597] {'Bleu_1': 0.7575634642739447, 'Bleu_2': 0.6801984054494276, 'Bleu_3': 0.6070714368018112, 'Bleu_4': 0.5375460985949125, 'METEOR': 0.37043611213404626, 'ROUGE_L': 0.6877241459351177, 'CIDEr': 2.21091660270416}
[INFO: 2022-09-28 21:11:58,560] ######## Epoch (TEST)12 ########
[INFO: 2022-09-28 21:11:58,561] {'Bleu_1': 0.8150782361297083, 'Bleu_2': 0.7276571525701785, 'Bleu_3': 0.6380714760057205, 'Bleu_4': 0.5548523211533266, 'METEOR': 0.400893318859928, 'ROUGE_L': 0.7119578161180701, 'CIDEr': 2.2416286351915464}
[INFO: 2022-09-28 21:13:29,525] ######## Epoch (VAL)13 ########
[INFO: 2022-09-28 21:13:29,525] {'Bleu_1': 0.7651164172529319, 'Bleu_2': 0.6882207386419585, 'Bleu_3': 0.6150695935793231, 'Bleu_4': 0.5454283576460751, 'METEOR': 0.3735036311328134, 'ROUGE_L': 0.6957983410816574, 'CIDEr': 2.23642502661112}
[INFO: 2022-09-28 21:13:48,457] ######## Epoch (TEST)13 ########
[INFO: 2022-09-28 21:13:48,457] {'Bleu_1': 0.8170212765945858, 'Bleu_2': 0.7265285475966969, 'Bleu_3': 0.6374253119456033, 'Bleu_4': 0.5546241563210956, 'METEOR': 0.4004292273463119, 'ROUGE_L': 0.7189286472690222, 'CIDEr': 2.265873100527548}
[INFO: 2022-09-28 21:15:18,866] ######## Epoch (VAL)14 ########
[INFO: 2022-09-28 21:15:18,866] {'Bleu_1': 0.7824858757051095, 'Bleu_2': 0.7042553959707091, 'Bleu_3': 0.6310832277846351, 'Bleu_4': 0.5640132144467888, 'METEOR': 0.38530544762042224, 'ROUGE_L': 0.7081546705069021, 'CIDEr': 2.4164330439867645}
[INFO: 2022-09-28 21:15:38,051] ######## Epoch (TEST)14 ########
[INFO: 2022-09-28 21:15:38,051] {'Bleu_1': 0.8276353276341487, 'Bleu_2': 0.7416490776570432, 'Bleu_3': 0.6525247751127233, 'Bleu_4': 0.5688562613732201, 'METEOR': 0.4112555530453879, 'ROUGE_L': 0.7308168508268476, 'CIDEr': 2.3375492980803214}
[INFO: 2022-09-28 21:17:08,810] ######## Epoch (VAL)15 ########
[INFO: 2022-09-28 21:17:08,810] {'Bleu_1': 0.777119079314197, 'Bleu_2': 0.7018900259875265, 'Bleu_3': 0.6316383833027583, 'Bleu_4': 0.5653644872206047, 'METEOR': 0.37952148246634154, 'ROUGE_L': 0.7095767748602888, 'CIDEr': 2.3287733887242896}
[INFO: 2022-09-28 21:17:28,179] ######## Epoch (TEST)15 ########
[INFO: 2022-09-28 21:17:28,179] {'Bleu_1': 0.8081361070132025, 'Bleu_2': 0.7244209565609155, 'Bleu_3': 0.6373285390392406, 'Bleu_4': 0.5548530217974476, 'METEOR': 0.40674461163874925, 'ROUGE_L': 0.7250387320618493, 'CIDEr': 2.227077765654933}
[INFO: 2022-09-28 21:18:58,868] ######## Epoch (VAL)16 ########
[INFO: 2022-09-28 21:18:58,869] {'Bleu_1': 0.7777777777767239, 'Bleu_2': 0.7013059712836384, 'Bleu_3': 0.6331548049681532, 'Bleu_4': 0.5708745141936634, 'METEOR': 0.39974811152456463, 'ROUGE_L': 0.719230139133972, 'CIDEr': 2.5245148919366995}
[INFO: 2022-09-28 21:19:18,578] ######## Epoch (TEST)16 ########
[INFO: 2022-09-28 21:19:18,579] {'Bleu_1': 0.8124156545198213, 'Bleu_2': 0.7308057576808901, 'Bleu_3': 0.6463538330363894, 'Bleu_4': 0.567637534624646, 'METEOR': 0.42020883344183163, 'ROUGE_L': 0.7461712870234147, 'CIDEr': 2.4847810599336295}
[INFO: 2022-09-28 21:20:49,219] ######## Epoch (VAL)17 ########
[INFO: 2022-09-28 21:20:49,219] {'Bleu_1': 0.7826577248251412, 'Bleu_2': 0.6971877841047568, 'Bleu_3': 0.6235781311801784, 'Bleu_4': 0.5570011913190946, 'METEOR': 0.38862144734121146, 'ROUGE_L': 0.7119771736137228, 'CIDEr': 2.4393343631195408}
[INFO: 2022-09-28 21:21:08,429] ######## Epoch (TEST)17 ########
[INFO: 2022-09-28 21:21:08,430] {'Bleu_1': 0.8097982708922049, 'Bleu_2': 0.723403783199564, 'Bleu_3': 0.6366384400312655, 'Bleu_4': 0.551923910420707, 'METEOR': 0.4082153470417687, 'ROUGE_L': 0.7295108504292243, 'CIDEr': 2.292495107246979}
[INFO: 2022-09-28 21:22:39,422] ######## Epoch (VAL)18 ########
[INFO: 2022-09-28 21:22:39,423] {'Bleu_1': 0.788405861306727, 'Bleu_2': 0.7117539507342708, 'Bleu_3': 0.6452800332954866, 'Bleu_4': 0.5827462174609719, 'METEOR': 0.3983624609090531, 'ROUGE_L': 0.7209529144302353, 'CIDEr': 2.5074991233707076}
[INFO: 2022-09-28 21:22:59,366] ######## Epoch (TEST)18 ########
[INFO: 2022-09-28 21:22:59,367] {'Bleu_1': 0.8237822349558399, 'Bleu_2': 0.7422293241484449, 'Bleu_3': 0.657291721428949, 'Bleu_4': 0.576624833084527, 'METEOR': 0.4208906240369685, 'ROUGE_L': 0.7479107946584806, 'CIDEr': 2.3727234575292466}
[INFO: 2022-09-28 21:24:30,714] ######## Epoch (VAL)19 ########
[INFO: 2022-09-28 21:24:30,715] {'Bleu_1': 0.7859116022088593, 'Bleu_2': 0.7040027907048082, 'Bleu_3': 0.6349286779870257, 'Bleu_4': 0.5732248791345889, 'METEOR': 0.39229405226615227, 'ROUGE_L': 0.7159028438861403, 'CIDEr': 2.511267845043119}
[INFO: 2022-09-28 21:24:50,972] ######## Epoch (TEST)19 ########
[INFO: 2022-09-28 21:24:50,972] {'Bleu_1': 0.8238557558934482, 'Bleu_2': 0.7436161810328387, 'Bleu_3': 0.6596151856665179, 'Bleu_4': 0.5802091725080637, 'METEOR': 0.4244144348862528, 'ROUGE_L': 0.7585433674663568, 'CIDEr': 2.462533148276738}
[INFO: 2022-09-28 21:26:22,304] ######## Epoch (VAL)20 ########
[INFO: 2022-09-28 21:26:22,304] {'Bleu_1': 0.798008534849505, 'Bleu_2': 0.7182769639550017, 'Bleu_3': 0.648289751919925, 'Bleu_4': 0.5821557146973907, 'METEOR': 0.40255428785307557, 'ROUGE_L': 0.7250257949986633, 'CIDEr': 2.4589140471180304}
[INFO: 2022-09-28 21:26:41,858] ######## Epoch (TEST)20 ########
[INFO: 2022-09-28 21:26:41,858] {'Bleu_1': 0.8310249307467714, 'Bleu_2': 0.7446031168932524, 'Bleu_3': 0.6577272291292016, 'Bleu_4': 0.5766789876262773, 'METEOR': 0.42446723964922006, 'ROUGE_L': 0.7528719159714534, 'CIDEr': 2.4438293324061453}
[INFO: 2022-09-29 10:39:30,578] Training with config:
[INFO: 2022-09-29 10:39:30,580] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mssydney/sent/sydney_train_input.pkl',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 8,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mssydney/sent/sydney_train_target.pkl',
                 'TEST_4W_ID': './mscoco/misc/ids2path_json/coco_test4w_ids2path.json',
                 'TEST_ATT_FEATS': './mssydney/feature/Sydney',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mssydney/misc/ids2path_json/sydney_val_ids2path.json',
                 'TRAIN_ATT_FEATS': './mssydney/feature/Sydney',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mssydney/misc/ids2path_json/sydney_train_ids2path.json',
                 'VAL_ATT_FEATS': './mssydney/feature/Sydney',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mssydney/misc/ids2path_json/sydney_test_ids2path.json'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 5,
               'CAP_KEY': 'caption',
               'COCO_PATH': './coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mssydney/misc/val_sydney.json',
               'VAL_ANNFILE': './mssydney/misc/test_sydney.json',
               'VOCAB': './mssydney/txt/Sydney_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'CrossEntropy'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 1536,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 512,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 512,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [64, 32, 64],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 3,
                        'DIM': 512,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [64, 32, 64],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.1,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 3,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.1,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.1,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 1536,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 512,
           'SEQ_LEN': 24,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'PureT',
           'VOCAB_SIZE': 181,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 512,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'MAX_LEN': 'MAX_LEN',
           'MULCLASS': 'MULCLASS',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments_PureT/PureT_XE_Sydney/',
 'SCORER': {'CIDER_CACHED': './mssydney/misc/sydney_train_cider.pkl',
            'GT_PATH': './mssydney/misc/sydney_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1234.0,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 0.0005,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 512,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Noam',
                          'WARMUP': 10000},
            'MAX_EPOCH': 20,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2022-09-29 10:40:49,568] ######## Epoch (VAL)1 ########
[INFO: 2022-09-29 10:40:49,569] {'Bleu_1': 0.04549254804195608, 'Bleu_2': 0.008242602293238118, 'Bleu_3': 4.7859189122493805e-08, 'Bleu_4': 1.1705474508518034e-10, 'METEOR': 0.018324271851041695, 'ROUGE_L': 0.040337236271239627, 'CIDEr': 0.009599521837893924}
[INFO: 2022-09-29 10:41:06,165] ######## Epoch (TEST)1 ########
[INFO: 2022-09-29 10:41:06,165] {'Bleu_1': 0.08838183472695615, 'Bleu_2': 0.02055809031881353, 'Bleu_3': 9.006487214139164e-08, 'Bleu_4': 1.914194191155289e-10, 'METEOR': 0.03466591468922222, 'ROUGE_L': 0.07121825138175532, 'CIDEr': 0.013275387976364395}
[INFO: 2022-09-29 10:42:15,293] ######## Epoch (VAL)2 ########
[INFO: 2022-09-29 10:42:15,294] {'Bleu_1': 1.4571660550857826e-06, 'Bleu_2': 1.5166665161171894e-06, 'Bleu_3': 1.5370350928554942e-08, 'Bleu_4': 1.5473217327305172e-09, 'METEOR': 0.017086487804336244, 'ROUGE_L': 0.09714344402661028, 'CIDEr': 0.015477363150856254}
[INFO: 2022-09-29 10:42:31,972] ######## Epoch (TEST)2 ########
[INFO: 2022-09-29 10:42:31,972] {'Bleu_1': 9.260173922495319e-05, 'Bleu_2': 8.513736718165124e-05, 'Bleu_3': 7.078054661915057e-05, 'Bleu_4': 7.67482107283434e-05, 'METEOR': 0.031756004493814424, 'ROUGE_L': 0.12206710224719526, 'CIDEr': 0.04662536389705692}
[INFO: 2022-09-29 10:43:42,011] ######## Epoch (VAL)3 ########
[INFO: 2022-09-29 10:43:42,011] {'Bleu_1': 0.02081551957239611, 'Bleu_2': 0.020021326416513118, 'Bleu_3': 0.01995006997895426, 'Bleu_4': 0.0006580627355445964, 'METEOR': 0.09150492969134695, 'ROUGE_L': 0.2612941339405759, 'CIDEr': 0.16574988363108184}
[INFO: 2022-09-29 10:43:59,224] ######## Epoch (TEST)3 ########
[INFO: 2022-09-29 10:43:59,224] {'Bleu_1': 0.01833158604833985, 'Bleu_2': 0.016885817356475267, 'Bleu_3': 0.01652892517716023, 'Bleu_4': 0.0005616443733704814, 'METEOR': 0.08786281694299779, 'ROUGE_L': 0.23373486472388663, 'CIDEr': 0.13477394674878682}
[INFO: 2022-09-29 10:45:09,929] ######## Epoch (VAL)4 ########
[INFO: 2022-09-29 10:45:09,929] {'Bleu_1': 0.12346069910065613, 'Bleu_2': 0.11458171072062509, 'Bleu_3': 0.11411443173093809, 'Bleu_4': 0.12341521529585738, 'METEOR': 0.14441793805426847, 'ROUGE_L': 0.36719644178623495, 'CIDEr': 0.7433251604606462}
[INFO: 2022-09-29 10:45:26,155] ######## Epoch (TEST)4 ########
[INFO: 2022-09-29 10:45:26,155] {'Bleu_1': 0.10775938270430033, 'Bleu_2': 0.09924195600704405, 'Bleu_3': 0.09833891671305003, 'Bleu_4': 0.10549013644384683, 'METEOR': 0.13317993592899444, 'ROUGE_L': 0.3362252363393875, 'CIDEr': 0.6733087241824856}
[INFO: 2022-09-29 10:46:38,737] ######## Epoch (VAL)5 ########
[INFO: 2022-09-29 10:46:38,738] {'Bleu_1': 0.16937071943800827, 'Bleu_2': 0.15545488247045305, 'Bleu_3': 0.15126778329374332, 'Bleu_4': 0.15208193632705141, 'METEOR': 0.15424607372432192, 'ROUGE_L': 0.3991585686313956, 'CIDEr': 0.9503824772330122}
[INFO: 2022-09-29 10:46:56,031] ######## Epoch (TEST)5 ########
[INFO: 2022-09-29 10:46:56,031] {'Bleu_1': 0.16033869321873068, 'Bleu_2': 0.14807546336344796, 'Bleu_3': 0.14320281188398173, 'Bleu_4': 0.14166975644779575, 'METEOR': 0.14819684414484896, 'ROUGE_L': 0.37857899101356773, 'CIDEr': 0.8542058171171752}
[INFO: 2022-09-29 10:48:06,905] ######## Epoch (VAL)6 ########
[INFO: 2022-09-29 10:48:06,905] {'Bleu_1': 0.3199111424786393, 'Bleu_2': 0.2952107647904553, 'Bleu_3': 0.2728222138335235, 'Bleu_4': 0.2494577936879438, 'METEOR': 0.22091836340751878, 'ROUGE_L': 0.4781751484339778, 'CIDEr': 1.2285013383310444}
[INFO: 2022-09-29 10:48:23,464] ######## Epoch (TEST)6 ########
[INFO: 2022-09-29 10:48:23,464] {'Bleu_1': 0.3421927073055902, 'Bleu_2': 0.3162490574899414, 'Bleu_3': 0.29138710354947966, 'Bleu_4': 0.25745294634787647, 'METEOR': 0.21160748016269557, 'ROUGE_L': 0.4706424861221855, 'CIDEr': 1.192418078229688}
[INFO: 2022-09-29 10:49:35,205] ######## Epoch (VAL)7 ########
[INFO: 2022-09-29 10:49:35,206] {'Bleu_1': 0.5925674947505735, 'Bleu_2': 0.5295331939109312, 'Bleu_3': 0.46979837448154854, 'Bleu_4': 0.41033255960315956, 'METEOR': 0.3047636282460835, 'ROUGE_L': 0.6196309506271779, 'CIDEr': 1.5097849128360021}
[INFO: 2022-09-29 10:49:51,827] ######## Epoch (TEST)7 ########
[INFO: 2022-09-29 10:49:51,828] {'Bleu_1': 0.667397346877751, 'Bleu_2': 0.608600054335767, 'Bleu_3': 0.5372154078900723, 'Bleu_4': 0.45572818651169916, 'METEOR': 0.3182247779488166, 'ROUGE_L': 0.6539110095046032, 'CIDEr': 1.631713645916133}
[INFO: 2022-09-29 10:51:03,909] ######## Epoch (VAL)8 ########
[INFO: 2022-09-29 10:51:03,911] {'Bleu_1': 0.5896912323290553, 'Bleu_2': 0.5214017026576325, 'Bleu_3': 0.456228696006919, 'Bleu_4': 0.38980268950274455, 'METEOR': 0.301534738445219, 'ROUGE_L': 0.616465034587134, 'CIDEr': 1.5653233318607682}
[INFO: 2022-09-29 10:51:20,939] ######## Epoch (TEST)8 ########
[INFO: 2022-09-29 10:51:20,940] {'Bleu_1': 0.6659932210458194, 'Bleu_2': 0.6125606423392034, 'Bleu_3': 0.5542579295749729, 'Bleu_4': 0.4848396013696118, 'METEOR': 0.34591552086446004, 'ROUGE_L': 0.674353898636133, 'CIDEr': 1.8296171592331074}
[INFO: 2022-09-29 10:52:32,526] ######## Epoch (VAL)9 ########
[INFO: 2022-09-29 10:52:32,526] {'Bleu_1': 0.6970551030416333, 'Bleu_2': 0.620076946935558, 'Bleu_3': 0.5444001770527541, 'Bleu_4': 0.47021382072187085, 'METEOR': 0.3204005382833992, 'ROUGE_L': 0.6461227853383643, 'CIDEr': 1.8530042879319144}
[INFO: 2022-09-29 10:52:49,725] ######## Epoch (TEST)9 ########
[INFO: 2022-09-29 10:52:49,726] {'Bleu_1': 0.7968456306616495, 'Bleu_2': 0.7274461061143108, 'Bleu_3': 0.6493513145787706, 'Bleu_4': 0.5680544880284273, 'METEOR': 0.35730910506637875, 'ROUGE_L': 0.6966944096760245, 'CIDEr': 2.06014466347207}
[INFO: 2022-09-29 10:54:02,622] ######## Epoch (VAL)10 ########
[INFO: 2022-09-29 10:54:02,623] {'Bleu_1': 0.731389272039818, 'Bleu_2': 0.6530260520418913, 'Bleu_3': 0.5798195271247552, 'Bleu_4': 0.5060964395512608, 'METEOR': 0.3485575385596907, 'ROUGE_L': 0.6354933345191064, 'CIDEr': 1.893557044616566}
[INFO: 2022-09-29 10:54:20,572] ######## Epoch (TEST)10 ########
[INFO: 2022-09-29 10:54:20,572] {'Bleu_1': 0.8122014236635285, 'Bleu_2': 0.7398186210462272, 'Bleu_3': 0.662943212712012, 'Bleu_4': 0.5870005354959728, 'METEOR': 0.38181046426552173, 'ROUGE_L': 0.700700619313964, 'CIDEr': 2.1904408122292076}
[INFO: 2022-09-29 10:55:33,929] ######## Epoch (VAL)11 ########
[INFO: 2022-09-29 10:55:33,930] {'Bleu_1': 0.758018670480305, 'Bleu_2': 0.6800132078277906, 'Bleu_3': 0.6066964035525799, 'Bleu_4': 0.5329369693514492, 'METEOR': 0.36164045156858476, 'ROUGE_L': 0.666083269241494, 'CIDEr': 2.0320289062734136}
[INFO: 2022-09-29 10:55:51,048] ######## Epoch (TEST)11 ########
[INFO: 2022-09-29 10:55:51,048] {'Bleu_1': 0.8113868855285146, 'Bleu_2': 0.7436211546453447, 'Bleu_3': 0.6678842194924034, 'Bleu_4': 0.5912401478158821, 'METEOR': 0.38520758112751474, 'ROUGE_L': 0.7098672176511728, 'CIDEr': 2.1735686930458176}
[INFO: 2022-09-29 10:57:04,488] ######## Epoch (VAL)12 ########
[INFO: 2022-09-29 10:57:04,488] {'Bleu_1': 0.7765316101343543, 'Bleu_2': 0.6940906344678757, 'Bleu_3': 0.6178069704056074, 'Bleu_4': 0.5445465642394854, 'METEOR': 0.3727156126979067, 'ROUGE_L': 0.6918913898418183, 'CIDEr': 2.166624490052727}
[INFO: 2022-09-29 10:57:21,913] ######## Epoch (TEST)12 ########
[INFO: 2022-09-29 10:57:21,914] {'Bleu_1': 0.8289473684198407, 'Bleu_2': 0.7422034645882555, 'Bleu_3': 0.6544329445759346, 'Bleu_4': 0.5721566819457017, 'METEOR': 0.40268042950762695, 'ROUGE_L': 0.7222778748639577, 'CIDEr': 2.256115817976212}
[INFO: 2022-09-29 10:58:36,712] ######## Epoch (VAL)13 ########
[INFO: 2022-09-29 10:58:36,713] {'Bleu_1': 0.7821950898447109, 'Bleu_2': 0.6986221976324766, 'Bleu_3': 0.623885774319707, 'Bleu_4': 0.5529111059440408, 'METEOR': 0.3773404956269928, 'ROUGE_L': 0.6960255763114804, 'CIDEr': 2.2415677527382307}
[INFO: 2022-09-29 10:58:54,918] ######## Epoch (TEST)13 ########
[INFO: 2022-09-29 10:58:54,919] {'Bleu_1': 0.8287769784160737, 'Bleu_2': 0.7462270843905745, 'Bleu_3': 0.660787119491517, 'Bleu_4': 0.5797547127625708, 'METEOR': 0.40399196923258157, 'ROUGE_L': 0.7284797946258161, 'CIDEr': 2.3496272562685934}
[INFO: 2022-09-29 11:00:08,925] ######## Epoch (VAL)14 ########
[INFO: 2022-09-29 11:00:08,927] {'Bleu_1': 0.7689075630241332, 'Bleu_2': 0.6838669167509609, 'Bleu_3': 0.6105365449371734, 'Bleu_4': 0.5434729022710858, 'METEOR': 0.38014439563323443, 'ROUGE_L': 0.7029514160299136, 'CIDEr': 2.358624741774764}
[INFO: 2022-09-29 11:00:26,228] ######## Epoch (TEST)14 ########
[INFO: 2022-09-29 11:00:26,229] {'Bleu_1': 0.8210818307894299, 'Bleu_2': 0.732285449798682, 'Bleu_3': 0.6401754991705207, 'Bleu_4': 0.5558283883072239, 'METEOR': 0.41367836108231826, 'ROUGE_L': 0.7459822609627721, 'CIDEr': 2.3871410293375797}
[INFO: 2022-09-29 11:01:40,720] ######## Epoch (VAL)15 ########
[INFO: 2022-09-29 11:01:40,720] {'Bleu_1': 0.7511925337411253, 'Bleu_2': 0.6781579821808421, 'Bleu_3': 0.613751574470239, 'Bleu_4': 0.5548463290829739, 'METEOR': 0.3776331455572271, 'ROUGE_L': 0.6970794940186246, 'CIDEr': 2.3792074628257747}
[INFO: 2022-09-29 11:01:58,145] ######## Epoch (TEST)15 ########
[INFO: 2022-09-29 11:01:58,145] {'Bleu_1': 0.8309859154917874, 'Bleu_2': 0.7505578443259062, 'Bleu_3': 0.6720124049699316, 'Bleu_4': 0.5980932207794811, 'METEOR': 0.4246776967612277, 'ROUGE_L': 0.7497569317207687, 'CIDEr': 2.529859282285596}
[INFO: 2022-09-29 11:03:11,958] ######## Epoch (VAL)16 ########
[INFO: 2022-09-29 11:03:11,958] {'Bleu_1': 0.7804195804184889, 'Bleu_2': 0.7054860088392676, 'Bleu_3': 0.636263818192811, 'Bleu_4': 0.568897826363855, 'METEOR': 0.3965629384133349, 'ROUGE_L': 0.7095450138085639, 'CIDEr': 2.459011054534828}
[INFO: 2022-09-29 11:03:28,576] ######## Epoch (TEST)16 ########
[INFO: 2022-09-29 11:03:28,576] {'Bleu_1': 0.826502732239308, 'Bleu_2': 0.7469609477876158, 'Bleu_3': 0.6624809147685339, 'Bleu_4': 0.5857989495068021, 'METEOR': 0.4309879886943217, 'ROUGE_L': 0.7548341644771103, 'CIDEr': 2.482591261444275}
[INFO: 2022-09-29 11:04:43,028] ######## Epoch (VAL)17 ########
[INFO: 2022-09-29 11:04:43,028] {'Bleu_1': 0.7106344768892013, 'Bleu_2': 0.6233049370250343, 'Bleu_3': 0.5544927269098932, 'Bleu_4': 0.4954789241445687, 'METEOR': 0.3675758336376021, 'ROUGE_L': 0.673287967383716, 'CIDEr': 2.2282145653738663}
[INFO: 2022-09-29 11:05:00,414] ######## Epoch (TEST)17 ########
[INFO: 2022-09-29 11:05:00,414] {'Bleu_1': 0.813630041723486, 'Bleu_2': 0.731740994980822, 'Bleu_3': 0.6532945517904806, 'Bleu_4': 0.5805249574662472, 'METEOR': 0.4262748444910601, 'ROUGE_L': 0.7442214509000229, 'CIDEr': 2.5819945407346667}
[INFO: 2022-09-29 11:06:13,448] ######## Epoch (VAL)18 ########
[INFO: 2022-09-29 11:06:13,448] {'Bleu_1': 0.7554945054934677, 'Bleu_2': 0.6699151351755243, 'Bleu_3': 0.5968914872351705, 'Bleu_4': 0.5309292888990679, 'METEOR': 0.3837736344201378, 'ROUGE_L': 0.6976719722985212, 'CIDEr': 2.3650747081781383}
[INFO: 2022-09-29 11:06:30,690] ######## Epoch (TEST)18 ########
[INFO: 2022-09-29 11:06:30,690] {'Bleu_1': 0.8294036061014849, 'Bleu_2': 0.7452769344764402, 'Bleu_3': 0.6605969204796256, 'Bleu_4': 0.581527839396693, 'METEOR': 0.4290475167255508, 'ROUGE_L': 0.7565703714616349, 'CIDEr': 2.496999449668536}
[INFO: 2022-09-29 11:07:43,434] ######## Epoch (VAL)19 ########
[INFO: 2022-09-29 11:07:43,434] {'Bleu_1': 0.7557980900398966, 'Bleu_2': 0.6709096447368093, 'Bleu_3': 0.6006199938660866, 'Bleu_4': 0.5397689715350157, 'METEOR': 0.3840912963973764, 'ROUGE_L': 0.7026339119949827, 'CIDEr': 2.441823354275145}
[INFO: 2022-09-29 11:08:00,316] ######## Epoch (TEST)19 ########
[INFO: 2022-09-29 11:08:00,317] {'Bleu_1': 0.835164835163688, 'Bleu_2': 0.7605148330026013, 'Bleu_3': 0.6862726435655663, 'Bleu_4': 0.6173691316250084, 'METEOR': 0.43873959047567296, 'ROUGE_L': 0.7627456437794801, 'CIDEr': 2.7193905147258834}
[INFO: 2022-09-29 11:09:13,195] ######## Epoch (VAL)20 ########
[INFO: 2022-09-29 11:09:13,196] {'Bleu_1': 0.7662889518402743, 'Bleu_2': 0.6825852352878928, 'Bleu_3': 0.6111106753483633, 'Bleu_4': 0.5478564996492976, 'METEOR': 0.3881941594331095, 'ROUGE_L': 0.699968538916382, 'CIDEr': 2.4745951194375047}
[INFO: 2022-09-29 11:09:29,746] ######## Epoch (TEST)20 ########
[INFO: 2022-09-29 11:09:29,746] {'Bleu_1': 0.8177684774032848, 'Bleu_2': 0.7376408100369447, 'Bleu_3': 0.6564994258635495, 'Bleu_4': 0.5772861488289345, 'METEOR': 0.4143456887160001, 'ROUGE_L': 0.7420676487618226, 'CIDEr': 2.4555281702209877}
[INFO: 2022-10-12 13:29:36,011] Training with config:
[INFO: 2022-10-12 13:29:36,017] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mssydney/sent/sydney_train_input.pkl',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 8,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mssydney/sent/sydney_train_target.pkl',
                 'TEST_4W_ID': './mscoco/misc/ids2path_json/coco_test4w_ids2path.json',
                 'TEST_ATT_FEATS': './mssydney/feature/Sydney',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mssydney/misc/ids2path_json/sydney_val_ids2path.json',
                 'TRAIN_ATT_FEATS': './mssydney/feature/Sydney',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mssydney/misc/ids2path_json/sydney_train_ids2path.json',
                 'VAL_ATT_FEATS': './mssydney/feature/Sydney',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mssydney/misc/ids2path_json/sydney_test_ids2path.json'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 5,
               'CAP_KEY': 'caption',
               'COCO_PATH': './coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mssydney/misc/val_sydney.json',
               'VAL_ANNFILE': './mssydney/misc/test_sydney.json',
               'VOCAB': './mssydney/txt/Sydney_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'CrossEntropy'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 1536,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 512,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 512,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [64, 32, 64],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 3,
                        'DIM': 512,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [64, 32, 64],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.1,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 3,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.1,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.1,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 1536,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 512,
           'SEQ_LEN': 24,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'PureT',
           'VOCAB_SIZE': 181,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 512,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'MAX_LEN': 'MAX_LEN',
           'MULCLASS': 'MULCLASS',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments_PureT/PureT_XE_Sydney/',
 'SCORER': {'CIDER_CACHED': './mssydney/misc/sydney_train_cider.pkl',
            'GT_PATH': './mssydney/misc/sydney_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1234.0,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 0.0005,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 512,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Noam',
                          'WARMUP': 10000},
            'MAX_EPOCH': 20,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2022-10-12 13:46:06,494] Training with config:
[INFO: 2022-10-12 13:46:06,496] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mssydney/sent/sydney_train_input.pkl',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 8,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mssydney/sent/sydney_train_target.pkl',
                 'TEST_4W_ID': './mscoco/misc/ids2path_json/coco_test4w_ids2path.json',
                 'TEST_ATT_FEATS': './mssydney/feature/Sydney',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mssydney/misc/ids2path_json/sydney_val_ids2path.json',
                 'TRAIN_ATT_FEATS': './mssydney/feature/Sydney',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mssydney/misc/ids2path_json/sydney_train_ids2path.json',
                 'VAL_ATT_FEATS': './mssydney/feature/Sydney',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mssydney/misc/ids2path_json/sydney_test_ids2path.json'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 5,
               'CAP_KEY': 'caption',
               'COCO_PATH': './coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mssydney/misc/val_sydney.json',
               'VAL_ANNFILE': './mssydney/misc/test_sydney.json',
               'VOCAB': './mssydney/txt/Sydney_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'CrossEntropy'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 1536,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 512,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 512,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [64, 32, 64],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 3,
                        'DIM': 512,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [64, 32, 64],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.1,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 3,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.1,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.1,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 1536,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 512,
           'SEQ_LEN': 24,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'PureT',
           'VOCAB_SIZE': 181,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 512,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'MAX_LEN': 'MAX_LEN',
           'MULCLASS': 'MULCLASS',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments_PureT/PureT_XE_Sydney/',
 'SCORER': {'CIDER_CACHED': './mssydney/misc/sydney_train_cider.pkl',
            'GT_PATH': './mssydney/misc/sydney_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1234.0,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 0.0005,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 512,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Noam',
                          'WARMUP': 10000},
            'MAX_EPOCH': 20,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2022-10-12 13:50:09,185] Training with config:
[INFO: 2022-10-12 13:50:09,192] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mssydney/sent/sydney_train_input.pkl',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 8,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mssydney/sent/sydney_train_target.pkl',
                 'TEST_4W_ID': './mscoco/misc/ids2path_json/coco_test4w_ids2path.json',
                 'TEST_ATT_FEATS': './mssydney/feature/Sydney',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mssydney/misc/ids2path_json/sydney_val_ids2path.json',
                 'TRAIN_ATT_FEATS': './mssydney/feature/Sydney',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mssydney/misc/ids2path_json/sydney_train_ids2path.json',
                 'VAL_ATT_FEATS': './mssydney/feature/Sydney',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mssydney/misc/ids2path_json/sydney_test_ids2path.json'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 5,
               'CAP_KEY': 'caption',
               'COCO_PATH': './coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mssydney/misc/val_sydney.json',
               'VAL_ANNFILE': './mssydney/misc/test_sydney.json',
               'VOCAB': './mssydney/txt/Sydney_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'CrossEntropy'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 1536,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 512,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 512,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [64, 32, 64],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 3,
                        'DIM': 512,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [64, 32, 64],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.1,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 3,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.1,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.1,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 1536,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 512,
           'SEQ_LEN': 24,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'PureT',
           'VOCAB_SIZE': 181,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 512,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'MAX_LEN': 'MAX_LEN',
           'MULCLASS': 'MULCLASS',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments_PureT/PureT_XE_Sydney/',
 'SCORER': {'CIDER_CACHED': './mssydney/misc/sydney_train_cider.pkl',
            'GT_PATH': './mssydney/misc/sydney_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1234.0,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 0.0005,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 512,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Noam',
                          'WARMUP': 10000},
            'MAX_EPOCH': 20,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2022-10-12 14:00:05,066] Training with config:
[INFO: 2022-10-12 14:00:05,067] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mssydney/sent/sydney_train_input.pkl',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 8,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mssydney/sent/sydney_train_target.pkl',
                 'TEST_4W_ID': './mscoco/misc/ids2path_json/coco_test4w_ids2path.json',
                 'TEST_ATT_FEATS': './mssydney/feature/Sydney',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mssydney/misc/ids2path_json/sydney_val_ids2path.json',
                 'TRAIN_ATT_FEATS': './mssydney/feature/Sydney',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mssydney/misc/ids2path_json/sydney_train_ids2path.json',
                 'VAL_ATT_FEATS': './mssydney/feature/Sydney',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mssydney/misc/ids2path_json/sydney_test_ids2path.json'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 5,
               'CAP_KEY': 'caption',
               'COCO_PATH': './coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mssydney/misc/val_sydney.json',
               'VAL_ANNFILE': './mssydney/misc/test_sydney.json',
               'VOCAB': './mssydney/txt/Sydney_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'CrossEntropy'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 1536,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 512,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 512,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [64, 32, 64],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 3,
                        'DIM': 512,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [64, 32, 64],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.1,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 3,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.1,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.1,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 1536,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 512,
           'SEQ_LEN': 24,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'PureT',
           'VOCAB_SIZE': 181,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 512,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'MAX_LEN': 'MAX_LEN',
           'MULCLASS': 'MULCLASS',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments_PureT/PureT_XE_Sydney/',
 'SCORER': {'CIDER_CACHED': './mssydney/misc/sydney_train_cider.pkl',
            'GT_PATH': './mssydney/misc/sydney_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1234.0,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 0.0005,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 512,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Noam',
                          'WARMUP': 10000},
            'MAX_EPOCH': 20,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2022-10-12 14:01:58,878] Training with config:
[INFO: 2022-10-12 14:01:58,880] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mssydney/sent/sydney_train_input.pkl',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 8,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mssydney/sent/sydney_train_target.pkl',
                 'TEST_4W_ID': './mscoco/misc/ids2path_json/coco_test4w_ids2path.json',
                 'TEST_ATT_FEATS': './mssydney/feature/Sydney',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mssydney/misc/ids2path_json/sydney_val_ids2path.json',
                 'TRAIN_ATT_FEATS': './mssydney/feature/Sydney',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mssydney/misc/ids2path_json/sydney_train_ids2path.json',
                 'VAL_ATT_FEATS': './mssydney/feature/Sydney',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mssydney/misc/ids2path_json/sydney_test_ids2path.json'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 5,
               'CAP_KEY': 'caption',
               'COCO_PATH': './coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mssydney/misc/val_sydney.json',
               'VAL_ANNFILE': './mssydney/misc/test_sydney.json',
               'VOCAB': './mssydney/txt/Sydney_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'CrossEntropy'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 1536,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 512,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 512,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [64, 32, 64],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 3,
                        'DIM': 512,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [64, 32, 64],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.1,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 3,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.1,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.1,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 1536,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 512,
           'SEQ_LEN': 24,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'PureT',
           'VOCAB_SIZE': 181,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 512,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'MAX_LEN': 'MAX_LEN',
           'MULCLASS': 'MULCLASS',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments_PureT/PureT_XE_Sydney/',
 'SCORER': {'CIDER_CACHED': './mssydney/misc/sydney_train_cider.pkl',
            'GT_PATH': './mssydney/misc/sydney_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1234.0,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 0.0005,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 512,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Noam',
                          'WARMUP': 10000},
            'MAX_EPOCH': 20,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2022-10-12 14:03:51,213] Training with config:
[INFO: 2022-10-12 14:03:51,214] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mssydney/sent/sydney_train_input.pkl',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 8,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mssydney/sent/sydney_train_target.pkl',
                 'TEST_4W_ID': './mscoco/misc/ids2path_json/coco_test4w_ids2path.json',
                 'TEST_ATT_FEATS': './mssydney/feature/Sydney',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mssydney/misc/ids2path_json/sydney_val_ids2path.json',
                 'TRAIN_ATT_FEATS': './mssydney/feature/Sydney',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mssydney/misc/ids2path_json/sydney_train_ids2path.json',
                 'VAL_ATT_FEATS': './mssydney/feature/Sydney',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mssydney/misc/ids2path_json/sydney_test_ids2path.json'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 5,
               'CAP_KEY': 'caption',
               'COCO_PATH': './coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mssydney/misc/val_sydney.json',
               'VAL_ANNFILE': './mssydney/misc/test_sydney.json',
               'VOCAB': './mssydney/txt/Sydney_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'CrossEntropy'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 1536,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 512,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 512,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [64, 32, 64],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 3,
                        'DIM': 512,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [64, 32, 64],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.1,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 3,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.1,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.1,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 1536,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 512,
           'SEQ_LEN': 24,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'PureT',
           'VOCAB_SIZE': 181,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 512,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'MAX_LEN': 'MAX_LEN',
           'MULCLASS': 'MULCLASS',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments_PureT/PureT_XE_Sydney/',
 'SCORER': {'CIDER_CACHED': './mssydney/misc/sydney_train_cider.pkl',
            'GT_PATH': './mssydney/misc/sydney_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1234.0,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 0.0005,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 512,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Noam',
                          'WARMUP': 10000},
            'MAX_EPOCH': 20,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2022-10-12 14:08:39,330] Training with config:
[INFO: 2022-10-12 14:08:39,332] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mssydney/sent/sydney_train_input.pkl',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 8,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mssydney/sent/sydney_train_target.pkl',
                 'TEST_4W_ID': './mscoco/misc/ids2path_json/coco_test4w_ids2path.json',
                 'TEST_ATT_FEATS': './mssydney/feature/Sydney',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mssydney/misc/ids2path_json/sydney_val_ids2path.json',
                 'TRAIN_ATT_FEATS': './mssydney/feature/Sydney',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mssydney/misc/ids2path_json/sydney_train_ids2path.json',
                 'VAL_ATT_FEATS': './mssydney/feature/Sydney',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mssydney/misc/ids2path_json/sydney_test_ids2path.json'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 5,
               'CAP_KEY': 'caption',
               'COCO_PATH': './coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mssydney/misc/val_sydney.json',
               'VAL_ANNFILE': './mssydney/misc/test_sydney.json',
               'VOCAB': './mssydney/txt/Sydney_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'CrossEntropy'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 1536,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 512,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 512,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [64, 32, 64],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 3,
                        'DIM': 512,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [64, 32, 64],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.1,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 3,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.1,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.1,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 1536,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 512,
           'SEQ_LEN': 24,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'PureT',
           'VOCAB_SIZE': 181,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 512,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'MAX_LEN': 'MAX_LEN',
           'MULCLASS': 'MULCLASS',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments_PureT/PureT_XE_Sydney/',
 'SCORER': {'CIDER_CACHED': './mssydney/misc/sydney_train_cider.pkl',
            'GT_PATH': './mssydney/misc/sydney_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1234.0,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 0.0005,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 512,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Noam',
                          'WARMUP': 10000},
            'MAX_EPOCH': 20,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2022-10-12 14:13:15,538] Training with config:
[INFO: 2022-10-12 14:13:15,540] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mssydney/sent/sydney_train_input.pkl',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 8,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mssydney/sent/sydney_train_target.pkl',
                 'TEST_4W_ID': './mscoco/misc/ids2path_json/coco_test4w_ids2path.json',
                 'TEST_ATT_FEATS': './mssydney/feature/Sydney',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mssydney/misc/ids2path_json/sydney_val_ids2path.json',
                 'TRAIN_ATT_FEATS': './mssydney/feature/Sydney',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mssydney/misc/ids2path_json/sydney_train_ids2path.json',
                 'VAL_ATT_FEATS': './mssydney/feature/Sydney',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mssydney/misc/ids2path_json/sydney_test_ids2path.json'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 5,
               'CAP_KEY': 'caption',
               'COCO_PATH': './coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mssydney/misc/val_sydney.json',
               'VAL_ANNFILE': './mssydney/misc/test_sydney.json',
               'VOCAB': './mssydney/txt/Sydney_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'CrossEntropy'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 1536,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 512,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 512,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [64, 32, 64],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 3,
                        'DIM': 512,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [64, 32, 64],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.1,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 3,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.1,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.1,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 1536,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 512,
           'SEQ_LEN': 24,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'PureT',
           'VOCAB_SIZE': 181,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 512,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'MAX_LEN': 'MAX_LEN',
           'MULCLASS': 'MULCLASS',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments_PureT/PureT_XE_Sydney/',
 'SCORER': {'CIDER_CACHED': './mssydney/misc/sydney_train_cider.pkl',
            'GT_PATH': './mssydney/misc/sydney_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1234.0,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 0.0005,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 512,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Noam',
                          'WARMUP': 10000},
            'MAX_EPOCH': 20,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2022-10-12 14:23:30,499] Training with config:
[INFO: 2022-10-12 14:23:30,501] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mssydney/sent/sydney_train_input.pkl',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 8,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mssydney/sent/sydney_train_target.pkl',
                 'TEST_4W_ID': './mscoco/misc/ids2path_json/coco_test4w_ids2path.json',
                 'TEST_ATT_FEATS': './mssydney/feature/Sydney',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mssydney/misc/ids2path_json/sydney_val_ids2path.json',
                 'TRAIN_ATT_FEATS': './mssydney/feature/Sydney',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mssydney/misc/ids2path_json/sydney_train_ids2path.json',
                 'VAL_ATT_FEATS': './mssydney/feature/Sydney',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mssydney/misc/ids2path_json/sydney_test_ids2path.json'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 5,
               'CAP_KEY': 'caption',
               'COCO_PATH': './coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mssydney/misc/val_sydney.json',
               'VAL_ANNFILE': './mssydney/misc/test_sydney.json',
               'VOCAB': './mssydney/txt/Sydney_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'CrossEntropy'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 1536,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 512,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 512,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [64, 32, 64],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 3,
                        'DIM': 512,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [64, 32, 64],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.1,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 3,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.1,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.1,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 1536,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 512,
           'SEQ_LEN': 24,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'PureT',
           'VOCAB_SIZE': 181,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 512,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'MAX_LEN': 'MAX_LEN',
           'MULCLASS': 'MULCLASS',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments_PureT/PureT_XE_Sydney/',
 'SCORER': {'CIDER_CACHED': './mssydney/misc/sydney_train_cider.pkl',
            'GT_PATH': './mssydney/misc/sydney_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1234.0,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 0.0005,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 512,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Noam',
                          'WARMUP': 10000},
            'MAX_EPOCH': 20,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2022-10-12 15:20:30,273] Training with config:
[INFO: 2022-10-12 15:20:30,274] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mssydney/sent/sydney_train_input.pkl',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 8,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mssydney/sent/sydney_train_target.pkl',
                 'TEST_4W_ID': './mscoco/misc/ids2path_json/coco_test4w_ids2path.json',
                 'TEST_ATT_FEATS': './mssydney/feature/Sydney',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mssydney/misc/ids2path_json/sydney_val_ids2path.json',
                 'TRAIN_ATT_FEATS': './mssydney/feature/Sydney',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mssydney/misc/ids2path_json/sydney_train_ids2path.json',
                 'VAL_ATT_FEATS': './mssydney/feature/Sydney',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mssydney/misc/ids2path_json/sydney_test_ids2path.json'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 5,
               'CAP_KEY': 'caption',
               'COCO_PATH': './coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mssydney/misc/val_sydney.json',
               'VAL_ANNFILE': './mssydney/misc/test_sydney.json',
               'VOCAB': './mssydney/txt/Sydney_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'CrossEntropy'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 1536,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 512,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 512,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [64, 32, 64],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 3,
                        'DIM': 512,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [64, 32, 64],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.1,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 3,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.1,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.1,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 1536,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 512,
           'SEQ_LEN': 24,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'PureT',
           'VOCAB_SIZE': 181,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 512,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'MAX_LEN': 'MAX_LEN',
           'MULCLASS': 'MULCLASS',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments_PureT/PureT_XE_Sydney/',
 'SCORER': {'CIDER_CACHED': './mssydney/misc/sydney_train_cider.pkl',
            'GT_PATH': './mssydney/misc/sydney_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1234.0,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 0.0005,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 512,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Noam',
                          'WARMUP': 10000},
            'MAX_EPOCH': 20,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2022-10-12 15:25:11,761] Training with config:
[INFO: 2022-10-12 15:25:11,763] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mssydney/sent/sydney_train_input.pkl',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 8,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mssydney/sent/sydney_train_target.pkl',
                 'TEST_4W_ID': './mscoco/misc/ids2path_json/coco_test4w_ids2path.json',
                 'TEST_ATT_FEATS': './mssydney/feature/Sydney',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mssydney/misc/ids2path_json/sydney_val_ids2path.json',
                 'TRAIN_ATT_FEATS': './mssydney/feature/Sydney',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mssydney/misc/ids2path_json/sydney_train_ids2path.json',
                 'VAL_ATT_FEATS': './mssydney/feature/Sydney',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mssydney/misc/ids2path_json/sydney_test_ids2path.json'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 5,
               'CAP_KEY': 'caption',
               'COCO_PATH': './coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mssydney/misc/val_sydney.json',
               'VAL_ANNFILE': './mssydney/misc/test_sydney.json',
               'VOCAB': './mssydney/txt/Sydney_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'CrossEntropy'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 1536,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 512,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 512,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [64, 32, 64],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 3,
                        'DIM': 512,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [64, 32, 64],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.1,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 3,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.1,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.1,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 1536,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 512,
           'SEQ_LEN': 24,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'PureT',
           'VOCAB_SIZE': 181,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 512,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'MAX_LEN': 'MAX_LEN',
           'MULCLASS': 'MULCLASS',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments_PureT/PureT_XE_Sydney/',
 'SCORER': {'CIDER_CACHED': './mssydney/misc/sydney_train_cider.pkl',
            'GT_PATH': './mssydney/misc/sydney_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1234.0,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 0.0005,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 512,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Noam',
                          'WARMUP': 10000},
            'MAX_EPOCH': 20,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2022-10-12 15:29:06,077] Training with config:
[INFO: 2022-10-12 15:29:06,078] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mssydney/sent/sydney_train_input.pkl',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 8,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mssydney/sent/sydney_train_target.pkl',
                 'TEST_4W_ID': './mscoco/misc/ids2path_json/coco_test4w_ids2path.json',
                 'TEST_ATT_FEATS': './mssydney/feature/Sydney',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mssydney/misc/ids2path_json/sydney_val_ids2path.json',
                 'TRAIN_ATT_FEATS': './mssydney/feature/Sydney',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mssydney/misc/ids2path_json/sydney_train_ids2path.json',
                 'VAL_ATT_FEATS': './mssydney/feature/Sydney',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mssydney/misc/ids2path_json/sydney_test_ids2path.json'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 5,
               'CAP_KEY': 'caption',
               'COCO_PATH': './coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mssydney/misc/val_sydney.json',
               'VAL_ANNFILE': './mssydney/misc/test_sydney.json',
               'VOCAB': './mssydney/txt/Sydney_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'CrossEntropy'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 1536,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 512,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 512,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [64, 32, 64],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 3,
                        'DIM': 512,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [64, 32, 64],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.1,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 3,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.1,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.1,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 1536,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 512,
           'SEQ_LEN': 24,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'PureT',
           'VOCAB_SIZE': 181,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 512,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'MAX_LEN': 'MAX_LEN',
           'MULCLASS': 'MULCLASS',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments_PureT/PureT_XE_Sydney/',
 'SCORER': {'CIDER_CACHED': './mssydney/misc/sydney_train_cider.pkl',
            'GT_PATH': './mssydney/misc/sydney_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1234.0,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 0.0005,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 512,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Noam',
                          'WARMUP': 10000},
            'MAX_EPOCH': 20,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2022-10-12 15:29:59,333] Training with config:
[INFO: 2022-10-12 15:29:59,335] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mssydney/sent/sydney_train_input.pkl',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 8,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mssydney/sent/sydney_train_target.pkl',
                 'TEST_4W_ID': './mscoco/misc/ids2path_json/coco_test4w_ids2path.json',
                 'TEST_ATT_FEATS': './mssydney/feature/Sydney',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mssydney/misc/ids2path_json/sydney_val_ids2path.json',
                 'TRAIN_ATT_FEATS': './mssydney/feature/Sydney',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mssydney/misc/ids2path_json/sydney_train_ids2path.json',
                 'VAL_ATT_FEATS': './mssydney/feature/Sydney',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mssydney/misc/ids2path_json/sydney_test_ids2path.json'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 5,
               'CAP_KEY': 'caption',
               'COCO_PATH': './coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mssydney/misc/val_sydney.json',
               'VAL_ANNFILE': './mssydney/misc/test_sydney.json',
               'VOCAB': './mssydney/txt/Sydney_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'CrossEntropy'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 1536,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 512,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 512,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [64, 32, 64],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 3,
                        'DIM': 512,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [64, 32, 64],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.1,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 3,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.1,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.1,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 1536,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 512,
           'SEQ_LEN': 24,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'PureT',
           'VOCAB_SIZE': 181,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 512,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'MAX_LEN': 'MAX_LEN',
           'MULCLASS': 'MULCLASS',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments_PureT/PureT_XE_Sydney/',
 'SCORER': {'CIDER_CACHED': './mssydney/misc/sydney_train_cider.pkl',
            'GT_PATH': './mssydney/misc/sydney_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1234.0,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 0.0005,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 512,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Noam',
                          'WARMUP': 10000},
            'MAX_EPOCH': 20,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2022-10-12 15:31:49,710] Training with config:
[INFO: 2022-10-12 15:31:49,711] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mssydney/sent/sydney_train_input.pkl',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 8,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mssydney/sent/sydney_train_target.pkl',
                 'TEST_4W_ID': './mscoco/misc/ids2path_json/coco_test4w_ids2path.json',
                 'TEST_ATT_FEATS': './mssydney/feature/Sydney',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mssydney/misc/ids2path_json/sydney_val_ids2path.json',
                 'TRAIN_ATT_FEATS': './mssydney/feature/Sydney',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mssydney/misc/ids2path_json/sydney_train_ids2path.json',
                 'VAL_ATT_FEATS': './mssydney/feature/Sydney',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mssydney/misc/ids2path_json/sydney_test_ids2path.json'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 5,
               'CAP_KEY': 'caption',
               'COCO_PATH': './coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mssydney/misc/val_sydney.json',
               'VAL_ANNFILE': './mssydney/misc/test_sydney.json',
               'VOCAB': './mssydney/txt/Sydney_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'CrossEntropy'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 1536,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 512,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 512,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [64, 32, 64],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 3,
                        'DIM': 512,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [64, 32, 64],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.1,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 3,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.1,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.1,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 1536,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 512,
           'SEQ_LEN': 24,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'PureT',
           'VOCAB_SIZE': 181,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 512,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'MAX_LEN': 'MAX_LEN',
           'MULCLASS': 'MULCLASS',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments_PureT/PureT_XE_Sydney/',
 'SCORER': {'CIDER_CACHED': './mssydney/misc/sydney_train_cider.pkl',
            'GT_PATH': './mssydney/misc/sydney_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1234.0,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 0.0005,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 512,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Noam',
                          'WARMUP': 10000},
            'MAX_EPOCH': 20,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2022-10-12 15:36:30,121] Training with config:
[INFO: 2022-10-12 15:36:30,122] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mssydney/sent/sydney_train_input.pkl',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 8,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mssydney/sent/sydney_train_target.pkl',
                 'TEST_4W_ID': './mscoco/misc/ids2path_json/coco_test4w_ids2path.json',
                 'TEST_ATT_FEATS': './mssydney/feature/Sydney',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mssydney/misc/ids2path_json/sydney_val_ids2path.json',
                 'TRAIN_ATT_FEATS': './mssydney/feature/Sydney',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mssydney/misc/ids2path_json/sydney_train_ids2path.json',
                 'VAL_ATT_FEATS': './mssydney/feature/Sydney',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mssydney/misc/ids2path_json/sydney_test_ids2path.json'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 5,
               'CAP_KEY': 'caption',
               'COCO_PATH': './coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mssydney/misc/val_sydney.json',
               'VAL_ANNFILE': './mssydney/misc/test_sydney.json',
               'VOCAB': './mssydney/txt/Sydney_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'CrossEntropy'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 1536,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 512,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 512,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [64, 32, 64],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 3,
                        'DIM': 512,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [64, 32, 64],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.1,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 3,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.1,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.1,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 1536,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 512,
           'SEQ_LEN': 24,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'PureT',
           'VOCAB_SIZE': 181,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 512,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'MAX_LEN': 'MAX_LEN',
           'MULCLASS': 'MULCLASS',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments_PureT/PureT_XE_Sydney/',
 'SCORER': {'CIDER_CACHED': './mssydney/misc/sydney_train_cider.pkl',
            'GT_PATH': './mssydney/misc/sydney_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1234.0,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 0.0005,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 512,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Noam',
                          'WARMUP': 10000},
            'MAX_EPOCH': 20,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2022-10-12 15:40:42,617] Training with config:
[INFO: 2022-10-12 15:40:42,619] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mssydney/sent/sydney_train_input.pkl',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 8,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mssydney/sent/sydney_train_target.pkl',
                 'TEST_4W_ID': './mscoco/misc/ids2path_json/coco_test4w_ids2path.json',
                 'TEST_ATT_FEATS': './mssydney/feature/Sydney',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mssydney/misc/ids2path_json/sydney_val_ids2path.json',
                 'TRAIN_ATT_FEATS': './mssydney/feature/Sydney',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mssydney/misc/ids2path_json/sydney_train_ids2path.json',
                 'VAL_ATT_FEATS': './mssydney/feature/Sydney',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mssydney/misc/ids2path_json/sydney_test_ids2path.json'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 5,
               'CAP_KEY': 'caption',
               'COCO_PATH': './coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mssydney/misc/val_sydney.json',
               'VAL_ANNFILE': './mssydney/misc/test_sydney.json',
               'VOCAB': './mssydney/txt/Sydney_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'CrossEntropy'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 1536,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 512,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 512,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [64, 32, 64],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 3,
                        'DIM': 512,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [64, 32, 64],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.1,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 3,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.1,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.1,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 1536,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 512,
           'SEQ_LEN': 24,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'PureT',
           'VOCAB_SIZE': 181,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 512,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'MAX_LEN': 'MAX_LEN',
           'MULCLASS': 'MULCLASS',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments_PureT/PureT_XE_Sydney/',
 'SCORER': {'CIDER_CACHED': './mssydney/misc/sydney_train_cider.pkl',
            'GT_PATH': './mssydney/misc/sydney_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1234.0,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 0.0005,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 512,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Noam',
                          'WARMUP': 10000},
            'MAX_EPOCH': 20,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2022-10-12 15:41:41,005] Training with config:
[INFO: 2022-10-12 15:41:41,006] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mssydney/sent/sydney_train_input.pkl',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 8,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mssydney/sent/sydney_train_target.pkl',
                 'TEST_4W_ID': './mscoco/misc/ids2path_json/coco_test4w_ids2path.json',
                 'TEST_ATT_FEATS': './mssydney/feature/Sydney',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mssydney/misc/ids2path_json/sydney_val_ids2path.json',
                 'TRAIN_ATT_FEATS': './mssydney/feature/Sydney',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mssydney/misc/ids2path_json/sydney_train_ids2path.json',
                 'VAL_ATT_FEATS': './mssydney/feature/Sydney',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mssydney/misc/ids2path_json/sydney_test_ids2path.json'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 5,
               'CAP_KEY': 'caption',
               'COCO_PATH': './coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mssydney/misc/val_sydney.json',
               'VAL_ANNFILE': './mssydney/misc/test_sydney.json',
               'VOCAB': './mssydney/txt/Sydney_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'CrossEntropy'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 1536,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 512,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 512,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [64, 32, 64],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 3,
                        'DIM': 512,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [64, 32, 64],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.1,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 3,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.1,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.1,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 1536,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 512,
           'SEQ_LEN': 24,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'PureT',
           'VOCAB_SIZE': 181,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 512,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'MAX_LEN': 'MAX_LEN',
           'MULCLASS': 'MULCLASS',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments_PureT/PureT_XE_Sydney/',
 'SCORER': {'CIDER_CACHED': './mssydney/misc/sydney_train_cider.pkl',
            'GT_PATH': './mssydney/misc/sydney_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1234.0,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 0.0005,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 512,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Noam',
                          'WARMUP': 10000},
            'MAX_EPOCH': 20,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2022-10-12 15:44:01,033] Training with config:
[INFO: 2022-10-12 15:44:01,044] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mssydney/sent/sydney_train_input.pkl',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 8,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mssydney/sent/sydney_train_target.pkl',
                 'TEST_4W_ID': './mscoco/misc/ids2path_json/coco_test4w_ids2path.json',
                 'TEST_ATT_FEATS': './mssydney/feature/Sydney',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mssydney/misc/ids2path_json/sydney_val_ids2path.json',
                 'TRAIN_ATT_FEATS': './mssydney/feature/Sydney',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mssydney/misc/ids2path_json/sydney_train_ids2path.json',
                 'VAL_ATT_FEATS': './mssydney/feature/Sydney',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mssydney/misc/ids2path_json/sydney_test_ids2path.json'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 5,
               'CAP_KEY': 'caption',
               'COCO_PATH': './coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mssydney/misc/val_sydney.json',
               'VAL_ANNFILE': './mssydney/misc/test_sydney.json',
               'VOCAB': './mssydney/txt/Sydney_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'CrossEntropy'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 1536,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 512,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 512,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [64, 32, 64],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 3,
                        'DIM': 512,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [64, 32, 64],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.1,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 3,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.1,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.1,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 1536,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 512,
           'SEQ_LEN': 24,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'PureT',
           'VOCAB_SIZE': 181,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 512,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'MAX_LEN': 'MAX_LEN',
           'MULCLASS': 'MULCLASS',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments_PureT/PureT_XE_Sydney/',
 'SCORER': {'CIDER_CACHED': './mssydney/misc/sydney_train_cider.pkl',
            'GT_PATH': './mssydney/misc/sydney_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1234.0,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 0.0005,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 512,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Noam',
                          'WARMUP': 10000},
            'MAX_EPOCH': 20,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2022-10-12 15:49:51,939] Training with config:
[INFO: 2022-10-12 15:49:51,941] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mssydney/sent/sydney_train_input.pkl',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 8,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mssydney/sent/sydney_train_target.pkl',
                 'TEST_4W_ID': './mscoco/misc/ids2path_json/coco_test4w_ids2path.json',
                 'TEST_ATT_FEATS': './mssydney/feature/Sydney',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mssydney/misc/ids2path_json/sydney_val_ids2path.json',
                 'TRAIN_ATT_FEATS': './mssydney/feature/Sydney',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mssydney/misc/ids2path_json/sydney_train_ids2path.json',
                 'VAL_ATT_FEATS': './mssydney/feature/Sydney',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mssydney/misc/ids2path_json/sydney_test_ids2path.json'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 5,
               'CAP_KEY': 'caption',
               'COCO_PATH': './coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mssydney/misc/val_sydney.json',
               'VAL_ANNFILE': './mssydney/misc/test_sydney.json',
               'VOCAB': './mssydney/txt/Sydney_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'CrossEntropy'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 1536,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 512,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 512,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [64, 32, 64],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 3,
                        'DIM': 512,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [64, 32, 64],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.1,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 3,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.1,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.1,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 1536,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 512,
           'SEQ_LEN': 24,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'PureT',
           'VOCAB_SIZE': 181,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 512,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'MAX_LEN': 'MAX_LEN',
           'MULCLASS': 'MULCLASS',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments_PureT/PureT_XE_Sydney/',
 'SCORER': {'CIDER_CACHED': './mssydney/misc/sydney_train_cider.pkl',
            'GT_PATH': './mssydney/misc/sydney_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1234.0,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 0.0005,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 512,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Noam',
                          'WARMUP': 10000},
            'MAX_EPOCH': 20,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2022-10-12 16:09:13,068] Training with config:
[INFO: 2022-10-12 16:09:13,070] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mssydney/sent/sydney_train_input.pkl',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 8,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mssydney/sent/sydney_train_target.pkl',
                 'TEST_4W_ID': './mscoco/misc/ids2path_json/coco_test4w_ids2path.json',
                 'TEST_ATT_FEATS': './mssydney/feature/Sydney',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mssydney/misc/ids2path_json/sydney_val_ids2path.json',
                 'TRAIN_ATT_FEATS': './mssydney/feature/Sydney',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mssydney/misc/ids2path_json/sydney_train_ids2path.json',
                 'VAL_ATT_FEATS': './mssydney/feature/Sydney',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mssydney/misc/ids2path_json/sydney_test_ids2path.json'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 5,
               'CAP_KEY': 'caption',
               'COCO_PATH': './coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mssydney/misc/val_sydney.json',
               'VAL_ANNFILE': './mssydney/misc/test_sydney.json',
               'VOCAB': './mssydney/txt/Sydney_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'CrossEntropy'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 1536,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 512,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 512,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [64, 32, 64],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 3,
                        'DIM': 512,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [64, 32, 64],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.1,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 3,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.1,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.1,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 1536,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 512,
           'SEQ_LEN': 24,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'PureT',
           'VOCAB_SIZE': 181,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 512,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'MAX_LEN': 'MAX_LEN',
           'MULCLASS': 'MULCLASS',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments_PureT/PureT_XE_Sydney/',
 'SCORER': {'CIDER_CACHED': './mssydney/misc/sydney_train_cider.pkl',
            'GT_PATH': './mssydney/misc/sydney_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1234.0,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 0.0005,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 512,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Noam',
                          'WARMUP': 10000},
            'MAX_EPOCH': 20,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2022-10-12 16:15:05,247] Training with config:
[INFO: 2022-10-12 16:15:05,248] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mssydney/sent/sydney_train_input.pkl',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 8,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mssydney/sent/sydney_train_target.pkl',
                 'TEST_4W_ID': './mscoco/misc/ids2path_json/coco_test4w_ids2path.json',
                 'TEST_ATT_FEATS': './mssydney/feature/Sydney',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mssydney/misc/ids2path_json/sydney_val_ids2path.json',
                 'TRAIN_ATT_FEATS': './mssydney/feature/Sydney',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mssydney/misc/ids2path_json/sydney_train_ids2path.json',
                 'VAL_ATT_FEATS': './mssydney/feature/Sydney',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mssydney/misc/ids2path_json/sydney_test_ids2path.json'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 5,
               'CAP_KEY': 'caption',
               'COCO_PATH': './coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mssydney/misc/val_sydney.json',
               'VAL_ANNFILE': './mssydney/misc/test_sydney.json',
               'VOCAB': './mssydney/txt/Sydney_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'CrossEntropy'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 1536,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 512,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 512,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [64, 32, 64],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 3,
                        'DIM': 512,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [64, 32, 64],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.1,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 3,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.1,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.1,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 1536,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 512,
           'SEQ_LEN': 24,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'PureT',
           'VOCAB_SIZE': 181,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 512,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'MAX_LEN': 'MAX_LEN',
           'MULCLASS': 'MULCLASS',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments_PureT/PureT_XE_Sydney/',
 'SCORER': {'CIDER_CACHED': './mssydney/misc/sydney_train_cider.pkl',
            'GT_PATH': './mssydney/misc/sydney_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1234.0,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 0.0005,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 512,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Noam',
                          'WARMUP': 10000},
            'MAX_EPOCH': 20,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2022-10-12 16:30:53,404] Training with config:
[INFO: 2022-10-12 16:30:53,406] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mssydney/sent/sydney_train_input.pkl',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 8,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mssydney/sent/sydney_train_target.pkl',
                 'TEST_4W_ID': './mscoco/misc/ids2path_json/coco_test4w_ids2path.json',
                 'TEST_ATT_FEATS': './mssydney/feature/Sydney',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mssydney/misc/ids2path_json/sydney_val_ids2path.json',
                 'TRAIN_ATT_FEATS': './mssydney/feature/Sydney',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mssydney/misc/ids2path_json/sydney_train_ids2path.json',
                 'VAL_ATT_FEATS': './mssydney/feature/Sydney',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mssydney/misc/ids2path_json/sydney_test_ids2path.json'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 5,
               'CAP_KEY': 'caption',
               'COCO_PATH': './coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mssydney/misc/val_sydney.json',
               'VAL_ANNFILE': './mssydney/misc/test_sydney.json',
               'VOCAB': './mssydney/txt/Sydney_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'CrossEntropy'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 1536,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 512,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 512,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [64, 32, 64],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 3,
                        'DIM': 512,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [64, 32, 64],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.1,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 3,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.1,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.1,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 1536,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 512,
           'SEQ_LEN': 24,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'PureT',
           'VOCAB_SIZE': 181,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 512,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'MAX_LEN': 'MAX_LEN',
           'MULCLASS': 'MULCLASS',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments_PureT/PureT_XE_Sydney/',
 'SCORER': {'CIDER_CACHED': './mssydney/misc/sydney_train_cider.pkl',
            'GT_PATH': './mssydney/misc/sydney_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1234.0,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 0.0005,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 512,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Noam',
                          'WARMUP': 10000},
            'MAX_EPOCH': 20,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2022-10-12 16:39:31,197] Training with config:
[INFO: 2022-10-12 16:39:31,199] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mssydney/sent/sydney_train_input.pkl',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 8,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mssydney/sent/sydney_train_target.pkl',
                 'TEST_4W_ID': './mscoco/misc/ids2path_json/coco_test4w_ids2path.json',
                 'TEST_ATT_FEATS': './mssydney/feature/Sydney',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mssydney/misc/ids2path_json/sydney_val_ids2path.json',
                 'TRAIN_ATT_FEATS': './mssydney/feature/Sydney',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mssydney/misc/ids2path_json/sydney_train_ids2path.json',
                 'VAL_ATT_FEATS': './mssydney/feature/Sydney',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mssydney/misc/ids2path_json/sydney_test_ids2path.json'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 5,
               'CAP_KEY': 'caption',
               'COCO_PATH': './coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mssydney/misc/val_sydney.json',
               'VAL_ANNFILE': './mssydney/misc/test_sydney.json',
               'VOCAB': './mssydney/txt/Sydney_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'CrossEntropy'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 1536,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 512,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 512,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [64, 32, 64],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 3,
                        'DIM': 512,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [64, 32, 64],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.1,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 3,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.1,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.1,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 1536,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 512,
           'SEQ_LEN': 24,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'PureT',
           'VOCAB_SIZE': 181,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 512,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'MAX_LEN': 'MAX_LEN',
           'MULCLASS': 'MULCLASS',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments_PureT/PureT_XE_Sydney/',
 'SCORER': {'CIDER_CACHED': './mssydney/misc/sydney_train_cider.pkl',
            'GT_PATH': './mssydney/misc/sydney_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1234.0,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 0.0005,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 512,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Noam',
                          'WARMUP': 10000},
            'MAX_EPOCH': 20,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2022-10-20 18:05:34,486] Training with config:
[INFO: 2022-10-20 18:05:34,494] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mssydney/sent/sydney_train_input.pkl',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 8,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mssydney/sent/sydney_train_target.pkl',
                 'TEST_4W_ID': './mscoco/misc/ids2path_json/coco_test4w_ids2path.json',
                 'TEST_ATT_FEATS': './mssydney/feature/Sydney',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mssydney/misc/ids2path_json/sydney_val_ids2path.json',
                 'TRAIN_ATT_FEATS': './mssydney/feature/Sydney',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mssydney/misc/ids2path_json/sydney_train_ids2path.json',
                 'VAL_ATT_FEATS': './mssydney/feature/Sydney',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mssydney/misc/ids2path_json/sydney_test_ids2path.json'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 5,
               'CAP_KEY': 'caption',
               'COCO_PATH': './coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mssydney/misc/val_sydney.json',
               'VAL_ANNFILE': './mssydney/misc/test_sydney.json',
               'VOCAB': './mssydney/txt/Sydney_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'CrossEntropy'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 1536,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 512,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 512,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [64, 32, 64],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 3,
                        'DIM': 512,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [64, 32, 64],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.1,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 3,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.1,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.1,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 1536,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 512,
           'SEQ_LEN': 24,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'PureT',
           'VOCAB_SIZE': 181,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 512,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'MAX_LEN': 'MAX_LEN',
           'MULCLASS': 'MULCLASS',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments_PureT/PureT_XE_Sydney/',
 'SCORER': {'CIDER_CACHED': './mssydney/misc/sydney_train_cider.pkl',
            'GT_PATH': './mssydney/misc/sydney_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1234.0,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 0.0005,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 512,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Noam',
                          'WARMUP': 10000},
            'MAX_EPOCH': 20,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2022-10-20 18:08:33,411] Training with config:
[INFO: 2022-10-20 18:08:33,419] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mssydney/sent/sydney_train_input.pkl',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 8,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mssydney/sent/sydney_train_target.pkl',
                 'TEST_4W_ID': './mscoco/misc/ids2path_json/coco_test4w_ids2path.json',
                 'TEST_ATT_FEATS': './mssydney/feature/Sydney',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mssydney/misc/ids2path_json/sydney_val_ids2path.json',
                 'TRAIN_ATT_FEATS': './mssydney/feature/Sydney',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mssydney/misc/ids2path_json/sydney_train_ids2path.json',
                 'VAL_ATT_FEATS': './mssydney/feature/Sydney',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mssydney/misc/ids2path_json/sydney_test_ids2path.json'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 5,
               'CAP_KEY': 'caption',
               'COCO_PATH': './coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mssydney/misc/val_sydney.json',
               'VAL_ANNFILE': './mssydney/misc/test_sydney.json',
               'VOCAB': './mssydney/txt/Sydney_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'CrossEntropy'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 1536,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 512,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 512,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [64, 32, 64],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 3,
                        'DIM': 512,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [64, 32, 64],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.1,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 3,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.1,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.1,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 1536,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 512,
           'SEQ_LEN': 24,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'PureT',
           'VOCAB_SIZE': 181,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 512,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'MAX_LEN': 'MAX_LEN',
           'MULCLASS': 'MULCLASS',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments_PureT/PureT_XE_Sydney/',
 'SCORER': {'CIDER_CACHED': './mssydney/misc/sydney_train_cider.pkl',
            'GT_PATH': './mssydney/misc/sydney_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1234.0,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 0.0005,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 512,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Noam',
                          'WARMUP': 10000},
            'MAX_EPOCH': 20,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2022-10-20 18:41:39,737] Training with config:
[INFO: 2022-10-20 18:41:39,745] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mssydney/sent/sydney_train_input.pkl',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 8,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mssydney/sent/sydney_train_target.pkl',
                 'TEST_4W_ID': './mscoco/misc/ids2path_json/coco_test4w_ids2path.json',
                 'TEST_ATT_FEATS': './mssydney/feature/Sydney',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mssydney/misc/ids2path_json/sydney_val_ids2path.json',
                 'TRAIN_ATT_FEATS': './mssydney/feature/Sydney',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mssydney/misc/ids2path_json/sydney_train_ids2path.json',
                 'VAL_ATT_FEATS': './mssydney/feature/Sydney',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mssydney/misc/ids2path_json/sydney_test_ids2path.json'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 5,
               'CAP_KEY': 'caption',
               'COCO_PATH': './coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mssydney/misc/val_sydney.json',
               'VAL_ANNFILE': './mssydney/misc/test_sydney.json',
               'VOCAB': './mssydney/txt/Sydney_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'CrossEntropy'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 1536,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 512,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 512,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [64, 32, 64],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 3,
                        'DIM': 512,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [64, 32, 64],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.1,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 3,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.1,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.1,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 1536,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 512,
           'SEQ_LEN': 24,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'PureT',
           'VOCAB_SIZE': 181,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 512,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'MAX_LEN': 'MAX_LEN',
           'MULCLASS': 'MULCLASS',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments_PureT/PureT_XE_Sydney/',
 'SCORER': {'CIDER_CACHED': './mssydney/misc/sydney_train_cider.pkl',
            'GT_PATH': './mssydney/misc/sydney_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1234.0,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 0.0005,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 512,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Noam',
                          'WARMUP': 10000},
            'MAX_EPOCH': 20,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2022-10-20 18:53:09,597] Training with config:
[INFO: 2022-10-20 18:53:09,605] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mssydney/sent/sydney_train_input.pkl',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 8,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mssydney/sent/sydney_train_target.pkl',
                 'TEST_4W_ID': './mscoco/misc/ids2path_json/coco_test4w_ids2path.json',
                 'TEST_ATT_FEATS': './mssydney/feature/Sydney',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mssydney/misc/ids2path_json/sydney_val_ids2path.json',
                 'TRAIN_ATT_FEATS': './mssydney/feature/Sydney',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mssydney/misc/ids2path_json/sydney_train_ids2path.json',
                 'VAL_ATT_FEATS': './mssydney/feature/Sydney',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mssydney/misc/ids2path_json/sydney_test_ids2path.json'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 5,
               'CAP_KEY': 'caption',
               'COCO_PATH': './coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mssydney/misc/val_sydney.json',
               'VAL_ANNFILE': './mssydney/misc/test_sydney.json',
               'VOCAB': './mssydney/txt/Sydney_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'CrossEntropy'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 1536,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 512,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 512,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [64, 32, 64],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 3,
                        'DIM': 512,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [64, 32, 64],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.1,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 3,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.1,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.1,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 1536,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 512,
           'SEQ_LEN': 24,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'PureT',
           'VOCAB_SIZE': 181,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 512,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'MAX_LEN': 'MAX_LEN',
           'MULCLASS': 'MULCLASS',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments_PureT/PureT_XE_Sydney/',
 'SCORER': {'CIDER_CACHED': './mssydney/misc/sydney_train_cider.pkl',
            'GT_PATH': './mssydney/misc/sydney_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1234.0,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 0.0005,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 512,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Noam',
                          'WARMUP': 10000},
            'MAX_EPOCH': 20,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2022-10-21 11:02:54,013] Training with config:
[INFO: 2022-10-21 11:02:54,016] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mssydney/sent/sydney_train_input.pkl',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 8,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mssydney/sent/sydney_train_target.pkl',
                 'TEST_4W_ID': './mscoco/misc/ids2path_json/coco_test4w_ids2path.json',
                 'TEST_ATT_FEATS': './mssydney/feature/Sydney',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mssydney/misc/ids2path_json/sydney_val_ids2path.json',
                 'TRAIN_ATT_FEATS': './mssydney/feature/Sydney',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mssydney/misc/ids2path_json/sydney_train_ids2path.json',
                 'VAL_ATT_FEATS': './mssydney/feature/Sydney',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mssydney/misc/ids2path_json/sydney_test_ids2path.json'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 5,
               'CAP_KEY': 'caption',
               'COCO_PATH': './coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mssydney/misc/val_sydney.json',
               'VAL_ANNFILE': './mssydney/misc/test_sydney.json',
               'VOCAB': './mssydney/txt/Sydney_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'CrossEntropy'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 1536,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 512,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 512,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [64, 32, 64],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 3,
                        'DIM': 512,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [64, 32, 64],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.1,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 3,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.1,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.1,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 1536,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 512,
           'SEQ_LEN': 24,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'PureT',
           'VOCAB_SIZE': 181,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 512,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'MAX_LEN': 'MAX_LEN',
           'MULCLASS': 'MULCLASS',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments_PureT/PureT_XE_Sydney/',
 'SCORER': {'CIDER_CACHED': './mssydney/misc/sydney_train_cider.pkl',
            'GT_PATH': './mssydney/misc/sydney_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1234.0,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 0.0005,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 512,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Noam',
                          'WARMUP': 10000},
            'MAX_EPOCH': 20,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2022-10-21 11:04:11,025] ######## Epoch (VAL)1 ########
[INFO: 2022-10-21 11:04:11,026] {'Bleu_1': 0.08573655494927067, 'Bleu_2': 0.02049229481268417, 'Bleu_3': 7.112737451755803e-08, 'Bleu_4': 1.3418279654777002e-10, 'METEOR': 0.0494368650364598, 'ROUGE_L': 0.10506970892262117, 'CIDEr': 0.0068689814635554}
[INFO: 2022-10-21 11:04:26,184] ######## Epoch (TEST)1 ########
[INFO: 2022-10-21 11:04:26,185] {'Bleu_1': 0.06515837104066502, 'Bleu_2': 0.011156469081650515, 'Bleu_3': 5.009635324147539e-08, 'Bleu_4': 1.075979197246663e-10, 'METEOR': 0.03164855013236347, 'ROUGE_L': 0.07221967459406889, 'CIDEr': 0.011350189843755926}
[INFO: 2022-10-21 11:05:35,573] ######## Epoch (VAL)2 ########
[INFO: 2022-10-21 11:05:35,573] {'Bleu_1': 2.913179342078917e-08, 'Bleu_2': 2.503405269119519e-08, 'Bleu_3': 1.801053061719689e-08, 'Bleu_4': 1.4833240913228891e-08, 'METEOR': 0.012000240045113634, 'ROUGE_L': 0.03640369282823317, 'CIDEr': 0.08931485404058054}
[INFO: 2022-10-21 11:05:50,344] ######## Epoch (TEST)2 ########
[INFO: 2022-10-21 11:05:50,345] {'Bleu_1': 4.145259515494481e-21, 'Bleu_2': 3.707632824357906e-21, 'Bleu_3': 2.8353176255862928e-21, 'Bleu_4': 2.4794435055122977e-21, 'METEOR': 0.008703792618415238, 'ROUGE_L': 0.021238092001084147, 'CIDEr': 0.05013566143880463}
[INFO: 2022-10-21 11:07:00,082] ######## Epoch (VAL)3 ########
[INFO: 2022-10-21 11:07:00,083] {'Bleu_1': 0.03227110244331399, 'Bleu_2': 0.02802884493313186, 'Bleu_3': 0.024510506429252513, 'Bleu_4': 0.019296215930574068, 'METEOR': 0.07724273021680766, 'ROUGE_L': 0.24055949660768564, 'CIDEr': 0.22436819723586485}
[INFO: 2022-10-21 11:07:15,076] ######## Epoch (TEST)3 ########
[INFO: 2022-10-21 11:07:15,076] {'Bleu_1': 0.025097535195177663, 'Bleu_2': 0.021570853755727624, 'Bleu_3': 0.01858843427107472, 'Bleu_4': 0.013257692916874678, 'METEOR': 0.07496531841222018, 'ROUGE_L': 0.2272564865778623, 'CIDEr': 0.2154243168508885}
[INFO: 2022-10-21 11:08:24,714] ######## Epoch (VAL)4 ########
[INFO: 2022-10-21 11:08:24,714] {'Bleu_1': 0.08082571024226182, 'Bleu_2': 0.07414769338015771, 'Bleu_3': 0.07428268400658561, 'Bleu_4': 0.0790060054961812, 'METEOR': 0.12255653998786567, 'ROUGE_L': 0.3420222454651049, 'CIDEr': 0.501087289948047}
[INFO: 2022-10-21 11:08:39,757] ######## Epoch (TEST)4 ########
[INFO: 2022-10-21 11:08:39,757] {'Bleu_1': 0.06942937698618354, 'Bleu_2': 0.06456924441817587, 'Bleu_3': 0.06425684095233823, 'Bleu_4': 0.0680518971809588, 'METEOR': 0.11485236089887546, 'ROUGE_L': 0.31647020478527166, 'CIDEr': 0.439325077909348}
[INFO: 2022-10-21 11:09:49,366] ######## Epoch (VAL)5 ########
[INFO: 2022-10-21 11:09:49,366] {'Bleu_1': 0.18149589794109772, 'Bleu_2': 0.1602300138996583, 'Bleu_3': 0.14119034799947122, 'Bleu_4': 0.11400593697224187, 'METEOR': 0.13570790450259396, 'ROUGE_L': 0.38014399139341504, 'CIDEr': 0.5940341174733745}
[INFO: 2022-10-21 11:10:04,292] ######## Epoch (TEST)5 ########
[INFO: 2022-10-21 11:10:04,293] {'Bleu_1': 0.15900763016141894, 'Bleu_2': 0.14096437995521435, 'Bleu_3': 0.12219697190663273, 'Bleu_4': 0.09297523772126916, 'METEOR': 0.13035362947711296, 'ROUGE_L': 0.3706430733380117, 'CIDEr': 0.5382159694011741}
[INFO: 2022-10-21 11:11:14,149] ######## Epoch (VAL)6 ########
[INFO: 2022-10-21 11:11:14,149] {'Bleu_1': 0.35156182984717915, 'Bleu_2': 0.3126572660316777, 'Bleu_3': 0.28094246669560974, 'Bleu_4': 0.25241688912720334, 'METEOR': 0.20095629453479996, 'ROUGE_L': 0.4602119448170608, 'CIDEr': 1.188989386374449}
[INFO: 2022-10-21 11:11:29,791] ######## Epoch (TEST)6 ########
[INFO: 2022-10-21 11:11:29,792] {'Bleu_1': 0.4195316108427675, 'Bleu_2': 0.3945840461416388, 'Bleu_3': 0.35812535623092734, 'Bleu_4': 0.3057428913956932, 'METEOR': 0.22821301328339735, 'ROUGE_L': 0.496231137555481, 'CIDEr': 1.2088949586100164}
[INFO: 2022-10-21 11:12:39,689] ######## Epoch (VAL)7 ########
[INFO: 2022-10-21 11:12:39,690] {'Bleu_1': 0.681293330884184, 'Bleu_2': 0.6041788718618697, 'Bleu_3': 0.5308928913089784, 'Bleu_4': 0.4607473798782389, 'METEOR': 0.3061300775792277, 'ROUGE_L': 0.6214277819898351, 'CIDEr': 1.7283672613296885}
[INFO: 2022-10-21 11:12:54,804] ######## Epoch (TEST)7 ########
[INFO: 2022-10-21 11:12:54,805] {'Bleu_1': 0.7583846835698395, 'Bleu_2': 0.6948175568762778, 'Bleu_3': 0.6127114566658737, 'Bleu_4': 0.5216309458728522, 'METEOR': 0.32887079889171683, 'ROUGE_L': 0.6527884137582473, 'CIDEr': 1.7281079346809656}
[INFO: 2022-10-21 11:14:05,068] ######## Epoch (VAL)8 ########
[INFO: 2022-10-21 11:14:05,068] {'Bleu_1': 0.6286583218508378, 'Bleu_2': 0.5605302379015249, 'Bleu_3': 0.49844006498953275, 'Bleu_4': 0.4353889060169663, 'METEOR': 0.31176016803599443, 'ROUGE_L': 0.6372313530914983, 'CIDEr': 1.7120370899176935}
[INFO: 2022-10-21 11:14:20,251] ######## Epoch (TEST)8 ########
[INFO: 2022-10-21 11:14:20,252] {'Bleu_1': 0.7177450736572532, 'Bleu_2': 0.662005856565241, 'Bleu_3': 0.5897910579875432, 'Bleu_4': 0.5096116141652984, 'METEOR': 0.3414979878029712, 'ROUGE_L': 0.6836062371649608, 'CIDEr': 1.8926833037276878}
[INFO: 2022-10-21 11:15:30,105] ######## Epoch (VAL)9 ########
[INFO: 2022-10-21 11:15:30,106] {'Bleu_1': 0.6164680548773293, 'Bleu_2': 0.5546581386261973, 'Bleu_3': 0.49239894699798975, 'Bleu_4': 0.4294494458075409, 'METEOR': 0.3129977092648659, 'ROUGE_L': 0.6451991736691933, 'CIDEr': 1.6369277713711743}
[INFO: 2022-10-21 11:15:45,124] ######## Epoch (TEST)9 ########
[INFO: 2022-10-21 11:15:45,125] {'Bleu_1': 0.6327327539182177, 'Bleu_2': 0.5861359611169268, 'Bleu_3': 0.5334364587970962, 'Bleu_4': 0.4758893970855963, 'METEOR': 0.34206066222468157, 'ROUGE_L': 0.6752620536239262, 'CIDEr': 1.802041884037758}
[INFO: 2022-10-21 11:16:55,149] ######## Epoch (VAL)10 ########
[INFO: 2022-10-21 11:16:55,149] {'Bleu_1': 0.7729435743089592, 'Bleu_2': 0.6973300042048919, 'Bleu_3': 0.6264111190672023, 'Bleu_4': 0.5559584860527171, 'METEOR': 0.3622617922489365, 'ROUGE_L': 0.6629043603944385, 'CIDEr': 2.0972225268941957}
[INFO: 2022-10-21 11:17:10,221] ######## Epoch (TEST)10 ########
[INFO: 2022-10-21 11:17:10,221] {'Bleu_1': 0.8064122997109382, 'Bleu_2': 0.7389845495548789, 'Bleu_3': 0.6660992163446702, 'Bleu_4': 0.5938058746665354, 'METEOR': 0.3855887673162711, 'ROUGE_L': 0.7048783685949945, 'CIDEr': 2.2408194696606993}
[INFO: 2022-10-21 11:18:20,211] ######## Epoch (VAL)11 ########
[INFO: 2022-10-21 11:18:20,211] {'Bleu_1': 0.7834602318697141, 'Bleu_2': 0.7027081910906856, 'Bleu_3': 0.6334227708233121, 'Bleu_4': 0.567198966727706, 'METEOR': 0.36670437718928783, 'ROUGE_L': 0.6878992819456544, 'CIDEr': 2.130171511129376}
[INFO: 2022-10-21 11:18:35,369] ######## Epoch (TEST)11 ########
[INFO: 2022-10-21 11:18:35,372] {'Bleu_1': 0.8076242268592089, 'Bleu_2': 0.7277635696028636, 'Bleu_3': 0.6469680609378964, 'Bleu_4': 0.5712143754361005, 'METEOR': 0.3881549854773554, 'ROUGE_L': 0.7036111320213398, 'CIDEr': 2.1886092046672925}
[INFO: 2022-10-21 11:19:45,356] ######## Epoch (VAL)12 ########
[INFO: 2022-10-21 11:19:45,357] {'Bleu_1': 0.7687411331255299, 'Bleu_2': 0.6990389312185262, 'Bleu_3': 0.6313064159908419, 'Bleu_4': 0.5634616719678792, 'METEOR': 0.3698404538440383, 'ROUGE_L': 0.6875245755938245, 'CIDEr': 2.151179941594939}
[INFO: 2022-10-21 11:20:00,482] ######## Epoch (TEST)12 ########
[INFO: 2022-10-21 11:20:00,483] {'Bleu_1': 0.7802558209043864, 'Bleu_2': 0.7059091272002692, 'Bleu_3': 0.6298832889437216, 'Bleu_4': 0.5614644345888906, 'METEOR': 0.3736362095222312, 'ROUGE_L': 0.6956242537560986, 'CIDEr': 2.1564959174319482}
[INFO: 2022-10-21 11:21:10,667] ######## Epoch (VAL)13 ########
[INFO: 2022-10-21 11:21:10,667] {'Bleu_1': 0.7882352941164879, 'Bleu_2': 0.7012108201785962, 'Bleu_3': 0.6286674738586333, 'Bleu_4': 0.5632699460324131, 'METEOR': 0.36887267775817445, 'ROUGE_L': 0.6901049266992842, 'CIDEr': 2.2736852463373767}
[INFO: 2022-10-21 11:21:25,952] ######## Epoch (TEST)13 ########
[INFO: 2022-10-21 11:21:25,953] {'Bleu_1': 0.8190273137238153, 'Bleu_2': 0.7405922163429354, 'Bleu_3': 0.6579351999228569, 'Bleu_4': 0.5792415269291163, 'METEOR': 0.39145313597533665, 'ROUGE_L': 0.7205976023659365, 'CIDEr': 2.3088944200149832}
[INFO: 2022-10-21 11:22:35,764] ######## Epoch (VAL)14 ########
[INFO: 2022-10-21 11:22:35,765] {'Bleu_1': 0.7772170621531685, 'Bleu_2': 0.6967347400254603, 'Bleu_3': 0.6272281301012894, 'Bleu_4': 0.5619837697537757, 'METEOR': 0.377626513164134, 'ROUGE_L': 0.7000950360072075, 'CIDEr': 2.39390690010019}
[INFO: 2022-10-21 11:22:50,910] ######## Epoch (TEST)14 ########
[INFO: 2022-10-21 11:22:50,911] {'Bleu_1': 0.8309037900862524, 'Bleu_2': 0.7498769652650914, 'Bleu_3': 0.664926760093277, 'Bleu_4': 0.5857352131775422, 'METEOR': 0.40866191198453394, 'ROUGE_L': 0.7320955431648599, 'CIDEr': 2.3445432868352363}
[INFO: 2022-10-21 11:24:00,698] ######## Epoch (VAL)15 ########
[INFO: 2022-10-21 11:24:00,699] {'Bleu_1': 0.7731525223344686, 'Bleu_2': 0.6911677621187542, 'Bleu_3': 0.6225683399546622, 'Bleu_4': 0.5592273681762995, 'METEOR': 0.3724433942645461, 'ROUGE_L': 0.6924284055557025, 'CIDEr': 2.3577176778683233}
[INFO: 2022-10-21 11:24:16,027] ######## Epoch (TEST)15 ########
[INFO: 2022-10-21 11:24:16,027] {'Bleu_1': 0.8392101551469122, 'Bleu_2': 0.7607956862937862, 'Bleu_3': 0.6742231793943645, 'Bleu_4': 0.5937850341581419, 'METEOR': 0.42736329377549476, 'ROUGE_L': 0.7469857295851792, 'CIDEr': 2.49811841034297}
[INFO: 2022-10-21 11:25:26,134] ######## Epoch (VAL)16 ########
[INFO: 2022-10-21 11:25:26,134] {'Bleu_1': 0.7747252747242106, 'Bleu_2': 0.6902160738751809, 'Bleu_3': 0.6192122199244936, 'Bleu_4': 0.55662691490789, 'METEOR': 0.3915147393009773, 'ROUGE_L': 0.7153337370364362, 'CIDEr': 2.493716048519785}
[INFO: 2022-10-21 11:25:41,558] ######## Epoch (TEST)16 ########
[INFO: 2022-10-21 11:25:41,558] {'Bleu_1': 0.8083109919560211, 'Bleu_2': 0.7271119463525585, 'Bleu_3': 0.6465061007949027, 'Bleu_4': 0.5735078067261716, 'METEOR': 0.42408168097112703, 'ROUGE_L': 0.7399576771974881, 'CIDEr': 2.4395918637920158}
[INFO: 2022-10-21 11:26:51,795] ######## Epoch (VAL)17 ########
[INFO: 2022-10-21 11:26:51,795] {'Bleu_1': 0.7680865622646035, 'Bleu_2': 0.6957523031468195, 'Bleu_3': 0.6307190368408293, 'Bleu_4': 0.570357220353548, 'METEOR': 0.3860779003983157, 'ROUGE_L': 0.7004856419026902, 'CIDEr': 2.496374514197222}
[INFO: 2022-10-21 11:27:06,995] ######## Epoch (TEST)17 ########
[INFO: 2022-10-21 11:27:06,996] {'Bleu_1': 0.8436578171066558, 'Bleu_2': 0.7746519482165027, 'Bleu_3': 0.7034472018661395, 'Bleu_4': 0.6407128767382564, 'METEOR': 0.4436139476410402, 'ROUGE_L': 0.7498417467180571, 'CIDEr': 2.5750760214821797}
[INFO: 2022-10-21 11:28:17,103] ######## Epoch (VAL)18 ########
[INFO: 2022-10-21 11:28:17,104] {'Bleu_1': 0.7727891156452071, 'Bleu_2': 0.6940526063539418, 'Bleu_3': 0.6271688271906808, 'Bleu_4': 0.5645476808672394, 'METEOR': 0.4014342513549174, 'ROUGE_L': 0.7194884968970482, 'CIDEr': 2.688039004940519}
[INFO: 2022-10-21 11:28:32,630] ######## Epoch (TEST)18 ########
[INFO: 2022-10-21 11:28:32,631] {'Bleu_1': 0.8547717842311829, 'Bleu_2': 0.7854795541390319, 'Bleu_3': 0.7152554788566987, 'Bleu_4': 0.6488931923644135, 'METEOR': 0.44794547715057875, 'ROUGE_L': 0.7773600875676001, 'CIDEr': 2.7348883636441808}
[INFO: 2022-10-21 11:29:42,997] ######## Epoch (VAL)19 ########
[INFO: 2022-10-21 11:29:42,997] {'Bleu_1': 0.735583684949739, 'Bleu_2': 0.6473377341965141, 'Bleu_3': 0.5771683520566697, 'Bleu_4': 0.5140341393501412, 'METEOR': 0.38923979204540526, 'ROUGE_L': 0.6832742434043957, 'CIDEr': 2.3659778652813315}
[INFO: 2022-10-21 11:29:58,314] ######## Epoch (TEST)19 ########
[INFO: 2022-10-21 11:29:58,314] {'Bleu_1': 0.8211267605622238, 'Bleu_2': 0.7444021921592173, 'Bleu_3': 0.667636146244853, 'Bleu_4': 0.5964820728163367, 'METEOR': 0.42192925503618905, 'ROUGE_L': 0.7371772737240343, 'CIDEr': 2.5884923474443506}
[INFO: 2022-10-21 11:31:08,796] ######## Epoch (VAL)20 ########
[INFO: 2022-10-21 11:31:08,797] {'Bleu_1': 0.7450585090733772, 'Bleu_2': 0.648636375038047, 'Bleu_3': 0.574205153357114, 'Bleu_4': 0.5085371787912174, 'METEOR': 0.3861955660136158, 'ROUGE_L': 0.6807811953697582, 'CIDEr': 2.264951213325461}
[INFO: 2022-10-21 11:31:24,603] ######## Epoch (TEST)20 ########
[INFO: 2022-10-21 11:31:24,604] {'Bleu_1': 0.8189655172402026, 'Bleu_2': 0.7342553403043335, 'Bleu_3': 0.6540499396473616, 'Bleu_4': 0.5826398319321997, 'METEOR': 0.42943980775918406, 'ROUGE_L': 0.7499439067763746, 'CIDEr': 2.5867463553696517}
[INFO: 2022-10-21 11:34:30,286] Training with config:
[INFO: 2022-10-21 11:34:30,289] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mssydney/sent/sydney_train_input.pkl',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 8,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mssydney/sent/sydney_train_target.pkl',
                 'TEST_4W_ID': './mscoco/misc/ids2path_json/coco_test4w_ids2path.json',
                 'TEST_ATT_FEATS': './mssydney/feature/Sydney',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mssydney/misc/ids2path_json/sydney_val_ids2path.json',
                 'TRAIN_ATT_FEATS': './mssydney/feature/Sydney',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mssydney/misc/ids2path_json/sydney_train_ids2path.json',
                 'VAL_ATT_FEATS': './mssydney/feature/Sydney',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mssydney/misc/ids2path_json/sydney_test_ids2path.json'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 5,
               'CAP_KEY': 'caption',
               'COCO_PATH': './coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mssydney/misc/val_sydney.json',
               'VAL_ANNFILE': './mssydney/misc/test_sydney.json',
               'VOCAB': './mssydney/txt/Sydney_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'CrossEntropy'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 1536,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 512,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 512,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [64, 32, 64],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 3,
                        'DIM': 512,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [64, 32, 64],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.1,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 3,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.1,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.1,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 1536,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 512,
           'SEQ_LEN': 24,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'PureT',
           'VOCAB_SIZE': 181,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 512,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'MAX_LEN': 'MAX_LEN',
           'MULCLASS': 'MULCLASS',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments_PureT/PureT_XE_Sydney/',
 'SCORER': {'CIDER_CACHED': './mssydney/misc/sydney_train_cider.pkl',
            'GT_PATH': './mssydney/misc/sydney_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1234.0,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 0.0005,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 512,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Noam',
                          'WARMUP': 10000},
            'MAX_EPOCH': 20,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2022-10-21 11:35:48,118] ######## Epoch (VAL)1 ########
[INFO: 2022-10-21 11:35:48,118] {'Bleu_1': 0.10018726591750919, 'Bleu_2': 0.019919368743965243, 'Bleu_3': 7.4697270286388e-08, 'Bleu_4': 1.4677749259900045e-10, 'METEOR': 0.04532403425578902, 'ROUGE_L': 0.12168303095649148, 'CIDEr': 0.02301859365567243}
[INFO: 2022-10-21 11:36:03,003] ######## Epoch (TEST)1 ########
[INFO: 2022-10-21 11:36:03,004] {'Bleu_1': 0.09241245136177781, 'Bleu_2': 0.016905966557470686, 'Bleu_3': 6.789999534642034e-08, 'Bleu_4': 1.3820714205745012e-10, 'METEOR': 0.03759918535869423, 'ROUGE_L': 0.11063474791881799, 'CIDEr': 0.01170362255841397}
[INFO: 2022-10-21 11:37:12,841] ######## Epoch (VAL)2 ########
[INFO: 2022-10-21 11:37:12,841] {'Bleu_1': 3.504353378033991e-35, 'Bleu_2': 2.393929101854575e-35, 'Bleu_3': 2.413475164219685e-40, 'Bleu_4': 9.113099411301327e-43, 'METEOR': 0.002321920458327311, 'ROUGE_L': 0.015501681490205787, 'CIDEr': 0.017438458831462524}
[INFO: 2022-10-21 11:37:27,663] ######## Epoch (TEST)2 ########
[INFO: 2022-10-21 11:37:27,663] {'Bleu_1': 1.020764167132717e-124, 'Bleu_2': 1.0207641673879078e-127, 'Bleu_3': 1.0207641674729718e-128, 'Bleu_4': 3.227939723234649e-129, 'METEOR': 0.0006362081991331663, 'ROUGE_L': 0.006373677227590878, 'CIDEr': 0.0016139468184890244}
[INFO: 2022-10-21 11:38:37,441] ######## Epoch (VAL)3 ########
[INFO: 2022-10-21 11:38:37,441] {'Bleu_1': 0.0033894719767990442, 'Bleu_2': 0.0032613842906421787, 'Bleu_3': 0.0031932874006684736, 'Bleu_4': 0.00010506149287576675, 'METEOR': 0.05357736483113426, 'ROUGE_L': 0.20793775539604217, 'CIDEr': 0.18865236568586913}
[INFO: 2022-10-21 11:38:52,417] ######## Epoch (TEST)3 ########
[INFO: 2022-10-21 11:38:52,418] {'Bleu_1': 0.004202703869626801, 'Bleu_2': 0.004430038853037761, 'Bleu_3': 0.004508517747408883, 'Bleu_4': 0.00014382914798794798, 'METEOR': 0.05932398136967717, 'ROUGE_L': 0.2032115712420896, 'CIDEr': 0.19731953306689667}
[INFO: 2022-10-21 11:40:02,468] ######## Epoch (VAL)4 ########
[INFO: 2022-10-21 11:40:02,469] {'Bleu_1': 0.08417351675363885, 'Bleu_2': 0.07679194197307694, 'Bleu_3': 0.07547311155745336, 'Bleu_4': 0.08153706566482817, 'METEOR': 0.12043229626744004, 'ROUGE_L': 0.34356178432895207, 'CIDEr': 0.4790451570442333}
[INFO: 2022-10-21 11:40:17,525] ######## Epoch (TEST)4 ########
[INFO: 2022-10-21 11:40:17,525] {'Bleu_1': 0.06634747132864871, 'Bleu_2': 0.059885473923768945, 'Bleu_3': 0.05765915413530329, 'Bleu_4': 0.06407576140438051, 'METEOR': 0.10902250716537122, 'ROUGE_L': 0.2995942246225896, 'CIDEr': 0.36125318995364125}
[INFO: 2022-10-21 11:41:27,897] ######## Epoch (VAL)5 ########
[INFO: 2022-10-21 11:41:27,898] {'Bleu_1': 0.1547868813814607, 'Bleu_2': 0.13980759520189953, 'Bleu_3': 0.12755968676182997, 'Bleu_4': 0.10652745088725596, 'METEOR': 0.13246277055114655, 'ROUGE_L': 0.3618285033853874, 'CIDEr': 0.6232679883329898}
[INFO: 2022-10-21 11:41:43,178] ######## Epoch (TEST)5 ########
[INFO: 2022-10-21 11:41:43,178] {'Bleu_1': 0.18515401516467295, 'Bleu_2': 0.16829658101966308, 'Bleu_3': 0.1489077006972174, 'Bleu_4': 0.11514923024348096, 'METEOR': 0.140082169212214, 'ROUGE_L': 0.38020852807399874, 'CIDEr': 0.5758605399604168}
[INFO: 2022-10-21 11:42:53,028] ######## Epoch (VAL)6 ########
[INFO: 2022-10-21 11:42:53,029] {'Bleu_1': 0.36893500275340474, 'Bleu_2': 0.32781495968628005, 'Bleu_3': 0.2948631750059713, 'Bleu_4': 0.26674175695473507, 'METEOR': 0.20828018351106772, 'ROUGE_L': 0.46036352540281783, 'CIDEr': 1.2006080974478188}
[INFO: 2022-10-21 11:43:08,011] ######## Epoch (TEST)6 ########
[INFO: 2022-10-21 11:43:08,011] {'Bleu_1': 0.4090818468069335, 'Bleu_2': 0.37987940227963074, 'Bleu_3': 0.34146766125339, 'Bleu_4': 0.29235600108396004, 'METEOR': 0.2257949202063594, 'ROUGE_L': 0.48030605627667494, 'CIDEr': 1.1526540471633713}
[INFO: 2022-10-21 11:44:18,049] ######## Epoch (VAL)7 ########
[INFO: 2022-10-21 11:44:18,049] {'Bleu_1': 0.6572833707261488, 'Bleu_2': 0.5777922539751112, 'Bleu_3': 0.5025841571072857, 'Bleu_4': 0.4333254939239513, 'METEOR': 0.2899051375221261, 'ROUGE_L': 0.5886881082290208, 'CIDEr': 1.6059023932747176}
[INFO: 2022-10-21 11:44:33,104] ######## Epoch (TEST)7 ########
[INFO: 2022-10-21 11:44:33,105] {'Bleu_1': 0.7414770356783004, 'Bleu_2': 0.6785401941801571, 'Bleu_3': 0.5977313975848687, 'Bleu_4': 0.5079495516868747, 'METEOR': 0.3182665562293945, 'ROUGE_L': 0.6410269040454536, 'CIDEr': 1.66895278138771}
[INFO: 2022-10-21 11:45:43,608] ######## Epoch (VAL)8 ########
[INFO: 2022-10-21 11:45:43,608] {'Bleu_1': 0.5961402939396933, 'Bleu_2': 0.5291877662330451, 'Bleu_3': 0.46479982439938566, 'Bleu_4': 0.40012888064233737, 'METEOR': 0.2977421112860215, 'ROUGE_L': 0.6111333045612789, 'CIDEr': 1.5911168699095388}
[INFO: 2022-10-21 11:45:58,710] ######## Epoch (TEST)8 ########
[INFO: 2022-10-21 11:45:58,711] {'Bleu_1': 0.6892663196486286, 'Bleu_2': 0.6410608707243963, 'Bleu_3': 0.5775684968052321, 'Bleu_4': 0.49978299825112377, 'METEOR': 0.3391657529431062, 'ROUGE_L': 0.6791611666670547, 'CIDEr': 1.8010655947983498}
[INFO: 2022-10-21 11:47:08,878] ######## Epoch (VAL)9 ########
[INFO: 2022-10-21 11:47:08,879] {'Bleu_1': 0.6196583407224502, 'Bleu_2': 0.5578868606466485, 'Bleu_3': 0.4996377155972788, 'Bleu_4': 0.439908985638298, 'METEOR': 0.31379598093983785, 'ROUGE_L': 0.6424424385757824, 'CIDEr': 1.6389083666133129}
[INFO: 2022-10-21 11:47:23,850] ######## Epoch (TEST)9 ########
[INFO: 2022-10-21 11:47:23,850] {'Bleu_1': 0.651307679429528, 'Bleu_2': 0.5977374923275497, 'Bleu_3': 0.5387007292010246, 'Bleu_4': 0.47236560386633086, 'METEOR': 0.3324296703585109, 'ROUGE_L': 0.6578928234197395, 'CIDEr': 1.7225840247303184}
[INFO: 2022-10-21 11:48:33,948] ######## Epoch (VAL)10 ########
[INFO: 2022-10-21 11:48:33,949] {'Bleu_1': 0.7609115871302862, 'Bleu_2': 0.6790390417926274, 'Bleu_3': 0.6057107709465097, 'Bleu_4': 0.5351779359009914, 'METEOR': 0.35848730592543154, 'ROUGE_L': 0.6506718714455147, 'CIDEr': 2.0508817814614786}
[INFO: 2022-10-21 11:48:48,777] ######## Epoch (TEST)10 ########
[INFO: 2022-10-21 11:48:48,777] {'Bleu_1': 0.812340937485244, 'Bleu_2': 0.7443816631910724, 'Bleu_3': 0.6695222715530946, 'Bleu_4': 0.5951962169693565, 'METEOR': 0.3849819558404393, 'ROUGE_L': 0.6977372050282835, 'CIDEr': 2.210554338183567}
[INFO: 2022-10-21 11:49:58,918] ######## Epoch (VAL)11 ########
[INFO: 2022-10-21 11:49:58,919] {'Bleu_1': 0.7746044268977229, 'Bleu_2': 0.6947106205313042, 'Bleu_3': 0.6249404548223565, 'Bleu_4': 0.557011577362387, 'METEOR': 0.36505303480189805, 'ROUGE_L': 0.6853951097293473, 'CIDEr': 2.1209986079143603}
[INFO: 2022-10-21 11:50:14,072] ######## Epoch (TEST)11 ########
[INFO: 2022-10-21 11:50:14,072] {'Bleu_1': 0.8004669713951759, 'Bleu_2': 0.7247575040288323, 'Bleu_3': 0.646194238410812, 'Bleu_4': 0.571000165617663, 'METEOR': 0.3867421278015472, 'ROUGE_L': 0.7025438906918732, 'CIDEr': 2.145976439809201}
[INFO: 2022-10-21 11:51:24,093] ######## Epoch (VAL)12 ########
[INFO: 2022-10-21 11:51:24,094] {'Bleu_1': 0.7770964166838104, 'Bleu_2': 0.7013525375203383, 'Bleu_3': 0.6307234242537275, 'Bleu_4': 0.562040202437394, 'METEOR': 0.3696559581400946, 'ROUGE_L': 0.6879524468561801, 'CIDEr': 2.13109228219775}
[INFO: 2022-10-21 11:51:38,915] ######## Epoch (TEST)12 ########
[INFO: 2022-10-21 11:51:38,916] {'Bleu_1': 0.7693453731417597, 'Bleu_2': 0.69571455370363, 'Bleu_3': 0.619161294997256, 'Bleu_4': 0.551422591789766, 'METEOR': 0.3672647113639876, 'ROUGE_L': 0.6760572785559883, 'CIDEr': 2.073560903388926}
[INFO: 2022-10-21 11:52:49,349] ######## Epoch (VAL)13 ########
[INFO: 2022-10-21 11:52:49,350] {'Bleu_1': 0.7965658533221711, 'Bleu_2': 0.7188862002621355, 'Bleu_3': 0.6489118349615438, 'Bleu_4': 0.583477855526188, 'METEOR': 0.3769105866461391, 'ROUGE_L': 0.7044002785574259, 'CIDEr': 2.2744460991140807}
[INFO: 2022-10-21 11:53:04,413] ######## Epoch (TEST)13 ########
[INFO: 2022-10-21 11:53:04,414] {'Bleu_1': 0.8111195086286175, 'Bleu_2': 0.7313711696225897, 'Bleu_3': 0.6471239703391669, 'Bleu_4': 0.5663870461044612, 'METEOR': 0.3950338553039424, 'ROUGE_L': 0.71084015267346, 'CIDEr': 2.1896343879063225}
[INFO: 2022-10-21 11:54:14,762] ######## Epoch (VAL)14 ########
[INFO: 2022-10-21 11:54:14,762] {'Bleu_1': 0.7699199117113407, 'Bleu_2': 0.68954842068979, 'Bleu_3': 0.6179316706757465, 'Bleu_4': 0.5526650118907417, 'METEOR': 0.37435017922573904, 'ROUGE_L': 0.6905878627600511, 'CIDEr': 2.323839619339726}
[INFO: 2022-10-21 11:54:29,741] ######## Epoch (TEST)14 ########
[INFO: 2022-10-21 11:54:29,741] {'Bleu_1': 0.8187050359700451, 'Bleu_2': 0.739074945043099, 'Bleu_3': 0.6536270781128428, 'Bleu_4': 0.5707611357105679, 'METEOR': 0.4111274898826896, 'ROUGE_L': 0.7247867630256185, 'CIDEr': 2.295368298081931}
[INFO: 2022-10-21 11:55:39,779] ######## Epoch (VAL)15 ########
[INFO: 2022-10-21 11:55:39,779] {'Bleu_1': 0.7748776824550595, 'Bleu_2': 0.6949556124976572, 'Bleu_3': 0.6238915682573105, 'Bleu_4': 0.5573345978258352, 'METEOR': 0.3810740830271633, 'ROUGE_L': 0.6972544749251375, 'CIDEr': 2.397900261776259}
[INFO: 2022-10-21 11:55:54,715] ######## Epoch (TEST)15 ########
[INFO: 2022-10-21 11:55:54,716] {'Bleu_1': 0.8192252510748649, 'Bleu_2': 0.7398866197119841, 'Bleu_3': 0.6533541317668752, 'Bleu_4': 0.5736012230564427, 'METEOR': 0.4072604728291736, 'ROUGE_L': 0.7253644817438476, 'CIDEr': 2.3013960666924542}
[INFO: 2022-10-21 11:57:04,834] ######## Epoch (VAL)16 ########
[INFO: 2022-10-21 11:57:04,835] {'Bleu_1': 0.7809917355361143, 'Bleu_2': 0.6990739655871095, 'Bleu_3': 0.6299271672471868, 'Bleu_4': 0.5662255326496407, 'METEOR': 0.39542927035760184, 'ROUGE_L': 0.7181786546937855, 'CIDEr': 2.4939660850025738}
[INFO: 2022-10-21 11:57:19,874] ######## Epoch (TEST)16 ########
[INFO: 2022-10-21 11:57:19,874] {'Bleu_1': 0.8112947658391029, 'Bleu_2': 0.7293536506113973, 'Bleu_3': 0.6438074103521964, 'Bleu_4': 0.562438181419519, 'METEOR': 0.4174129697592813, 'ROUGE_L': 0.7380928433108577, 'CIDEr': 2.274586215165786}
[INFO: 2022-10-21 11:58:30,137] ######## Epoch (VAL)17 ########
[INFO: 2022-10-21 11:58:30,138] {'Bleu_1': 0.7844474761244414, 'Bleu_2': 0.7052643526243282, 'Bleu_3': 0.6345891681233462, 'Bleu_4': 0.5694406916187144, 'METEOR': 0.399906654444362, 'ROUGE_L': 0.7189638624362475, 'CIDEr': 2.561452384183771}
[INFO: 2022-10-21 11:58:45,209] ######## Epoch (TEST)17 ########
[INFO: 2022-10-21 11:58:45,209] {'Bleu_1': 0.8291666666655151, 'Bleu_2': 0.7448928158791985, 'Bleu_3': 0.6586231736548486, 'Bleu_4': 0.5791475317441971, 'METEOR': 0.4241546383174456, 'ROUGE_L': 0.748555021491595, 'CIDEr': 2.4463101630525887}
[INFO: 2022-10-21 11:59:55,606] ######## Epoch (VAL)18 ########
[INFO: 2022-10-21 11:59:55,606] {'Bleu_1': 0.7991746905078416, 'Bleu_2': 0.7183724611737996, 'Bleu_3': 0.6465508786130758, 'Bleu_4': 0.579660546322308, 'METEOR': 0.4071687497330213, 'ROUGE_L': 0.7383412073052251, 'CIDEr': 2.5983954524493997}
[INFO: 2022-10-21 12:00:10,697] ######## Epoch (TEST)18 ########
[INFO: 2022-10-21 12:00:10,697] {'Bleu_1': 0.8321579689692071, 'Bleu_2': 0.7533622925340954, 'Bleu_3': 0.669112485903702, 'Bleu_4': 0.5883548642834339, 'METEOR': 0.42427032030307993, 'ROUGE_L': 0.7501913829693112, 'CIDEr': 2.437731204702474}
[INFO: 2022-10-21 12:01:20,765] ######## Epoch (VAL)19 ########
[INFO: 2022-10-21 12:01:20,765] {'Bleu_1': 0.7591549295763955, 'Bleu_2': 0.675591915424049, 'Bleu_3': 0.6027572381470232, 'Bleu_4': 0.5366481514889626, 'METEOR': 0.3881253295955609, 'ROUGE_L': 0.6954318909500424, 'CIDEr': 2.355783572907753}
[INFO: 2022-10-21 12:01:35,803] ######## Epoch (TEST)19 ########
[INFO: 2022-10-21 12:01:35,803] {'Bleu_1': 0.8266296809974666, 'Bleu_2': 0.7457034676907194, 'Bleu_3': 0.663643263342767, 'Bleu_4': 0.5862086931576169, 'METEOR': 0.4250339810258442, 'ROUGE_L': 0.7430897125968009, 'CIDEr': 2.5264814670886966}
[INFO: 2022-10-21 12:02:46,122] ######## Epoch (VAL)20 ########
[INFO: 2022-10-21 12:02:46,123] {'Bleu_1': 0.7342370223167175, 'Bleu_2': 0.6356974810831426, 'Bleu_3': 0.5605708231132897, 'Bleu_4': 0.49318902982801144, 'METEOR': 0.380445801492895, 'ROUGE_L': 0.6785906813844096, 'CIDEr': 2.2082604949032465}
[INFO: 2022-10-21 12:03:01,747] ######## Epoch (TEST)20 ########
[INFO: 2022-10-21 12:03:01,748] {'Bleu_1': 0.7903682719535547, 'Bleu_2': 0.6949840522341216, 'Bleu_3': 0.6098071026578256, 'Bleu_4': 0.5292013050490285, 'METEOR': 0.41073874458124443, 'ROUGE_L': 0.7145951291522088, 'CIDEr': 2.4325867921572364}
[INFO: 2022-10-23 11:02:12,109] Training with config:
[INFO: 2022-10-23 11:02:12,117] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mssydney/sent/sydney_train_input.pkl',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 8,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mssydney/sent/sydney_train_target.pkl',
                 'TEST_4W_ID': './mscoco/misc/ids2path_json/coco_test4w_ids2path.json',
                 'TEST_ATT_FEATS': './mssydney/feature/Sydney',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mssydney/misc/ids2path_json/sydney_val_ids2path.json',
                 'TRAIN_ATT_FEATS': './mssydney/feature/Sydney',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mssydney/misc/ids2path_json/sydney_train_ids2path.json',
                 'VAL_ATT_FEATS': './mssydney/feature/Sydney',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mssydney/misc/ids2path_json/sydney_test_ids2path.json'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 5,
               'CAP_KEY': 'caption',
               'COCO_PATH': './coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mssydney/misc/val_sydney.json',
               'VAL_ANNFILE': './mssydney/misc/test_sydney.json',
               'VOCAB': './mssydney/txt/Sydney_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'CrossEntropy'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 1536,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 512,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 512,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [64, 32, 64],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 3,
                        'DIM': 512,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [64, 32, 64],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.1,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 3,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.1,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.1,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 1536,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 512,
           'SEQ_LEN': 24,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'PureT',
           'VOCAB_SIZE': 181,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 512,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'MAX_LEN': 'MAX_LEN',
           'MULCLASS': 'MULCLASS',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments_PureT/PureT_XE_Sydney/',
 'SCORER': {'CIDER_CACHED': './mssydney/misc/sydney_train_cider.pkl',
            'GT_PATH': './mssydney/misc/sydney_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1234.0,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 0.0005,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 512,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Noam',
                          'WARMUP': 10000},
            'MAX_EPOCH': 20,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2022-10-23 11:03:26,366] ######## Epoch (VAL)1 ########
[INFO: 2022-10-23 11:03:26,367] {'Bleu_1': 0.11363636363621171, 'Bleu_2': 0.02222771122368839, 'Bleu_3': 9.10759928861124e-08, 'Bleu_4': 1.8698459029904108e-10, 'METEOR': 0.03733324514227632, 'ROUGE_L': 0.12075198635855443, 'CIDEr': 0.03593029998513254}
[INFO: 2022-10-23 11:03:41,168] ######## Epoch (TEST)1 ########
[INFO: 2022-10-23 11:03:41,168] {'Bleu_1': 0.10012515644543163, 'Bleu_2': 0.016439079573816434, 'Bleu_3': 7.27109619184467e-08, 'Bleu_4': 1.550581172120106e-10, 'METEOR': 0.03076172963531968, 'ROUGE_L': 0.10832912209688084, 'CIDEr': 0.010491816483928992}
[INFO: 2022-10-23 11:04:47,203] ######## Epoch (VAL)2 ########
[INFO: 2022-10-23 11:04:47,203] {'Bleu_1': 2.947590525429621e-06, 'Bleu_2': 3.061732765928081e-09, 'Bleu_3': 3.1007540904912947e-10, 'Bleu_4': 9.867732024810027e-11, 'METEOR': 0.013637791036741285, 'ROUGE_L': 0.1138909777193404, 'CIDEr': 0.0071627595400767415}
[INFO: 2022-10-23 11:05:01,699] ######## Epoch (TEST)2 ########
[INFO: 2022-10-23 11:05:01,699] {'Bleu_1': 9.570963445764006e-07, 'Bleu_2': 1.0404734222600503e-09, 'Bleu_3': 1.0698496993763124e-10, 'Bleu_4': 3.4305887406595176e-11, 'METEOR': 0.010792690405134704, 'ROUGE_L': 0.09046726671021287, 'CIDEr': 0.011685249940147765}
[INFO: 2022-10-23 11:06:08,338] ######## Epoch (VAL)3 ########
[INFO: 2022-10-23 11:06:08,339] {'Bleu_1': 0.00016220795423538823, 'Bleu_2': 1.6810834162139912e-07, 'Bleu_3': 1.701224529953232e-08, 'Bleu_4': 5.4118758141792364e-09, 'METEOR': 0.019833800101005467, 'ROUGE_L': 0.15514889548276953, 'CIDEr': 0.008824348265458698}
[INFO: 2022-10-23 11:06:22,854] ######## Epoch (TEST)3 ########
[INFO: 2022-10-23 11:06:22,854] {'Bleu_1': 0.00011763392840108813, 'Bleu_2': 1.2798190118026439e-07, 'Bleu_3': 1.3162969539069046e-08, 'Bleu_4': 4.2214002909842355e-09, 'METEOR': 0.01651499831479609, 'ROUGE_L': 0.1356160468045994, 'CIDEr': 0.017419774431422532}
[INFO: 2022-10-23 11:07:29,715] ######## Epoch (VAL)4 ########
[INFO: 2022-10-23 11:07:29,715] {'Bleu_1': 0.05219950221453088, 'Bleu_2': 0.04752161950577472, 'Bleu_3': 0.04550244855967263, 'Bleu_4': 0.0015533903092357652, 'METEOR': 0.11232324076263066, 'ROUGE_L': 0.31685473845668183, 'CIDEr': 0.32516021652972094}
[INFO: 2022-10-23 11:07:44,330] ######## Epoch (TEST)4 ########
[INFO: 2022-10-23 11:07:44,331] {'Bleu_1': 0.04912623712894282, 'Bleu_2': 0.043515292784246276, 'Bleu_3': 0.04079577849692871, 'Bleu_4': 8.126736641165706e-06, 'METEOR': 0.10215103627823596, 'ROUGE_L': 0.2805949801261615, 'CIDEr': 0.28556888052203694}
[INFO: 2022-10-23 11:08:51,013] ######## Epoch (VAL)5 ########
[INFO: 2022-10-23 11:08:51,014] {'Bleu_1': 0.12382441558015497, 'Bleu_2': 0.11143278261064944, 'Bleu_3': 0.10668112238682796, 'Bleu_4': 0.10291598351214817, 'METEOR': 0.12525588646310556, 'ROUGE_L': 0.36741884370523775, 'CIDEr': 0.6708074699281723}
[INFO: 2022-10-23 11:09:05,797] ######## Epoch (TEST)5 ########
[INFO: 2022-10-23 11:09:05,798] {'Bleu_1': 0.10914266187761959, 'Bleu_2': 0.10006575558562973, 'Bleu_3': 0.0971366010933618, 'Bleu_4': 0.09860714966583381, 'METEOR': 0.11877690074491098, 'ROUGE_L': 0.3358652556841607, 'CIDEr': 0.6429950457501117}
[INFO: 2022-10-23 11:10:13,409] ######## Epoch (VAL)6 ########
[INFO: 2022-10-23 11:10:13,410] {'Bleu_1': 0.31211164627735866, 'Bleu_2': 0.2673250370965097, 'Bleu_3': 0.22169894096912482, 'Bleu_4': 0.1776010482107352, 'METEOR': 0.1617833475834105, 'ROUGE_L': 0.42764691551986295, 'CIDEr': 0.8558023537611619}
[INFO: 2022-10-23 11:10:27,906] ######## Epoch (TEST)6 ########
[INFO: 2022-10-23 11:10:27,906] {'Bleu_1': 0.3096757397993351, 'Bleu_2': 0.2823540578774685, 'Bleu_3': 0.24901455789676938, 'Bleu_4': 0.20085539367724756, 'METEOR': 0.17203188514484516, 'ROUGE_L': 0.4487116195224583, 'CIDEr': 0.918654818042707}
[INFO: 2022-10-23 11:11:35,512] ######## Epoch (VAL)7 ########
[INFO: 2022-10-23 11:11:35,512] {'Bleu_1': 0.5840257663308425, 'Bleu_2': 0.5208282533321774, 'Bleu_3': 0.45794534937557746, 'Bleu_4': 0.3970816911934197, 'METEOR': 0.30011644772371154, 'ROUGE_L': 0.6282780966118809, 'CIDEr': 1.5039012861563958}
[INFO: 2022-10-23 11:11:50,216] ######## Epoch (TEST)7 ########
[INFO: 2022-10-23 11:11:50,216] {'Bleu_1': 0.6311734849581668, 'Bleu_2': 0.5715248069507446, 'Bleu_3': 0.5066423028548894, 'Bleu_4': 0.4316083609087463, 'METEOR': 0.30679996353993744, 'ROUGE_L': 0.6359062197237147, 'CIDEr': 1.540250425115258}
[INFO: 2022-10-23 11:12:57,395] ######## Epoch (VAL)8 ########
[INFO: 2022-10-23 11:12:57,395] {'Bleu_1': 0.6019061408675432, 'Bleu_2': 0.531734571221668, 'Bleu_3': 0.4680601532707293, 'Bleu_4': 0.40751838473209107, 'METEOR': 0.3029878852792641, 'ROUGE_L': 0.6308581903664628, 'CIDEr': 1.5903786538761677}
[INFO: 2022-10-23 11:13:12,432] ######## Epoch (TEST)8 ########
[INFO: 2022-10-23 11:13:12,432] {'Bleu_1': 0.6774678102552801, 'Bleu_2': 0.6241311677153016, 'Bleu_3': 0.5630709326874114, 'Bleu_4': 0.4884327361149803, 'METEOR': 0.33615621568393045, 'ROUGE_L': 0.6744382091934655, 'CIDEr': 1.79232459018552}
[INFO: 2022-10-23 11:14:19,745] ######## Epoch (VAL)9 ########
[INFO: 2022-10-23 11:14:19,746] {'Bleu_1': 0.6231115777103166, 'Bleu_2': 0.5564974088993216, 'Bleu_3': 0.4912601953699673, 'Bleu_4': 0.4246019410316302, 'METEOR': 0.3154017382296982, 'ROUGE_L': 0.6218579743170093, 'CIDEr': 1.6715969315269612}
[INFO: 2022-10-23 11:14:34,434] ######## Epoch (TEST)9 ########
[INFO: 2022-10-23 11:14:34,434] {'Bleu_1': 0.6595364257925933, 'Bleu_2': 0.602144510160616, 'Bleu_3': 0.5410119058360533, 'Bleu_4': 0.47198214383044323, 'METEOR': 0.33858268101564665, 'ROUGE_L': 0.6593205983750716, 'CIDEr': 1.7977805494247008}
[INFO: 2022-10-23 11:15:41,685] ######## Epoch (VAL)10 ########
[INFO: 2022-10-23 11:15:41,686] {'Bleu_1': 0.6424889778039029, 'Bleu_2': 0.5806819977032415, 'Bleu_3': 0.5154757763512887, 'Bleu_4': 0.4480055655774212, 'METEOR': 0.3272491824096136, 'ROUGE_L': 0.6666146505871686, 'CIDEr': 1.7878998684476295}
[INFO: 2022-10-23 11:15:56,187] ######## Epoch (TEST)10 ########
[INFO: 2022-10-23 11:15:56,187] {'Bleu_1': 0.649094046141853, 'Bleu_2': 0.5917595487828886, 'Bleu_3': 0.5265840612351879, 'Bleu_4': 0.46255237955427725, 'METEOR': 0.3260994921225279, 'ROUGE_L': 0.6662271419979164, 'CIDEr': 1.7831629597787677}
[INFO: 2022-10-23 11:17:03,815] ######## Epoch (VAL)11 ########
[INFO: 2022-10-23 11:17:03,816] {'Bleu_1': 0.7523311688761904, 'Bleu_2': 0.6751105661442969, 'Bleu_3': 0.604371741941096, 'Bleu_4': 0.5378964272265309, 'METEOR': 0.36351309307389496, 'ROUGE_L': 0.6722891857088581, 'CIDEr': 2.1340672249904564}
[INFO: 2022-10-23 11:17:18,602] ######## Epoch (TEST)11 ########
[INFO: 2022-10-23 11:17:18,602] {'Bleu_1': 0.8177842565585747, 'Bleu_2': 0.7404241898456704, 'Bleu_3': 0.6541235378618337, 'Bleu_4': 0.5743023740863996, 'METEOR': 0.40055612304281996, 'ROUGE_L': 0.7144026690269756, 'CIDEr': 2.24523877625621}
[INFO: 2022-10-23 11:18:26,138] ######## Epoch (VAL)12 ########
[INFO: 2022-10-23 11:18:26,138] {'Bleu_1': 0.7519089249488944, 'Bleu_2': 0.6754482757692923, 'Bleu_3': 0.6034853230025811, 'Bleu_4': 0.5355059483055958, 'METEOR': 0.3684917919967546, 'ROUGE_L': 0.6794864296689708, 'CIDEr': 2.217045144247259}
[INFO: 2022-10-23 11:18:41,657] ######## Epoch (TEST)12 ########
[INFO: 2022-10-23 11:18:41,657] {'Bleu_1': 0.8153618906930349, 'Bleu_2': 0.7384652280010711, 'Bleu_3': 0.6518995780907929, 'Bleu_4': 0.5702546507560279, 'METEOR': 0.39701361404616126, 'ROUGE_L': 0.7073712419818962, 'CIDEr': 2.2240170411394766}
[INFO: 2022-10-23 11:19:48,868] ######## Epoch (VAL)13 ########
[INFO: 2022-10-23 11:19:48,869] {'Bleu_1': 0.7751060820356788, 'Bleu_2': 0.6868418854877981, 'Bleu_3': 0.612594156992719, 'Bleu_4': 0.5485960282104438, 'METEOR': 0.3711075186106859, 'ROUGE_L': 0.6927064765717558, 'CIDEr': 2.298565381609937}
[INFO: 2022-10-23 11:20:03,927] ######## Epoch (TEST)13 ########
[INFO: 2022-10-23 11:20:03,927] {'Bleu_1': 0.8172804532566328, 'Bleu_2': 0.7329981063409131, 'Bleu_3': 0.6445159578402961, 'Bleu_4': 0.5618412808902917, 'METEOR': 0.40023900809300705, 'ROUGE_L': 0.7162498111629946, 'CIDEr': 2.260048034832674}
[INFO: 2022-10-23 11:21:10,792] ######## Epoch (VAL)14 ########
[INFO: 2022-10-23 11:21:10,793] {'Bleu_1': 0.7758865248215945, 'Bleu_2': 0.6960455269750743, 'Bleu_3': 0.6258334246956169, 'Bleu_4': 0.5645158051765563, 'METEOR': 0.37874872201247334, 'ROUGE_L': 0.6973940205461507, 'CIDEr': 2.414168661217587}
[INFO: 2022-10-23 11:21:25,780] ######## Epoch (TEST)14 ########
[INFO: 2022-10-23 11:21:25,781] {'Bleu_1': 0.8163841807898073, 'Bleu_2': 0.7357482658123954, 'Bleu_3': 0.6468588130641564, 'Bleu_4': 0.561417347824728, 'METEOR': 0.40098599157406456, 'ROUGE_L': 0.7128169763105109, 'CIDEr': 2.257807416974766}
[INFO: 2022-10-23 11:22:33,168] ######## Epoch (VAL)15 ########
[INFO: 2022-10-23 11:22:33,168] {'Bleu_1': 0.7805907172984802, 'Bleu_2': 0.7034856956493649, 'Bleu_3': 0.6344206598924576, 'Bleu_4': 0.5706444954522683, 'METEOR': 0.3869999944037718, 'ROUGE_L': 0.7083808127917833, 'CIDEr': 2.4701873485874106}
[INFO: 2022-10-23 11:22:47,806] ######## Epoch (TEST)15 ########
[INFO: 2022-10-23 11:22:47,807] {'Bleu_1': 0.8131101813098841, 'Bleu_2': 0.7266978524398371, 'Bleu_3': 0.639759163550875, 'Bleu_4': 0.5579707634244291, 'METEOR': 0.4026364613805572, 'ROUGE_L': 0.7094261394142859, 'CIDEr': 2.305888204336942}
[INFO: 2022-10-23 11:23:55,075] ######## Epoch (VAL)16 ########
[INFO: 2022-10-23 11:23:55,076] {'Bleu_1': 0.7867231638406967, 'Bleu_2': 0.7087259565786252, 'Bleu_3': 0.6400262946135201, 'Bleu_4': 0.5752270017272194, 'METEOR': 0.3985009209001329, 'ROUGE_L': 0.715045240337416, 'CIDEr': 2.4693854866900655}
[INFO: 2022-10-23 11:24:09,881] ######## Epoch (TEST)16 ########
[INFO: 2022-10-23 11:24:09,881] {'Bleu_1': 0.821378340364527, 'Bleu_2': 0.7354434092453742, 'Bleu_3': 0.647765152970607, 'Bleu_4': 0.5668617539952849, 'METEOR': 0.41920730791622374, 'ROUGE_L': 0.7392336974527778, 'CIDEr': 2.380475690533379}
[INFO: 2022-10-23 11:25:17,142] ######## Epoch (VAL)17 ########
[INFO: 2022-10-23 11:25:17,143] {'Bleu_1': 0.7754532775442462, 'Bleu_2': 0.692891433815931, 'Bleu_3': 0.6218335299837642, 'Bleu_4': 0.5561207277159282, 'METEOR': 0.3920290644168199, 'ROUGE_L': 0.7159801287886565, 'CIDEr': 2.481488195272074}
[INFO: 2022-10-23 11:25:32,060] ######## Epoch (TEST)17 ########
[INFO: 2022-10-23 11:25:32,061] {'Bleu_1': 0.82768361581804, 'Bleu_2': 0.7459611663556334, 'Bleu_3': 0.6615365075288099, 'Bleu_4': 0.5836244681716776, 'METEOR': 0.4214377507691185, 'ROUGE_L': 0.7444451189519841, 'CIDEr': 2.504500431309416}
[INFO: 2022-10-23 11:26:39,142] ######## Epoch (VAL)18 ########
[INFO: 2022-10-23 11:26:39,142] {'Bleu_1': 0.7860139860128867, 'Bleu_2': 0.7088544944162015, 'Bleu_3': 0.6362218535189399, 'Bleu_4': 0.5707991745651837, 'METEOR': 0.3967003293984697, 'ROUGE_L': 0.7245413212198268, 'CIDEr': 2.4637534686218574}
[INFO: 2022-10-23 11:26:54,009] ######## Epoch (TEST)18 ########
[INFO: 2022-10-23 11:26:54,009] {'Bleu_1': 0.8230337078640126, 'Bleu_2': 0.7432795722715587, 'Bleu_3': 0.6570420835463583, 'Bleu_4': 0.5761504333449111, 'METEOR': 0.42191197327753566, 'ROUGE_L': 0.7489270820482103, 'CIDEr': 2.51562184784188}
[INFO: 2022-10-23 11:28:01,912] ######## Epoch (VAL)19 ########
[INFO: 2022-10-23 11:28:01,912] {'Bleu_1': 0.7896995708143209, 'Bleu_2': 0.7081074128583686, 'Bleu_3': 0.6330683198030627, 'Bleu_4': 0.5637475680697867, 'METEOR': 0.3952026190528675, 'ROUGE_L': 0.7118213206419279, 'CIDEr': 2.3816981179447385}
[INFO: 2022-10-23 11:28:16,849] ######## Epoch (TEST)19 ########
[INFO: 2022-10-23 11:28:16,850] {'Bleu_1': 0.8342696629201766, 'Bleu_2': 0.7517374987881139, 'Bleu_3': 0.6677367400307518, 'Bleu_4': 0.590023642269168, 'METEOR': 0.4309008976838827, 'ROUGE_L': 0.7600420070510168, 'CIDEr': 2.4601450371544438}
[INFO: 2022-10-23 11:29:24,529] ######## Epoch (VAL)20 ########
[INFO: 2022-10-23 11:29:24,530] {'Bleu_1': 0.7113284869590629, 'Bleu_2': 0.6527854802698605, 'Bleu_3': 0.6014668085696273, 'Bleu_4': 0.5537236073938421, 'METEOR': 0.38159614417171484, 'ROUGE_L': 0.7180664966812981, 'CIDEr': 2.3805771157503264}
[INFO: 2022-10-23 11:29:39,439] ######## Epoch (TEST)20 ########
[INFO: 2022-10-23 11:29:39,439] {'Bleu_1': 0.7891920831768766, 'Bleu_2': 0.7329237747815314, 'Bleu_3': 0.6718499239226635, 'Bleu_4': 0.6103669295493378, 'METEOR': 0.42604418131263055, 'ROUGE_L': 0.7635004473704774, 'CIDEr': 2.464957470579254}
[INFO: 2022-10-25 15:31:16,474] Training with config:
[INFO: 2022-10-25 15:31:16,493] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mssydney/sent/sydney_train_input.pkl',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 8,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mssydney/sent/sydney_train_target.pkl',
                 'TEST_4W_ID': './mscoco/misc/ids2path_json/coco_test4w_ids2path.json',
                 'TEST_ATT_FEATS': './mssydney/feature/Sydney',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mssydney/misc/ids2path_json/sydney_val_ids2path.json',
                 'TRAIN_ATT_FEATS': './mssydney/feature/Sydney',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mssydney/misc/ids2path_json/sydney_train_ids2path.json',
                 'VAL_ATT_FEATS': './mssydney/feature/Sydney',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mssydney/misc/ids2path_json/sydney_test_ids2path.json'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 5,
               'CAP_KEY': 'caption',
               'COCO_PATH': './coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mssydney/misc/val_sydney.json',
               'VAL_ANNFILE': './mssydney/misc/test_sydney.json',
               'VOCAB': './mssydney/txt/Sydney_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'CrossEntropy'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 1536,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 512,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 512,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [64, 32, 64],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 3,
                        'DIM': 512,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [64, 32, 64],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.1,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 3,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.1,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.1,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 1536,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 512,
           'SEQ_LEN': 24,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'PureT',
           'VOCAB_SIZE': 181,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 512,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'MAX_LEN': 'MAX_LEN',
           'MULCLASS': 'MULCLASS',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments_PureT/PureT_XE_Sydney/',
 'SCORER': {'CIDER_CACHED': './mssydney/misc/sydney_train_cider.pkl',
            'GT_PATH': './mssydney/misc/sydney_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1234.0,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 0.0005,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 512,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Noam',
                          'WARMUP': 10000},
            'MAX_EPOCH': 20,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2022-10-25 15:35:58,399] Training with config:
[INFO: 2022-10-25 15:35:58,414] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mssydney/sent/sydney_train_input.pkl',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 8,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mssydney/sent/sydney_train_target.pkl',
                 'TEST_4W_ID': './mscoco/misc/ids2path_json/coco_test4w_ids2path.json',
                 'TEST_ATT_FEATS': './mssydney/feature/Sydney',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mssydney/misc/ids2path_json/sydney_val_ids2path.json',
                 'TRAIN_ATT_FEATS': './mssydney/feature/Sydney',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mssydney/misc/ids2path_json/sydney_train_ids2path.json',
                 'VAL_ATT_FEATS': './mssydney/feature/Sydney',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mssydney/misc/ids2path_json/sydney_test_ids2path.json'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 5,
               'CAP_KEY': 'caption',
               'COCO_PATH': './coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mssydney/misc/val_sydney.json',
               'VAL_ANNFILE': './mssydney/misc/test_sydney.json',
               'VOCAB': './mssydney/txt/Sydney_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'CrossEntropy'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 1536,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 512,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 512,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [64, 32, 64],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 3,
                        'DIM': 512,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [64, 32, 64],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.1,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 3,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.1,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.1,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 1536,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 512,
           'SEQ_LEN': 24,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'PureT',
           'VOCAB_SIZE': 181,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 512,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'MAX_LEN': 'MAX_LEN',
           'MULCLASS': 'MULCLASS',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments_PureT/PureT_XE_Sydney/',
 'SCORER': {'CIDER_CACHED': './mssydney/misc/sydney_train_cider.pkl',
            'GT_PATH': './mssydney/misc/sydney_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1234.0,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 0.0005,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 512,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Noam',
                          'WARMUP': 10000},
            'MAX_EPOCH': 20,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2022-10-25 21:19:14,704] Training with config:
[INFO: 2022-10-25 21:19:14,706] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mssydney/sent/sydney_train_input.pkl',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 8,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mssydney/sent/sydney_train_target.pkl',
                 'TEST_4W_ID': './mscoco/misc/ids2path_json/coco_test4w_ids2path.json',
                 'TEST_ATT_FEATS': './mssydney/feature/Sydney',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mssydney/misc/ids2path_json/sydney_val_ids2path.json',
                 'TRAIN_ATT_FEATS': './mssydney/feature/Sydney',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mssydney/misc/ids2path_json/sydney_train_ids2path.json',
                 'VAL_ATT_FEATS': './mssydney/feature/Sydney',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mssydney/misc/ids2path_json/sydney_test_ids2path.json'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 5,
               'CAP_KEY': 'caption',
               'COCO_PATH': './coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mssydney/misc/val_sydney.json',
               'VAL_ANNFILE': './mssydney/misc/test_sydney.json',
               'VOCAB': './mssydney/txt/Sydney_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'CrossEntropy'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 1536,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 512,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 512,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [64, 32, 64],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 3,
                        'DIM': 512,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [64, 32, 64],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.1,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 3,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.1,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.1,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 1536,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 512,
           'SEQ_LEN': 24,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'PureT',
           'VOCAB_SIZE': 181,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 512,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'MAX_LEN': 'MAX_LEN',
           'MULCLASS': 'MULCLASS',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments_PureT/PureT_XE_Sydney/',
 'SCORER': {'CIDER_CACHED': './mssydney/misc/sydney_train_cider.pkl',
            'GT_PATH': './mssydney/misc/sydney_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1234.0,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 0.0005,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 512,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Noam',
                          'WARMUP': 10000},
            'MAX_EPOCH': 20,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2022-10-25 21:20:26,906] ######## Epoch (VAL)1 ########
[INFO: 2022-10-25 21:20:26,907] {'Bleu_1': 0.13188405797082337, 'Bleu_2': 0.014434252419975296, 'Bleu_3': 7.120944366728229e-08, 'Bleu_4': 1.6088146165746194e-10, 'METEOR': 0.041438893546709404, 'ROUGE_L': 0.1331108232246172, 'CIDEr': 0.0366185319444846}
[INFO: 2022-10-25 21:20:42,893] ######## Epoch (TEST)1 ########
[INFO: 2022-10-25 21:20:42,897] {'Bleu_1': 0.17668383778009655, 'Bleu_2': 0.01712109311207486, 'Bleu_3': 8.140983284261203e-08, 'Bleu_4': 1.8067030599598956e-10, 'METEOR': 0.05736867575222112, 'ROUGE_L': 0.16468028583527372, 'CIDEr': 0.05063483673218963}
[INFO: 2022-10-25 21:21:48,030] ######## Epoch (VAL)2 ########
[INFO: 2022-10-25 21:21:48,031] {'Bleu_1': 0.0, 'Bleu_2': 0.0, 'Bleu_3': 0.0, 'Bleu_4': 0.0, 'METEOR': 0.0, 'ROUGE_L': 0.0, 'CIDEr': 0.0}
[INFO: 2022-10-25 21:22:03,425] ######## Epoch (TEST)2 ########
[INFO: 2022-10-25 21:22:03,426] {'Bleu_1': 0.0, 'Bleu_2': 0.0, 'Bleu_3': 0.0, 'Bleu_4': 0.0, 'METEOR': 0.0, 'ROUGE_L': 0.0, 'CIDEr': 0.0}
[INFO: 2022-10-25 21:23:10,369] ######## Epoch (VAL)3 ########
[INFO: 2022-10-25 21:23:10,370] {'Bleu_1': 0.00011459481807639542, 'Bleu_2': 0.00011892066281504056, 'Bleu_3': 0.00012039859944685885, 'Bleu_4': 3.8309236087308185e-06, 'METEOR': 0.021696882199729033, 'ROUGE_L': 0.14521400747007313, 'CIDEr': 0.05375122835301326}
[INFO: 2022-10-25 21:23:26,004] ######## Epoch (TEST)3 ########
[INFO: 2022-10-25 21:23:26,004] {'Bleu_1': 2.350139119536022e-05, 'Bleu_2': 2.5952944946115443e-08, 'Bleu_3': 2.682569629249518e-09, 'Bleu_4': 8.624485222266076e-10, 'METEOR': 0.013812852690979536, 'ROUGE_L': 0.11046794269815322, 'CIDEr': 0.01211358238800839}
[INFO: 2022-10-25 21:24:32,741] ######## Epoch (VAL)4 ########
[INFO: 2022-10-25 21:24:32,742] {'Bleu_1': 0.07070776673382818, 'Bleu_2': 0.06296231568864903, 'Bleu_3': 0.05983170065006013, 'Bleu_4': 0.0021134874649301155, 'METEOR': 0.1051933538666661, 'ROUGE_L': 0.31303598220048734, 'CIDEr': 0.2443928061896627}
[INFO: 2022-10-25 21:24:48,153] ######## Epoch (TEST)4 ########
[INFO: 2022-10-25 21:24:48,153] {'Bleu_1': 0.06032623940775732, 'Bleu_2': 0.05341841012276455, 'Bleu_3': 0.05036039464631471, 'Bleu_4': 0.0018117317327613841, 'METEOR': 0.09873740882622269, 'ROUGE_L': 0.2813730605638528, 'CIDEr': 0.22342719246663845}
[INFO: 2022-10-25 21:25:55,194] ######## Epoch (VAL)5 ########
[INFO: 2022-10-25 21:25:55,195] {'Bleu_1': 0.14045628355457118, 'Bleu_2': 0.1268928485915957, 'Bleu_3': 0.12019121690467915, 'Bleu_4': 0.11453601648594233, 'METEOR': 0.1290450781886293, 'ROUGE_L': 0.374649143938611, 'CIDEr': 0.7311901217992332}
[INFO: 2022-10-25 21:26:10,728] ######## Epoch (TEST)5 ########
[INFO: 2022-10-25 21:26:10,729] {'Bleu_1': 0.12637959387403333, 'Bleu_2': 0.1132354826275831, 'Bleu_3': 0.10497963564654156, 'Bleu_4': 0.09527199316778003, 'METEOR': 0.12285253190867289, 'ROUGE_L': 0.34772499865497253, 'CIDEr': 0.6254078387961428}
[INFO: 2022-10-25 21:27:18,127] ######## Epoch (VAL)6 ########
[INFO: 2022-10-25 21:27:18,128] {'Bleu_1': 0.3693937041957748, 'Bleu_2': 0.329837714878422, 'Bleu_3': 0.29593545503265617, 'Bleu_4': 0.26496328727219, 'METEOR': 0.2145992875313379, 'ROUGE_L': 0.46607851744255313, 'CIDEr': 1.2122823610607254}
[INFO: 2022-10-25 21:27:33,822] ######## Epoch (TEST)6 ########
[INFO: 2022-10-25 21:27:33,823] {'Bleu_1': 0.3437653993397996, 'Bleu_2': 0.3248413863232885, 'Bleu_3': 0.30085861977938466, 'Bleu_4': 0.26490043502969085, 'METEOR': 0.21743521153214246, 'ROUGE_L': 0.4599186112971011, 'CIDEr': 1.1149506905926203}
[INFO: 2022-10-25 21:28:41,155] ######## Epoch (VAL)7 ########
[INFO: 2022-10-25 21:28:41,156] {'Bleu_1': 0.6173826720475565, 'Bleu_2': 0.5532465738460102, 'Bleu_3': 0.4930581587117013, 'Bleu_4': 0.4352241495269594, 'METEOR': 0.29920198581298085, 'ROUGE_L': 0.6131820641854917, 'CIDEr': 1.5807753564178744}
[INFO: 2022-10-25 21:28:56,584] ######## Epoch (TEST)7 ########
[INFO: 2022-10-25 21:28:56,585] {'Bleu_1': 0.6618116820639712, 'Bleu_2': 0.599842147079428, 'Bleu_3': 0.5237213557172032, 'Bleu_4': 0.43728590884029367, 'METEOR': 0.3038380072135708, 'ROUGE_L': 0.6155182527725116, 'CIDEr': 1.5078106720178281}
[INFO: 2022-10-25 21:30:04,033] ######## Epoch (VAL)8 ########
[INFO: 2022-10-25 21:30:04,034] {'Bleu_1': 0.6240520542629575, 'Bleu_2': 0.5580174655632523, 'Bleu_3': 0.49453244111451466, 'Bleu_4': 0.42771759623803945, 'METEOR': 0.31114317176380146, 'ROUGE_L': 0.6345778763571412, 'CIDEr': 1.6174944874748365}
[INFO: 2022-10-25 21:30:19,990] ######## Epoch (TEST)8 ########
[INFO: 2022-10-25 21:30:19,990] {'Bleu_1': 0.640193896653505, 'Bleu_2': 0.5794343220194517, 'Bleu_3': 0.519581965084051, 'Bleu_4': 0.45290277207914, 'METEOR': 0.3300866666816616, 'ROUGE_L': 0.6646491807578976, 'CIDEr': 1.7825682021909417}
[INFO: 2022-10-25 21:31:27,401] ######## Epoch (VAL)9 ########
[INFO: 2022-10-25 21:31:27,401] {'Bleu_1': 0.6425933853398991, 'Bleu_2': 0.5821155998740059, 'Bleu_3': 0.5231277305978186, 'Bleu_4': 0.45993307126821853, 'METEOR': 0.32608701316452376, 'ROUGE_L': 0.6625331458350617, 'CIDEr': 1.7342064921421398}
[INFO: 2022-10-25 21:31:43,080] ######## Epoch (TEST)9 ########
[INFO: 2022-10-25 21:31:43,080] {'Bleu_1': 0.6118787032770963, 'Bleu_2': 0.5515274148140983, 'Bleu_3': 0.4948326058578302, 'Bleu_4': 0.435467075533181, 'METEOR': 0.32186514219456236, 'ROUGE_L': 0.6614599711411931, 'CIDEr': 1.7317988650322254}
[INFO: 2022-10-25 21:32:49,966] ######## Epoch (VAL)10 ########
[INFO: 2022-10-25 21:32:49,967] {'Bleu_1': 0.7271087727382592, 'Bleu_2': 0.6459669326800688, 'Bleu_3': 0.5740008542578737, 'Bleu_4': 0.5033734694334002, 'METEOR': 0.35106048276239205, 'ROUGE_L': 0.6407542151061942, 'CIDEr': 1.9393080741639432}
[INFO: 2022-10-25 21:33:05,648] ######## Epoch (TEST)10 ########
[INFO: 2022-10-25 21:33:05,648] {'Bleu_1': 0.7788047317129407, 'Bleu_2': 0.7161372285768633, 'Bleu_3': 0.646920186139877, 'Bleu_4': 0.5754757032684081, 'METEOR': 0.3741358242836216, 'ROUGE_L': 0.69681332487651, 'CIDEr': 2.1158481728976866}
[INFO: 2022-10-25 21:34:13,047] ######## Epoch (VAL)11 ########
[INFO: 2022-10-25 21:34:13,047] {'Bleu_1': 0.7868676630302429, 'Bleu_2': 0.7102271666704355, 'Bleu_3': 0.6391378518810895, 'Bleu_4': 0.5692200955120743, 'METEOR': 0.3771263794325279, 'ROUGE_L': 0.6957180438110417, 'CIDEr': 2.212705686463411}
[INFO: 2022-10-25 21:34:28,569] ######## Epoch (TEST)11 ########
[INFO: 2022-10-25 21:34:28,569] {'Bleu_1': 0.7683177512819417, 'Bleu_2': 0.6904561804294432, 'Bleu_3': 0.6154342635563672, 'Bleu_4': 0.5493028736662697, 'METEOR': 0.3677455890145623, 'ROUGE_L': 0.6787122342945094, 'CIDEr': 2.095053008013696}
[INFO: 2022-10-25 21:35:36,078] ######## Epoch (VAL)12 ########
[INFO: 2022-10-25 21:35:36,079] {'Bleu_1': 0.7743582182916544, 'Bleu_2': 0.698119678940315, 'Bleu_3': 0.6280856151374937, 'Bleu_4': 0.5603263262044016, 'METEOR': 0.36834105816651386, 'ROUGE_L': 0.6915221505084832, 'CIDEr': 2.158136738637592}
[INFO: 2022-10-25 21:35:51,159] ######## Epoch (TEST)12 ########
[INFO: 2022-10-25 21:35:51,159] {'Bleu_1': 0.81480671937009, 'Bleu_2': 0.7305742998891172, 'Bleu_3': 0.6459339246103621, 'Bleu_4': 0.5671191842097406, 'METEOR': 0.39322627468103294, 'ROUGE_L': 0.710589330960143, 'CIDEr': 2.180761637050276}
[INFO: 2022-10-25 21:36:58,334] ######## Epoch (VAL)13 ########
[INFO: 2022-10-25 21:36:58,334] {'Bleu_1': 0.7498459238654447, 'Bleu_2': 0.6685075257973688, 'Bleu_3': 0.5970143738089814, 'Bleu_4': 0.530158519281295, 'METEOR': 0.3660930774811366, 'ROUGE_L': 0.6770589831642598, 'CIDEr': 2.2005801192242167}
[INFO: 2022-10-25 21:37:13,900] ######## Epoch (TEST)13 ########
[INFO: 2022-10-25 21:37:13,900] {'Bleu_1': 0.8165938864616935, 'Bleu_2': 0.7384181868170662, 'Bleu_3': 0.6555365215206586, 'Bleu_4': 0.574228343966449, 'METEOR': 0.40604916375330063, 'ROUGE_L': 0.7213948662405659, 'CIDEr': 2.2801674807780703}
[INFO: 2022-10-25 21:38:21,438] ######## Epoch (VAL)14 ########
[INFO: 2022-10-25 21:38:21,438] {'Bleu_1': 0.7875426176503306, 'Bleu_2': 0.7105198948996488, 'Bleu_3': 0.6413277552884077, 'Bleu_4': 0.57687928822259, 'METEOR': 0.3822156491190223, 'ROUGE_L': 0.7118085443603681, 'CIDEr': 2.3404753442458506}
[INFO: 2022-10-25 21:38:37,132] ######## Epoch (TEST)14 ########
[INFO: 2022-10-25 21:38:37,133] {'Bleu_1': 0.8170028818432031, 'Bleu_2': 0.7318991855518399, 'Bleu_3': 0.6453434340458525, 'Bleu_4': 0.5627205408437908, 'METEOR': 0.40376157167175014, 'ROUGE_L': 0.7262929385742385, 'CIDEr': 2.280942415150192}
[INFO: 2022-10-25 21:39:44,010] ######## Epoch (VAL)15 ########
[INFO: 2022-10-25 21:39:44,010] {'Bleu_1': 0.7784337813970899, 'Bleu_2': 0.6978284246008374, 'Bleu_3': 0.6251851512600791, 'Bleu_4': 0.5583910654449383, 'METEOR': 0.3822274432273442, 'ROUGE_L': 0.7088489971252938, 'CIDEr': 2.3834344841925015}
[INFO: 2022-10-25 21:39:59,620] ######## Epoch (TEST)15 ########
[INFO: 2022-10-25 21:39:59,620] {'Bleu_1': 0.8238719068401399, 'Bleu_2': 0.7408180166602173, 'Bleu_3': 0.6554680508114555, 'Bleu_4': 0.5749069697737169, 'METEOR': 0.4103841937674521, 'ROUGE_L': 0.7272146125871345, 'CIDEr': 2.2867546420871547}
[INFO: 2022-10-25 21:41:06,209] ######## Epoch (VAL)16 ########
[INFO: 2022-10-25 21:41:06,210] {'Bleu_1': 0.7835187874688088, 'Bleu_2': 0.7114309997173818, 'Bleu_3': 0.646339116742337, 'Bleu_4': 0.5868652603390913, 'METEOR': 0.39750163636709523, 'ROUGE_L': 0.7313856750941408, 'CIDEr': 2.529038552530125}
[INFO: 2022-10-25 21:41:21,615] ######## Epoch (TEST)16 ########
[INFO: 2022-10-25 21:41:21,615] {'Bleu_1': 0.8421052631567284, 'Bleu_2': 0.7720547159770796, 'Bleu_3': 0.7015256435701391, 'Bleu_4': 0.6343381106829284, 'METEOR': 0.4454251638684613, 'ROUGE_L': 0.7818974836884741, 'CIDEr': 2.8567199361273765}
[INFO: 2022-10-25 21:42:28,926] ######## Epoch (VAL)17 ########
[INFO: 2022-10-25 21:42:28,926] {'Bleu_1': 0.807902310526395, 'Bleu_2': 0.7269385811215657, 'Bleu_3': 0.6587602008352902, 'Bleu_4': 0.5976598872429104, 'METEOR': 0.40639915855869446, 'ROUGE_L': 0.7394296139529065, 'CIDEr': 2.6052321705281436}
[INFO: 2022-10-25 21:42:44,683] ######## Epoch (TEST)17 ########
[INFO: 2022-10-25 21:42:44,684] {'Bleu_1': 0.8328690807787843, 'Bleu_2': 0.7468399423912779, 'Bleu_3': 0.6597915644423946, 'Bleu_4': 0.5784146835196315, 'METEOR': 0.42899685636841955, 'ROUGE_L': 0.7669723271978578, 'CIDEr': 2.4754980126522357}
[INFO: 2022-10-25 21:43:52,914] ######## Epoch (VAL)18 ########
[INFO: 2022-10-25 21:43:52,915] {'Bleu_1': 0.7346031663480072, 'Bleu_2': 0.6380909699844025, 'Bleu_3': 0.5682638655906986, 'Bleu_4': 0.5050056562619334, 'METEOR': 0.38282292312101923, 'ROUGE_L': 0.6776232202384592, 'CIDEr': 2.1958767121275646}
[INFO: 2022-10-25 21:44:08,502] ######## Epoch (TEST)18 ########
[INFO: 2022-10-25 21:44:08,502] {'Bleu_1': 0.7747875354096675, 'Bleu_2': 0.6784755073641173, 'Bleu_3': 0.5928013712192916, 'Bleu_4': 0.5079444529426493, 'METEOR': 0.4110501082279843, 'ROUGE_L': 0.7182689687381713, 'CIDEr': 2.256724378092196}
[INFO: 2022-10-25 21:45:16,182] ######## Epoch (VAL)19 ########
[INFO: 2022-10-25 21:45:16,183] {'Bleu_1': 0.7713693535388677, 'Bleu_2': 0.6874057687851618, 'Bleu_3': 0.6174446217121193, 'Bleu_4': 0.5519254204294248, 'METEOR': 0.38160895385832366, 'ROUGE_L': 0.7030403733139914, 'CIDEr': 2.3404805622689193}
[INFO: 2022-10-25 21:45:31,497] ######## Epoch (TEST)19 ########
[INFO: 2022-10-25 21:45:31,498] {'Bleu_1': 0.8382147838203093, 'Bleu_2': 0.7599112557541944, 'Bleu_3': 0.6798289870616415, 'Bleu_4': 0.6039927984012327, 'METEOR': 0.4379178395411627, 'ROUGE_L': 0.7654192317683786, 'CIDEr': 2.6490038752828116}
[INFO: 2022-10-25 21:46:38,655] ######## Epoch (VAL)20 ########
[INFO: 2022-10-25 21:46:38,655] {'Bleu_1': 0.7257688128751815, 'Bleu_2': 0.6338396322892822, 'Bleu_3': 0.5621820825051165, 'Bleu_4': 0.4959102084349404, 'METEOR': 0.38121354899813203, 'ROUGE_L': 0.6679619868370243, 'CIDEr': 2.1682346580469507}
[INFO: 2022-10-25 21:46:53,909] ######## Epoch (TEST)20 ########
[INFO: 2022-10-25 21:46:53,910] {'Bleu_1': 0.7804748534114435, 'Bleu_2': 0.6859138691976698, 'Bleu_3': 0.5981638699573181, 'Bleu_4': 0.5130601481077366, 'METEOR': 0.40052131842669597, 'ROUGE_L': 0.7081792579785509, 'CIDEr': 2.3141848046565294}
[INFO: 2022-10-25 21:53:41,461] Training with config:
[INFO: 2022-10-25 21:53:41,462] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mssydney/sent/sydney_train_input.pkl',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 8,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mssydney/sent/sydney_train_target.pkl',
                 'TEST_4W_ID': './mscoco/misc/ids2path_json/coco_test4w_ids2path.json',
                 'TEST_ATT_FEATS': './mssydney/feature/Sydney',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mssydney/misc/ids2path_json/sydney_val_ids2path.json',
                 'TRAIN_ATT_FEATS': './mssydney/feature/Sydney',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mssydney/misc/ids2path_json/sydney_train_ids2path.json',
                 'VAL_ATT_FEATS': './mssydney/feature/Sydney',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mssydney/misc/ids2path_json/sydney_test_ids2path.json'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 5,
               'CAP_KEY': 'caption',
               'COCO_PATH': './coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mssydney/misc/val_sydney.json',
               'VAL_ANNFILE': './mssydney/misc/test_sydney.json',
               'VOCAB': './mssydney/txt/Sydney_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'CrossEntropy'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 1536,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 512,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 512,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [64, 32, 64],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 3,
                        'DIM': 512,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [64, 32, 64],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.1,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 3,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.1,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.1,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 1536,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 512,
           'SEQ_LEN': 24,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'PureT',
           'VOCAB_SIZE': 181,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 512,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'MAX_LEN': 'MAX_LEN',
           'MULCLASS': 'MULCLASS',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments_PureT/PureT_XE_Sydney/',
 'SCORER': {'CIDER_CACHED': './mssydney/misc/sydney_train_cider.pkl',
            'GT_PATH': './mssydney/misc/sydney_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1234.0,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 0.0005,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 512,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Noam',
                          'WARMUP': 10000},
            'MAX_EPOCH': 20,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2022-10-25 21:54:25,516] Training with config:
[INFO: 2022-10-25 21:54:25,518] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mssydney/sent/sydney_train_input.pkl',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 8,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mssydney/sent/sydney_train_target.pkl',
                 'TEST_4W_ID': './mscoco/misc/ids2path_json/coco_test4w_ids2path.json',
                 'TEST_ATT_FEATS': './mssydney/feature/Sydney',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mssydney/misc/ids2path_json/sydney_val_ids2path.json',
                 'TRAIN_ATT_FEATS': './mssydney/feature/Sydney',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mssydney/misc/ids2path_json/sydney_train_ids2path.json',
                 'VAL_ATT_FEATS': './mssydney/feature/Sydney',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mssydney/misc/ids2path_json/sydney_test_ids2path.json'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 5,
               'CAP_KEY': 'caption',
               'COCO_PATH': './coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mssydney/misc/val_sydney.json',
               'VAL_ANNFILE': './mssydney/misc/test_sydney.json',
               'VOCAB': './mssydney/txt/Sydney_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'CrossEntropy'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 1536,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 512,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 512,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [64, 32, 64],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 3,
                        'DIM': 512,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [64, 32, 64],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.1,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 3,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.1,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.1,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 1536,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 512,
           'SEQ_LEN': 24,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'PureT',
           'VOCAB_SIZE': 181,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 512,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'MAX_LEN': 'MAX_LEN',
           'MULCLASS': 'MULCLASS',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments_PureT/PureT_XE_Sydney/',
 'SCORER': {'CIDER_CACHED': './mssydney/misc/sydney_train_cider.pkl',
            'GT_PATH': './mssydney/misc/sydney_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1234.0,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 0.0005,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 512,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Noam',
                          'WARMUP': 10000},
            'MAX_EPOCH': 20,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2022-10-25 21:55:39,567] ######## Epoch (VAL)1 ########
[INFO: 2022-10-25 21:55:39,568] {'Bleu_1': 0.15929799212753631, 'Bleu_2': 0.07163419265820647, 'Bleu_3': 2.1221916979049875e-07, 'Bleu_4': 3.7223727256810385e-10, 'METEOR': 0.06121871455981456, 'ROUGE_L': 0.15990528456859268, 'CIDEr': 0.06461513853961086}
[INFO: 2022-10-25 21:55:54,525] ######## Epoch (TEST)1 ########
[INFO: 2022-10-25 21:55:54,525] {'Bleu_1': 0.16087909320640528, 'Bleu_2': 0.07611935525929062, 'Bleu_3': 2.1722489458703126e-07, 'Bleu_4': 3.720613376888697e-10, 'METEOR': 0.051681314210905695, 'ROUGE_L': 0.13225117125757405, 'CIDEr': 0.03582465912870381}
[INFO: 2022-10-25 21:57:02,658] ######## Epoch (VAL)2 ########
[INFO: 2022-10-25 21:57:02,658] {'Bleu_1': 5.498492603306565e-05, 'Bleu_2': 5.6073842157594024e-05, 'Bleu_3': 5.644158545835759e-07, 'Bleu_4': 5.662636052249671e-08, 'METEOR': 0.03784235198185765, 'ROUGE_L': 0.1336566015572135, 'CIDEr': 0.0468494910785998}
[INFO: 2022-10-25 21:57:17,637] ######## Epoch (TEST)2 ########
[INFO: 2022-10-25 21:57:17,638] {'Bleu_1': 6.573998327363591e-05, 'Bleu_2': 6.635727365299969e-05, 'Bleu_3': 6.656432249944072e-07, 'Bleu_4': 6.666808906053272e-08, 'METEOR': 0.03795169810534038, 'ROUGE_L': 0.12906766753382465, 'CIDEr': 0.039297681838680605}
[INFO: 2022-10-25 21:58:27,582] ######## Epoch (VAL)3 ########
[INFO: 2022-10-25 21:58:27,583] {'Bleu_1': 0.06709645606852607, 'Bleu_2': 0.059120480578972706, 'Bleu_3': 0.05584742274556067, 'Bleu_4': 5.69537387866203e-06, 'METEOR': 0.11329082126420645, 'ROUGE_L': 0.33357180804716247, 'CIDEr': 0.3372417963279944}
[INFO: 2022-10-25 21:58:42,772] ######## Epoch (TEST)3 ########
[INFO: 2022-10-25 21:58:42,772] {'Bleu_1': 0.05493055275727486, 'Bleu_2': 0.04716783072240939, 'Bleu_3': 0.0456422903497837, 'Bleu_4': 5.414714065694861e-06, 'METEOR': 0.09864405735921025, 'ROUGE_L': 0.28576079277124, 'CIDEr': 0.2681859971095105}
[INFO: 2022-10-25 21:59:52,956] ######## Epoch (VAL)4 ########
[INFO: 2022-10-25 21:59:52,956] {'Bleu_1': 0.12940863818460746, 'Bleu_2': 0.1204585337469801, 'Bleu_3': 0.12023439286263198, 'Bleu_4': 0.12973625285393353, 'METEOR': 0.1484765479621056, 'ROUGE_L': 0.37469782120855644, 'CIDEr': 0.7938381628018649}
[INFO: 2022-10-25 22:00:08,307] ######## Epoch (TEST)4 ########
[INFO: 2022-10-25 22:00:08,308] {'Bleu_1': 0.1132383806840927, 'Bleu_2': 0.10524216885444118, 'Bleu_3': 0.10502782813906401, 'Bleu_4': 0.11369086748161801, 'METEOR': 0.13951724563345386, 'ROUGE_L': 0.34156732670957934, 'CIDEr': 0.7034875837440815}
[INFO: 2022-10-25 22:01:18,244] ######## Epoch (VAL)5 ########
[INFO: 2022-10-25 22:01:18,244] {'Bleu_1': 0.16234810204527805, 'Bleu_2': 0.15211841453435745, 'Bleu_3': 0.15137845033234712, 'Bleu_4': 0.157784523909056, 'METEOR': 0.16317024744673778, 'ROUGE_L': 0.3971285115364935, 'CIDEr': 0.9491155332869726}
[INFO: 2022-10-25 22:01:33,642] ######## Epoch (TEST)5 ########
[INFO: 2022-10-25 22:01:33,643] {'Bleu_1': 0.18942739450788734, 'Bleu_2': 0.17136191863308947, 'Bleu_3': 0.16227766249579495, 'Bleu_4': 0.1549311934089259, 'METEOR': 0.16293127172818941, 'ROUGE_L': 0.3875708686004079, 'CIDEr': 0.9048053885702407}
[INFO: 2022-10-25 22:02:43,192] ######## Epoch (VAL)6 ########
[INFO: 2022-10-25 22:02:43,193] {'Bleu_1': 0.47669538724750915, 'Bleu_2': 0.428955785187414, 'Bleu_3': 0.38111090362010946, 'Bleu_4': 0.3354544375027104, 'METEOR': 0.24678992173739245, 'ROUGE_L': 0.529168136190243, 'CIDEr': 1.3741601211496877}
[INFO: 2022-10-25 22:02:58,624] ######## Epoch (TEST)6 ########
[INFO: 2022-10-25 22:02:58,624] {'Bleu_1': 0.4575887659699269, 'Bleu_2': 0.41477960396916064, 'Bleu_3': 0.3707764081550077, 'Bleu_4': 0.32221325257807704, 'METEOR': 0.24077040801047808, 'ROUGE_L': 0.530905436893619, 'CIDEr': 1.2865106531856312}
[INFO: 2022-10-25 22:04:08,321] ######## Epoch (VAL)7 ########
[INFO: 2022-10-25 22:04:08,322] {'Bleu_1': 0.6064468608851369, 'Bleu_2': 0.5469864091647954, 'Bleu_3': 0.4898182096242188, 'Bleu_4': 0.4329685657327317, 'METEOR': 0.30724326492541454, 'ROUGE_L': 0.637489766342262, 'CIDEr': 1.6234925151018038}
[INFO: 2022-10-25 22:04:23,583] ######## Epoch (TEST)7 ########
[INFO: 2022-10-25 22:04:23,583] {'Bleu_1': 0.6470102393592125, 'Bleu_2': 0.5907116221554991, 'Bleu_3': 0.524068065480959, 'Bleu_4': 0.44761673465064256, 'METEOR': 0.31624866012943764, 'ROUGE_L': 0.6516397065600471, 'CIDEr': 1.6799017857522316}
[INFO: 2022-10-25 22:05:33,484] ######## Epoch (VAL)8 ########
[INFO: 2022-10-25 22:05:33,485] {'Bleu_1': 0.6087037823293604, 'Bleu_2': 0.5404470456022648, 'Bleu_3': 0.47260158165160604, 'Bleu_4': 0.40478320808126744, 'METEOR': 0.3040433007260771, 'ROUGE_L': 0.6269546718608354, 'CIDEr': 1.5445290431764798}
[INFO: 2022-10-25 22:05:49,063] ######## Epoch (TEST)8 ########
[INFO: 2022-10-25 22:05:49,064] {'Bleu_1': 0.6750118287285873, 'Bleu_2': 0.6198496693595351, 'Bleu_3': 0.5548473829901117, 'Bleu_4': 0.4750327641165692, 'METEOR': 0.3347352615927607, 'ROUGE_L': 0.6671349591724669, 'CIDEr': 1.770563572889808}
[INFO: 2022-10-25 22:06:59,477] ######## Epoch (VAL)9 ########
[INFO: 2022-10-25 22:06:59,478] {'Bleu_1': 0.7264398016273482, 'Bleu_2': 0.6525910587515386, 'Bleu_3': 0.5762304038617906, 'Bleu_4': 0.5001231848240426, 'METEOR': 0.325091019956637, 'ROUGE_L': 0.6565200482129, 'CIDEr': 1.8809155166394844}
[INFO: 2022-10-25 22:07:15,097] ######## Epoch (TEST)9 ########
[INFO: 2022-10-25 22:07:15,098] {'Bleu_1': 0.7760944049022264, 'Bleu_2': 0.7094030656513715, 'Bleu_3': 0.6340018599778142, 'Bleu_4': 0.5560758106193133, 'METEOR': 0.3503196197492139, 'ROUGE_L': 0.6953326195890044, 'CIDEr': 2.0165980150570175}
[INFO: 2022-10-25 22:08:25,236] ######## Epoch (VAL)10 ########
[INFO: 2022-10-25 22:08:25,237] {'Bleu_1': 0.7482153843655073, 'Bleu_2': 0.6662694211312418, 'Bleu_3': 0.5911912906945306, 'Bleu_4': 0.519244138579643, 'METEOR': 0.34966475117283896, 'ROUGE_L': 0.65675619240369, 'CIDEr': 1.9870741885857925}
[INFO: 2022-10-25 22:08:40,451] ######## Epoch (TEST)10 ########
[INFO: 2022-10-25 22:08:40,452] {'Bleu_1': 0.796680350695305, 'Bleu_2': 0.7334130320057908, 'Bleu_3': 0.6603784114380008, 'Bleu_4': 0.5848096321519949, 'METEOR': 0.387188588525629, 'ROUGE_L': 0.7042734471560149, 'CIDEr': 2.214545971950911}
[INFO: 2022-10-25 22:09:51,361] ######## Epoch (VAL)11 ########
[INFO: 2022-10-25 22:09:51,361] {'Bleu_1': 0.7790164323464235, 'Bleu_2': 0.6960465403800812, 'Bleu_3': 0.6173656042760799, 'Bleu_4': 0.5392057955290154, 'METEOR': 0.3622004595365468, 'ROUGE_L': 0.6720537857494499, 'CIDEr': 2.0369830660635717}
[INFO: 2022-10-25 22:10:07,028] ######## Epoch (TEST)11 ########
[INFO: 2022-10-25 22:10:07,028] {'Bleu_1': 0.8161159350808374, 'Bleu_2': 0.7475010741761945, 'Bleu_3': 0.6725050914529693, 'Bleu_4': 0.5967926788680471, 'METEOR': 0.38261894861563905, 'ROUGE_L': 0.7057178168811377, 'CIDEr': 2.218343850659472}
[INFO: 2022-10-25 22:11:17,342] ######## Epoch (VAL)12 ########
[INFO: 2022-10-25 22:11:17,343] {'Bleu_1': 0.7575634642739447, 'Bleu_2': 0.6801984054494276, 'Bleu_3': 0.6070714368018112, 'Bleu_4': 0.5375460985949125, 'METEOR': 0.37043611213404626, 'ROUGE_L': 0.6877241459351177, 'CIDEr': 2.21091660270416}
[INFO: 2022-10-25 22:11:32,688] ######## Epoch (TEST)12 ########
[INFO: 2022-10-25 22:11:32,688] {'Bleu_1': 0.8150782361297083, 'Bleu_2': 0.7276571525701785, 'Bleu_3': 0.6380714760057205, 'Bleu_4': 0.5548523211533266, 'METEOR': 0.400893318859928, 'ROUGE_L': 0.7119578161180701, 'CIDEr': 2.2416286351915464}
[INFO: 2022-10-25 22:12:43,146] ######## Epoch (VAL)13 ########
[INFO: 2022-10-25 22:12:43,146] {'Bleu_1': 0.7651164172529319, 'Bleu_2': 0.6882207386419585, 'Bleu_3': 0.6150695935793231, 'Bleu_4': 0.5454283576460751, 'METEOR': 0.3735036311328134, 'ROUGE_L': 0.6957983410816574, 'CIDEr': 2.23642502661112}
[INFO: 2022-10-25 22:12:58,342] ######## Epoch (TEST)13 ########
[INFO: 2022-10-25 22:12:58,342] {'Bleu_1': 0.8170212765945858, 'Bleu_2': 0.7265285475966969, 'Bleu_3': 0.6374253119456033, 'Bleu_4': 0.5546241563210956, 'METEOR': 0.4004292273463119, 'ROUGE_L': 0.7189286472690222, 'CIDEr': 2.265873100527548}
[INFO: 2022-10-25 22:14:10,474] ######## Epoch (VAL)14 ########
[INFO: 2022-10-25 22:14:10,475] {'Bleu_1': 0.7824858757051095, 'Bleu_2': 0.7042553959707091, 'Bleu_3': 0.6310832277846351, 'Bleu_4': 0.5640132144467888, 'METEOR': 0.38530544762042224, 'ROUGE_L': 0.7081546705069021, 'CIDEr': 2.4164330439867645}
[INFO: 2022-10-25 22:14:27,085] ######## Epoch (TEST)14 ########
[INFO: 2022-10-25 22:14:27,085] {'Bleu_1': 0.8276353276341487, 'Bleu_2': 0.7416490776570432, 'Bleu_3': 0.6525247751127233, 'Bleu_4': 0.5688562613732201, 'METEOR': 0.4112555530453879, 'ROUGE_L': 0.7308168508268476, 'CIDEr': 2.3375492980803214}
[INFO: 2022-10-25 22:15:37,451] ######## Epoch (VAL)15 ########
[INFO: 2022-10-25 22:15:37,451] {'Bleu_1': 0.777119079314197, 'Bleu_2': 0.7018900259875265, 'Bleu_3': 0.6316383833027583, 'Bleu_4': 0.5653644872206047, 'METEOR': 0.37952148246634154, 'ROUGE_L': 0.7095767748602888, 'CIDEr': 2.3287733887242896}
[INFO: 2022-10-25 22:15:52,754] ######## Epoch (TEST)15 ########
[INFO: 2022-10-25 22:15:52,755] {'Bleu_1': 0.8081361070132025, 'Bleu_2': 0.7244209565609155, 'Bleu_3': 0.6373285390392406, 'Bleu_4': 0.5548530217974476, 'METEOR': 0.40674461163874925, 'ROUGE_L': 0.7250387320618493, 'CIDEr': 2.227077765654933}
[INFO: 2022-10-25 22:17:03,066] ######## Epoch (VAL)16 ########
[INFO: 2022-10-25 22:17:03,066] {'Bleu_1': 0.7777777777767239, 'Bleu_2': 0.7013059712836384, 'Bleu_3': 0.6331548049681532, 'Bleu_4': 0.5708745141936634, 'METEOR': 0.39974811152456463, 'ROUGE_L': 0.719230139133972, 'CIDEr': 2.5245148919366995}
[INFO: 2022-10-25 22:17:18,371] ######## Epoch (TEST)16 ########
[INFO: 2022-10-25 22:17:18,372] {'Bleu_1': 0.8124156545198213, 'Bleu_2': 0.7308057576808901, 'Bleu_3': 0.6463538330363894, 'Bleu_4': 0.567637534624646, 'METEOR': 0.42020883344183163, 'ROUGE_L': 0.7461712870234147, 'CIDEr': 2.4847810599336295}
[INFO: 2022-10-25 22:18:28,768] ######## Epoch (VAL)17 ########
[INFO: 2022-10-25 22:18:28,768] {'Bleu_1': 0.7826577248251412, 'Bleu_2': 0.6971877841047568, 'Bleu_3': 0.6235781311801784, 'Bleu_4': 0.5570011913190946, 'METEOR': 0.38862144734121146, 'ROUGE_L': 0.7119771736137228, 'CIDEr': 2.4393343631195408}
[INFO: 2022-10-25 22:18:43,666] ######## Epoch (TEST)17 ########
[INFO: 2022-10-25 22:18:43,667] {'Bleu_1': 0.8097982708922049, 'Bleu_2': 0.723403783199564, 'Bleu_3': 0.6366384400312655, 'Bleu_4': 0.551923910420707, 'METEOR': 0.4082153470417687, 'ROUGE_L': 0.7295108504292243, 'CIDEr': 2.292495107246979}
[INFO: 2022-10-25 22:19:53,735] ######## Epoch (VAL)18 ########
[INFO: 2022-10-25 22:19:53,736] {'Bleu_1': 0.788405861306727, 'Bleu_2': 0.7117539507342708, 'Bleu_3': 0.6452800332954866, 'Bleu_4': 0.5827462174609719, 'METEOR': 0.3983624609090531, 'ROUGE_L': 0.7209529144302353, 'CIDEr': 2.5074991233707076}
[INFO: 2022-10-25 22:20:09,055] ######## Epoch (TEST)18 ########
[INFO: 2022-10-25 22:20:09,055] {'Bleu_1': 0.8237822349558399, 'Bleu_2': 0.7422293241484449, 'Bleu_3': 0.657291721428949, 'Bleu_4': 0.576624833084527, 'METEOR': 0.4208906240369685, 'ROUGE_L': 0.7479107946584806, 'CIDEr': 2.3727234575292466}
[INFO: 2022-10-25 22:21:19,117] ######## Epoch (VAL)19 ########
[INFO: 2022-10-25 22:21:19,117] {'Bleu_1': 0.7859116022088593, 'Bleu_2': 0.7040027907048082, 'Bleu_3': 0.6349286779870257, 'Bleu_4': 0.5732248791345889, 'METEOR': 0.39229405226615227, 'ROUGE_L': 0.7159028438861403, 'CIDEr': 2.511267845043119}
[INFO: 2022-10-25 22:21:34,591] ######## Epoch (TEST)19 ########
[INFO: 2022-10-25 22:21:34,591] {'Bleu_1': 0.8238557558934482, 'Bleu_2': 0.7436161810328387, 'Bleu_3': 0.6596151856665179, 'Bleu_4': 0.5802091725080637, 'METEOR': 0.4244144348862528, 'ROUGE_L': 0.7585433674663568, 'CIDEr': 2.462533148276738}
[INFO: 2022-10-25 22:22:44,691] ######## Epoch (VAL)20 ########
[INFO: 2022-10-25 22:22:44,692] {'Bleu_1': 0.798008534849505, 'Bleu_2': 0.7182769639550017, 'Bleu_3': 0.648289751919925, 'Bleu_4': 0.5821557146973907, 'METEOR': 0.40255428785307557, 'ROUGE_L': 0.7250257949986633, 'CIDEr': 2.4589140471180304}
[INFO: 2022-10-25 22:22:59,667] ######## Epoch (TEST)20 ########
[INFO: 2022-10-25 22:22:59,667] {'Bleu_1': 0.8310249307467714, 'Bleu_2': 0.7446031168932524, 'Bleu_3': 0.6577272291292016, 'Bleu_4': 0.5766789876262773, 'METEOR': 0.42446723964922006, 'ROUGE_L': 0.7528719159714534, 'CIDEr': 2.4438293324061453}
[INFO: 2022-10-27 13:55:48,197] Training with config:
[INFO: 2022-10-27 13:55:48,200] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mssydney/sent/sydney_train_input.pkl',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 8,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mssydney/sent/sydney_train_target.pkl',
                 'TEST_4W_ID': './mscoco/misc/ids2path_json/coco_test4w_ids2path.json',
                 'TEST_ATT_FEATS': './mssydney/feature/Sydney',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mssydney/misc/ids2path_json/sydney_val_ids2path.json',
                 'TRAIN_ATT_FEATS': './mssydney/feature/Sydney',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mssydney/misc/ids2path_json/sydney_train_ids2path.json',
                 'VAL_ATT_FEATS': './mssydney/feature/Sydney',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mssydney/misc/ids2path_json/sydney_test_ids2path.json'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 5,
               'CAP_KEY': 'caption',
               'COCO_PATH': './coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mssydney/misc/val_sydney.json',
               'VAL_ANNFILE': './mssydney/misc/test_sydney.json',
               'VOCAB': './mssydney/txt/Sydney_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'CrossEntropy'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 1536,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 512,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 512,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [64, 32, 64],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 3,
                        'DIM': 512,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [64, 32, 64],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.1,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 3,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.1,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.1,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 1536,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 512,
           'SEQ_LEN': 24,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'PureT',
           'VOCAB_SIZE': 181,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 512,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'MAX_LEN': 'MAX_LEN',
           'MULCLASS': 'MULCLASS',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments_PureT/PureT_XE_Sydney/',
 'SCORER': {'CIDER_CACHED': './mssydney/misc/sydney_train_cider.pkl',
            'GT_PATH': './mssydney/misc/sydney_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1234.0,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 0.0005,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 512,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Noam',
                          'WARMUP': 10000},
            'MAX_EPOCH': 20,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2022-10-27 13:57:15,921] Training with config:
[INFO: 2022-10-27 13:57:15,926] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mssydney/sent/sydney_train_input.pkl',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 8,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mssydney/sent/sydney_train_target.pkl',
                 'TEST_4W_ID': './mscoco/misc/ids2path_json/coco_test4w_ids2path.json',
                 'TEST_ATT_FEATS': './mssydney/feature/Sydney',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mssydney/misc/ids2path_json/sydney_val_ids2path.json',
                 'TRAIN_ATT_FEATS': './mssydney/feature/Sydney',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mssydney/misc/ids2path_json/sydney_train_ids2path.json',
                 'VAL_ATT_FEATS': './mssydney/feature/Sydney',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mssydney/misc/ids2path_json/sydney_test_ids2path.json'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 5,
               'CAP_KEY': 'caption',
               'COCO_PATH': './coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mssydney/misc/val_sydney.json',
               'VAL_ANNFILE': './mssydney/misc/test_sydney.json',
               'VOCAB': './mssydney/txt/Sydney_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'CrossEntropy'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 1536,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 512,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 512,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [64, 32, 64],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 3,
                        'DIM': 512,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [64, 32, 64],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.1,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 3,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.1,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.1,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 1536,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 512,
           'SEQ_LEN': 24,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'PureT',
           'VOCAB_SIZE': 181,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 512,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'MAX_LEN': 'MAX_LEN',
           'MULCLASS': 'MULCLASS',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments_PureT/PureT_XE_Sydney/',
 'SCORER': {'CIDER_CACHED': './mssydney/misc/sydney_train_cider.pkl',
            'GT_PATH': './mssydney/misc/sydney_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1234.0,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 0.0005,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 512,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Noam',
                          'WARMUP': 10000},
            'MAX_EPOCH': 20,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2022-10-27 13:57:36,758] Training with config:
[INFO: 2022-10-27 13:57:36,760] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mssydney/sent/sydney_train_input.pkl',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 8,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mssydney/sent/sydney_train_target.pkl',
                 'TEST_4W_ID': './mscoco/misc/ids2path_json/coco_test4w_ids2path.json',
                 'TEST_ATT_FEATS': './mssydney/feature/Sydney',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mssydney/misc/ids2path_json/sydney_val_ids2path.json',
                 'TRAIN_ATT_FEATS': './mssydney/feature/Sydney',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mssydney/misc/ids2path_json/sydney_train_ids2path.json',
                 'VAL_ATT_FEATS': './mssydney/feature/Sydney',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mssydney/misc/ids2path_json/sydney_test_ids2path.json'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 5,
               'CAP_KEY': 'caption',
               'COCO_PATH': './coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mssydney/misc/val_sydney.json',
               'VAL_ANNFILE': './mssydney/misc/test_sydney.json',
               'VOCAB': './mssydney/txt/Sydney_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'CrossEntropy'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 1536,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 512,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 512,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [64, 32, 64],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 3,
                        'DIM': 512,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [64, 32, 64],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.1,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 3,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.1,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.1,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 1536,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 512,
           'SEQ_LEN': 24,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'PureT',
           'VOCAB_SIZE': 181,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 512,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'MAX_LEN': 'MAX_LEN',
           'MULCLASS': 'MULCLASS',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments_PureT/PureT_XE_Sydney/',
 'SCORER': {'CIDER_CACHED': './mssydney/misc/sydney_train_cider.pkl',
            'GT_PATH': './mssydney/misc/sydney_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1234.0,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 0.0005,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 512,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Noam',
                          'WARMUP': 10000},
            'MAX_EPOCH': 20,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2022-10-27 13:58:55,653] ######## Epoch (VAL)1 ########
[INFO: 2022-10-27 13:58:55,653] {'Bleu_1': 0.0, 'Bleu_2': 0.0, 'Bleu_3': 0.0, 'Bleu_4': 0.0, 'METEOR': 0.0, 'ROUGE_L': 0.0, 'CIDEr': 0.0}
[INFO: 2022-10-27 13:59:10,840] ######## Epoch (TEST)1 ########
[INFO: 2022-10-27 13:59:10,841] {'Bleu_1': 0.0, 'Bleu_2': 0.0, 'Bleu_3': 0.0, 'Bleu_4': 0.0, 'METEOR': 0.0, 'ROUGE_L': 0.0, 'CIDEr': 0.0}
[INFO: 2022-10-27 14:00:24,746] ######## Epoch (VAL)2 ########
[INFO: 2022-10-27 14:00:24,746] {'Bleu_1': 0.0, 'Bleu_2': 0.0, 'Bleu_3': 0.0, 'Bleu_4': 0.0, 'METEOR': 0.0, 'ROUGE_L': 0.0, 'CIDEr': 0.0}
[INFO: 2022-10-27 14:00:40,515] ######## Epoch (TEST)2 ########
[INFO: 2022-10-27 14:00:40,516] {'Bleu_1': 0.0, 'Bleu_2': 0.0, 'Bleu_3': 0.0, 'Bleu_4': 0.0, 'METEOR': 0.0, 'ROUGE_L': 0.0, 'CIDEr': 0.0}
[INFO: 2022-10-27 14:01:55,961] ######## Epoch (VAL)3 ########
[INFO: 2022-10-27 14:01:55,961] {'Bleu_1': 4.5058731105610656e-07, 'Bleu_2': 4.636505179821784e-10, 'Bleu_3': 4.680885450003411e-11, 'Bleu_4': 1.487293381224263e-11, 'METEOR': 0.012136355523826522, 'ROUGE_L': 0.0935045050205347, 'CIDEr': 0.004424682133700322}
[INFO: 2022-10-27 14:02:11,804] ######## Epoch (TEST)3 ########
[INFO: 2022-10-27 14:02:11,804] {'Bleu_1': 2.5860058847225805e-07, 'Bleu_2': 2.932255054294517e-10, 'Bleu_3': 3.057683209610186e-11, 'Bleu_4': 9.873880365830566e-12, 'METEOR': 0.0089736399326977, 'ROUGE_L': 0.07196867849310419, 'CIDEr': 0.006777861339687996}
[INFO: 2022-10-27 14:03:28,563] ######## Epoch (VAL)4 ########
[INFO: 2022-10-27 14:03:28,564] {'Bleu_1': 0.02112811124083576, 'Bleu_2': 0.02035164127073676, 'Bleu_3': 0.020042753054882324, 'Bleu_4': 0.0006536918063216347, 'METEOR': 0.09298350475097156, 'ROUGE_L': 0.2834986729741967, 'CIDEr': 0.21381164676853154}
[INFO: 2022-10-27 14:03:44,475] ######## Epoch (TEST)4 ########
[INFO: 2022-10-27 14:03:44,476] {'Bleu_1': 0.018887088655865296, 'Bleu_2': 0.01790698315921378, 'Bleu_3': 0.01750090257932523, 'Bleu_4': 0.0005862370841986517, 'METEOR': 0.0838069474616802, 'ROUGE_L': 0.2494332836093827, 'CIDEr': 0.18050680806667643}
[INFO: 2022-10-27 14:05:01,345] ######## Epoch (VAL)5 ########
[INFO: 2022-10-27 14:05:01,348] {'Bleu_1': 0.13381564909079452, 'Bleu_2': 0.11906953433901579, 'Bleu_3': 0.11137271765914085, 'Bleu_4': 0.1035682519769479, 'METEOR': 0.13198983433098796, 'ROUGE_L': 0.36686959754893206, 'CIDEr': 0.6300774557022684}
[INFO: 2022-10-27 14:05:17,415] ######## Epoch (TEST)5 ########
[INFO: 2022-10-27 14:05:17,416] {'Bleu_1': 0.12283805349904188, 'Bleu_2': 0.10935566682044628, 'Bleu_3': 0.10319328212221965, 'Bleu_4': 0.09692327634851572, 'METEOR': 0.1264979494410203, 'ROUGE_L': 0.34070025367177253, 'CIDEr': 0.5889417062237825}
[INFO: 2022-10-27 14:06:34,193] ######## Epoch (VAL)6 ########
[INFO: 2022-10-27 14:06:34,194] {'Bleu_1': 0.4721958570298047, 'Bleu_2': 0.416518795962461, 'Bleu_3': 0.36603379810559944, 'Bleu_4': 0.324148572996441, 'METEOR': 0.2262504490964933, 'ROUGE_L': 0.504627225446421, 'CIDEr': 1.2563893804503228}
[INFO: 2022-10-27 14:06:50,101] ######## Epoch (TEST)6 ########
[INFO: 2022-10-27 14:06:50,102] {'Bleu_1': 0.46267394220214014, 'Bleu_2': 0.42294102475671874, 'Bleu_3': 0.37569698183790273, 'Bleu_4': 0.318611819151591, 'METEOR': 0.22641594523368755, 'ROUGE_L': 0.5097420102910146, 'CIDEr': 1.1748839735972054}
[INFO: 2022-10-27 14:08:06,760] ######## Epoch (VAL)7 ########
[INFO: 2022-10-27 14:08:06,760] {'Bleu_1': 0.6087064753529933, 'Bleu_2': 0.5501412490430674, 'Bleu_3': 0.4905193037673955, 'Bleu_4': 0.43379961794777583, 'METEOR': 0.30948466804192615, 'ROUGE_L': 0.6236148195346461, 'CIDEr': 1.6457058937298383}
[INFO: 2022-10-27 14:08:22,660] ######## Epoch (TEST)7 ########
[INFO: 2022-10-27 14:08:22,661] {'Bleu_1': 0.647078270184259, 'Bleu_2': 0.5904353044561025, 'Bleu_3': 0.5192855545131861, 'Bleu_4': 0.4425114432503243, 'METEOR': 0.31131358883224136, 'ROUGE_L': 0.6365557292010623, 'CIDEr': 1.544032365049157}
[INFO: 2022-10-27 14:09:38,896] ######## Epoch (VAL)8 ########
[INFO: 2022-10-27 14:09:38,897] {'Bleu_1': 0.5915765532516206, 'Bleu_2': 0.5188222991157041, 'Bleu_3': 0.4495519282902525, 'Bleu_4': 0.380750994137562, 'METEOR': 0.2974213317506087, 'ROUGE_L': 0.6111519744659433, 'CIDEr': 1.5609637748034715}
[INFO: 2022-10-27 14:09:54,681] ######## Epoch (TEST)8 ########
[INFO: 2022-10-27 14:09:54,682] {'Bleu_1': 0.6637291334704356, 'Bleu_2': 0.6048936419662395, 'Bleu_3': 0.5348726542126949, 'Bleu_4': 0.45449109820199074, 'METEOR': 0.31718214572417175, 'ROUGE_L': 0.6446644056389222, 'CIDEr': 1.6743658769344671}
[INFO: 2022-10-27 14:11:11,129] ######## Epoch (VAL)9 ########
[INFO: 2022-10-27 14:11:11,130] {'Bleu_1': 0.7349999320235504, 'Bleu_2': 0.6487386784075089, 'Bleu_3': 0.5743202631058382, 'Bleu_4': 0.5056951964896389, 'METEOR': 0.34548873121206847, 'ROUGE_L': 0.6348734006456372, 'CIDEr': 1.9406984964159426}
[INFO: 2022-10-27 14:11:26,992] ######## Epoch (TEST)9 ########
[INFO: 2022-10-27 14:11:26,993] {'Bleu_1': 0.7945115846187806, 'Bleu_2': 0.7255779827075353, 'Bleu_3': 0.6480765891900729, 'Bleu_4': 0.5720970760999723, 'METEOR': 0.37782981310257485, 'ROUGE_L': 0.689033947733913, 'CIDEr': 2.1615017670366456}
[INFO: 2022-10-27 14:12:43,951] ######## Epoch (VAL)10 ########
[INFO: 2022-10-27 14:12:43,951] {'Bleu_1': 0.7404366644582441, 'Bleu_2': 0.663145180366037, 'Bleu_3': 0.5883443333299847, 'Bleu_4': 0.5165565528717397, 'METEOR': 0.3549410910158437, 'ROUGE_L': 0.6487908247419603, 'CIDEr': 2.019399235470168}
[INFO: 2022-10-27 14:12:59,845] ######## Epoch (TEST)10 ########
[INFO: 2022-10-27 14:12:59,846] {'Bleu_1': 0.8093124287116202, 'Bleu_2': 0.7418670663002344, 'Bleu_3': 0.6654357077986934, 'Bleu_4': 0.5900632370002218, 'METEOR': 0.38441801828292615, 'ROUGE_L': 0.6956880091055196, 'CIDEr': 2.1899179444179167}
[INFO: 2022-10-27 14:14:16,153] ######## Epoch (VAL)11 ########
[INFO: 2022-10-27 14:14:16,154] {'Bleu_1': 0.751845930322229, 'Bleu_2': 0.6678949554568513, 'Bleu_3': 0.5928053118489868, 'Bleu_4': 0.5217006049885452, 'METEOR': 0.35495021989113834, 'ROUGE_L': 0.6479402849772697, 'CIDEr': 2.045941484557915}
[INFO: 2022-10-27 14:14:32,344] ######## Epoch (TEST)11 ########
[INFO: 2022-10-27 14:14:32,344] {'Bleu_1': 0.817011413426934, 'Bleu_2': 0.7461126965811412, 'Bleu_3': 0.6700021336933921, 'Bleu_4': 0.5927733841846484, 'METEOR': 0.38601698211345253, 'ROUGE_L': 0.6980484724826131, 'CIDEr': 2.2110013053668593}
[INFO: 2022-10-27 14:15:49,059] ######## Epoch (VAL)12 ########
[INFO: 2022-10-27 14:15:49,060] {'Bleu_1': 0.7692674355776457, 'Bleu_2': 0.6900683073815568, 'Bleu_3': 0.6206686731791373, 'Bleu_4': 0.555763852569064, 'METEOR': 0.37209395033985443, 'ROUGE_L': 0.6861605962438904, 'CIDEr': 2.287780569555122}
[INFO: 2022-10-27 14:16:05,423] ######## Epoch (TEST)12 ########
[INFO: 2022-10-27 14:16:05,424] {'Bleu_1': 0.8126843657805123, 'Bleu_2': 0.7312993531599216, 'Bleu_3': 0.6480472898253773, 'Bleu_4': 0.5696472993443545, 'METEOR': 0.39160696867284084, 'ROUGE_L': 0.7047305665551469, 'CIDEr': 2.1667479290882}
[INFO: 2022-10-27 14:17:22,365] ######## Epoch (VAL)13 ########
[INFO: 2022-10-27 14:17:22,365] {'Bleu_1': 0.7067949872131896, 'Bleu_2': 0.6113042517329151, 'Bleu_3': 0.541596579012635, 'Bleu_4': 0.477288612751609, 'METEOR': 0.35595341121335505, 'ROUGE_L': 0.6494710570088088, 'CIDEr': 2.0214430159701773}
[INFO: 2022-10-27 14:17:38,418] ######## Epoch (TEST)13 ########
[INFO: 2022-10-27 14:17:38,419] {'Bleu_1': 0.7315433317546179, 'Bleu_2': 0.6270343150614388, 'Bleu_3': 0.5329071399351538, 'Bleu_4': 0.44305676399637894, 'METEOR': 0.3648683174421769, 'ROUGE_L': 0.6580753349349647, 'CIDEr': 1.9369634775093867}
[INFO: 2022-10-27 14:18:55,774] ######## Epoch (VAL)14 ########
[INFO: 2022-10-27 14:18:55,775] {'Bleu_1': 0.7742729760504645, 'Bleu_2': 0.692124132507056, 'Bleu_3': 0.6219716008195335, 'Bleu_4': 0.5563176975544503, 'METEOR': 0.38015371885823457, 'ROUGE_L': 0.6972741216045011, 'CIDEr': 2.354677343904137}
[INFO: 2022-10-27 14:19:11,833] ######## Epoch (TEST)14 ########
[INFO: 2022-10-27 14:19:11,834] {'Bleu_1': 0.8143884892074613, 'Bleu_2': 0.7248814866202651, 'Bleu_3': 0.6371378966489473, 'Bleu_4': 0.5556367398387703, 'METEOR': 0.40314626989551006, 'ROUGE_L': 0.7190344813589435, 'CIDEr': 2.2052161505627152}
[INFO: 2022-10-27 14:20:28,800] ######## Epoch (VAL)15 ########
[INFO: 2022-10-27 14:20:28,801] {'Bleu_1': 0.7696677959493914, 'Bleu_2': 0.6861533231776482, 'Bleu_3': 0.6150883552452, 'Bleu_4': 0.5505018051925771, 'METEOR': 0.37224903407893906, 'ROUGE_L': 0.6879080895003231, 'CIDEr': 2.2941271100037626}
[INFO: 2022-10-27 14:20:44,800] ######## Epoch (TEST)15 ########
[INFO: 2022-10-27 14:20:44,800] {'Bleu_1': 0.8189781021885855, 'Bleu_2': 0.7362518902830256, 'Bleu_3': 0.6497969806256416, 'Bleu_4': 0.5666349377787492, 'METEOR': 0.4022856699063664, 'ROUGE_L': 0.7232067586556338, 'CIDEr': 2.214049718375823}
[INFO: 2022-10-27 14:22:01,585] ######## Epoch (VAL)16 ########
[INFO: 2022-10-27 14:22:01,586] {'Bleu_1': 0.7681755829893441, 'Bleu_2': 0.6867799333752712, 'Bleu_3': 0.6134304427177854, 'Bleu_4': 0.546840111127016, 'METEOR': 0.3855017219524767, 'ROUGE_L': 0.7040623017930878, 'CIDEr': 2.3910954208698283}
[INFO: 2022-10-27 14:22:17,870] ######## Epoch (TEST)16 ########
[INFO: 2022-10-27 14:22:17,871] {'Bleu_1': 0.8206896551712818, 'Bleu_2': 0.7349517405238452, 'Bleu_3': 0.6488590351923889, 'Bleu_4': 0.5693886854482536, 'METEOR': 0.4210954110928527, 'ROUGE_L': 0.7406477234279725, 'CIDEr': 2.461774170257429}
[INFO: 2022-10-27 14:23:34,887] ######## Epoch (VAL)17 ########
[INFO: 2022-10-27 14:23:34,887] {'Bleu_1': 0.7814932625528439, 'Bleu_2': 0.6990893569498154, 'Bleu_3': 0.6296259228537103, 'Bleu_4': 0.5650195743438188, 'METEOR': 0.38850745878152493, 'ROUGE_L': 0.7078707942471363, 'CIDEr': 2.4523060579172116}
[INFO: 2022-10-27 14:23:50,866] ######## Epoch (TEST)17 ########
[INFO: 2022-10-27 14:23:50,866] {'Bleu_1': 0.8160112359539101, 'Bleu_2': 0.7307706218890545, 'Bleu_3': 0.6460916551334355, 'Bleu_4': 0.5668809137162429, 'METEOR': 0.4162916927772664, 'ROUGE_L': 0.7282861582084837, 'CIDEr': 2.469266269387017}
[INFO: 2022-10-27 14:25:07,497] ######## Epoch (VAL)18 ########
[INFO: 2022-10-27 14:25:07,498] {'Bleu_1': 0.7780859916771455, 'Bleu_2': 0.698720844333767, 'Bleu_3': 0.6287349177166546, 'Bleu_4': 0.5654568676710202, 'METEOR': 0.39031492456384864, 'ROUGE_L': 0.7130616993842248, 'CIDEr': 2.446417490855427}
[INFO: 2022-10-27 14:25:23,562] ######## Epoch (TEST)18 ########
[INFO: 2022-10-27 14:25:23,563] {'Bleu_1': 0.8240223463675642, 'Bleu_2': 0.7431489056500797, 'Bleu_3': 0.6590528988356342, 'Bleu_4': 0.5777779958960193, 'METEOR': 0.42261363308441713, 'ROUGE_L': 0.7500220719943369, 'CIDEr': 2.450940488008435}
[INFO: 2022-10-27 14:26:40,283] ######## Epoch (VAL)19 ########
[INFO: 2022-10-27 14:26:40,284] {'Bleu_1': 0.7899128558305862, 'Bleu_2': 0.7137743486279939, 'Bleu_3': 0.6451421434944337, 'Bleu_4': 0.5803964138715803, 'METEOR': 0.39655531343304146, 'ROUGE_L': 0.7278519552865154, 'CIDEr': 2.550897029548879}
[INFO: 2022-10-27 14:26:56,333] ######## Epoch (TEST)19 ########
[INFO: 2022-10-27 14:26:56,333] {'Bleu_1': 0.8427762039648119, 'Bleu_2': 0.7692620850924599, 'Bleu_3': 0.6860948696256839, 'Bleu_4': 0.606577695169753, 'METEOR': 0.43266271245352805, 'ROUGE_L': 0.7662934837656962, 'CIDEr': 2.616536405625405}
[INFO: 2022-10-27 14:28:13,006] ######## Epoch (VAL)20 ########
[INFO: 2022-10-27 14:28:13,006] {'Bleu_1': 0.7765248354330159, 'Bleu_2': 0.6928089289917212, 'Bleu_3': 0.6227814058954273, 'Bleu_4': 0.5589008983130379, 'METEOR': 0.39002780271389464, 'ROUGE_L': 0.7130569228656243, 'CIDEr': 2.393105201369781}
[INFO: 2022-10-27 14:28:28,886] ######## Epoch (TEST)20 ########
[INFO: 2022-10-27 14:28:28,887] {'Bleu_1': 0.8189415041771324, 'Bleu_2': 0.7355254726659284, 'Bleu_3': 0.6502895727700065, 'Bleu_4': 0.5728293590453544, 'METEOR': 0.421102416870477, 'ROUGE_L': 0.7408150056505491, 'CIDEr': 2.453865515643275}
[INFO: 2022-10-27 14:44:37,048] Training with config:
[INFO: 2022-10-27 14:44:37,050] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mssydney/sent/sydney_train_input.pkl',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 8,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mssydney/sent/sydney_train_target.pkl',
                 'TEST_4W_ID': './mscoco/misc/ids2path_json/coco_test4w_ids2path.json',
                 'TEST_ATT_FEATS': './mssydney/feature/Sydney',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mssydney/misc/ids2path_json/sydney_val_ids2path.json',
                 'TRAIN_ATT_FEATS': './mssydney/feature/Sydney',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mssydney/misc/ids2path_json/sydney_train_ids2path.json',
                 'VAL_ATT_FEATS': './mssydney/feature/Sydney',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mssydney/misc/ids2path_json/sydney_test_ids2path.json'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 5,
               'CAP_KEY': 'caption',
               'COCO_PATH': './coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mssydney/misc/val_sydney.json',
               'VAL_ANNFILE': './mssydney/misc/test_sydney.json',
               'VOCAB': './mssydney/txt/Sydney_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'CrossEntropy'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 1536,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 512,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 512,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [64, 32, 64],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 3,
                        'DIM': 512,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [64, 32, 64],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.1,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 3,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.1,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.1,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 1536,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 512,
           'SEQ_LEN': 24,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'PureT',
           'VOCAB_SIZE': 181,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 512,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'MAX_LEN': 'MAX_LEN',
           'MULCLASS': 'MULCLASS',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments_PureT/PureT_XE_Sydney/',
 'SCORER': {'CIDER_CACHED': './mssydney/misc/sydney_train_cider.pkl',
            'GT_PATH': './mssydney/misc/sydney_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1234.0,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 0.0005,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 512,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Noam',
                          'WARMUP': 10000},
            'MAX_EPOCH': 20,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2022-10-27 14:45:54,027] ######## Epoch (VAL)1 ########
[INFO: 2022-10-27 14:45:54,028] {'Bleu_1': 0.05938071723369293, 'Bleu_2': 0.012138292304141833, 'Bleu_3': 5.944065839129964e-08, 'Bleu_4': 1.361053263830807e-10, 'METEOR': 0.033363312152093795, 'ROUGE_L': 0.10683382465257543, 'CIDEr': 0.0384167609535086}
[INFO: 2022-10-27 14:46:09,669] ######## Epoch (TEST)1 ########
[INFO: 2022-10-27 14:46:09,670] {'Bleu_1': 0.032452260543962136, 'Bleu_2': 1.6132218511856965e-10, 'Bleu_3': 2.968107035154945e-13, 'Bleu_4': 1.3641625374068429e-14, 'METEOR': 0.0366931755132236, 'ROUGE_L': 0.10665577536874164, 'CIDEr': 0.05111849117567391}
[INFO: 2022-10-27 14:47:22,057] ######## Epoch (VAL)2 ########
[INFO: 2022-10-27 14:47:22,058] {'Bleu_1': 0.0, 'Bleu_2': 0.0, 'Bleu_3': 0.0, 'Bleu_4': 0.0, 'METEOR': 0.0, 'ROUGE_L': 0.0, 'CIDEr': 0.0}
[INFO: 2022-10-27 14:47:37,940] ######## Epoch (TEST)2 ########
[INFO: 2022-10-27 14:47:37,940] {'Bleu_1': 0.0, 'Bleu_2': 0.0, 'Bleu_3': 0.0, 'Bleu_4': 0.0, 'METEOR': 0.0, 'ROUGE_L': 0.0, 'CIDEr': 0.0}
[INFO: 2022-10-27 14:48:51,985] ######## Epoch (VAL)3 ########
[INFO: 2022-10-27 14:48:51,986] {'Bleu_1': 0.000551726246972612, 'Bleu_2': 0.00039979348171467446, 'Bleu_3': 4.670327013963329e-06, 'Bleu_4': 5.047810951749194e-07, 'METEOR': 0.02405912979142555, 'ROUGE_L': 0.15913881068332517, 'CIDEr': 0.08365977833540619}
[INFO: 2022-10-27 14:49:08,075] ######## Epoch (TEST)3 ########
[INFO: 2022-10-27 14:49:08,076] {'Bleu_1': 0.0004387504600420684, 'Bleu_2': 0.00036653830708250425, 'Bleu_3': 4.131562877789714e-06, 'Bleu_4': 4.386436685861199e-07, 'METEOR': 0.023779109034894767, 'ROUGE_L': 0.15010483529340607, 'CIDEr': 0.13824690816936985}
[INFO: 2022-10-27 14:50:22,379] ######## Epoch (VAL)4 ########
[INFO: 2022-10-27 14:50:22,380] {'Bleu_1': 0.060637411758134994, 'Bleu_2': 0.054429245816969375, 'Bleu_3': 0.05310732025601023, 'Bleu_4': 0.0018414945871640007, 'METEOR': 0.11052138072385526, 'ROUGE_L': 0.31416800493642216, 'CIDEr': 0.323832007332403}
[INFO: 2022-10-27 14:50:38,450] ######## Epoch (TEST)4 ########
[INFO: 2022-10-27 14:50:38,450] {'Bleu_1': 0.050893229719214776, 'Bleu_2': 0.04568494109419904, 'Bleu_3': 0.04484793624101302, 'Bleu_4': 0.001570392850692327, 'METEOR': 0.10423303846651966, 'ROUGE_L': 0.2817393324852142, 'CIDEr': 0.2855823674972891}
[INFO: 2022-10-27 14:51:53,077] ######## Epoch (VAL)5 ########
[INFO: 2022-10-27 14:51:53,077] {'Bleu_1': 0.07171858796144358, 'Bleu_2': 0.06375997273709466, 'Bleu_3': 0.0603439740356337, 'Bleu_4': 0.06760360333561743, 'METEOR': 0.1112854215878595, 'ROUGE_L': 0.3163336908371039, 'CIDEr': 0.3491220503965142}
[INFO: 2022-10-27 14:52:08,886] ######## Epoch (TEST)5 ########
[INFO: 2022-10-27 14:52:08,887] {'Bleu_1': 0.06266150069927934, 'Bleu_2': 0.05553122003435799, 'Bleu_3': 0.05236158367021042, 'Bleu_4': 0.05960767125651983, 'METEOR': 0.10501046620492466, 'ROUGE_L': 0.28450739722492807, 'CIDEr': 0.3123295310339776}
[INFO: 2022-10-27 14:53:23,293] ######## Epoch (VAL)6 ########
[INFO: 2022-10-27 14:53:23,293] {'Bleu_1': 0.39230367104774433, 'Bleu_2': 0.3437628698763325, 'Bleu_3': 0.3024647412161162, 'Bleu_4': 0.2667908735645197, 'METEOR': 0.20464958293901372, 'ROUGE_L': 0.45403682305447424, 'CIDEr': 1.2330743416919285}
[INFO: 2022-10-27 14:53:39,073] ######## Epoch (TEST)6 ########
[INFO: 2022-10-27 14:53:39,073] {'Bleu_1': 0.3798580154394921, 'Bleu_2': 0.35597030440690847, 'Bleu_3': 0.3252780274820618, 'Bleu_4': 0.2872058757226632, 'METEOR': 0.223493219858016, 'ROUGE_L': 0.4790254936261815, 'CIDEr': 1.2242371373112144}
[INFO: 2022-10-27 14:54:53,987] ######## Epoch (VAL)7 ########
[INFO: 2022-10-27 14:54:53,987] {'Bleu_1': 0.6443948902373796, 'Bleu_2': 0.567102022592957, 'Bleu_3': 0.4992254256487697, 'Bleu_4': 0.43547474328100083, 'METEOR': 0.30330869135759825, 'ROUGE_L': 0.6241579666605663, 'CIDEr': 1.6469101696067865}
[INFO: 2022-10-27 14:55:09,938] ######## Epoch (TEST)7 ########
[INFO: 2022-10-27 14:55:09,938] {'Bleu_1': 0.6501861430864423, 'Bleu_2': 0.5742937485612586, 'Bleu_3': 0.49542778198501686, 'Bleu_4': 0.41528347228700524, 'METEOR': 0.2978892947471044, 'ROUGE_L': 0.6299969659981128, 'CIDEr': 1.5193078040748496}
[INFO: 2022-10-27 14:56:24,357] ######## Epoch (VAL)8 ########
[INFO: 2022-10-27 14:56:24,358] {'Bleu_1': 0.7350206364804088, 'Bleu_2': 0.656776639321072, 'Bleu_3': 0.5844325559266768, 'Bleu_4': 0.5189486117859956, 'METEOR': 0.3476095370163131, 'ROUGE_L': 0.651250229822248, 'CIDEr': 1.969354800216581}
[INFO: 2022-10-27 14:56:40,276] ######## Epoch (TEST)8 ########
[INFO: 2022-10-27 14:56:40,276] {'Bleu_1': 0.7702359667593702, 'Bleu_2': 0.6989725653180467, 'Bleu_3': 0.624300801699825, 'Bleu_4': 0.5520168345566308, 'METEOR': 0.37216932226419847, 'ROUGE_L': 0.6773555098915203, 'CIDEr': 2.0820467664162945}
[INFO: 2022-10-27 14:57:54,759] ######## Epoch (VAL)9 ########
[INFO: 2022-10-27 14:57:54,760] {'Bleu_1': 0.7418389444838097, 'Bleu_2': 0.6520515830014851, 'Bleu_3': 0.5723559069590775, 'Bleu_4': 0.5003135678333623, 'METEOR': 0.34710497609993746, 'ROUGE_L': 0.6411538484771108, 'CIDEr': 1.9468641282649535}
[INFO: 2022-10-27 14:58:10,801] ######## Epoch (TEST)9 ########
[INFO: 2022-10-27 14:58:10,802] {'Bleu_1': 0.7902655267554316, 'Bleu_2': 0.7204760626413553, 'Bleu_3': 0.6455925955447548, 'Bleu_4': 0.5718556192592137, 'METEOR': 0.3834868199756911, 'ROUGE_L': 0.691432433132836, 'CIDEr': 2.1703441817346816}
[INFO: 2022-10-27 14:59:25,113] ######## Epoch (VAL)10 ########
[INFO: 2022-10-27 14:59:25,114] {'Bleu_1': 0.7298268871281073, 'Bleu_2': 0.6463575539068855, 'Bleu_3': 0.5717338140729669, 'Bleu_4': 0.5019621574430875, 'METEOR': 0.34367391164135896, 'ROUGE_L': 0.6753717474991916, 'CIDEr': 1.9373996224323113}
[INFO: 2022-10-27 14:59:41,191] ######## Epoch (TEST)10 ########
[INFO: 2022-10-27 14:59:41,192] {'Bleu_1': 0.7439968747277532, 'Bleu_2': 0.6704933558021597, 'Bleu_3': 0.5892198991384714, 'Bleu_4': 0.5027783095009557, 'METEOR': 0.3674384061389358, 'ROUGE_L': 0.6928527628101382, 'CIDEr': 1.9727260466115863}
[INFO: 2022-10-27 15:00:55,182] ######## Epoch (VAL)11 ########
[INFO: 2022-10-27 15:00:55,183] {'Bleu_1': 0.7070871327466464, 'Bleu_2': 0.626385183682213, 'Bleu_3': 0.5542466961377313, 'Bleu_4': 0.48659261806721255, 'METEOR': 0.34200987886000667, 'ROUGE_L': 0.6708424638126441, 'CIDEr': 1.9986621964661087}
[INFO: 2022-10-27 15:01:11,092] ######## Epoch (TEST)11 ########
[INFO: 2022-10-27 15:01:11,093] {'Bleu_1': 0.7673050251891866, 'Bleu_2': 0.6972847443108223, 'Bleu_3': 0.6142931626820846, 'Bleu_4': 0.5266826506729506, 'METEOR': 0.36344036625242915, 'ROUGE_L': 0.6935027003549019, 'CIDEr': 2.0805048184644948}
[INFO: 2022-10-27 15:02:26,923] ######## Epoch (VAL)12 ########
[INFO: 2022-10-27 15:02:26,924] {'Bleu_1': 0.7513655041440288, 'Bleu_2': 0.6754305243121119, 'Bleu_3': 0.6048137933860913, 'Bleu_4': 0.5387475228240555, 'METEOR': 0.36567154560973203, 'ROUGE_L': 0.6795298358232797, 'CIDEr': 2.2040121104735344}
[INFO: 2022-10-27 15:02:43,295] ######## Epoch (TEST)12 ########
[INFO: 2022-10-27 15:02:43,296] {'Bleu_1': 0.8179190751433267, 'Bleu_2': 0.7352204035346682, 'Bleu_3': 0.6458001948385962, 'Bleu_4': 0.5635618956949825, 'METEOR': 0.39851793749170245, 'ROUGE_L': 0.7092461568835674, 'CIDEr': 2.2357214740961227}
[INFO: 2022-10-27 15:03:58,136] ######## Epoch (VAL)13 ########
[INFO: 2022-10-27 15:03:58,137] {'Bleu_1': 0.7736317817430384, 'Bleu_2': 0.6893763562461013, 'Bleu_3': 0.6159921747114683, 'Bleu_4': 0.5480764541082318, 'METEOR': 0.3662692899977112, 'ROUGE_L': 0.6885999079793068, 'CIDEr': 2.263025183062691}
[INFO: 2022-10-27 15:04:14,154] ######## Epoch (TEST)13 ########
[INFO: 2022-10-27 15:04:14,155] {'Bleu_1': 0.817663817662653, 'Bleu_2': 0.7380284481891891, 'Bleu_3': 0.6511309606618406, 'Bleu_4': 0.5650689342807329, 'METEOR': 0.39937640440041045, 'ROUGE_L': 0.713528501152264, 'CIDEr': 2.2020262014576963}
[INFO: 2022-10-27 15:05:29,100] ######## Epoch (VAL)14 ########
[INFO: 2022-10-27 15:05:29,101] {'Bleu_1': 0.6830378872811409, 'Bleu_2': 0.5679017782794212, 'Bleu_3': 0.48647773792615084, 'Bleu_4': 0.4152319716256577, 'METEOR': 0.3437414674351677, 'ROUGE_L': 0.6238474311482304, 'CIDEr': 1.8048723104146582}
[INFO: 2022-10-27 15:05:45,106] ######## Epoch (TEST)14 ########
[INFO: 2022-10-27 15:05:45,106] {'Bleu_1': 0.7423740018508665, 'Bleu_2': 0.6344868815041527, 'Bleu_3': 0.5411850728945803, 'Bleu_4': 0.4488452204153611, 'METEOR': 0.3780911766608833, 'ROUGE_L': 0.6578246206345904, 'CIDEr': 1.9597975159971595}
[INFO: 2022-10-27 15:06:59,940] ######## Epoch (VAL)15 ########
[INFO: 2022-10-27 15:06:59,941] {'Bleu_1': 0.7399468243668473, 'Bleu_2': 0.6549767265853763, 'Bleu_3': 0.5824884251887588, 'Bleu_4': 0.5173191998463622, 'METEOR': 0.365074933971943, 'ROUGE_L': 0.6800094024795237, 'CIDEr': 2.3138437994641174}
[INFO: 2022-10-27 15:07:16,029] ######## Epoch (TEST)15 ########
[INFO: 2022-10-27 15:07:16,030] {'Bleu_1': 0.8020378457048005, 'Bleu_2': 0.7123831592927251, 'Bleu_3': 0.6244733574189464, 'Bleu_4': 0.5428987814885741, 'METEOR': 0.3972496379143075, 'ROUGE_L': 0.7022006766439676, 'CIDEr': 2.2829512196925923}
[INFO: 2022-10-27 15:08:30,716] ######## Epoch (VAL)16 ########
[INFO: 2022-10-27 15:08:30,717] {'Bleu_1': 0.7366906474809544, 'Bleu_2': 0.6541445449312445, 'Bleu_3': 0.578526679640896, 'Bleu_4': 0.5085705870929679, 'METEOR': 0.3737287031874086, 'ROUGE_L': 0.6533456345047336, 'CIDEr': 2.0431106115516697}
[INFO: 2022-10-27 15:08:46,691] ######## Epoch (TEST)16 ########
[INFO: 2022-10-27 15:08:46,691] {'Bleu_1': 0.8364688856717273, 'Bleu_2': 0.7590428351002708, 'Bleu_3': 0.6786925883953504, 'Bleu_4': 0.6066583767414903, 'METEOR': 0.4239875927279904, 'ROUGE_L': 0.7386811354776133, 'CIDEr': 2.3152434219282876}
[INFO: 2022-10-27 15:10:01,404] ######## Epoch (VAL)17 ########
[INFO: 2022-10-27 15:10:01,405] {'Bleu_1': 0.7607449856722626, 'Bleu_2': 0.6782425698251161, 'Bleu_3': 0.6063155934424594, 'Bleu_4': 0.5387130908265242, 'METEOR': 0.3889990479876762, 'ROUGE_L': 0.6917485789047866, 'CIDEr': 2.258889104403947}
[INFO: 2022-10-27 15:10:17,130] ######## Epoch (TEST)17 ########
[INFO: 2022-10-27 15:10:17,131] {'Bleu_1': 0.8089887640438076, 'Bleu_2': 0.7276193755481773, 'Bleu_3': 0.6449455708052606, 'Bleu_4': 0.5708757962523099, 'METEOR': 0.420861716335299, 'ROUGE_L': 0.7360926774823632, 'CIDEr': 2.3316191334963317}
[INFO: 2022-10-27 15:11:31,069] ######## Epoch (VAL)18 ########
[INFO: 2022-10-27 15:11:31,069] {'Bleu_1': 0.7018516261380795, 'Bleu_2': 0.5956813631315738, 'Bleu_3': 0.5217281107428278, 'Bleu_4': 0.4586101474182807, 'METEOR': 0.36498189188942315, 'ROUGE_L': 0.652460580434748, 'CIDEr': 2.0511008725564097}
[INFO: 2022-10-27 15:11:46,845] ######## Epoch (TEST)18 ########
[INFO: 2022-10-27 15:11:46,845] {'Bleu_1': 0.7521246458912859, 'Bleu_2': 0.6526651735522728, 'Bleu_3': 0.5651403182053479, 'Bleu_4': 0.4788750775573847, 'METEOR': 0.39036758859592346, 'ROUGE_L': 0.6807419348927738, 'CIDEr': 2.192715028952969}
[INFO: 2022-10-27 15:13:01,753] ######## Epoch (VAL)19 ########
[INFO: 2022-10-27 15:13:01,753] {'Bleu_1': 0.7568681318670922, 'Bleu_2': 0.6696809758973199, 'Bleu_3': 0.598803100807729, 'Bleu_4': 0.536019377603083, 'METEOR': 0.386896565066161, 'ROUGE_L': 0.7095408972183005, 'CIDEr': 2.461601365762797}
[INFO: 2022-10-27 15:13:17,651] ######## Epoch (TEST)19 ########
[INFO: 2022-10-27 15:13:17,652] {'Bleu_1': 0.8119777158763064, 'Bleu_2': 0.7281799597982317, 'Bleu_3': 0.6452483922174809, 'Bleu_4': 0.5661236618159899, 'METEOR': 0.4231394328709615, 'ROUGE_L': 0.7487266617786799, 'CIDEr': 2.630639105174737}
[INFO: 2022-10-27 15:14:32,074] ######## Epoch (VAL)20 ########
[INFO: 2022-10-27 15:14:32,075] {'Bleu_1': 0.7814661134152401, 'Bleu_2': 0.7025365081717435, 'Bleu_3': 0.6316894147458708, 'Bleu_4': 0.5681867185146952, 'METEOR': 0.3903608838377117, 'ROUGE_L': 0.7178539317066547, 'CIDEr': 2.496376325631782}
[INFO: 2022-10-27 15:14:48,106] ######## Epoch (TEST)20 ########
[INFO: 2022-10-27 15:14:48,107] {'Bleu_1': 0.8310249307467714, 'Bleu_2': 0.7487933757313469, 'Bleu_3': 0.6651090048594972, 'Bleu_4': 0.5849094049663999, 'METEOR': 0.42808564382419945, 'ROUGE_L': 0.7512924612495705, 'CIDEr': 2.5302675904088883}
[INFO: 2022-10-27 15:48:35,728] Training with config:
[INFO: 2022-10-27 15:48:35,733] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mssydney/sent/sydney_train_input.pkl',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 8,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mssydney/sent/sydney_train_target.pkl',
                 'TEST_4W_ID': './mscoco/misc/ids2path_json/coco_test4w_ids2path.json',
                 'TEST_ATT_FEATS': './mssydney/feature/Sydney',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mssydney/misc/ids2path_json/sydney_val_ids2path.json',
                 'TRAIN_ATT_FEATS': './mssydney/feature/Sydney',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mssydney/misc/ids2path_json/sydney_train_ids2path.json',
                 'VAL_ATT_FEATS': './mssydney/feature/Sydney',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mssydney/misc/ids2path_json/sydney_test_ids2path.json'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 5,
               'CAP_KEY': 'caption',
               'COCO_PATH': './coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mssydney/misc/val_sydney.json',
               'VAL_ANNFILE': './mssydney/misc/test_sydney.json',
               'VOCAB': './mssydney/txt/Sydney_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'CrossEntropy'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 1536,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 512,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 512,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [64, 32, 64],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 3,
                        'DIM': 512,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [64, 32, 64],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.1,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 3,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.1,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.1,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 1536,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 512,
           'SEQ_LEN': 24,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'PureT',
           'VOCAB_SIZE': 181,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 512,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'MAX_LEN': 'MAX_LEN',
           'MULCLASS': 'MULCLASS',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments_PureT/PureT_XE_Sydney/',
 'SCORER': {'CIDER_CACHED': './mssydney/misc/sydney_train_cider.pkl',
            'GT_PATH': './mssydney/misc/sydney_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1234.0,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 0.0005,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 512,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Noam',
                          'WARMUP': 10000},
            'MAX_EPOCH': 20,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2022-10-27 15:49:54,574] ######## Epoch (VAL)1 ########
[INFO: 2022-10-27 15:49:54,574] {'Bleu_1': 0.0, 'Bleu_2': 0.0, 'Bleu_3': 0.0, 'Bleu_4': 0.0, 'METEOR': 0.0, 'ROUGE_L': 0.0, 'CIDEr': 0.0}
[INFO: 2022-10-27 15:50:10,994] ######## Epoch (TEST)1 ########
[INFO: 2022-10-27 15:50:10,995] {'Bleu_1': 0.0, 'Bleu_2': 0.0, 'Bleu_3': 0.0, 'Bleu_4': 0.0, 'METEOR': 0.0, 'ROUGE_L': 0.0, 'CIDEr': 0.0}
[INFO: 2022-10-27 15:51:26,135] ######## Epoch (VAL)2 ########
[INFO: 2022-10-27 15:51:26,135] {'Bleu_1': 0.0, 'Bleu_2': 0.0, 'Bleu_3': 0.0, 'Bleu_4': 0.0, 'METEOR': 0.0, 'ROUGE_L': 0.0, 'CIDEr': 0.0}
[INFO: 2022-10-27 15:51:43,100] ######## Epoch (TEST)2 ########
[INFO: 2022-10-27 15:51:43,101] {'Bleu_1': 0.0, 'Bleu_2': 0.0, 'Bleu_3': 0.0, 'Bleu_4': 0.0, 'METEOR': 0.0, 'ROUGE_L': 0.0, 'CIDEr': 0.0}
[INFO: 2022-10-27 15:52:59,573] ######## Epoch (VAL)3 ########
[INFO: 2022-10-27 15:52:59,574] {'Bleu_1': 4.5058731105610656e-07, 'Bleu_2': 4.636505179821784e-10, 'Bleu_3': 4.680885450003411e-11, 'Bleu_4': 1.487293381224263e-11, 'METEOR': 0.012136355523826522, 'ROUGE_L': 0.0935045050205347, 'CIDEr': 0.004424682133700349}
[INFO: 2022-10-27 15:53:16,195] ######## Epoch (TEST)3 ########
[INFO: 2022-10-27 15:53:16,195] {'Bleu_1': 2.5860058847225805e-07, 'Bleu_2': 2.932255054294517e-10, 'Bleu_3': 3.057683209610186e-11, 'Bleu_4': 9.873880365830566e-12, 'METEOR': 0.0089736399326977, 'ROUGE_L': 0.07196867849310419, 'CIDEr': 0.006777861339687995}
[INFO: 2022-10-27 15:54:32,318] ######## Epoch (VAL)4 ########
[INFO: 2022-10-27 15:54:32,319] {'Bleu_1': 0.02112811124083576, 'Bleu_2': 0.02035164127073676, 'Bleu_3': 0.020042753054882324, 'Bleu_4': 0.0006536918063216347, 'METEOR': 0.09298350475097156, 'ROUGE_L': 0.2834986729741967, 'CIDEr': 0.21381164676853157}
[INFO: 2022-10-27 15:54:48,371] ######## Epoch (TEST)4 ########
[INFO: 2022-10-27 15:54:48,372] {'Bleu_1': 0.018887088655865296, 'Bleu_2': 0.01790698315921378, 'Bleu_3': 0.01750090257932523, 'Bleu_4': 0.0005862370841986517, 'METEOR': 0.0838069474616802, 'ROUGE_L': 0.2494332836093827, 'CIDEr': 0.18050680806667643}
[INFO: 2022-10-27 15:56:04,023] ######## Epoch (VAL)5 ########
[INFO: 2022-10-27 15:56:04,024] {'Bleu_1': 0.13381564909079452, 'Bleu_2': 0.11906953433901579, 'Bleu_3': 0.11137271765914085, 'Bleu_4': 0.1035682519769479, 'METEOR': 0.13198983433098796, 'ROUGE_L': 0.36686959754893206, 'CIDEr': 0.6300774557022684}
[INFO: 2022-10-27 15:56:19,894] ######## Epoch (TEST)5 ########
[INFO: 2022-10-27 15:56:19,894] {'Bleu_1': 0.12283805349904188, 'Bleu_2': 0.10935566682044628, 'Bleu_3': 0.10319328212221965, 'Bleu_4': 0.09692327634851572, 'METEOR': 0.1264979494410203, 'ROUGE_L': 0.34070025367177253, 'CIDEr': 0.5889417062237825}
[INFO: 2022-10-27 15:57:35,968] ######## Epoch (VAL)6 ########
[INFO: 2022-10-27 15:57:35,968] {'Bleu_1': 0.4799929477268818, 'Bleu_2': 0.42642795337310635, 'Bleu_3': 0.3785405540622512, 'Bleu_4': 0.3379795052657929, 'METEOR': 0.23144426139500504, 'ROUGE_L': 0.5121084525317956, 'CIDEr': 1.2985769330760422}
[INFO: 2022-10-27 15:57:51,880] ######## Epoch (TEST)6 ########
[INFO: 2022-10-27 15:57:51,881] {'Bleu_1': 0.46267394220214014, 'Bleu_2': 0.42294102475671874, 'Bleu_3': 0.37569698183790273, 'Bleu_4': 0.318611819151591, 'METEOR': 0.22641594523368755, 'ROUGE_L': 0.5097420102910146, 'CIDEr': 1.1748839735972054}
[INFO: 2022-10-27 15:59:08,139] ######## Epoch (VAL)7 ########
[INFO: 2022-10-27 15:59:08,139] {'Bleu_1': 0.6171370512523351, 'Bleu_2': 0.5555010254694018, 'Bleu_3': 0.49479712417056526, 'Bleu_4': 0.4376978328758516, 'METEOR': 0.3094014184200549, 'ROUGE_L': 0.626465091776118, 'CIDEr': 1.6435633120511342}
[INFO: 2022-10-27 15:59:24,984] ######## Epoch (TEST)7 ########
[INFO: 2022-10-27 15:59:24,984] {'Bleu_1': 0.6314340268222044, 'Bleu_2': 0.5735209497337429, 'Bleu_3': 0.5029469812536801, 'Bleu_4': 0.4283796205181124, 'METEOR': 0.305330734056054, 'ROUGE_L': 0.6287825467328796, 'CIDEr': 1.4851658636528768}
[INFO: 2022-10-27 16:00:41,366] ######## Epoch (VAL)8 ########
[INFO: 2022-10-27 16:00:41,366] {'Bleu_1': 0.6040825640762666, 'Bleu_2': 0.5285274058267184, 'Bleu_3': 0.45875341509142986, 'Bleu_4': 0.38954479824458066, 'METEOR': 0.300027927971256, 'ROUGE_L': 0.6138480621597763, 'CIDEr': 1.5855929335883592}
[INFO: 2022-10-27 16:00:57,823] ######## Epoch (TEST)8 ########
[INFO: 2022-10-27 16:00:57,823] {'Bleu_1': 0.6764321919218573, 'Bleu_2': 0.6205826278880574, 'Bleu_3': 0.5519933297431926, 'Bleu_4': 0.47208046139838084, 'METEOR': 0.3273531446831576, 'ROUGE_L': 0.658148881436017, 'CIDEr': 1.7646509713464718}
[INFO: 2022-10-27 16:02:14,608] ######## Epoch (VAL)9 ########
[INFO: 2022-10-27 16:02:14,609] {'Bleu_1': 0.7432016088555998, 'Bleu_2': 0.6553345592393358, 'Bleu_3': 0.5797456591801804, 'Bleu_4': 0.5098608187742466, 'METEOR': 0.34815669903871, 'ROUGE_L': 0.6388275317483012, 'CIDEr': 1.9714370142706295}
[INFO: 2022-10-27 16:02:31,412] ######## Epoch (TEST)9 ########
[INFO: 2022-10-27 16:02:31,413] {'Bleu_1': 0.7966014146386802, 'Bleu_2': 0.7253829001208746, 'Bleu_3': 0.6457157835599877, 'Bleu_4': 0.5677969443018761, 'METEOR': 0.37776789355535495, 'ROUGE_L': 0.6840916513390761, 'CIDEr': 2.151912986125155}
[INFO: 2022-10-27 16:03:47,731] ######## Epoch (VAL)10 ########
[INFO: 2022-10-27 16:03:47,731] {'Bleu_1': 0.7397186493149591, 'Bleu_2': 0.6598981899233931, 'Bleu_3': 0.5849387764978154, 'Bleu_4': 0.5137848651709691, 'METEOR': 0.3542795520457574, 'ROUGE_L': 0.648102691262438, 'CIDEr': 2.0001938351201902}
[INFO: 2022-10-27 16:04:04,266] ######## Epoch (TEST)10 ########
[INFO: 2022-10-27 16:04:04,266] {'Bleu_1': 0.8123287563536447, 'Bleu_2': 0.7445539482244191, 'Bleu_3': 0.6663108663115576, 'Bleu_4': 0.5903577260251971, 'METEOR': 0.3820294273229207, 'ROUGE_L': 0.6958368081435389, 'CIDEr': 2.191584931990754}
[INFO: 2022-10-27 16:05:20,411] ######## Epoch (VAL)11 ########
[INFO: 2022-10-27 16:05:20,411] {'Bleu_1': 0.7556825618956693, 'Bleu_2': 0.6701317040004823, 'Bleu_3': 0.5938639958553855, 'Bleu_4': 0.5215020133532027, 'METEOR': 0.3558951742999259, 'ROUGE_L': 0.6516155167867741, 'CIDEr': 2.067624869170187}
[INFO: 2022-10-27 16:05:36,980] ######## Epoch (TEST)11 ########
[INFO: 2022-10-27 16:05:36,980] {'Bleu_1': 0.8200599634770344, 'Bleu_2': 0.7502532703095163, 'Bleu_3': 0.67401574335145, 'Bleu_4': 0.5961888198900924, 'METEOR': 0.38747408006992595, 'ROUGE_L': 0.7008794930423198, 'CIDEr': 2.2428031038058815}
[INFO: 2022-10-27 16:06:53,126] ######## Epoch (VAL)12 ########
[INFO: 2022-10-27 16:06:53,126] {'Bleu_1': 0.7710846797753981, 'Bleu_2': 0.6911426327735162, 'Bleu_3': 0.6208396980483688, 'Bleu_4': 0.5554767695538654, 'METEOR': 0.37407353939273064, 'ROUGE_L': 0.6887913159070721, 'CIDEr': 2.2875287333487084}
[INFO: 2022-10-27 16:07:09,469] ######## Epoch (TEST)12 ########
[INFO: 2022-10-27 16:07:09,470] {'Bleu_1': 0.8135095447858832, 'Bleu_2': 0.7343656066942365, 'Bleu_3': 0.6517155287909414, 'Bleu_4': 0.5726748604642333, 'METEOR': 0.3943841078209397, 'ROUGE_L': 0.7076491039564429, 'CIDEr': 2.1748254247492715}
[INFO: 2022-10-27 16:08:25,491] ######## Epoch (VAL)13 ########
[INFO: 2022-10-27 16:08:25,491] {'Bleu_1': 0.7090472252179159, 'Bleu_2': 0.6113408410088785, 'Bleu_3': 0.5417734321474008, 'Bleu_4': 0.4791107086919665, 'METEOR': 0.35332692390263765, 'ROUGE_L': 0.6461845053795984, 'CIDEr': 2.004704500402789}
[INFO: 2022-10-27 16:08:41,693] ######## Epoch (TEST)13 ########
[INFO: 2022-10-27 16:08:41,694] {'Bleu_1': 0.743359584866176, 'Bleu_2': 0.6404361540286164, 'Bleu_3': 0.5460862073596179, 'Bleu_4': 0.4545610666518039, 'METEOR': 0.36953929137747765, 'ROUGE_L': 0.6629663131435805, 'CIDEr': 1.9653184698395756}
[INFO: 2022-10-27 16:09:57,608] ######## Epoch (VAL)14 ########
[INFO: 2022-10-27 16:09:57,609] {'Bleu_1': 0.7764841839627784, 'Bleu_2': 0.6942373561560141, 'Bleu_3': 0.625426445409879, 'Bleu_4': 0.5612300894779626, 'METEOR': 0.37559289838266635, 'ROUGE_L': 0.6939064723308385, 'CIDEr': 2.348627962851615}
[INFO: 2022-10-27 16:10:13,857] ######## Epoch (TEST)14 ########
[INFO: 2022-10-27 16:10:13,858] {'Bleu_1': 0.8204379562031818, 'Bleu_2': 0.735129968124065, 'Bleu_3': 0.6506358593792116, 'Bleu_4': 0.5715636081015296, 'METEOR': 0.4015254833231559, 'ROUGE_L': 0.7196469152574639, 'CIDEr': 2.2400865842547697}
[INFO: 2022-10-27 16:11:30,398] ######## Epoch (VAL)15 ########
[INFO: 2022-10-27 16:11:30,398] {'Bleu_1': 0.7682332272232527, 'Bleu_2': 0.6846815156994699, 'Bleu_3': 0.6135543652644849, 'Bleu_4': 0.5495367723482376, 'METEOR': 0.37109516264999504, 'ROUGE_L': 0.6852547522893658, 'CIDEr': 2.2735977387342015}
[INFO: 2022-10-27 16:11:47,184] ######## Epoch (TEST)15 ########
[INFO: 2022-10-27 16:11:47,185] {'Bleu_1': 0.8204379562031818, 'Bleu_2': 0.7377951006169564, 'Bleu_3': 0.6507046622189123, 'Bleu_4': 0.5686998926294232, 'METEOR': 0.4029941441465308, 'ROUGE_L': 0.7233896599267678, 'CIDEr': 2.225699686214705}
[INFO: 2022-10-27 16:13:03,043] ######## Epoch (VAL)16 ########
[INFO: 2022-10-27 16:13:03,044] {'Bleu_1': 0.7790055248608025, 'Bleu_2': 0.6983950969982619, 'Bleu_3': 0.6281823857138139, 'Bleu_4': 0.5649379547799248, 'METEOR': 0.3918304688055621, 'ROUGE_L': 0.7141348381383825, 'CIDEr': 2.4772432830447886}
[INFO: 2022-10-27 16:13:19,027] ######## Epoch (TEST)16 ########
[INFO: 2022-10-27 16:13:19,028] {'Bleu_1': 0.8196948682374207, 'Bleu_2': 0.730821334969845, 'Bleu_3': 0.643612792558996, 'Bleu_4': 0.5635912676761449, 'METEOR': 0.41420127531003, 'ROUGE_L': 0.7300652587175358, 'CIDEr': 2.3967982694670686}
[INFO: 2022-10-27 16:14:35,681] ######## Epoch (VAL)17 ########
[INFO: 2022-10-27 16:14:35,681] {'Bleu_1': 0.7556112322852675, 'Bleu_2': 0.6635938897521111, 'Bleu_3': 0.5915936265356638, 'Bleu_4': 0.5255766448162055, 'METEOR': 0.38039430726553586, 'ROUGE_L': 0.6908594087694563, 'CIDEr': 2.2702846478149636}
[INFO: 2022-10-27 16:14:51,878] ######## Epoch (TEST)17 ########
[INFO: 2022-10-27 16:14:51,879] {'Bleu_1': 0.7774607703269937, 'Bleu_2': 0.685817489807729, 'Bleu_3': 0.5987665115461132, 'Bleu_4': 0.5144848432173202, 'METEOR': 0.4027889632830863, 'ROUGE_L': 0.7087766386614625, 'CIDEr': 2.3948291419090015}
[INFO: 2022-10-27 16:16:07,862] ######## Epoch (VAL)18 ########
[INFO: 2022-10-27 16:16:07,862] {'Bleu_1': 0.7729805013916811, 'Bleu_2': 0.6904138680464164, 'Bleu_3': 0.6193192682869917, 'Bleu_4': 0.5567264938621121, 'METEOR': 0.39214593215469257, 'ROUGE_L': 0.7083997029154468, 'CIDEr': 2.4014288024338755}
[INFO: 2022-10-27 16:16:24,880] ######## Epoch (TEST)18 ########
[INFO: 2022-10-27 16:16:24,880] {'Bleu_1': 0.8039772727261307, 'Bleu_2': 0.7212631892962166, 'Bleu_3': 0.636889888224208, 'Bleu_4': 0.5566674844523505, 'METEOR': 0.41308030290457587, 'ROUGE_L': 0.7332660253153711, 'CIDEr': 2.361283336514291}
[INFO: 2022-10-27 16:17:41,373] ######## Epoch (VAL)19 ########
[INFO: 2022-10-27 16:17:41,373] {'Bleu_1': 0.7819901866303964, 'Bleu_2': 0.7033943630579039, 'Bleu_3': 0.6352268528958785, 'Bleu_4': 0.5726600595390138, 'METEOR': 0.3910974381423089, 'ROUGE_L': 0.7141715743774266, 'CIDEr': 2.4990628659896106}
[INFO: 2022-10-27 16:17:57,554] ######## Epoch (TEST)19 ########
[INFO: 2022-10-27 16:17:57,554] {'Bleu_1': 0.8448519040890764, 'Bleu_2': 0.7726427168267389, 'Bleu_3': 0.6918833480246803, 'Bleu_4': 0.6142825412117122, 'METEOR': 0.43573853656733313, 'ROUGE_L': 0.7719992214318425, 'CIDEr': 2.660515329286458}
[INFO: 2022-10-27 16:19:13,857] ######## Epoch (VAL)20 ########
[INFO: 2022-10-27 16:19:13,857] {'Bleu_1': 0.7770083102482312, 'Bleu_2': 0.6935051700968909, 'Bleu_3': 0.6218559635146144, 'Bleu_4': 0.5567795064900478, 'METEOR': 0.38898660247273903, 'ROUGE_L': 0.712597624937436, 'CIDEr': 2.410665800152989}
[INFO: 2022-10-27 16:19:30,190] ######## Epoch (TEST)20 ########
[INFO: 2022-10-27 16:19:30,190] {'Bleu_1': 0.8259052924779584, 'Bleu_2': 0.743711147979066, 'Bleu_3': 0.6593594403525491, 'Bleu_4': 0.581509588182382, 'METEOR': 0.42393533419893475, 'ROUGE_L': 0.7526499516122902, 'CIDEr': 2.4981484106137684}
[INFO: 2022-10-28 19:56:32,390] Training with config:
[INFO: 2022-10-28 19:56:32,397] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mssydney/sent/sydney_train_input.pkl',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 8,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mssydney/sent/sydney_train_target.pkl',
                 'TEST_4W_ID': './mscoco/misc/ids2path_json/coco_test4w_ids2path.json',
                 'TEST_ATT_FEATS': './mssydney/feature/Sydney',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mssydney/misc/ids2path_json/sydney_val_ids2path.json',
                 'TRAIN_ATT_FEATS': './mssydney/feature/Sydney',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mssydney/misc/ids2path_json/sydney_train_ids2path.json',
                 'VAL_ATT_FEATS': './mssydney/feature/Sydney',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mssydney/misc/ids2path_json/sydney_test_ids2path.json'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 5,
               'CAP_KEY': 'caption',
               'COCO_PATH': './coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mssydney/misc/val_sydney.json',
               'VAL_ANNFILE': './mssydney/misc/test_sydney.json',
               'VOCAB': './mssydney/txt/Sydney_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'CrossEntropy'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 1536,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 512,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 512,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [64, 32, 64],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 3,
                        'DIM': 512,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [64, 32, 64],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.1,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 3,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.1,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.1,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 1536,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 512,
           'SEQ_LEN': 24,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'PureT',
           'VOCAB_SIZE': 181,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 512,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'MAX_LEN': 'MAX_LEN',
           'MULCLASS': 'MULCLASS',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments_PureT/PureT_XE_Sydney/',
 'SCORER': {'CIDER_CACHED': './mssydney/misc/sydney_train_cider.pkl',
            'GT_PATH': './mssydney/misc/sydney_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1234.0,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 0.0005,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 512,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Noam',
                          'WARMUP': 10000},
            'MAX_EPOCH': 20,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2022-10-28 19:57:49,254] ######## Epoch (VAL)1 ########
[INFO: 2022-10-28 19:57:49,254] {'Bleu_1': 0.0, 'Bleu_2': 0.0, 'Bleu_3': 0.0, 'Bleu_4': 0.0, 'METEOR': 0.0, 'ROUGE_L': 0.0, 'CIDEr': 0.0}
[INFO: 2022-10-28 19:58:04,874] ######## Epoch (TEST)1 ########
[INFO: 2022-10-28 19:58:04,874] {'Bleu_1': 0.0, 'Bleu_2': 0.0, 'Bleu_3': 0.0, 'Bleu_4': 0.0, 'METEOR': 0.0, 'ROUGE_L': 0.0, 'CIDEr': 0.0}
[INFO: 2022-10-28 19:59:17,176] ######## Epoch (VAL)2 ########
[INFO: 2022-10-28 19:59:17,176] {'Bleu_1': 0.0, 'Bleu_2': 0.0, 'Bleu_3': 0.0, 'Bleu_4': 0.0, 'METEOR': 0.0, 'ROUGE_L': 0.0, 'CIDEr': 0.0}
[INFO: 2022-10-28 19:59:32,923] ######## Epoch (TEST)2 ########
[INFO: 2022-10-28 19:59:32,924] {'Bleu_1': 0.0, 'Bleu_2': 0.0, 'Bleu_3': 0.0, 'Bleu_4': 0.0, 'METEOR': 0.0, 'ROUGE_L': 0.0, 'CIDEr': 0.0}
[INFO: 2022-10-28 20:00:46,572] ######## Epoch (VAL)3 ########
[INFO: 2022-10-28 20:00:46,572] {'Bleu_1': 1.9987412282205808e-10, 'Bleu_2': 1.998741228262221e-13, 'Bleu_3': 1.9987412282761023e-14, 'Bleu_4': 6.3205747346569686e-15, 'METEOR': 0.007896685037426998, 'ROUGE_L': 0.06544840687577523, 'CIDEr': 0.0031153352408728953}
[INFO: 2022-10-28 20:01:02,119] ######## Epoch (TEST)3 ########
[INFO: 2022-10-28 20:01:02,120] {'Bleu_1': 1.266758736019834e-11, 'Bleu_2': 1.2965689025053257e-14, 'Bleu_3': 1.3066607088117912e-15, 'Bleu_4': 4.14807354321591e-16, 'METEOR': 0.006606370428627606, 'ROUGE_L': 0.0527137734219956, 'CIDEr': 0.005028130757830347}
[INFO: 2022-10-28 20:02:16,300] ######## Epoch (VAL)4 ########
[INFO: 2022-10-28 20:02:16,301] {'Bleu_1': 0.035517333919646316, 'Bleu_2': 0.03354258015540342, 'Bleu_3': 0.0322730592767631, 'Bleu_4': 5.0621016715895544e-06, 'METEOR': 0.10610673612738845, 'ROUGE_L': 0.3075538839316874, 'CIDEr': 0.3011657270860548}
[INFO: 2022-10-28 20:02:32,061] ######## Epoch (TEST)4 ########
[INFO: 2022-10-28 20:02:32,061] {'Bleu_1': 0.027767781313658396, 'Bleu_2': 0.026744062150450526, 'Bleu_3': 0.026093040074227268, 'Bleu_4': 0.0008758062087021335, 'METEOR': 0.0929219800826827, 'ROUGE_L': 0.26659832037640757, 'CIDEr': 0.26223900777849507}
[INFO: 2022-10-28 20:03:45,954] ######## Epoch (VAL)5 ########
[INFO: 2022-10-28 20:03:45,954] {'Bleu_1': 0.13755550952393697, 'Bleu_2': 0.12383577105378978, 'Bleu_3': 0.11743689755918794, 'Bleu_4': 0.11219282904775131, 'METEOR': 0.13817038316613914, 'ROUGE_L': 0.37723153846502194, 'CIDEr': 0.6999563141193414}
[INFO: 2022-10-28 20:04:02,140] ######## Epoch (TEST)5 ########
[INFO: 2022-10-28 20:04:02,141] {'Bleu_1': 0.1333896935306346, 'Bleu_2': 0.11887235598721858, 'Bleu_3': 0.1118042130436895, 'Bleu_4': 0.10444577834511343, 'METEOR': 0.13322878451036776, 'ROUGE_L': 0.35021302372911123, 'CIDEr': 0.649767267088776}
[INFO: 2022-10-28 20:05:17,250] ######## Epoch (VAL)6 ########
[INFO: 2022-10-28 20:05:17,251] {'Bleu_1': 0.48836265526783684, 'Bleu_2': 0.43943288281899123, 'Bleu_3': 0.39504436711468405, 'Bleu_4': 0.3535784976079481, 'METEOR': 0.24211714567357476, 'ROUGE_L': 0.5225149424211085, 'CIDEr': 1.3744639475046956}
[INFO: 2022-10-28 20:05:33,464] ######## Epoch (TEST)6 ########
[INFO: 2022-10-28 20:05:33,464] {'Bleu_1': 0.44770406857040385, 'Bleu_2': 0.41595905813143474, 'Bleu_3': 0.3749702923816787, 'Bleu_4': 0.3218763240362314, 'METEOR': 0.23505165016237275, 'ROUGE_L': 0.5156195389554695, 'CIDEr': 1.208860091055696}
[INFO: 2022-10-28 20:06:48,449] ######## Epoch (VAL)7 ########
[INFO: 2022-10-28 20:06:48,449] {'Bleu_1': 0.5823142043523342, 'Bleu_2': 0.5157077179734615, 'Bleu_3': 0.45451666870075275, 'Bleu_4': 0.3965634362032731, 'METEOR': 0.30084519786283853, 'ROUGE_L': 0.6044250680153603, 'CIDEr': 1.5061300810486584}
[INFO: 2022-10-28 20:07:04,352] ######## Epoch (TEST)7 ########
[INFO: 2022-10-28 20:07:04,352] {'Bleu_1': 0.6443693106704858, 'Bleu_2': 0.5819970013822897, 'Bleu_3': 0.5102992840459463, 'Bleu_4': 0.4345504331279644, 'METEOR': 0.31273785639977303, 'ROUGE_L': 0.6292675826452869, 'CIDEr': 1.5509198344217092}
[INFO: 2022-10-28 20:08:18,998] ######## Epoch (VAL)8 ########
[INFO: 2022-10-28 20:08:18,998] {'Bleu_1': 0.6334325105968296, 'Bleu_2': 0.5627327033228557, 'Bleu_3': 0.4966506667993273, 'Bleu_4': 0.43128757722155875, 'METEOR': 0.3178178696912213, 'ROUGE_L': 0.6197777335331714, 'CIDEr': 1.6559217033348894}
[INFO: 2022-10-28 20:08:34,822] ######## Epoch (TEST)8 ########
[INFO: 2022-10-28 20:08:34,823] {'Bleu_1': 0.6982849835913182, 'Bleu_2': 0.6394882711086207, 'Bleu_3': 0.5714607818956249, 'Bleu_4': 0.49667330701411366, 'METEOR': 0.34963752760464084, 'ROUGE_L': 0.6744254299447808, 'CIDEr': 1.8994019969749432}
[INFO: 2022-10-28 20:09:49,711] ######## Epoch (VAL)9 ########
[INFO: 2022-10-28 20:09:49,711] {'Bleu_1': 0.7512251032293072, 'Bleu_2': 0.6740963493353077, 'Bleu_3': 0.602418779238686, 'Bleu_4': 0.5339710343146875, 'METEOR': 0.357521564480531, 'ROUGE_L': 0.6542065260578414, 'CIDEr': 1.9996796816635902}
[INFO: 2022-10-28 20:10:06,289] ######## Epoch (TEST)9 ########
[INFO: 2022-10-28 20:10:06,290] {'Bleu_1': 0.7827426267145989, 'Bleu_2': 0.7170555282912947, 'Bleu_3': 0.6482836844188086, 'Bleu_4': 0.5787193279251427, 'METEOR': 0.3798598944998073, 'ROUGE_L': 0.6888648384213935, 'CIDEr': 2.1819990284920183}
[INFO: 2022-10-28 20:11:21,528] ######## Epoch (VAL)10 ########
[INFO: 2022-10-28 20:11:21,528] {'Bleu_1': 0.7353541454787236, 'Bleu_2': 0.6570286547770696, 'Bleu_3': 0.5838812869762444, 'Bleu_4': 0.5127727194121445, 'METEOR': 0.3541148249595496, 'ROUGE_L': 0.6421114713823298, 'CIDEr': 1.9723906451728705}
[INFO: 2022-10-28 20:11:37,462] ######## Epoch (TEST)10 ########
[INFO: 2022-10-28 20:11:37,462] {'Bleu_1': 0.802019400483566, 'Bleu_2': 0.7354451923075135, 'Bleu_3': 0.6605814397646728, 'Bleu_4': 0.5863460364463746, 'METEOR': 0.38318948739341685, 'ROUGE_L': 0.6906343438722202, 'CIDEr': 2.1853709827583776}
[INFO: 2022-10-28 20:12:52,066] ######## Epoch (VAL)11 ########
[INFO: 2022-10-28 20:12:52,066] {'Bleu_1': 0.7336323845576903, 'Bleu_2': 0.6557586902843084, 'Bleu_3': 0.581626336594425, 'Bleu_4': 0.5102656110927033, 'METEOR': 0.3571242123978149, 'ROUGE_L': 0.6448464498554053, 'CIDEr': 1.9534358802335556}
[INFO: 2022-10-28 20:13:08,224] ######## Epoch (TEST)11 ########
[INFO: 2022-10-28 20:13:08,224] {'Bleu_1': 0.8107855650266209, 'Bleu_2': 0.7426330946069181, 'Bleu_3': 0.6652599593244322, 'Bleu_4': 0.5893569973431767, 'METEOR': 0.380711568806534, 'ROUGE_L': 0.6864027932361897, 'CIDEr': 2.1717634749989823}
[INFO: 2022-10-28 20:14:23,362] ######## Epoch (VAL)12 ########
[INFO: 2022-10-28 20:14:23,363] {'Bleu_1': 0.7525632719752725, 'Bleu_2': 0.6767916210043231, 'Bleu_3': 0.6065100138910856, 'Bleu_4': 0.5403234374547131, 'METEOR': 0.3703797746037302, 'ROUGE_L': 0.6807043111730278, 'CIDEr': 2.185284347860118}
[INFO: 2022-10-28 20:14:39,320] ######## Epoch (TEST)12 ########
[INFO: 2022-10-28 20:14:39,321] {'Bleu_1': 0.814319606902811, 'Bleu_2': 0.7384206584342311, 'Bleu_3': 0.6508925658308333, 'Bleu_4': 0.5671005096023234, 'METEOR': 0.39042329794677977, 'ROUGE_L': 0.7011468016912543, 'CIDEr': 2.14303240099967}
[INFO: 2022-10-28 20:15:54,025] ######## Epoch (VAL)13 ########
[INFO: 2022-10-28 20:15:54,025] {'Bleu_1': 0.7260187255746556, 'Bleu_2': 0.6389105753192449, 'Bleu_3': 0.5667025626613129, 'Bleu_4': 0.5005757154936309, 'METEOR': 0.360833063207193, 'ROUGE_L': 0.6648027297011032, 'CIDEr': 2.0866757132884777}
[INFO: 2022-10-28 20:16:10,143] ######## Epoch (TEST)13 ########
[INFO: 2022-10-28 20:16:10,144] {'Bleu_1': 0.7759882869681172, 'Bleu_2': 0.6796088789904708, 'Bleu_3': 0.5867623466598269, 'Bleu_4': 0.49882519569104933, 'METEOR': 0.3818447213976041, 'ROUGE_L': 0.6836596494307579, 'CIDEr': 2.0680157188755417}
[INFO: 2022-10-28 20:17:25,014] ######## Epoch (VAL)14 ########
[INFO: 2022-10-28 20:17:25,014] {'Bleu_1': 0.7603732215606157, 'Bleu_2': 0.685842818368589, 'Bleu_3': 0.6165515493481392, 'Bleu_4': 0.5549224192920312, 'METEOR': 0.3722774032242202, 'ROUGE_L': 0.6808546594043831, 'CIDEr': 2.2962043857090024}
[INFO: 2022-10-28 20:17:41,565] ######## Epoch (TEST)14 ########
[INFO: 2022-10-28 20:17:41,565] {'Bleu_1': 0.8205499276399124, 'Bleu_2': 0.7369833260502668, 'Bleu_3': 0.6472068802922976, 'Bleu_4': 0.5632938576045219, 'METEOR': 0.3994969879137239, 'ROUGE_L': 0.7178307432114489, 'CIDEr': 2.187270287916273}
[INFO: 2022-10-28 20:18:56,167] ######## Epoch (VAL)15 ########
[INFO: 2022-10-28 20:18:56,168] {'Bleu_1': 0.7683163589660137, 'Bleu_2': 0.6931159917625774, 'Bleu_3': 0.6223352772348485, 'Bleu_4': 0.5573613540499142, 'METEOR': 0.3802662036202474, 'ROUGE_L': 0.6915091110489123, 'CIDEr': 2.303480347028155}
[INFO: 2022-10-28 20:19:12,145] ######## Epoch (TEST)15 ########
[INFO: 2022-10-28 20:19:12,146] {'Bleu_1': 0.82036775105966, 'Bleu_2': 0.73896490766267, 'Bleu_3': 0.6498386421161559, 'Bleu_4': 0.5650522971881231, 'METEOR': 0.40099996626989576, 'ROUGE_L': 0.7212869765192904, 'CIDEr': 2.2352770993143447}
[INFO: 2022-10-28 20:20:26,627] ######## Epoch (VAL)16 ########
[INFO: 2022-10-28 20:20:26,627] {'Bleu_1': 0.7720994475127457, 'Bleu_2': 0.691949710698374, 'Bleu_3': 0.6181903857722895, 'Bleu_4': 0.5512652635877824, 'METEOR': 0.3918886156834629, 'ROUGE_L': 0.7073685634849295, 'CIDEr': 2.4020470749004663}
[INFO: 2022-10-28 20:20:42,409] ######## Epoch (TEST)16 ########
[INFO: 2022-10-28 20:20:42,409] {'Bleu_1': 0.8172942817282883, 'Bleu_2': 0.7294158043053462, 'Bleu_3': 0.6420699600114548, 'Bleu_4': 0.559481615873061, 'METEOR': 0.4026877429403566, 'ROUGE_L': 0.723479491770483, 'CIDEr': 2.293650308404307}
[INFO: 2022-10-28 20:21:57,814] ######## Epoch (VAL)17 ########
[INFO: 2022-10-28 20:21:57,815] {'Bleu_1': 0.7596685082862435, 'Bleu_2': 0.6754682541270131, 'Bleu_3': 0.6042516971335798, 'Bleu_4': 0.5393781515236494, 'METEOR': 0.3813617939479066, 'ROUGE_L': 0.6891491148577584, 'CIDEr': 2.3845558040431807}
[INFO: 2022-10-28 20:22:15,418] ######## Epoch (TEST)17 ########
[INFO: 2022-10-28 20:22:15,418] {'Bleu_1': 0.8100407055619945, 'Bleu_2': 0.7245108150533284, 'Bleu_3': 0.6378406205271654, 'Bleu_4': 0.5557757812682481, 'METEOR': 0.40551274798104153, 'ROUGE_L': 0.7210119289551884, 'CIDEr': 2.3930662327159156}
[INFO: 2022-10-28 20:23:30,632] ######## Epoch (VAL)18 ########
[INFO: 2022-10-28 20:23:30,633] {'Bleu_1': 0.7752043596719684, 'Bleu_2': 0.6890249144245881, 'Bleu_3': 0.6137845571848117, 'Bleu_4': 0.545215764482933, 'METEOR': 0.3981715068430291, 'ROUGE_L': 0.7104424481430276, 'CIDEr': 2.4391964926730094}
[INFO: 2022-10-28 20:23:46,936] ######## Epoch (TEST)18 ########
[INFO: 2022-10-28 20:23:46,937] {'Bleu_1': 0.7994542974068221, 'Bleu_2': 0.7069702843618222, 'Bleu_3': 0.6184434615122671, 'Bleu_4': 0.5331880307024315, 'METEOR': 0.40931375127608227, 'ROUGE_L': 0.7260721459329412, 'CIDEr': 2.3503932974517356}
[INFO: 2022-10-28 20:25:01,714] ######## Epoch (VAL)19 ########
[INFO: 2022-10-28 20:25:01,714] {'Bleu_1': 0.7229104695975304, 'Bleu_2': 0.6420816845918759, 'Bleu_3': 0.5705036789382246, 'Bleu_4': 0.5031621652866648, 'METEOR': 0.3673965077979923, 'ROUGE_L': 0.6830416795721727, 'CIDEr': 2.186159494921159}
[INFO: 2022-10-28 20:25:18,066] ######## Epoch (TEST)19 ########
[INFO: 2022-10-28 20:25:18,066] {'Bleu_1': 0.8249221697854395, 'Bleu_2': 0.7437912353226322, 'Bleu_3': 0.6593928095017283, 'Bleu_4': 0.579150854696667, 'METEOR': 0.40977171224767334, 'ROUGE_L': 0.7404717428452073, 'CIDEr': 2.374799807033186}
[INFO: 2022-10-28 20:26:33,148] ######## Epoch (VAL)20 ########
[INFO: 2022-10-28 20:26:33,148] {'Bleu_1': 0.75174551239356, 'Bleu_2': 0.6708075856195171, 'Bleu_3': 0.5976788801212086, 'Bleu_4': 0.5335537275370079, 'METEOR': 0.36996589260803314, 'ROUGE_L': 0.6680294838613083, 'CIDEr': 2.2524444141297404}
[INFO: 2022-10-28 20:26:49,336] ######## Epoch (TEST)20 ########
[INFO: 2022-10-28 20:26:49,337] {'Bleu_1': 0.8086592178759656, 'Bleu_2': 0.7210078739847748, 'Bleu_3': 0.6353409166632408, 'Bleu_4': 0.555334061340833, 'METEOR': 0.4081954256281991, 'ROUGE_L': 0.727703316127026, 'CIDEr': 2.3438784150993843}
[INFO: 2022-10-28 20:32:28,227] Training with config:
[INFO: 2022-10-28 20:32:28,229] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mssydney/sent/sydney_train_input.pkl',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 8,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mssydney/sent/sydney_train_target.pkl',
                 'TEST_4W_ID': './mscoco/misc/ids2path_json/coco_test4w_ids2path.json',
                 'TEST_ATT_FEATS': './mssydney/feature/Sydney',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mssydney/misc/ids2path_json/sydney_val_ids2path.json',
                 'TRAIN_ATT_FEATS': './mssydney/feature/Sydney',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mssydney/misc/ids2path_json/sydney_train_ids2path.json',
                 'VAL_ATT_FEATS': './mssydney/feature/Sydney',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mssydney/misc/ids2path_json/sydney_test_ids2path.json'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 5,
               'CAP_KEY': 'caption',
               'COCO_PATH': './coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mssydney/misc/val_sydney.json',
               'VAL_ANNFILE': './mssydney/misc/test_sydney.json',
               'VOCAB': './mssydney/txt/Sydney_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'CrossEntropy'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 1536,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 512,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 512,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [64, 32, 64],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 3,
                        'DIM': 512,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [64, 32, 64],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.1,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 3,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.1,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.1,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 1536,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 512,
           'SEQ_LEN': 24,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'PureT',
           'VOCAB_SIZE': 181,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 512,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'MAX_LEN': 'MAX_LEN',
           'MULCLASS': 'MULCLASS',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments_PureT/PureT_XE_Sydney/',
 'SCORER': {'CIDER_CACHED': './mssydney/misc/sydney_train_cider.pkl',
            'GT_PATH': './mssydney/misc/sydney_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1234.0,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 0.0005,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 512,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Noam',
                          'WARMUP': 10000},
            'MAX_EPOCH': 20,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2022-10-28 20:33:46,662] ######## Epoch (VAL)1 ########
[INFO: 2022-10-28 20:33:46,662] {'Bleu_1': 0.0, 'Bleu_2': 0.0, 'Bleu_3': 0.0, 'Bleu_4': 0.0, 'METEOR': 0.0, 'ROUGE_L': 0.0, 'CIDEr': 0.0}
[INFO: 2022-10-28 20:34:02,714] ######## Epoch (TEST)1 ########
[INFO: 2022-10-28 20:34:02,714] {'Bleu_1': 0.0, 'Bleu_2': 0.0, 'Bleu_3': 0.0, 'Bleu_4': 0.0, 'METEOR': 0.0, 'ROUGE_L': 0.0, 'CIDEr': 0.0}
[INFO: 2022-10-28 20:35:15,841] ######## Epoch (VAL)2 ########
[INFO: 2022-10-28 20:35:15,842] {'Bleu_1': 0.0, 'Bleu_2': 0.0, 'Bleu_3': 0.0, 'Bleu_4': 0.0, 'METEOR': 0.0, 'ROUGE_L': 0.0, 'CIDEr': 0.0}
[INFO: 2022-10-28 20:35:31,800] ######## Epoch (TEST)2 ########
[INFO: 2022-10-28 20:35:31,800] {'Bleu_1': 0.0, 'Bleu_2': 0.0, 'Bleu_3': 0.0, 'Bleu_4': 0.0, 'METEOR': 0.0, 'ROUGE_L': 0.0, 'CIDEr': 0.0}
[INFO: 2022-10-28 20:36:46,439] ######## Epoch (VAL)3 ########
[INFO: 2022-10-28 20:36:46,440] {'Bleu_1': 4.879432564511341e-10, 'Bleu_2': 4.980050007338246e-13, 'Bleu_3': 5.014048127833361e-14, 'Bleu_4': 1.590984305511095e-14, 'METEOR': 0.007884686460514968, 'ROUGE_L': 0.06422085727783935, 'CIDEr': 0.0028232006407572833}
[INFO: 2022-10-28 20:37:02,203] ######## Epoch (TEST)3 ########
[INFO: 2022-10-28 20:37:02,204] {'Bleu_1': 2.057813992563611e-13, 'Bleu_2': 2.1142028985997405e-16, 'Bleu_3': 2.133340508220505e-17, 'Bleu_4': 6.7766793676563784e-18, 'METEOR': 0.005722005880950489, 'ROUGE_L': 0.04700312712880278, 'CIDEr': 0.0048150346846095055}
[INFO: 2022-10-28 20:38:16,883] ######## Epoch (VAL)4 ########
[INFO: 2022-10-28 20:38:16,884] {'Bleu_1': 0.027853209666250975, 'Bleu_2': 0.025309367578462125, 'Bleu_3': 0.024286721854682967, 'Bleu_4': 3.922771155458988e-06, 'METEOR': 0.08805081303041955, 'ROUGE_L': 0.2752792844708028, 'CIDEr': 0.18550754203861067}
[INFO: 2022-10-28 20:38:33,144] ######## Epoch (TEST)4 ########
[INFO: 2022-10-28 20:38:33,145] {'Bleu_1': 0.035445433725774245, 'Bleu_2': 0.03158085752743317, 'Bleu_3': 0.03060530419687643, 'Bleu_4': 0.0010757130389251958, 'METEOR': 0.09038351753942532, 'ROUGE_L': 0.2568006479512542, 'CIDEr': 0.18129562886803002}
[INFO: 2022-10-28 20:39:47,418] ######## Epoch (VAL)5 ########
[INFO: 2022-10-28 20:39:47,418] {'Bleu_1': 0.12675565286510812, 'Bleu_2': 0.11171595322165905, 'Bleu_3': 0.10346209345180046, 'Bleu_4': 0.09207056023941262, 'METEOR': 0.12959848994663828, 'ROUGE_L': 0.3614124368695886, 'CIDEr': 0.5735310648545279}
[INFO: 2022-10-28 20:40:03,464] ######## Epoch (TEST)5 ########
[INFO: 2022-10-28 20:40:03,465] {'Bleu_1': 0.12283805349904188, 'Bleu_2': 0.10871049501380933, 'Bleu_3': 0.0999103216247639, 'Bleu_4': 0.08916734705270178, 'METEOR': 0.12705433670038907, 'ROUGE_L': 0.3364633357756747, 'CIDEr': 0.5782209013124796}
[INFO: 2022-10-28 20:41:17,570] ######## Epoch (VAL)6 ########
[INFO: 2022-10-28 20:41:17,570] {'Bleu_1': 0.3996663115552484, 'Bleu_2': 0.3552152189445653, 'Bleu_3': 0.31713549369974176, 'Bleu_4': 0.28181795238639645, 'METEOR': 0.21334193583659425, 'ROUGE_L': 0.4828584020509157, 'CIDEr': 1.2752453814456082}
[INFO: 2022-10-28 20:41:33,857] ######## Epoch (TEST)6 ########
[INFO: 2022-10-28 20:41:33,858] {'Bleu_1': 0.4323645727788384, 'Bleu_2': 0.3990717004949988, 'Bleu_3': 0.36074401503430537, 'Bleu_4': 0.3155177589497805, 'METEOR': 0.22421737394017827, 'ROUGE_L': 0.5073853276365929, 'CIDEr': 1.2064248489380156}
[INFO: 2022-10-28 20:42:48,817] ######## Epoch (VAL)7 ########
[INFO: 2022-10-28 20:42:48,817] {'Bleu_1': 0.7339430106941366, 'Bleu_2': 0.6651361045166462, 'Bleu_3': 0.6025103731709062, 'Bleu_4': 0.5449515792577858, 'METEOR': 0.3512044071942201, 'ROUGE_L': 0.6549499943951027, 'CIDEr': 2.003336072245278}
[INFO: 2022-10-28 20:43:06,011] ######## Epoch (TEST)7 ########
[INFO: 2022-10-28 20:43:06,011] {'Bleu_1': 0.723374939388656, 'Bleu_2': 0.6533585826791091, 'Bleu_3': 0.5790430535124709, 'Bleu_4': 0.5095970616584895, 'METEOR': 0.3322604978684697, 'ROUGE_L': 0.6371986622227337, 'CIDEr': 1.7289608073218132}
[INFO: 2022-10-28 20:44:20,535] ######## Epoch (VAL)8 ########
[INFO: 2022-10-28 20:44:20,536] {'Bleu_1': 0.6829669205799148, 'Bleu_2': 0.6121818623229787, 'Bleu_3': 0.5440426111093315, 'Bleu_4': 0.4816808573061869, 'METEOR': 0.32806933766503105, 'ROUGE_L': 0.606208836055457, 'CIDEr': 1.718018030754521}
[INFO: 2022-10-28 20:44:36,579] ######## Epoch (TEST)8 ########
[INFO: 2022-10-28 20:44:36,579] {'Bleu_1': 0.7356058530766473, 'Bleu_2': 0.6658566434813277, 'Bleu_3': 0.5954237007167463, 'Bleu_4': 0.5244125235295553, 'METEOR': 0.35857357133823853, 'ROUGE_L': 0.6476961299948641, 'CIDEr': 1.8391635918450697}
[INFO: 2022-10-28 20:45:51,073] ######## Epoch (VAL)9 ########
[INFO: 2022-10-28 20:45:51,073] {'Bleu_1': 0.7371935858309542, 'Bleu_2': 0.6569674322011627, 'Bleu_3': 0.584634347030416, 'Bleu_4': 0.5163128027937037, 'METEOR': 0.34862153894194076, 'ROUGE_L': 0.6437491094581367, 'CIDEr': 1.9456832063366136}
[INFO: 2022-10-28 20:46:07,491] ######## Epoch (TEST)9 ########
[INFO: 2022-10-28 20:46:07,492] {'Bleu_1': 0.7955416086108293, 'Bleu_2': 0.7285437940443044, 'Bleu_3': 0.6582265521209677, 'Bleu_4': 0.5868069203490258, 'METEOR': 0.3862902757734082, 'ROUGE_L': 0.7003580302523766, 'CIDEr': 2.2394137569694843}
[INFO: 2022-10-28 20:47:22,682] ######## Epoch (VAL)10 ########
[INFO: 2022-10-28 20:47:22,682] {'Bleu_1': 0.736259054949474, 'Bleu_2': 0.649113054816871, 'Bleu_3': 0.5737459190309221, 'Bleu_4': 0.5031958328078082, 'METEOR': 0.34368126871793164, 'ROUGE_L': 0.6348531298445045, 'CIDEr': 1.915903306017512}
[INFO: 2022-10-28 20:47:38,910] ######## Epoch (TEST)10 ########
[INFO: 2022-10-28 20:47:38,911] {'Bleu_1': 0.8029028828220078, 'Bleu_2': 0.736378407567794, 'Bleu_3': 0.6624282959263783, 'Bleu_4': 0.5873412413279944, 'METEOR': 0.39002747745810434, 'ROUGE_L': 0.703336254934267, 'CIDEr': 2.2717386719409407}
[INFO: 2022-10-28 20:48:53,603] ######## Epoch (VAL)11 ########
[INFO: 2022-10-28 20:48:53,604] {'Bleu_1': 0.7457643372337539, 'Bleu_2': 0.6623641761440403, 'Bleu_3': 0.5860772163946283, 'Bleu_4': 0.5125791137050195, 'METEOR': 0.35474362821199346, 'ROUGE_L': 0.649461790207367, 'CIDEr': 1.9739315272034355}
[INFO: 2022-10-28 20:49:10,051] ######## Epoch (TEST)11 ########
[INFO: 2022-10-28 20:49:10,052] {'Bleu_1': 0.8126870836462688, 'Bleu_2': 0.7448022451112785, 'Bleu_3': 0.6691268690481107, 'Bleu_4': 0.5942694537785835, 'METEOR': 0.387097559319606, 'ROUGE_L': 0.701399660748039, 'CIDEr': 2.206058342172164}
[INFO: 2022-10-28 20:50:25,302] ######## Epoch (VAL)12 ########
[INFO: 2022-10-28 20:50:25,303] {'Bleu_1': 0.7591772985722133, 'Bleu_2': 0.6815616918115827, 'Bleu_3': 0.6118909201428875, 'Bleu_4': 0.549328772147397, 'METEOR': 0.36896369745199403, 'ROUGE_L': 0.6823246262137806, 'CIDEr': 2.229727793092357}
[INFO: 2022-10-28 20:50:41,830] ######## Epoch (TEST)12 ########
[INFO: 2022-10-28 20:50:41,831] {'Bleu_1': 0.8134863701566521, 'Bleu_2': 0.7320921654474722, 'Bleu_3': 0.6436025304512998, 'Bleu_4': 0.5607745783305229, 'METEOR': 0.4021724785120928, 'ROUGE_L': 0.7145592687384772, 'CIDEr': 2.1934678302160533}
[INFO: 2022-10-28 20:51:56,977] ######## Epoch (VAL)13 ########
[INFO: 2022-10-28 20:51:56,977] {'Bleu_1': 0.7359179171078749, 'Bleu_2': 0.6519742247767535, 'Bleu_3': 0.5826860064446964, 'Bleu_4': 0.520932102452491, 'METEOR': 0.3613110193349685, 'ROUGE_L': 0.6655565376157507, 'CIDEr': 2.1093844576453367}
[INFO: 2022-10-28 20:52:13,078] ######## Epoch (TEST)13 ########
[INFO: 2022-10-28 20:52:13,079] {'Bleu_1': 0.7621145374438149, 'Bleu_2': 0.6654575931441638, 'Bleu_3': 0.5753509906350244, 'Bleu_4': 0.48963281546002857, 'METEOR': 0.3727558449097638, 'ROUGE_L': 0.6663093280512978, 'CIDEr': 2.0217495173141122}
[INFO: 2022-10-28 20:53:27,932] ######## Epoch (VAL)14 ########
[INFO: 2022-10-28 20:53:27,933] {'Bleu_1': 0.7558945908449988, 'Bleu_2': 0.6761546528143206, 'Bleu_3': 0.6056587731784078, 'Bleu_4': 0.5429722333994734, 'METEOR': 0.38273838188595355, 'ROUGE_L': 0.6930339978023705, 'CIDEr': 2.360745452944456}
[INFO: 2022-10-28 20:53:44,332] ######## Epoch (TEST)14 ########
[INFO: 2022-10-28 20:53:44,332] {'Bleu_1': 0.8172661870491839, 'Bleu_2': 0.7323188115406426, 'Bleu_3': 0.6444757093499357, 'Bleu_4': 0.561157551147928, 'METEOR': 0.4000208339656254, 'ROUGE_L': 0.720322118759409, 'CIDEr': 2.2208507813111145}
[INFO: 2022-10-28 20:54:58,664] ######## Epoch (VAL)15 ########
[INFO: 2022-10-28 20:54:58,665] {'Bleu_1': 0.7806564233394748, 'Bleu_2': 0.7048845534467986, 'Bleu_3': 0.6356490087561562, 'Bleu_4': 0.5733141613260925, 'METEOR': 0.3788838557238981, 'ROUGE_L': 0.7014002716329929, 'CIDEr': 2.394955525803639}
[INFO: 2022-10-28 20:55:14,872] ######## Epoch (TEST)15 ########
[INFO: 2022-10-28 20:55:14,873] {'Bleu_1': 0.820402298849396, 'Bleu_2': 0.732269798228487, 'Bleu_3': 0.6448183922323172, 'Bleu_4': 0.5618376890044605, 'METEOR': 0.3997637137876901, 'ROUGE_L': 0.7140712924684576, 'CIDEr': 2.2106057285970193}
[INFO: 2022-10-28 20:56:29,882] ######## Epoch (VAL)16 ########
[INFO: 2022-10-28 20:56:29,882] {'Bleu_1': 0.7801120448157419, 'Bleu_2': 0.7067262411365922, 'Bleu_3': 0.6414499530477581, 'Bleu_4': 0.5809150439780826, 'METEOR': 0.4024602951080387, 'ROUGE_L': 0.7186661029066244, 'CIDEr': 2.5874171067039966}
[INFO: 2022-10-28 20:56:46,104] ######## Epoch (TEST)16 ########
[INFO: 2022-10-28 20:56:46,105] {'Bleu_1': 0.8212290502781826, 'Bleu_2': 0.7283056348973609, 'Bleu_3': 0.6381769882139635, 'Bleu_4': 0.5551014106569063, 'METEOR': 0.40986588006791613, 'ROUGE_L': 0.7270235784256021, 'CIDEr': 2.3084792626359065}
[INFO: 2022-10-28 20:58:01,358] ######## Epoch (VAL)17 ########
[INFO: 2022-10-28 20:58:01,359] {'Bleu_1': 0.7569832402224065, 'Bleu_2': 0.6681070400992367, 'Bleu_3': 0.5962960080599767, 'Bleu_4': 0.5327990108839317, 'METEOR': 0.3813449691549248, 'ROUGE_L': 0.6922215381679149, 'CIDEr': 2.2730663769183543}
[INFO: 2022-10-28 20:58:17,998] ######## Epoch (TEST)17 ########
[INFO: 2022-10-28 20:58:17,999] {'Bleu_1': 0.8085991678213473, 'Bleu_2': 0.7224898751183918, 'Bleu_3': 0.6387119372111758, 'Bleu_4': 0.5576426118256907, 'METEOR': 0.41626101638729135, 'ROUGE_L': 0.7244896599244813, 'CIDEr': 2.463940720986182}
[INFO: 2022-10-28 20:59:33,075] ######## Epoch (VAL)18 ########
[INFO: 2022-10-28 20:59:33,076] {'Bleu_1': 0.7558299039770153, 'Bleu_2': 0.6737570123032812, 'Bleu_3': 0.6063232275232178, 'Bleu_4': 0.5476674289488421, 'METEOR': 0.39594457474815203, 'ROUGE_L': 0.7083995717775405, 'CIDEr': 2.5258932372436}
[INFO: 2022-10-28 20:59:49,247] ######## Epoch (TEST)18 ########
[INFO: 2022-10-28 20:59:49,247] {'Bleu_1': 0.8011126564662016, 'Bleu_2': 0.7092022669313252, 'Bleu_3': 0.6223579672387788, 'Bleu_4': 0.5426191072261712, 'METEOR': 0.41159457729319254, 'ROUGE_L': 0.7296500223159278, 'CIDEr': 2.3611358170890795}
[INFO: 2022-10-28 21:01:04,460] ######## Epoch (VAL)19 ########
[INFO: 2022-10-28 21:01:04,461] {'Bleu_1': 0.7562069917096126, 'Bleu_2': 0.6790260307833748, 'Bleu_3': 0.6122923198328017, 'Bleu_4': 0.5525328547720182, 'METEOR': 0.38968390367232913, 'ROUGE_L': 0.7061263826725974, 'CIDEr': 2.4746488287431276}
[INFO: 2022-10-28 21:01:20,877] ######## Epoch (TEST)19 ########
[INFO: 2022-10-28 21:01:20,878] {'Bleu_1': 0.8274894810647581, 'Bleu_2': 0.7497916444156364, 'Bleu_3': 0.6739019931832493, 'Bleu_4': 0.6024518753026296, 'METEOR': 0.4333509707133438, 'ROUGE_L': 0.7638339690372598, 'CIDEr': 2.713803107115035}
[INFO: 2022-10-28 21:02:37,088] ######## Epoch (VAL)20 ########
[INFO: 2022-10-28 21:02:37,088] {'Bleu_1': 0.7625698324001046, 'Bleu_2': 0.6825585166180432, 'Bleu_3': 0.6146104015991075, 'Bleu_4': 0.5559379529153625, 'METEOR': 0.38215511018924225, 'ROUGE_L': 0.6962433204521128, 'CIDEr': 2.4732931818034594}
[INFO: 2022-10-28 21:02:53,958] ######## Epoch (TEST)20 ########
[INFO: 2022-10-28 21:02:53,958] {'Bleu_1': 0.8467966573804362, 'Bleu_2': 0.7732333160949677, 'Bleu_3': 0.699081306426791, 'Bleu_4': 0.6288482819284846, 'METEOR': 0.4449108454200525, 'ROUGE_L': 0.7713478290518576, 'CIDEr': 2.9222651465916702}
[INFO: 2022-11-02 10:04:39,240] Training with config:
[INFO: 2022-11-02 10:04:39,246] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mssydney/sent/sydney_train_input.pkl',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 8,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mssydney/sent/sydney_train_target.pkl',
                 'TEST_4W_ID': './mscoco/misc/ids2path_json/coco_test4w_ids2path.json',
                 'TEST_ATT_FEATS': './mssydney/feature/Sydney',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mssydney/misc/ids2path_json/sydney_val_ids2path.json',
                 'TRAIN_ATT_FEATS': './mssydney/feature/Sydney',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mssydney/misc/ids2path_json/sydney_train_ids2path.json',
                 'VAL_ATT_FEATS': './mssydney/feature/Sydney',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mssydney/misc/ids2path_json/sydney_test_ids2path.json'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 5,
               'CAP_KEY': 'caption',
               'COCO_PATH': './coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mssydney/misc/val_sydney.json',
               'VAL_ANNFILE': './mssydney/misc/test_sydney.json',
               'VOCAB': './mssydney/txt/Sydney_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'CrossEntropy'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 1536,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 512,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 512,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [64, 32, 64],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 3,
                        'DIM': 512,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [64, 32, 64],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.1,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 3,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.1,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.1,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 1536,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 512,
           'SEQ_LEN': 24,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'PureT',
           'VOCAB_SIZE': 175,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 512,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'MAX_LEN': 'MAX_LEN',
           'MULCLASS': 'MULCLASS',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments_PureT/PureT_XE_Sydney/',
 'SCORER': {'CIDER_CACHED': './mssydney/misc/sydney_train_cider.pkl',
            'GT_PATH': './mssydney/misc/sydney_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1234.0,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 0.0005,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 512,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Noam',
                          'WARMUP': 10000},
            'MAX_EPOCH': 20,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2022-11-02 10:08:03,711] Training with config:
[INFO: 2022-11-02 10:08:03,713] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mssydney/sent/sydney_train_input.pkl',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 8,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mssydney/sent/sydney_train_target.pkl',
                 'TEST_4W_ID': './mscoco/misc/ids2path_json/coco_test4w_ids2path.json',
                 'TEST_ATT_FEATS': './mssydney/feature/Sydney',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mssydney/misc/ids2path_json/sydney_val_ids2path.json',
                 'TRAIN_ATT_FEATS': './mssydney/feature/Sydney',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mssydney/misc/ids2path_json/sydney_train_ids2path.json',
                 'VAL_ATT_FEATS': './mssydney/feature/Sydney',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mssydney/misc/ids2path_json/sydney_test_ids2path.json'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 5,
               'CAP_KEY': 'caption',
               'COCO_PATH': './coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mssydney/misc/val_sydney.json',
               'VAL_ANNFILE': './mssydney/misc/test_sydney.json',
               'VOCAB': './mssydney/txt/Sydney_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'CrossEntropy'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 1536,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 512,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 512,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [64, 32, 64],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 3,
                        'DIM': 512,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [64, 32, 64],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.1,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 3,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.1,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.1,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 1536,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 512,
           'SEQ_LEN': 24,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'PureT',
           'VOCAB_SIZE': 180,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 512,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'MAX_LEN': 'MAX_LEN',
           'MULCLASS': 'MULCLASS',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments_PureT/PureT_XE_Sydney/',
 'SCORER': {'CIDER_CACHED': './mssydney/misc/sydney_train_cider.pkl',
            'GT_PATH': './mssydney/misc/sydney_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1234.0,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 0.0005,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 512,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Noam',
                          'WARMUP': 10000},
            'MAX_EPOCH': 20,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2023-01-06 14:23:56,261] Training with config:
[INFO: 2023-01-06 14:23:56,273] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mssydney/sent/sydney_train_input.pkl',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 8,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mssydney/sent/sydney_train_target.pkl',
                 'TEST_4W_ID': './mscoco/misc/ids2path_json/coco_test4w_ids2path.json',
                 'TEST_ATT_FEATS': './mssydney/feature/Sydney',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mssydney/misc/ids2path_json/sydney_val_ids2path.json',
                 'TRAIN_ATT_FEATS': './mssydney/feature/Sydney',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mssydney/misc/ids2path_json/sydney_train_ids2path.json',
                 'VAL_ATT_FEATS': './mssydney/feature/Sydney',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mssydney/misc/ids2path_json/sydney_test_ids2path.json'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 5,
               'CAP_KEY': 'caption',
               'COCO_PATH': './coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mssydney/misc/val_sydney.json',
               'VAL_ANNFILE': './mssydney/misc/test_sydney.json',
               'VOCAB': './mssydney/txt/Sydney_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'CrossEntropy'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 1536,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 512,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 512,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [64, 32, 64],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 3,
                        'DIM': 512,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [64, 32, 64],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.1,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 3,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.1,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.1,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 1536,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 512,
           'SEQ_LEN': 24,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'PureT',
           'VOCAB_SIZE': 180,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 512,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'MAX_LEN': 'MAX_LEN',
           'MULCLASS': 'MULCLASS',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments_PureT/PureT_XE_Sydney/',
 'SCORER': {'CIDER_CACHED': './mssydney/misc/sydney_train_cider.pkl',
            'GT_PATH': './mssydney/misc/sydney_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1234.0,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 0.0005,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 512,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Noam',
                          'WARMUP': 10000},
            'MAX_EPOCH': 20,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2023-01-06 16:27:50,521] Training with config:
[INFO: 2023-01-06 16:27:50,532] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mssydney/sent/sydney_train_input.pkl',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 8,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mssydney/sent/sydney_train_target.pkl',
                 'TEST_4W_ID': './mscoco/misc/ids2path_json/coco_test4w_ids2path.json',
                 'TEST_ATT_FEATS': './mssydney/feature/Sydney',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mssydney/misc/ids2path_json/sydney_val_ids2path.json',
                 'TRAIN_ATT_FEATS': './mssydney/feature/Sydney',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mssydney/misc/ids2path_json/sydney_train_ids2path.json',
                 'VAL_ATT_FEATS': './mssydney/feature/Sydney',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mssydney/misc/ids2path_json/sydney_test_ids2path.json'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 5,
               'CAP_KEY': 'caption',
               'COCO_PATH': './coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mssydney/misc/val_sydney.json',
               'VAL_ANNFILE': './mssydney/misc/test_sydney.json',
               'VOCAB': './mssydney/txt/Sydney_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'CrossEntropy'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 1536,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 512,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 512,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [64, 32, 64],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 3,
                        'DIM': 512,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [64, 32, 64],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.1,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 3,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.1,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.1,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 1536,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 512,
           'SEQ_LEN': 24,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'PureT',
           'VOCAB_SIZE': 180,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 512,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'MAX_LEN': 'MAX_LEN',
           'MULCLASS': 'MULCLASS',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments_PureT/PureT_XE_Sydney/',
 'SCORER': {'CIDER_CACHED': './mssydney/misc/sydney_train_cider.pkl',
            'GT_PATH': './mssydney/misc/sydney_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1234.0,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 0.0005,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 512,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Noam',
                          'WARMUP': 10000},
            'MAX_EPOCH': 20,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2023-01-06 18:47:47,272] Training with config:
[INFO: 2023-01-06 18:47:47,284] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mssydney/sent/sydney_train_input.pkl',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 8,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mssydney/sent/sydney_train_target.pkl',
                 'TEST_4W_ID': './mscoco/misc/ids2path_json/coco_test4w_ids2path.json',
                 'TEST_ATT_FEATS': './mssydney/feature/Sydney',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mssydney/misc/ids2path_json/sydney_val_ids2path.json',
                 'TRAIN_ATT_FEATS': './mssydney/feature/Sydney',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mssydney/misc/ids2path_json/sydney_train_ids2path.json',
                 'VAL_ATT_FEATS': './mssydney/feature/Sydney',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mssydney/misc/ids2path_json/sydney_test_ids2path.json'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 5,
               'CAP_KEY': 'caption',
               'COCO_PATH': './coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mssydney/misc/val_sydney.json',
               'VAL_ANNFILE': './mssydney/misc/test_sydney.json',
               'VOCAB': './mssydney/txt/Sydney_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'CrossEntropy'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 1536,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 512,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 512,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [64, 32, 64],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 3,
                        'DIM': 512,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [64, 32, 64],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.1,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 3,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.1,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.1,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 1536,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 512,
           'SEQ_LEN': 24,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'PureT',
           'VOCAB_SIZE': 180,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 512,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'MAX_LEN': 'MAX_LEN',
           'MULCLASS': 'MULCLASS',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments_PureT/PureT_XE_Sydney/',
 'SCORER': {'CIDER_CACHED': './mssydney/misc/sydney_train_cider.pkl',
            'GT_PATH': './mssydney/misc/sydney_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1234.0,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 0.0005,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 512,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Noam',
                          'WARMUP': 10000},
            'MAX_EPOCH': 20,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2023-01-06 21:15:34,402] Training with config:
[INFO: 2023-01-06 21:15:34,414] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mssydney/sent/sydney_train_input.pkl',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 8,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mssydney/sent/sydney_train_target.pkl',
                 'TEST_4W_ID': './mscoco/misc/ids2path_json/coco_test4w_ids2path.json',
                 'TEST_ATT_FEATS': './mssydney/feature/Sydney',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mssydney/misc/ids2path_json/sydney_val_ids2path.json',
                 'TRAIN_ATT_FEATS': './mssydney/feature/Sydney',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mssydney/misc/ids2path_json/sydney_train_ids2path.json',
                 'VAL_ATT_FEATS': './mssydney/feature/Sydney',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mssydney/misc/ids2path_json/sydney_test_ids2path.json'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 5,
               'CAP_KEY': 'caption',
               'COCO_PATH': './coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mssydney/misc/val_sydney.json',
               'VAL_ANNFILE': './mssydney/misc/test_sydney.json',
               'VOCAB': './mssydney/txt/Sydney_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'CrossEntropy'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 1536,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 512,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 512,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [64, 32, 64],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 3,
                        'DIM': 512,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [64, 32, 64],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.1,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 3,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.1,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.1,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 1536,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 512,
           'SEQ_LEN': 24,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'PureT',
           'VOCAB_SIZE': 180,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 512,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'MAX_LEN': 'MAX_LEN',
           'MULCLASS': 'MULCLASS',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments_PureT/PureT_XE_Sydney/',
 'SCORER': {'CIDER_CACHED': './mssydney/misc/sydney_train_cider.pkl',
            'GT_PATH': './mssydney/misc/sydney_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1234.0,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 0.0005,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 512,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Noam',
                          'WARMUP': 10000},
            'MAX_EPOCH': 20,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2023-01-06 21:18:19,118] Training with config:
[INFO: 2023-01-06 21:18:19,130] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mssydney/sent/sydney_train_input.pkl',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 8,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mssydney/sent/sydney_train_target.pkl',
                 'TEST_4W_ID': './mscoco/misc/ids2path_json/coco_test4w_ids2path.json',
                 'TEST_ATT_FEATS': './mssydney/feature/Sydney',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mssydney/misc/ids2path_json/sydney_val_ids2path.json',
                 'TRAIN_ATT_FEATS': './mssydney/feature/Sydney',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mssydney/misc/ids2path_json/sydney_train_ids2path.json',
                 'VAL_ATT_FEATS': './mssydney/feature/Sydney',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mssydney/misc/ids2path_json/sydney_test_ids2path.json'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 5,
               'CAP_KEY': 'caption',
               'COCO_PATH': './coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mssydney/misc/val_sydney.json',
               'VAL_ANNFILE': './mssydney/misc/test_sydney.json',
               'VOCAB': './mssydney/txt/Sydney_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'CrossEntropy'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 1536,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 512,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 512,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [64, 32, 64],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 3,
                        'DIM': 512,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [64, 32, 64],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.1,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 3,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.1,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.1,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 1536,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 512,
           'SEQ_LEN': 24,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'PureT',
           'VOCAB_SIZE': 180,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 512,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'MAX_LEN': 'MAX_LEN',
           'MULCLASS': 'MULCLASS',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments_PureT/PureT_XE_Sydney/',
 'SCORER': {'CIDER_CACHED': './mssydney/misc/sydney_train_cider.pkl',
            'GT_PATH': './mssydney/misc/sydney_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1234.0,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 0.0005,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 512,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Noam',
                          'WARMUP': 10000},
            'MAX_EPOCH': 20,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2023-01-06 21:59:26,954] Training with config:
[INFO: 2023-01-06 21:59:26,965] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mssydney/sent/sydney_train_input.pkl',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 8,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mssydney/sent/sydney_train_target.pkl',
                 'TEST_4W_ID': './mscoco/misc/ids2path_json/coco_test4w_ids2path.json',
                 'TEST_ATT_FEATS': './mssydney/feature/Sydney',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mssydney/misc/ids2path_json/sydney_val_ids2path.json',
                 'TRAIN_ATT_FEATS': './mssydney/feature/Sydney',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mssydney/misc/ids2path_json/sydney_train_ids2path.json',
                 'VAL_ATT_FEATS': './mssydney/feature/Sydney',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mssydney/misc/ids2path_json/sydney_test_ids2path.json'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 5,
               'CAP_KEY': 'caption',
               'COCO_PATH': './coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mssydney/misc/val_sydney.json',
               'VAL_ANNFILE': './mssydney/misc/test_sydney.json',
               'VOCAB': './mssydney/txt/Sydney_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'CrossEntropy'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 1536,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 512,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 512,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [64, 32, 64],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 3,
                        'DIM': 512,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [64, 32, 64],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.1,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 3,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.1,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.1,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 1536,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 512,
           'SEQ_LEN': 24,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'PureT',
           'VOCAB_SIZE': 180,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 512,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'MAX_LEN': 'MAX_LEN',
           'MULCLASS': 'MULCLASS',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments_PureT/PureT_XE_Sydney/',
 'SCORER': {'CIDER_CACHED': './mssydney/misc/sydney_train_cider.pkl',
            'GT_PATH': './mssydney/misc/sydney_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1234.0,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 0.0005,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 512,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Noam',
                          'WARMUP': 10000},
            'MAX_EPOCH': 20,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2023-01-06 22:29:27,361] Training with config:
[INFO: 2023-01-06 22:29:27,373] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mssydney/sent/sydney_train_input.pkl',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 8,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mssydney/sent/sydney_train_target.pkl',
                 'TEST_4W_ID': './mscoco/misc/ids2path_json/coco_test4w_ids2path.json',
                 'TEST_ATT_FEATS': './mssydney/feature/Sydney',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mssydney/misc/ids2path_json/sydney_val_ids2path.json',
                 'TRAIN_ATT_FEATS': './mssydney/feature/Sydney',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mssydney/misc/ids2path_json/sydney_train_ids2path.json',
                 'VAL_ATT_FEATS': './mssydney/feature/Sydney',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mssydney/misc/ids2path_json/sydney_test_ids2path.json'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 5,
               'CAP_KEY': 'caption',
               'COCO_PATH': './coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mssydney/misc/val_sydney.json',
               'VAL_ANNFILE': './mssydney/misc/test_sydney.json',
               'VOCAB': './mssydney/txt/Sydney_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'CrossEntropy'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 1536,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 512,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 512,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [64, 32, 64],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 3,
                        'DIM': 512,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [64, 32, 64],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.1,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 3,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.1,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.1,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 1536,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 512,
           'SEQ_LEN': 24,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'PureT',
           'VOCAB_SIZE': 180,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 512,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'MAX_LEN': 'MAX_LEN',
           'MULCLASS': 'MULCLASS',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments_PureT/PureT_XE_Sydney/',
 'SCORER': {'CIDER_CACHED': './mssydney/misc/sydney_train_cider.pkl',
            'GT_PATH': './mssydney/misc/sydney_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1234.0,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 0.0005,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 512,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Noam',
                          'WARMUP': 10000},
            'MAX_EPOCH': 20,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2023-01-06 22:33:03,422] Training with config:
[INFO: 2023-01-06 22:33:03,433] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mssydney/sent/sydney_train_input.pkl',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 8,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mssydney/sent/sydney_train_target.pkl',
                 'TEST_4W_ID': './mscoco/misc/ids2path_json/coco_test4w_ids2path.json',
                 'TEST_ATT_FEATS': './mssydney/feature/Sydney',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mssydney/misc/ids2path_json/sydney_val_ids2path.json',
                 'TRAIN_ATT_FEATS': './mssydney/feature/Sydney',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mssydney/misc/ids2path_json/sydney_train_ids2path.json',
                 'VAL_ATT_FEATS': './mssydney/feature/Sydney',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mssydney/misc/ids2path_json/sydney_test_ids2path.json'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 5,
               'CAP_KEY': 'caption',
               'COCO_PATH': './coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mssydney/misc/val_sydney.json',
               'VAL_ANNFILE': './mssydney/misc/test_sydney.json',
               'VOCAB': './mssydney/txt/Sydney_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'CrossEntropy'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 1536,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 512,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 512,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [64, 32, 64],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 3,
                        'DIM': 512,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [64, 32, 64],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.1,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 3,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.1,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.1,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 1536,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 512,
           'SEQ_LEN': 24,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'PureT',
           'VOCAB_SIZE': 180,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 512,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'MAX_LEN': 'MAX_LEN',
           'MULCLASS': 'MULCLASS',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'REGION_FEATS_MASK': 'REGION_FEATS_MASK',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments_PureT/PureT_XE_Sydney/',
 'SCORER': {'CIDER_CACHED': './mssydney/misc/sydney_train_cider.pkl',
            'GT_PATH': './mssydney/misc/sydney_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1234.0,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 0.0005,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 512,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Noam',
                          'WARMUP': 10000},
            'MAX_EPOCH': 20,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2023-01-06 22:37:54,558] Training with config:
[INFO: 2023-01-06 22:37:54,570] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mssydney/sent/sydney_train_input.pkl',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 8,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mssydney/sent/sydney_train_target.pkl',
                 'TEST_4W_ID': './mscoco/misc/ids2path_json/coco_test4w_ids2path.json',
                 'TEST_ATT_FEATS': './mssydney/feature/Sydney',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mssydney/misc/ids2path_json/sydney_val_ids2path.json',
                 'TRAIN_ATT_FEATS': './mssydney/feature/Sydney',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mssydney/misc/ids2path_json/sydney_train_ids2path.json',
                 'VAL_ATT_FEATS': './mssydney/feature/Sydney',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mssydney/misc/ids2path_json/sydney_test_ids2path.json'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 5,
               'CAP_KEY': 'caption',
               'COCO_PATH': './coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mssydney/misc/val_sydney.json',
               'VAL_ANNFILE': './mssydney/misc/test_sydney.json',
               'VOCAB': './mssydney/txt/Sydney_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'CrossEntropy'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 1536,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 512,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 512,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [64, 32, 64],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 3,
                        'DIM': 512,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [64, 32, 64],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.1,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 3,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.1,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.1,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 1536,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 512,
           'SEQ_LEN': 24,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'PureT',
           'VOCAB_SIZE': 180,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 512,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'MAX_LEN': 'MAX_LEN',
           'MULCLASS': 'MULCLASS',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'REGION_FEATS_MASK': 'REGION_FEATS_MASK',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments_PureT/PureT_XE_Sydney/',
 'SCORER': {'CIDER_CACHED': './mssydney/misc/sydney_train_cider.pkl',
            'GT_PATH': './mssydney/misc/sydney_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1234.0,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 0.0005,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 512,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Noam',
                          'WARMUP': 10000},
            'MAX_EPOCH': 20,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2023-01-07 12:59:54,486] Training with config:
[INFO: 2023-01-07 12:59:54,498] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mssydney/sent/sydney_train_input.pkl',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 8,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mssydney/sent/sydney_train_target.pkl',
                 'TEST_4W_ID': './mscoco/misc/ids2path_json/coco_test4w_ids2path.json',
                 'TEST_ATT_FEATS': './mssydney/feature/Sydney',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mssydney/misc/ids2path_json/sydney_val_ids2path.json',
                 'TRAIN_ATT_FEATS': './mssydney/feature/Sydney',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mssydney/misc/ids2path_json/sydney_train_ids2path.json',
                 'VAL_ATT_FEATS': './mssydney/feature/Sydney',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mssydney/misc/ids2path_json/sydney_test_ids2path.json'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 5,
               'CAP_KEY': 'caption',
               'COCO_PATH': './coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mssydney/misc/val_sydney.json',
               'VAL_ANNFILE': './mssydney/misc/test_sydney.json',
               'VOCAB': './mssydney/txt/Sydney_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'CrossEntropy'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 1536,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 512,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 512,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [64, 32, 64],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 3,
                        'DIM': 512,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [64, 32, 64],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.1,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 3,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.1,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.1,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 1536,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 512,
           'SEQ_LEN': 24,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'PureT',
           'VOCAB_SIZE': 180,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 512,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'MAX_LEN': 'MAX_LEN',
           'MULCLASS': 'MULCLASS',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'REGION_FEATS_MASK': 'REGION_FEATS_MASK',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments_PureT/PureT_XE_Sydney/',
 'SCORER': {'CIDER_CACHED': './mssydney/misc/sydney_train_cider.pkl',
            'GT_PATH': './mssydney/misc/sydney_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1234.0,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 0.0005,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 512,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Noam',
                          'WARMUP': 10000},
            'MAX_EPOCH': 20,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2023-01-07 13:10:41,036] Training with config:
[INFO: 2023-01-07 13:10:41,047] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mssydney/sent/sydney_train_input.pkl',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 8,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mssydney/sent/sydney_train_target.pkl',
                 'TEST_4W_ID': './mscoco/misc/ids2path_json/coco_test4w_ids2path.json',
                 'TEST_ATT_FEATS': './mssydney/feature/Sydney',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mssydney/misc/ids2path_json/sydney_val_ids2path.json',
                 'TRAIN_ATT_FEATS': './mssydney/feature/Sydney',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mssydney/misc/ids2path_json/sydney_train_ids2path.json',
                 'VAL_ATT_FEATS': './mssydney/feature/Sydney',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mssydney/misc/ids2path_json/sydney_test_ids2path.json'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 5,
               'CAP_KEY': 'caption',
               'COCO_PATH': './coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mssydney/misc/val_sydney.json',
               'VAL_ANNFILE': './mssydney/misc/test_sydney.json',
               'VOCAB': './mssydney/txt/Sydney_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'CrossEntropy'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 1536,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 512,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 512,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [64, 32, 64],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 3,
                        'DIM': 512,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [64, 32, 64],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.1,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 3,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.1,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.1,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 1536,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 512,
           'SEQ_LEN': 24,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'PureT',
           'VOCAB_SIZE': 180,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 512,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'MAX_LEN': 'MAX_LEN',
           'MULCLASS': 'MULCLASS',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'REGION_FEATS_MASK': 'REGION_FEATS_MASK',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments_PureT/PureT_XE_Sydney/',
 'SCORER': {'CIDER_CACHED': './mssydney/misc/sydney_train_cider.pkl',
            'GT_PATH': './mssydney/misc/sydney_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1234.0,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 0.0005,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 512,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Noam',
                          'WARMUP': 10000},
            'MAX_EPOCH': 20,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2023-01-07 13:27:11,536] Training with config:
[INFO: 2023-01-07 13:27:11,551] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mssydney/sent/sydney_train_input.pkl',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 8,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mssydney/sent/sydney_train_target.pkl',
                 'TEST_4W_ID': './mscoco/misc/ids2path_json/coco_test4w_ids2path.json',
                 'TEST_ATT_FEATS': './mssydney/feature/Sydney',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mssydney/misc/ids2path_json/sydney_val_ids2path.json',
                 'TRAIN_ATT_FEATS': './mssydney/feature/Sydney',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mssydney/misc/ids2path_json/sydney_train_ids2path.json',
                 'VAL_ATT_FEATS': './mssydney/feature/Sydney',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mssydney/misc/ids2path_json/sydney_test_ids2path.json'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 5,
               'CAP_KEY': 'caption',
               'COCO_PATH': './coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mssydney/misc/val_sydney.json',
               'VAL_ANNFILE': './mssydney/misc/test_sydney.json',
               'VOCAB': './mssydney/txt/Sydney_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'CrossEntropy'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 1536,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 512,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 512,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [64, 32, 64],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 3,
                        'DIM': 512,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [64, 32, 64],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.1,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 3,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.1,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.1,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 1536,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 512,
           'SEQ_LEN': 24,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'PureT',
           'VOCAB_SIZE': 180,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 512,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'MAX_LEN': 'MAX_LEN',
           'MULCLASS': 'MULCLASS',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'REGION_FEATS_MASK': 'REGION_FEATS_MASK',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments_PureT/PureT_XE_Sydney/',
 'SCORER': {'CIDER_CACHED': './mssydney/misc/sydney_train_cider.pkl',
            'GT_PATH': './mssydney/misc/sydney_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1234.0,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 0.0005,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 512,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Noam',
                          'WARMUP': 10000},
            'MAX_EPOCH': 20,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2023-01-14 14:01:03,812] Training with config:
[INFO: 2023-01-14 14:01:03,824] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mssydney/sent/sydney_train_input.pkl',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 8,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mssydney/sent/sydney_train_target.pkl',
                 'TEST_4W_ID': './mscoco/misc/ids2path_json/coco_test4w_ids2path.json',
                 'TEST_ATT_FEATS': './mssydney/feature/Sydney',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mssydney/misc/ids2path_json/sydney_val_ids2path.json',
                 'TRAIN_ATT_FEATS': './mssydney/feature/Sydney',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mssydney/misc/ids2path_json/sydney_train_ids2path.json',
                 'VAL_ATT_FEATS': './mssydney/feature/Sydney',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mssydney/misc/ids2path_json/sydney_test_ids2path.json'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 5,
               'CAP_KEY': 'caption',
               'COCO_PATH': './coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mssydney/misc/val_sydney.json',
               'VAL_ANNFILE': './mssydney/misc/test_sydney.json',
               'VOCAB': './mssydney/txt/Sydney_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'CrossEntropy'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 1536,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 512,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 512,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [64, 32, 64],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 3,
                        'DIM': 512,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [64, 32, 64],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.1,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 3,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.1,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.1,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 1536,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 512,
           'SEQ_LEN': 24,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'PureT',
           'VOCAB_SIZE': 180,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 512,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'MAX_LEN': 'MAX_LEN',
           'MULCLASS': 'MULCLASS',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'REGION_FEATS_MASK': 'REGION_FEATS_MASK',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments_PureT/PureT_XE_Sydney/',
 'SCORER': {'CIDER_CACHED': './mssydney/misc/sydney_train_cider.pkl',
            'GT_PATH': './mssydney/misc/sydney_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1234.0,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 0.0005,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 512,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Noam',
                          'WARMUP': 10000},
            'MAX_EPOCH': 20,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2023-01-14 14:07:02,113] Training with config:
[INFO: 2023-01-14 14:07:02,125] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mssydney/sent/sydney_train_input.pkl',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 8,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mssydney/sent/sydney_train_target.pkl',
                 'TEST_4W_ID': './mscoco/misc/ids2path_json/coco_test4w_ids2path.json',
                 'TEST_ATT_FEATS': './mssydney/feature/Sydney',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mssydney/misc/ids2path_json/sydney_val_ids2path.json',
                 'TRAIN_ATT_FEATS': './mssydney/feature/Sydney',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mssydney/misc/ids2path_json/sydney_train_ids2path.json',
                 'VAL_ATT_FEATS': './mssydney/feature/Sydney',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mssydney/misc/ids2path_json/sydney_test_ids2path.json'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 5,
               'CAP_KEY': 'caption',
               'COCO_PATH': './coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mssydney/misc/val_sydney.json',
               'VAL_ANNFILE': './mssydney/misc/test_sydney.json',
               'VOCAB': './mssydney/txt/Sydney_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'CrossEntropy'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 1536,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 512,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 512,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [64, 32, 64],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 3,
                        'DIM': 512,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [64, 32, 64],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.1,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 3,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.1,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.1,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 1536,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 512,
           'SEQ_LEN': 24,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'PureT',
           'VOCAB_SIZE': 180,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 512,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'MAX_LEN': 'MAX_LEN',
           'MULCLASS': 'MULCLASS',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'REGION_FEATS_MASK': 'REGION_FEATS_MASK',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments_PureT/PureT_XE_Sydney/',
 'SCORER': {'CIDER_CACHED': './mssydney/misc/sydney_train_cider.pkl',
            'GT_PATH': './mssydney/misc/sydney_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1234.0,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 0.0005,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 512,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Noam',
                          'WARMUP': 10000},
            'MAX_EPOCH': 20,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2023-01-14 14:11:02,876] Training with config:
[INFO: 2023-01-14 14:11:02,888] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mssydney/sent/sydney_train_input.pkl',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 8,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mssydney/sent/sydney_train_target.pkl',
                 'TEST_4W_ID': './mscoco/misc/ids2path_json/coco_test4w_ids2path.json',
                 'TEST_ATT_FEATS': './mssydney/feature/Sydney',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mssydney/misc/ids2path_json/sydney_val_ids2path.json',
                 'TRAIN_ATT_FEATS': './mssydney/feature/Sydney',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mssydney/misc/ids2path_json/sydney_train_ids2path.json',
                 'VAL_ATT_FEATS': './mssydney/feature/Sydney',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mssydney/misc/ids2path_json/sydney_test_ids2path.json'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 5,
               'CAP_KEY': 'caption',
               'COCO_PATH': './coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mssydney/misc/val_sydney.json',
               'VAL_ANNFILE': './mssydney/misc/test_sydney.json',
               'VOCAB': './mssydney/txt/Sydney_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'CrossEntropy'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 1536,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 512,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 512,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [64, 32, 64],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 3,
                        'DIM': 512,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [64, 32, 64],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.1,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 3,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.1,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.1,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 1536,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 512,
           'SEQ_LEN': 24,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'PureT',
           'VOCAB_SIZE': 180,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 512,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'MAX_LEN': 'MAX_LEN',
           'MULCLASS': 'MULCLASS',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'REGION_FEATS_MASK': 'REGION_FEATS_MASK',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments_PureT/PureT_XE_Sydney/',
 'SCORER': {'CIDER_CACHED': './mssydney/misc/sydney_train_cider.pkl',
            'GT_PATH': './mssydney/misc/sydney_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1234.0,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 0.0005,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 512,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Noam',
                          'WARMUP': 10000},
            'MAX_EPOCH': 20,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2023-01-14 14:23:02,631] Training with config:
[INFO: 2023-01-14 14:23:02,643] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mssydney/sent/sydney_train_input.pkl',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 8,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mssydney/sent/sydney_train_target.pkl',
                 'TEST_4W_ID': './mscoco/misc/ids2path_json/coco_test4w_ids2path.json',
                 'TEST_ATT_FEATS': './mssydney/feature/Sydney',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mssydney/misc/ids2path_json/sydney_val_ids2path.json',
                 'TRAIN_ATT_FEATS': './mssydney/feature/Sydney',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mssydney/misc/ids2path_json/sydney_train_ids2path.json',
                 'VAL_ATT_FEATS': './mssydney/feature/Sydney',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mssydney/misc/ids2path_json/sydney_test_ids2path.json'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 5,
               'CAP_KEY': 'caption',
               'COCO_PATH': './coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mssydney/misc/val_sydney.json',
               'VAL_ANNFILE': './mssydney/misc/test_sydney.json',
               'VOCAB': './mssydney/txt/Sydney_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'CrossEntropy'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 1536,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 512,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 512,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [64, 32, 64],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 3,
                        'DIM': 512,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [64, 32, 64],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.1,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 3,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.1,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.1,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 1536,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 512,
           'SEQ_LEN': 24,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'PureT',
           'VOCAB_SIZE': 180,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 512,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'MAX_LEN': 'MAX_LEN',
           'MULCLASS': 'MULCLASS',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'REGION_FEATS_MASK': 'REGION_FEATS_MASK',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments_PureT/PureT_XE_Sydney/',
 'SCORER': {'CIDER_CACHED': './mssydney/misc/sydney_train_cider.pkl',
            'GT_PATH': './mssydney/misc/sydney_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1234.0,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 0.0005,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 512,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Noam',
                          'WARMUP': 10000},
            'MAX_EPOCH': 20,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2023-01-14 14:40:24,442] Training with config:
[INFO: 2023-01-14 14:40:24,453] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mssydney/sent/sydney_train_input.pkl',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 8,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mssydney/sent/sydney_train_target.pkl',
                 'TEST_4W_ID': './mscoco/misc/ids2path_json/coco_test4w_ids2path.json',
                 'TEST_ATT_FEATS': './mssydney/feature/Sydney',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mssydney/misc/ids2path_json/sydney_val_ids2path.json',
                 'TRAIN_ATT_FEATS': './mssydney/feature/Sydney',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mssydney/misc/ids2path_json/sydney_train_ids2path.json',
                 'VAL_ATT_FEATS': './mssydney/feature/Sydney',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mssydney/misc/ids2path_json/sydney_test_ids2path.json'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 5,
               'CAP_KEY': 'caption',
               'COCO_PATH': './coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mssydney/misc/val_sydney.json',
               'VAL_ANNFILE': './mssydney/misc/test_sydney.json',
               'VOCAB': './mssydney/txt/Sydney_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'CrossEntropy'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 1536,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 512,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 512,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [64, 32, 64],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 3,
                        'DIM': 512,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [64, 32, 64],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.1,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 3,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.1,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.1,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 1536,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 512,
           'SEQ_LEN': 24,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'PureT',
           'VOCAB_SIZE': 180,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 512,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'MAX_LEN': 'MAX_LEN',
           'MULCLASS': 'MULCLASS',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'REGION_FEATS_MASK': 'REGION_FEATS_MASK',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments_PureT/PureT_XE_Sydney/',
 'SCORER': {'CIDER_CACHED': './mssydney/misc/sydney_train_cider.pkl',
            'GT_PATH': './mssydney/misc/sydney_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1234.0,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 0.0005,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 512,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Noam',
                          'WARMUP': 10000},
            'MAX_EPOCH': 20,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2023-01-14 15:51:13,149] Training with config:
[INFO: 2023-01-14 15:51:13,162] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mssydney/sent/sydney_train_input.pkl',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 8,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mssydney/sent/sydney_train_target.pkl',
                 'TEST_4W_ID': './mscoco/misc/ids2path_json/coco_test4w_ids2path.json',
                 'TEST_ATT_FEATS': './mssydney/feature/Sydney',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mssydney/misc/ids2path_json/sydney_val_ids2path.json',
                 'TRAIN_ATT_FEATS': './mssydney/feature/Sydney',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mssydney/misc/ids2path_json/sydney_train_ids2path.json',
                 'VAL_ATT_FEATS': './mssydney/feature/Sydney',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mssydney/misc/ids2path_json/sydney_test_ids2path.json'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 5,
               'CAP_KEY': 'caption',
               'COCO_PATH': './coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mssydney/misc/val_sydney.json',
               'VAL_ANNFILE': './mssydney/misc/test_sydney.json',
               'VOCAB': './mssydney/txt/Sydney_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'CrossEntropy'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 1536,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 512,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 512,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [64, 32, 64],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 3,
                        'DIM': 512,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [64, 32, 64],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.1,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 3,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.1,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.1,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 1536,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 512,
           'SEQ_LEN': 24,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'PureT',
           'VOCAB_SIZE': 180,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 512,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'MAX_LEN': 'MAX_LEN',
           'MULCLASS': 'MULCLASS',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'REGION_FEATS_MASK': 'REGION_FEATS_MASK',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments_PureT/PureT_XE_Sydney/',
 'SCORER': {'CIDER_CACHED': './mssydney/misc/sydney_train_cider.pkl',
            'GT_PATH': './mssydney/misc/sydney_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1234.0,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 0.0005,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 512,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Noam',
                          'WARMUP': 10000},
            'MAX_EPOCH': 20,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2023-01-14 18:02:29,148] Training with config:
[INFO: 2023-01-14 18:02:29,160] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mssydney/sent/sydney_train_input.pkl',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 8,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mssydney/sent/sydney_train_target.pkl',
                 'TEST_4W_ID': './mscoco/misc/ids2path_json/coco_test4w_ids2path.json',
                 'TEST_ATT_FEATS': './mssydney/feature/Sydney',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mssydney/misc/ids2path_json/sydney_val_ids2path.json',
                 'TRAIN_ATT_FEATS': './mssydney/feature/Sydney',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mssydney/misc/ids2path_json/sydney_train_ids2path.json',
                 'VAL_ATT_FEATS': './mssydney/feature/Sydney',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mssydney/misc/ids2path_json/sydney_test_ids2path.json'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 5,
               'CAP_KEY': 'caption',
               'COCO_PATH': './coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mssydney/misc/val_sydney.json',
               'VAL_ANNFILE': './mssydney/misc/test_sydney.json',
               'VOCAB': './mssydney/txt/Sydney_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'CrossEntropy'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 1536,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 512,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 512,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [64, 32, 64],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 3,
                        'DIM': 512,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [64, 32, 64],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.1,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 3,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.1,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.1,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 1536,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 512,
           'SEQ_LEN': 24,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'PureT',
           'VOCAB_SIZE': 180,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 512,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'MAX_LEN': 'MAX_LEN',
           'MULCLASS': 'MULCLASS',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'REGION_FEATS_MASK': 'REGION_FEATS_MASK',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments_PureT/PureT_XE_Sydney/',
 'SCORER': {'CIDER_CACHED': './mssydney/misc/sydney_train_cider.pkl',
            'GT_PATH': './mssydney/misc/sydney_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1234.0,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 0.0005,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 512,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Noam',
                          'WARMUP': 10000},
            'MAX_EPOCH': 20,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2023-01-14 18:22:26,205] Training with config:
[INFO: 2023-01-14 18:22:26,216] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mssydney/sent/sydney_train_input.pkl',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 8,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mssydney/sent/sydney_train_target.pkl',
                 'TEST_4W_ID': './mscoco/misc/ids2path_json/coco_test4w_ids2path.json',
                 'TEST_ATT_FEATS': './mssydney/feature/Sydney',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mssydney/misc/ids2path_json/sydney_val_ids2path.json',
                 'TRAIN_ATT_FEATS': './mssydney/feature/Sydney',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mssydney/misc/ids2path_json/sydney_train_ids2path.json',
                 'VAL_ATT_FEATS': './mssydney/feature/Sydney',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mssydney/misc/ids2path_json/sydney_test_ids2path.json'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 5,
               'CAP_KEY': 'caption',
               'COCO_PATH': './coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mssydney/misc/val_sydney.json',
               'VAL_ANNFILE': './mssydney/misc/test_sydney.json',
               'VOCAB': './mssydney/txt/Sydney_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'CrossEntropy'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 1536,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 512,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 512,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [64, 32, 64],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 3,
                        'DIM': 512,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [64, 32, 64],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.1,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 3,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.1,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.1,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 1536,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 512,
           'SEQ_LEN': 24,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'PureT',
           'VOCAB_SIZE': 180,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 512,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'MAX_LEN': 'MAX_LEN',
           'MULCLASS': 'MULCLASS',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'REGION_FEATS_MASK': 'REGION_FEATS_MASK',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments_PureT/PureT_XE_Sydney/',
 'SCORER': {'CIDER_CACHED': './mssydney/misc/sydney_train_cider.pkl',
            'GT_PATH': './mssydney/misc/sydney_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1234.0,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 0.0005,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 512,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Noam',
                          'WARMUP': 10000},
            'MAX_EPOCH': 20,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2023-01-14 18:35:14,991] Training with config:
[INFO: 2023-01-14 18:35:15,002] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mssydney/sent/sydney_train_input.pkl',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 8,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mssydney/sent/sydney_train_target.pkl',
                 'TEST_4W_ID': './mscoco/misc/ids2path_json/coco_test4w_ids2path.json',
                 'TEST_ATT_FEATS': './mssydney/feature/Sydney',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mssydney/misc/ids2path_json/sydney_val_ids2path.json',
                 'TRAIN_ATT_FEATS': './mssydney/feature/Sydney',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mssydney/misc/ids2path_json/sydney_train_ids2path.json',
                 'VAL_ATT_FEATS': './mssydney/feature/Sydney',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mssydney/misc/ids2path_json/sydney_test_ids2path.json'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 5,
               'CAP_KEY': 'caption',
               'COCO_PATH': './coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mssydney/misc/val_sydney.json',
               'VAL_ANNFILE': './mssydney/misc/test_sydney.json',
               'VOCAB': './mssydney/txt/Sydney_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'CrossEntropy'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 1536,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 512,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 512,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [64, 32, 64],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 3,
                        'DIM': 512,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [64, 32, 64],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.1,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 3,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.1,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.1,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 1536,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 512,
           'SEQ_LEN': 24,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'PureT',
           'VOCAB_SIZE': 180,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 512,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'MAX_LEN': 'MAX_LEN',
           'MULCLASS': 'MULCLASS',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'REGION_FEATS_MASK': 'REGION_FEATS_MASK',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments_PureT/PureT_XE_Sydney/',
 'SCORER': {'CIDER_CACHED': './mssydney/misc/sydney_train_cider.pkl',
            'GT_PATH': './mssydney/misc/sydney_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1234.0,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 0.0005,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 512,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Noam',
                          'WARMUP': 10000},
            'MAX_EPOCH': 20,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2023-01-17 14:48:28,474] Training with config:
[INFO: 2023-01-17 14:48:28,486] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mssydney/sent/sydney_train_input.pkl',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 8,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mssydney/sent/sydney_train_target.pkl',
                 'TEST_4W_ID': './mscoco/misc/ids2path_json/coco_test4w_ids2path.json',
                 'TEST_ATT_FEATS': './mssydney/feature/Sydney',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mssydney/misc/ids2path_json/sydney_val_ids2path.json',
                 'TRAIN_ATT_FEATS': './mssydney/feature/Sydney',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mssydney/misc/ids2path_json/sydney_train_ids2path.json',
                 'VAL_ATT_FEATS': './mssydney/feature/Sydney',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mssydney/misc/ids2path_json/sydney_test_ids2path.json'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 5,
               'CAP_KEY': 'caption',
               'COCO_PATH': './coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mssydney/misc/val_sydney.json',
               'VAL_ANNFILE': './mssydney/misc/test_sydney.json',
               'VOCAB': './mssydney/txt/Sydney_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'CrossEntropy'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 1536,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 512,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 512,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [64, 32, 64],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 3,
                        'DIM': 512,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [64, 32, 64],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.1,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 3,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.1,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.1,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 1536,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 512,
           'SEQ_LEN': 24,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'PureT',
           'VOCAB_SIZE': 180,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 512,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'MAX_LEN': 'MAX_LEN',
           'MULCLASS': 'MULCLASS',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'REGION_FEATS_MASK': 'REGION_FEATS_MASK',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments_PureT/PureT_XE_Sydney/',
 'SCORER': {'CIDER_CACHED': './mssydney/misc/sydney_train_cider.pkl',
            'GT_PATH': './mssydney/misc/sydney_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1234.0,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 0.0005,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 512,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Noam',
                          'WARMUP': 10000},
            'MAX_EPOCH': 20,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2023-01-17 14:51:35,306] Training with config:
[INFO: 2023-01-17 14:51:35,317] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mssydney/sent/sydney_train_input.pkl',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 8,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mssydney/sent/sydney_train_target.pkl',
                 'TEST_4W_ID': './mscoco/misc/ids2path_json/coco_test4w_ids2path.json',
                 'TEST_ATT_FEATS': './mssydney/feature/Sydney',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mssydney/misc/ids2path_json/sydney_val_ids2path.json',
                 'TRAIN_ATT_FEATS': './mssydney/feature/Sydney',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mssydney/misc/ids2path_json/sydney_train_ids2path.json',
                 'VAL_ATT_FEATS': './mssydney/feature/Sydney',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mssydney/misc/ids2path_json/sydney_test_ids2path.json'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 5,
               'CAP_KEY': 'caption',
               'COCO_PATH': './coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mssydney/misc/val_sydney.json',
               'VAL_ANNFILE': './mssydney/misc/test_sydney.json',
               'VOCAB': './mssydney/txt/Sydney_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'CrossEntropy'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 1536,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 512,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 512,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [64, 32, 64],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 3,
                        'DIM': 512,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [64, 32, 64],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.1,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 3,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.1,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.1,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 1536,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 512,
           'SEQ_LEN': 24,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'PureT',
           'VOCAB_SIZE': 180,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 512,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'MAX_LEN': 'MAX_LEN',
           'MULCLASS': 'MULCLASS',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'REGION_FEATS_MASK': 'REGION_FEATS_MASK',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments_PureT/PureT_XE_Sydney/',
 'SCORER': {'CIDER_CACHED': './mssydney/misc/sydney_train_cider.pkl',
            'GT_PATH': './mssydney/misc/sydney_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1234.0,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 0.0005,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 512,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Noam',
                          'WARMUP': 10000},
            'MAX_EPOCH': 20,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2023-01-17 15:34:52,486] Training with config:
[INFO: 2023-01-17 15:34:52,498] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mssydney/sent/sydney_train_input.pkl',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 8,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mssydney/sent/sydney_train_target.pkl',
                 'TEST_4W_ID': './mscoco/misc/ids2path_json/coco_test4w_ids2path.json',
                 'TEST_ATT_FEATS': './mssydney/feature/Sydney',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mssydney/misc/ids2path_json/sydney_val_ids2path.json',
                 'TRAIN_ATT_FEATS': './mssydney/feature/Sydney',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mssydney/misc/ids2path_json/sydney_train_ids2path.json',
                 'VAL_ATT_FEATS': './mssydney/feature/Sydney',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mssydney/misc/ids2path_json/sydney_test_ids2path.json'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 5,
               'CAP_KEY': 'caption',
               'COCO_PATH': './coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mssydney/misc/val_sydney.json',
               'VAL_ANNFILE': './mssydney/misc/test_sydney.json',
               'VOCAB': './mssydney/txt/Sydney_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'CrossEntropy'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 1536,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 512,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 512,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [64, 32, 64],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 3,
                        'DIM': 512,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [64, 32, 64],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.1,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 3,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.1,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.1,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 1536,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 512,
           'SEQ_LEN': 24,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'PureT',
           'VOCAB_SIZE': 180,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 512,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'MAX_LEN': 'MAX_LEN',
           'MULCLASS': 'MULCLASS',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'REGION_FEATS_MASK': 'REGION_FEATS_MASK',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments_PureT/PureT_XE_Sydney/',
 'SCORER': {'CIDER_CACHED': './mssydney/misc/sydney_train_cider.pkl',
            'GT_PATH': './mssydney/misc/sydney_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1234.0,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 0.0005,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 512,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Noam',
                          'WARMUP': 10000},
            'MAX_EPOCH': 20,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2023-01-17 15:51:46,371] Training with config:
[INFO: 2023-01-17 15:51:46,387] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mssydney/sent/sydney_train_input.pkl',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 8,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mssydney/sent/sydney_train_target.pkl',
                 'TEST_4W_ID': './mscoco/misc/ids2path_json/coco_test4w_ids2path.json',
                 'TEST_ATT_FEATS': './mssydney/feature/Sydney',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mssydney/misc/ids2path_json/sydney_val_ids2path.json',
                 'TRAIN_ATT_FEATS': './mssydney/feature/Sydney',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mssydney/misc/ids2path_json/sydney_train_ids2path.json',
                 'VAL_ATT_FEATS': './mssydney/feature/Sydney',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mssydney/misc/ids2path_json/sydney_test_ids2path.json'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 5,
               'CAP_KEY': 'caption',
               'COCO_PATH': './coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mssydney/misc/val_sydney.json',
               'VAL_ANNFILE': './mssydney/misc/test_sydney.json',
               'VOCAB': './mssydney/txt/Sydney_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'CrossEntropy'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 1536,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 512,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 512,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [64, 32, 64],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 3,
                        'DIM': 512,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [64, 32, 64],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.1,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 3,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.1,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.1,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 1536,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 512,
           'SEQ_LEN': 24,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'PureT',
           'VOCAB_SIZE': 180,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 512,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'MAX_LEN': 'MAX_LEN',
           'MULCLASS': 'MULCLASS',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'REGION_FEATS_MASK': 'REGION_FEATS_MASK',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments_PureT/PureT_XE_Sydney/',
 'SCORER': {'CIDER_CACHED': './mssydney/misc/sydney_train_cider.pkl',
            'GT_PATH': './mssydney/misc/sydney_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1234.0,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 0.0005,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 512,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Noam',
                          'WARMUP': 10000},
            'MAX_EPOCH': 20,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2023-01-17 16:20:45,179] Training with config:
[INFO: 2023-01-17 16:20:45,191] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mssydney/sent/sydney_train_input.pkl',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 8,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mssydney/sent/sydney_train_target.pkl',
                 'TEST_4W_ID': './mscoco/misc/ids2path_json/coco_test4w_ids2path.json',
                 'TEST_ATT_FEATS': './mssydney/feature/Sydney',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mssydney/misc/ids2path_json/sydney_val_ids2path.json',
                 'TRAIN_ATT_FEATS': './mssydney/feature/Sydney',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mssydney/misc/ids2path_json/sydney_train_ids2path.json',
                 'VAL_ATT_FEATS': './mssydney/feature/Sydney',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mssydney/misc/ids2path_json/sydney_test_ids2path.json'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 5,
               'CAP_KEY': 'caption',
               'COCO_PATH': './coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mssydney/misc/val_sydney.json',
               'VAL_ANNFILE': './mssydney/misc/test_sydney.json',
               'VOCAB': './mssydney/txt/Sydney_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'CrossEntropy'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 1536,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 512,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 512,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [64, 32, 64],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 3,
                        'DIM': 512,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [64, 32, 64],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.1,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 3,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.1,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.1,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 1536,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 512,
           'SEQ_LEN': 24,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'PureT',
           'VOCAB_SIZE': 180,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 512,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'MAX_LEN': 'MAX_LEN',
           'MULCLASS': 'MULCLASS',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'REGION_FEATS_MASK': 'REGION_FEATS_MASK',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments_PureT/PureT_XE_Sydney/',
 'SCORER': {'CIDER_CACHED': './mssydney/misc/sydney_train_cider.pkl',
            'GT_PATH': './mssydney/misc/sydney_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1234.0,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 0.0005,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 512,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Noam',
                          'WARMUP': 10000},
            'MAX_EPOCH': 20,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2023-01-17 16:26:09,944] Training with config:
[INFO: 2023-01-17 16:26:09,955] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mssydney/sent/sydney_train_input.pkl',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 8,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mssydney/sent/sydney_train_target.pkl',
                 'TEST_4W_ID': './mscoco/misc/ids2path_json/coco_test4w_ids2path.json',
                 'TEST_ATT_FEATS': './mssydney/feature/Sydney',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mssydney/misc/ids2path_json/sydney_val_ids2path.json',
                 'TRAIN_ATT_FEATS': './mssydney/feature/Sydney',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mssydney/misc/ids2path_json/sydney_train_ids2path.json',
                 'VAL_ATT_FEATS': './mssydney/feature/Sydney',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mssydney/misc/ids2path_json/sydney_test_ids2path.json'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 5,
               'CAP_KEY': 'caption',
               'COCO_PATH': './coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mssydney/misc/val_sydney.json',
               'VAL_ANNFILE': './mssydney/misc/test_sydney.json',
               'VOCAB': './mssydney/txt/Sydney_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'CrossEntropy'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 1536,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 512,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 512,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [64, 32, 64],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 3,
                        'DIM': 512,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [64, 32, 64],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.1,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 3,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.1,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.1,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 1536,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 512,
           'SEQ_LEN': 24,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'PureT',
           'VOCAB_SIZE': 180,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 512,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'MAX_LEN': 'MAX_LEN',
           'MULCLASS': 'MULCLASS',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'REGION_FEATS_MASK': 'REGION_FEATS_MASK',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments_PureT/PureT_XE_Sydney/',
 'SCORER': {'CIDER_CACHED': './mssydney/misc/sydney_train_cider.pkl',
            'GT_PATH': './mssydney/misc/sydney_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1234.0,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 0.0005,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 512,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Noam',
                          'WARMUP': 10000},
            'MAX_EPOCH': 20,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2023-01-17 16:46:24,204] Training with config:
[INFO: 2023-01-17 16:46:24,215] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mssydney/sent/sydney_train_input.pkl',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 8,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mssydney/sent/sydney_train_target.pkl',
                 'TEST_4W_ID': './mscoco/misc/ids2path_json/coco_test4w_ids2path.json',
                 'TEST_ATT_FEATS': './mssydney/feature/Sydney',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mssydney/misc/ids2path_json/sydney_val_ids2path.json',
                 'TRAIN_ATT_FEATS': './mssydney/feature/Sydney',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mssydney/misc/ids2path_json/sydney_train_ids2path.json',
                 'VAL_ATT_FEATS': './mssydney/feature/Sydney',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mssydney/misc/ids2path_json/sydney_test_ids2path.json'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 5,
               'CAP_KEY': 'caption',
               'COCO_PATH': './coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mssydney/misc/val_sydney.json',
               'VAL_ANNFILE': './mssydney/misc/test_sydney.json',
               'VOCAB': './mssydney/txt/Sydney_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'CrossEntropy'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 1536,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 512,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 512,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [64, 32, 64],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 3,
                        'DIM': 512,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [64, 32, 64],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.1,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 3,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.1,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.1,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 1536,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 512,
           'SEQ_LEN': 24,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'PureT',
           'VOCAB_SIZE': 180,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 512,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'MAX_LEN': 'MAX_LEN',
           'MULCLASS': 'MULCLASS',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'REGION_FEATS_MASK': 'REGION_FEATS_MASK',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments_PureT/PureT_XE_Sydney/',
 'SCORER': {'CIDER_CACHED': './mssydney/misc/sydney_train_cider.pkl',
            'GT_PATH': './mssydney/misc/sydney_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1234.0,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 0.0005,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 512,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Noam',
                          'WARMUP': 10000},
            'MAX_EPOCH': 20,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2023-01-17 16:53:21,425] Training with config:
[INFO: 2023-01-17 16:53:21,436] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mssydney/sent/sydney_train_input.pkl',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 8,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mssydney/sent/sydney_train_target.pkl',
                 'TEST_4W_ID': './mscoco/misc/ids2path_json/coco_test4w_ids2path.json',
                 'TEST_ATT_FEATS': './mssydney/feature/Sydney',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mssydney/misc/ids2path_json/sydney_val_ids2path.json',
                 'TRAIN_ATT_FEATS': './mssydney/feature/Sydney',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mssydney/misc/ids2path_json/sydney_train_ids2path.json',
                 'VAL_ATT_FEATS': './mssydney/feature/Sydney',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mssydney/misc/ids2path_json/sydney_test_ids2path.json'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 5,
               'CAP_KEY': 'caption',
               'COCO_PATH': './coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mssydney/misc/val_sydney.json',
               'VAL_ANNFILE': './mssydney/misc/test_sydney.json',
               'VOCAB': './mssydney/txt/Sydney_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'CrossEntropy'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 1536,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 512,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 512,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [64, 32, 64],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 3,
                        'DIM': 512,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [64, 32, 64],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.1,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 3,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.1,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.1,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 1536,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 512,
           'SEQ_LEN': 24,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'PureT',
           'VOCAB_SIZE': 180,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 512,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'MAX_LEN': 'MAX_LEN',
           'MULCLASS': 'MULCLASS',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'REGION_FEATS_MASK': 'REGION_FEATS_MASK',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments_PureT/PureT_XE_Sydney/',
 'SCORER': {'CIDER_CACHED': './mssydney/misc/sydney_train_cider.pkl',
            'GT_PATH': './mssydney/misc/sydney_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1234.0,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 0.0005,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 512,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Noam',
                          'WARMUP': 10000},
            'MAX_EPOCH': 20,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2023-01-17 16:56:29,066] Training with config:
[INFO: 2023-01-17 16:56:29,077] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mssydney/sent/sydney_train_input.pkl',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 8,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mssydney/sent/sydney_train_target.pkl',
                 'TEST_4W_ID': './mscoco/misc/ids2path_json/coco_test4w_ids2path.json',
                 'TEST_ATT_FEATS': './mssydney/feature/Sydney',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mssydney/misc/ids2path_json/sydney_val_ids2path.json',
                 'TRAIN_ATT_FEATS': './mssydney/feature/Sydney',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mssydney/misc/ids2path_json/sydney_train_ids2path.json',
                 'VAL_ATT_FEATS': './mssydney/feature/Sydney',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mssydney/misc/ids2path_json/sydney_test_ids2path.json'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 5,
               'CAP_KEY': 'caption',
               'COCO_PATH': './coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mssydney/misc/val_sydney.json',
               'VAL_ANNFILE': './mssydney/misc/test_sydney.json',
               'VOCAB': './mssydney/txt/Sydney_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'CrossEntropy'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 1536,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 512,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 512,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [64, 32, 64],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 3,
                        'DIM': 512,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [64, 32, 64],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.1,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 3,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.1,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.1,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 1536,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 512,
           'SEQ_LEN': 24,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'PureT',
           'VOCAB_SIZE': 180,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 512,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'MAX_LEN': 'MAX_LEN',
           'MULCLASS': 'MULCLASS',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'REGION_FEATS_MASK': 'REGION_FEATS_MASK',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments_PureT/PureT_XE_Sydney/',
 'SCORER': {'CIDER_CACHED': './mssydney/misc/sydney_train_cider.pkl',
            'GT_PATH': './mssydney/misc/sydney_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1234.0,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 0.0005,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 512,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Noam',
                          'WARMUP': 10000},
            'MAX_EPOCH': 20,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2023-02-16 21:17:36,564] Training with config:
[INFO: 2023-02-16 21:17:36,567] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mssydney/sent/sydney_train_input.pkl',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 8,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mssydney/sent/sydney_train_target.pkl',
                 'TEST_4W_ID': './mscoco/misc/ids2path_json/coco_test4w_ids2path.json',
                 'TEST_ATT_FEATS': './mssydney/feature/Sydney',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mssydney/misc/ids2path_json/sydney_val_ids2path.json',
                 'TRAIN_ATT_FEATS': './mssydney/feature/Sydney',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mssydney/misc/ids2path_json/sydney_train_ids2path.json',
                 'VAL_ATT_FEATS': './mssydney/feature/Sydney',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mssydney/misc/ids2path_json/sydney_test_ids2path.json'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 5,
               'CAP_KEY': 'caption',
               'COCO_PATH': './coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mssydney/misc/val_sydney.json',
               'VAL_ANNFILE': './mssydney/misc/test_sydney.json',
               'VOCAB': './mssydney/txt/Sydney_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'CrossEntropy'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 1536,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 512,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 512,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [64, 32, 64],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 3,
                        'DIM': 512,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [64, 32, 64],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.1,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 3,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.1,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.1,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 1536,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 512,
           'SEQ_LEN': 24,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'PureT',
           'VOCAB_SIZE': 180,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 512,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'MAX_LEN': 'MAX_LEN',
           'MULCLASS': 'MULCLASS',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'REGION_FEATS_MASK': 'REGION_FEATS_MASK',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments_PureT/PureT_XE_Sydney/',
 'SCORER': {'CIDER_CACHED': './mssydney/misc/sydney_train_cider.pkl',
            'GT_PATH': './mssydney/misc/sydney_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1234.0,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 0.0005,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 512,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Noam',
                          'WARMUP': 10000},
            'MAX_EPOCH': 20,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2023-02-17 10:35:00,450] Training with config:
[INFO: 2023-02-17 10:35:00,457] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mssydney/sent/sydney_train_input.pkl',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 8,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mssydney/sent/sydney_train_target.pkl',
                 'TEST_4W_ID': './mscoco/misc/ids2path_json/coco_test4w_ids2path.json',
                 'TEST_ATT_FEATS': './mssydney/feature/Sydney',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mssydney/misc/ids2path_json/sydney_val_ids2path.json',
                 'TRAIN_ATT_FEATS': './mssydney/feature/Sydney',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mssydney/misc/ids2path_json/sydney_train_ids2path.json',
                 'VAL_ATT_FEATS': './mssydney/feature/Sydney',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mssydney/misc/ids2path_json/sydney_test_ids2path.json'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 5,
               'CAP_KEY': 'caption',
               'COCO_PATH': './coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mssydney/misc/val_sydney.json',
               'VAL_ANNFILE': './mssydney/misc/test_sydney.json',
               'VOCAB': './mssydney/txt/Sydney_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'CrossEntropy'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 1536,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 512,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 512,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [64, 32, 64],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 3,
                        'DIM': 512,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [64, 32, 64],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.1,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 3,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.1,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.1,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 1536,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 512,
           'SEQ_LEN': 24,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'PureT',
           'VOCAB_SIZE': 180,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 512,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'MAX_LEN': 'MAX_LEN',
           'MULCLASS': 'MULCLASS',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments_PureT/PureT_XE_Sydney/',
 'SCORER': {'CIDER_CACHED': './mssydney/misc/sydney_train_cider.pkl',
            'GT_PATH': './mssydney/misc/sydney_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1234.0,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 0.0005,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 512,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Noam',
                          'WARMUP': 10000},
            'MAX_EPOCH': 20,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2023-02-17 11:19:31,601] Training with config:
[INFO: 2023-02-17 11:19:31,609] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mssydney/sent/sydney_train_input.pkl',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 8,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mssydney/sent/sydney_train_target.pkl',
                 'TEST_4W_ID': './mscoco/misc/ids2path_json/coco_test4w_ids2path.json',
                 'TEST_ATT_FEATS': './mssydney/feature/Sydney',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mssydney/misc/ids2path_json/sydney_val_ids2path.json',
                 'TRAIN_ATT_FEATS': './mssydney/feature/Sydney',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mssydney/misc/ids2path_json/sydney_train_ids2path.json',
                 'VAL_ATT_FEATS': './mssydney/feature/Sydney',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mssydney/misc/ids2path_json/sydney_test_ids2path.json'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 5,
               'CAP_KEY': 'caption',
               'COCO_PATH': './coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mssydney/misc/val_sydney.json',
               'VAL_ANNFILE': './mssydney/misc/test_sydney.json',
               'VOCAB': './mssydney/txt/Sydney_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'CrossEntropy'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 1536,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 512,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 512,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [64, 32, 64],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 3,
                        'DIM': 512,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [64, 32, 64],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.1,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 3,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.1,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.1,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 1536,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 512,
           'SEQ_LEN': 24,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'PureT',
           'VOCAB_SIZE': 180,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 512,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'MAX_LEN': 'MAX_LEN',
           'MULCLASS': 'MULCLASS',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments_PureT/PureT_XE_Sydney/',
 'SCORER': {'CIDER_CACHED': './mssydney/misc/sydney_train_cider.pkl',
            'GT_PATH': './mssydney/misc/sydney_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1234.0,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 0.0005,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 512,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Noam',
                          'WARMUP': 10000},
            'MAX_EPOCH': 20,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2023-02-17 11:30:21,857] Training with config:
[INFO: 2023-02-17 11:30:21,864] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mssydney/sent/sydney_train_input.pkl',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 8,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mssydney/sent/sydney_train_target.pkl',
                 'TEST_4W_ID': './mscoco/misc/ids2path_json/coco_test4w_ids2path.json',
                 'TEST_ATT_FEATS': './mssydney/feature/Sydney',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mssydney/misc/ids2path_json/sydney_val_ids2path.json',
                 'TRAIN_ATT_FEATS': './mssydney/feature/Sydney',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mssydney/misc/ids2path_json/sydney_train_ids2path.json',
                 'VAL_ATT_FEATS': './mssydney/feature/Sydney',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mssydney/misc/ids2path_json/sydney_test_ids2path.json'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 5,
               'CAP_KEY': 'caption',
               'COCO_PATH': './coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mssydney/misc/val_sydney.json',
               'VAL_ANNFILE': './mssydney/misc/test_sydney.json',
               'VOCAB': './mssydney/txt/Sydney_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'CrossEntropy'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 1536,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 512,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 512,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [64, 32, 64],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 3,
                        'DIM': 512,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [64, 32, 64],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.1,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 3,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.1,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.1,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 1536,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 512,
           'SEQ_LEN': 24,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'PureT',
           'VOCAB_SIZE': 180,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 512,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'MAX_LEN': 'MAX_LEN',
           'MULCLASS': 'MULCLASS',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments_PureT/PureT_XE_Sydney/',
 'SCORER': {'CIDER_CACHED': './mssydney/misc/sydney_train_cider.pkl',
            'GT_PATH': './mssydney/misc/sydney_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1234.0,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 0.0005,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 512,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Noam',
                          'WARMUP': 10000},
            'MAX_EPOCH': 20,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2023-02-17 11:30:31,365] Training with config:
[INFO: 2023-02-17 11:30:31,373] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mssydney/sent/sydney_train_input.pkl',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 8,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mssydney/sent/sydney_train_target.pkl',
                 'TEST_4W_ID': './mscoco/misc/ids2path_json/coco_test4w_ids2path.json',
                 'TEST_ATT_FEATS': './mssydney/feature/Sydney',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mssydney/misc/ids2path_json/sydney_val_ids2path.json',
                 'TRAIN_ATT_FEATS': './mssydney/feature/Sydney',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mssydney/misc/ids2path_json/sydney_train_ids2path.json',
                 'VAL_ATT_FEATS': './mssydney/feature/Sydney',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mssydney/misc/ids2path_json/sydney_test_ids2path.json'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 5,
               'CAP_KEY': 'caption',
               'COCO_PATH': './coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mssydney/misc/val_sydney.json',
               'VAL_ANNFILE': './mssydney/misc/test_sydney.json',
               'VOCAB': './mssydney/txt/Sydney_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'CrossEntropy'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 1536,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 512,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 512,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [64, 32, 64],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 3,
                        'DIM': 512,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [64, 32, 64],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.1,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 3,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.1,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.1,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 1536,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 512,
           'SEQ_LEN': 24,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'PureT',
           'VOCAB_SIZE': 180,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 512,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'MAX_LEN': 'MAX_LEN',
           'MULCLASS': 'MULCLASS',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments_PureT/PureT_XE_Sydney/',
 'SCORER': {'CIDER_CACHED': './mssydney/misc/sydney_train_cider.pkl',
            'GT_PATH': './mssydney/misc/sydney_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1234.0,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 0.0005,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 512,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Noam',
                          'WARMUP': 10000},
            'MAX_EPOCH': 20,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2023-02-17 11:49:15,514] Training with config:
[INFO: 2023-02-17 11:49:15,522] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mssydney/sent/sydney_train_input.pkl',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 8,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mssydney/sent/sydney_train_target.pkl',
                 'TEST_4W_ID': './mscoco/misc/ids2path_json/coco_test4w_ids2path.json',
                 'TEST_ATT_FEATS': './mssydney/feature/Sydney',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mssydney/misc/ids2path_json/sydney_val_ids2path.json',
                 'TRAIN_ATT_FEATS': './mssydney/feature/Sydney',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mssydney/misc/ids2path_json/sydney_train_ids2path.json',
                 'VAL_ATT_FEATS': './mssydney/feature/Sydney',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mssydney/misc/ids2path_json/sydney_test_ids2path.json'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 5,
               'CAP_KEY': 'caption',
               'COCO_PATH': './coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mssydney/misc/val_sydney.json',
               'VAL_ANNFILE': './mssydney/misc/test_sydney.json',
               'VOCAB': './mssydney/txt/Sydney_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'CrossEntropy'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 2048,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 512,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 512,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [64, 32, 64],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 3,
                        'DIM': 512,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [64, 32, 64],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.1,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 3,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.1,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.1,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 2048,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 512,
           'SEQ_LEN': 24,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'PureT',
           'VOCAB_SIZE': 175,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 512,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'MAX_LEN': 'MAX_LEN',
           'MULCLASS': 'MULCLASS',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments_PureT/PureT_XE_Sydney/',
 'SCORER': {'CIDER_CACHED': './mssydney/misc/sydney_train_cider.pkl',
            'GT_PATH': './mssydney/misc/sydney_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1234.0,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 0.0005,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 512,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Noam',
                          'WARMUP': 10000},
            'MAX_EPOCH': 20,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2023-02-17 11:54:12,557] Training with config:
[INFO: 2023-02-17 11:54:12,565] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mssydney/sent/sydney_train_input.pkl',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 8,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mssydney/sent/sydney_train_target.pkl',
                 'TEST_4W_ID': './mscoco/misc/ids2path_json/coco_test4w_ids2path.json',
                 'TEST_ATT_FEATS': './mssydney/feature/Sydney',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mssydney/misc/ids2path_json/sydney_val_ids2path.json',
                 'TRAIN_ATT_FEATS': './mssydney/feature/Sydney',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mssydney/misc/ids2path_json/sydney_train_ids2path.json',
                 'VAL_ATT_FEATS': './mssydney/feature/Sydney',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mssydney/misc/ids2path_json/sydney_test_ids2path.json'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 5,
               'CAP_KEY': 'caption',
               'COCO_PATH': './coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mssydney/misc/val_sydney.json',
               'VAL_ANNFILE': './mssydney/misc/test_sydney.json',
               'VOCAB': './mssydney/txt/Sydney_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'CrossEntropy'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 2048,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 512,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 512,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [64, 32, 64],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 3,
                        'DIM': 512,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [64, 32, 64],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.1,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 3,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.1,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.1,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 2048,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 512,
           'SEQ_LEN': 24,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'PureT',
           'VOCAB_SIZE': 175,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 512,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'MAX_LEN': 'MAX_LEN',
           'MULCLASS': 'MULCLASS',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments_PureT/PureT_XE_Sydney/',
 'SCORER': {'CIDER_CACHED': './mssydney/misc/sydney_train_cider.pkl',
            'GT_PATH': './mssydney/misc/sydney_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1234.0,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 0.0005,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 512,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Noam',
                          'WARMUP': 10000},
            'MAX_EPOCH': 20,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2023-02-21 20:56:26,937] Training with config:
[INFO: 2023-02-21 20:56:26,943] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mssydney/sent/sydney_train_input.pkl',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 8,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mssydney/sent/sydney_train_target.pkl',
                 'TEST_4W_ID': './mscoco/misc/ids2path_json/coco_test4w_ids2path.json',
                 'TEST_ATT_FEATS': './mssydney/feature/Sydney',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mssydney/misc/ids2path_json/sydney_val_ids2path.json',
                 'TRAIN_ATT_FEATS': './mssydney/feature/Sydney',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mssydney/misc/ids2path_json/sydney_train_ids2path.json',
                 'VAL_ATT_FEATS': './mssydney/feature/Sydney',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mssydney/misc/ids2path_json/sydney_test_ids2path.json'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 5,
               'CAP_KEY': 'caption',
               'COCO_PATH': './coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mssydney/misc/val_sydney.json',
               'VAL_ANNFILE': './mssydney/misc/test_sydney.json',
               'VOCAB': './mssydney/txt/Sydney_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'CrossEntropy'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 2048,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 512,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 512,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [64, 32, 64],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 3,
                        'DIM': 512,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [64, 32, 64],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.1,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 3,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.1,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.1,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 2048,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 512,
           'SEQ_LEN': 24,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'PureT',
           'VOCAB_SIZE': 175,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 512,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'MAX_LEN': 'MAX_LEN',
           'MULCLASS': 'MULCLASS',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments_PureT/PureT_XE_Sydney/',
 'SCORER': {'CIDER_CACHED': './mssydney/misc/sydney_train_cider.pkl',
            'GT_PATH': './mssydney/misc/sydney_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1234.0,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 0.0005,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 512,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Noam',
                          'WARMUP': 10000},
            'MAX_EPOCH': 20,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2023-02-21 20:57:04,908] Training with config:
[INFO: 2023-02-21 20:57:04,912] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mssydney/sent/sydney_train_input.pkl',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 8,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mssydney/sent/sydney_train_target.pkl',
                 'TEST_4W_ID': './mscoco/misc/ids2path_json/coco_test4w_ids2path.json',
                 'TEST_ATT_FEATS': './mssydney/feature/Sydney',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mssydney/misc/ids2path_json/sydney_val_ids2path.json',
                 'TRAIN_ATT_FEATS': './mssydney/feature/Sydney',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mssydney/misc/ids2path_json/sydney_train_ids2path.json',
                 'VAL_ATT_FEATS': './mssydney/feature/Sydney',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mssydney/misc/ids2path_json/sydney_test_ids2path.json'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 5,
               'CAP_KEY': 'caption',
               'COCO_PATH': './coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mssydney/misc/val_sydney.json',
               'VAL_ANNFILE': './mssydney/misc/test_sydney.json',
               'VOCAB': './mssydney/txt/Sydney_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'CrossEntropy'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 2048,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 512,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 512,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [64, 32, 64],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 3,
                        'DIM': 512,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [64, 32, 64],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.1,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 3,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.1,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.1,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 2048,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 512,
           'SEQ_LEN': 24,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'PureT',
           'VOCAB_SIZE': 175,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 512,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'MAX_LEN': 'MAX_LEN',
           'MULCLASS': 'MULCLASS',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments_PureT/PureT_XE_Sydney/',
 'SCORER': {'CIDER_CACHED': './mssydney/misc/sydney_train_cider.pkl',
            'GT_PATH': './mssydney/misc/sydney_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1234.0,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 0.0005,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 512,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Noam',
                          'WARMUP': 10000},
            'MAX_EPOCH': 20,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2023-02-21 20:58:56,243] Training with config:
[INFO: 2023-02-21 20:58:56,248] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mssydney/sent/sydney_train_input.pkl',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 8,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mssydney/sent/sydney_train_target.pkl',
                 'TEST_4W_ID': './mscoco/misc/ids2path_json/coco_test4w_ids2path.json',
                 'TEST_ATT_FEATS': './mssydney/feature/Sydney',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mssydney/misc/ids2path_json/sydney_val_ids2path.json',
                 'TRAIN_ATT_FEATS': './mssydney/feature/Sydney',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mssydney/misc/ids2path_json/sydney_train_ids2path.json',
                 'VAL_ATT_FEATS': './mssydney/feature/Sydney',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mssydney/misc/ids2path_json/sydney_test_ids2path.json'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 5,
               'CAP_KEY': 'caption',
               'COCO_PATH': './coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mssydney/misc/val_sydney.json',
               'VAL_ANNFILE': './mssydney/misc/test_sydney.json',
               'VOCAB': './mssydney/txt/Sydney_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'CrossEntropy'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 1536,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 512,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 512,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [64, 32, 64],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 3,
                        'DIM': 512,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [64, 32, 64],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.1,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 3,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.1,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.1,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 1536,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 512,
           'SEQ_LEN': 24,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'PureT',
           'VOCAB_SIZE': 175,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 512,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'MAX_LEN': 'MAX_LEN',
           'MULCLASS': 'MULCLASS',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments_PureT/PureT_XE_Sydney/',
 'SCORER': {'CIDER_CACHED': './mssydney/misc/sydney_train_cider.pkl',
            'GT_PATH': './mssydney/misc/sydney_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1234.0,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 0.0005,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 512,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Noam',
                          'WARMUP': 10000},
            'MAX_EPOCH': 20,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2023-02-21 21:00:15,351] Training with config:
[INFO: 2023-02-21 21:00:15,354] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mssydney/sent/sydney_train_input.pkl',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 8,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mssydney/sent/sydney_train_target.pkl',
                 'TEST_4W_ID': './mscoco/misc/ids2path_json/coco_test4w_ids2path.json',
                 'TEST_ATT_FEATS': './mssydney/feature/Sydney',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mssydney/misc/ids2path_json/sydney_val_ids2path.json',
                 'TRAIN_ATT_FEATS': './mssydney/feature/Sydney',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mssydney/misc/ids2path_json/sydney_train_ids2path.json',
                 'VAL_ATT_FEATS': './mssydney/feature/Sydney',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mssydney/misc/ids2path_json/sydney_test_ids2path.json'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 5,
               'CAP_KEY': 'caption',
               'COCO_PATH': './coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mssydney/misc/val_sydney.json',
               'VAL_ANNFILE': './mssydney/misc/test_sydney.json',
               'VOCAB': './mssydney/txt/Sydney_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'CrossEntropy'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 1536,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 512,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 512,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [64, 32, 64],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 3,
                        'DIM': 512,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [64, 32, 64],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.1,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 3,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.1,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.1,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 1536,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 512,
           'SEQ_LEN': 24,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'PureT',
           'VOCAB_SIZE': 175,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 512,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'MAX_LEN': 'MAX_LEN',
           'MULCLASS': 'MULCLASS',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments_PureT/PureT_XE_Sydney/',
 'SCORER': {'CIDER_CACHED': './mssydney/misc/sydney_train_cider.pkl',
            'GT_PATH': './mssydney/misc/sydney_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1234.0,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 0.0005,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 512,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Noam',
                          'WARMUP': 10000},
            'MAX_EPOCH': 20,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2023-02-21 21:03:28,215] Training with config:
[INFO: 2023-02-21 21:03:28,220] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mssydney/sent/sydney_train_input.pkl',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 8,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mssydney/sent/sydney_train_target.pkl',
                 'TEST_4W_ID': './mscoco/misc/ids2path_json/coco_test4w_ids2path.json',
                 'TEST_ATT_FEATS': './mssydney/feature/Sydney',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mssydney/misc/ids2path_json/sydney_val_ids2path.json',
                 'TRAIN_ATT_FEATS': './mssydney/feature/Sydney',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mssydney/misc/ids2path_json/sydney_train_ids2path.json',
                 'VAL_ATT_FEATS': './mssydney/feature/Sydney',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mssydney/misc/ids2path_json/sydney_test_ids2path.json'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 5,
               'CAP_KEY': 'caption',
               'COCO_PATH': './coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mssydney/misc/val_sydney.json',
               'VAL_ANNFILE': './mssydney/misc/test_sydney.json',
               'VOCAB': './mssydney/txt/Sydney_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'LabelSmoothing'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 1536,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 512,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 512,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [64, 32, 64],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 3,
                        'DIM': 512,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [64, 32, 64],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.1,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 3,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.1,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.1,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 1536,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 512,
           'SEQ_LEN': 24,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'PureT',
           'VOCAB_SIZE': 175,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 512,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'MAX_LEN': 'MAX_LEN',
           'MULCLASS': 'MULCLASS',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments_PureT/PureT_XE_Sydney/',
 'SCORER': {'CIDER_CACHED': './mssydney/misc/sydney_train_cider.pkl',
            'GT_PATH': './mssydney/misc/sydney_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1234.0,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 0.0005,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 512,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Noam',
                          'WARMUP': 10000},
            'MAX_EPOCH': 30,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2023-02-21 21:06:51,667] Training with config:
[INFO: 2023-02-21 21:06:51,673] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mssydney/sent/sydney_train_input.pkl',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 8,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mssydney/sent/sydney_train_target.pkl',
                 'TEST_4W_ID': './mscoco/misc/ids2path_json/coco_test4w_ids2path.json',
                 'TEST_ATT_FEATS': './mssydney/feature/Sydney',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mssydney/misc/ids2path_json/sydney_val_ids2path.json',
                 'TRAIN_ATT_FEATS': './mssydney/feature/Sydney',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mssydney/misc/ids2path_json/sydney_train_ids2path.json',
                 'VAL_ATT_FEATS': './mssydney/feature/Sydney',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mssydney/misc/ids2path_json/sydney_test_ids2path.json'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 5,
               'CAP_KEY': 'caption',
               'COCO_PATH': './coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mssydney/misc/val_sydney.json',
               'VAL_ANNFILE': './mssydney/misc/test_sydney.json',
               'VOCAB': './mssydney/txt/Sydney_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'LabelSmoothing'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 1536,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 512,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 512,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [64, 32, 64],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 3,
                        'DIM': 512,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [64, 32, 64],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.1,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 3,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.1,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.1,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 1536,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 512,
           'SEQ_LEN': 24,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'PureT',
           'VOCAB_SIZE': 175,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 512,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'MAX_LEN': 'MAX_LEN',
           'MULCLASS': 'MULCLASS',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments_PureT/PureT_XE_Sydney/',
 'SCORER': {'CIDER_CACHED': './mssydney/misc/sydney_train_cider.pkl',
            'GT_PATH': './mssydney/misc/sydney_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1234.0,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 0.0005,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 512,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Noam',
                          'WARMUP': 10000},
            'MAX_EPOCH': 30,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2023-02-21 21:33:37,522] Training with config:
[INFO: 2023-02-21 21:33:37,545] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mssydney/sent/sydney_train_input.pkl',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 8,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mssydney/sent/sydney_train_target.pkl',
                 'TEST_4W_ID': './mscoco/misc/ids2path_json/coco_test4w_ids2path.json',
                 'TEST_ATT_FEATS': './mssydney/feature/Sydney',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mssydney/misc/ids2path_json/sydney_val_ids2path.json',
                 'TRAIN_ATT_FEATS': './mssydney/feature/Sydney',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mssydney/misc/ids2path_json/sydney_train_ids2path.json',
                 'VAL_ATT_FEATS': './mssydney/feature/Sydney',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mssydney/misc/ids2path_json/sydney_test_ids2path.json'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 5,
               'CAP_KEY': 'caption',
               'COCO_PATH': './coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mssydney/misc/val_sydney.json',
               'VAL_ANNFILE': './mssydney/misc/test_sydney.json',
               'VOCAB': './mssydney/txt/Sydney_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'LabelSmoothing'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 1536,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 512,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 512,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [64, 32, 64],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 3,
                        'DIM': 512,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [64, 32, 64],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.1,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 3,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.1,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.1,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 1536,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 512,
           'SEQ_LEN': 24,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'PureT',
           'VOCAB_SIZE': 175,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 512,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'MAX_LEN': 'MAX_LEN',
           'MULCLASS': 'MULCLASS',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments_PureT/PureT_XE_Sydney/',
 'SCORER': {'CIDER_CACHED': './mssydney/misc/sydney_train_cider.pkl',
            'GT_PATH': './mssydney/misc/sydney_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1234.0,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 0.0005,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 512,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Noam',
                          'WARMUP': 10000},
            'MAX_EPOCH': 20,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2023-02-27 22:59:06,732] Training with config:
[INFO: 2023-02-27 22:59:06,736] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mssydney/sent/sydney_train_input.pkl',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 8,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mssydney/sent/sydney_train_target.pkl',
                 'TEST_4W_ID': './mscoco/misc/ids2path_json/coco_test4w_ids2path.json',
                 'TEST_ATT_FEATS': './mssydney/feature/Sydney',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mssydney/misc/ids2path_json/sydney_test_ids2path.json',
                 'TRAIN_ATT_FEATS': './mssydney/feature/Sydney',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mssydney/misc/ids2path_json/sydney_train_ids2path.json',
                 'VAL_ATT_FEATS': './mssydney/feature/Sydney',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mssydney/misc/ids2path_json/sydney_val_ids2path.json'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 5,
               'CAP_KEY': 'caption',
               'COCO_PATH': './coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mssydney/misc/test_sydney.json',
               'VAL_ANNFILE': './mssydney/misc/val_sydney.json',
               'VOCAB': './mssydney/txt/Sydney_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'CrossEntropy'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 1536,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 512,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 512,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [64, 32, 64],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 3,
                        'DIM': 512,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [64, 32, 64],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.1,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 3,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.1,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.1,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 1536,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 512,
           'SEQ_LEN': 24,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'PureT',
           'VOCAB_SIZE': 181,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 512,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'MAX_LEN': 'MAX_LEN',
           'MULCLASS': 'MULCLASS',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments_PureT/PureT_XE_Sydney/',
 'SCORER': {'CIDER_CACHED': './mssydney/misc/sydney_train_cider.pkl',
            'GT_PATH': './mssydney/misc/sydney_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1234.0,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 0.0005,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 512,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Noam',
                          'WARMUP': 10000},
            'MAX_EPOCH': 20,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2023-02-27 23:00:19,412] ######## Epoch (VAL)1 ########
[INFO: 2023-02-27 23:00:19,413] {'Bleu_1': 8.551566359038922e-12, 'Bleu_2': 1.9533154048782363e-19, 'Bleu_3': 5.624919720916227e-22, 'Bleu_4': 3.0537898816377345e-23, 'METEOR': 0.000630715862503942, 'ROUGE_L': 0.0011382295865054483, 'CIDEr': 6.456111789480353e-06}
[INFO: 2023-02-27 23:00:34,202] ######## Epoch (TEST)1 ########
[INFO: 2023-02-27 23:00:34,202] {'Bleu_1': 0.0, 'Bleu_2': 0.0, 'Bleu_3': 0.0, 'Bleu_4': 0.0, 'METEOR': 0.0, 'ROUGE_L': 0.0, 'CIDEr': 0.0}
[INFO: 2023-02-27 23:01:40,624] ######## Epoch (VAL)2 ########
[INFO: 2023-02-27 23:01:40,625] {'Bleu_1': 0.0, 'Bleu_2': 0.0, 'Bleu_3': 0.0, 'Bleu_4': 0.0, 'METEOR': 0.0, 'ROUGE_L': 0.0, 'CIDEr': 0.0}
[INFO: 2023-02-27 23:01:55,613] ######## Epoch (TEST)2 ########
[INFO: 2023-02-27 23:01:55,613] {'Bleu_1': 0.0, 'Bleu_2': 0.0, 'Bleu_3': 0.0, 'Bleu_4': 0.0, 'METEOR': 0.0, 'ROUGE_L': 0.0, 'CIDEr': 0.0}
[INFO: 2023-02-27 23:03:03,485] ######## Epoch (VAL)3 ########
[INFO: 2023-02-27 23:03:03,485] {'Bleu_1': 9.812000808767361e-13, 'Bleu_2': 9.812000809012661e-16, 'Bleu_3': 9.812000809094432e-17, 'Bleu_4': 3.1028270960282653e-17, 'METEOR': 0.006280667320902846, 'ROUGE_L': 0.050412407693481306, 'CIDEr': 0.004873611275972108}
[INFO: 2023-02-27 23:03:18,278] ######## Epoch (TEST)3 ########
[INFO: 2023-02-27 23:03:18,279] {'Bleu_1': 1.3431462790240985e-14, 'Bleu_2': 1.3431462790636027e-17, 'Bleu_3': 1.3431462790767716e-18, 'Bleu_4': 4.2474014726835765e-19, 'METEOR': 0.005460750853242321, 'ROUGE_L': 0.0469495228924317, 'CIDEr': 0.0021373168721182372}
[INFO: 2023-02-27 23:04:27,127] ######## Epoch (VAL)4 ########
[INFO: 2023-02-27 23:04:27,127] {'Bleu_1': 0.013609579148963229, 'Bleu_2': 0.013854887439049616, 'Bleu_3': 0.014010810431544082, 'Bleu_4': 0.01438621106575846, 'METEOR': 0.07520968915066359, 'ROUGE_L': 0.2398307633001015, 'CIDEr': 0.2304835166913671}
[INFO: 2023-02-27 23:04:41,882] ######## Epoch (TEST)4 ########
[INFO: 2023-02-27 23:04:41,883] {'Bleu_1': 0.011388748414239206, 'Bleu_2': 0.010971960965160185, 'Bleu_3': 0.010845703367169026, 'Bleu_4': 0.0003551319327483157, 'METEOR': 0.0740565105964416, 'ROUGE_L': 0.25069237067271016, 'CIDEr': 0.1876007296843128}
[INFO: 2023-02-27 23:05:50,582] ######## Epoch (VAL)5 ########
[INFO: 2023-02-27 23:05:50,582] {'Bleu_1': 0.12955919175712724, 'Bleu_2': 0.11510695744514275, 'Bleu_3': 0.10784140777407154, 'Bleu_4': 0.10022643129414978, 'METEOR': 0.12974090048039344, 'ROUGE_L': 0.34540320518471435, 'CIDEr': 0.6404665252019391}
[INFO: 2023-02-27 23:06:05,519] ######## Epoch (TEST)5 ########
[INFO: 2023-02-27 23:06:05,520] {'Bleu_1': 0.10736211960739771, 'Bleu_2': 0.09451881229584248, 'Bleu_3': 0.08757483876838287, 'Bleu_4': 0.07772654134268978, 'METEOR': 0.12400929802826326, 'ROUGE_L': 0.3469591296299843, 'CIDEr': 0.5213023358919642}
[INFO: 2023-02-27 23:07:14,370] ######## Epoch (VAL)6 ########
[INFO: 2023-02-27 23:07:14,370] {'Bleu_1': 0.34955351264829154, 'Bleu_2': 0.32002112184747766, 'Bleu_3': 0.2907640179534735, 'Bleu_4': 0.25670626007394703, 'METEOR': 0.20538009407471766, 'ROUGE_L': 0.47166189689285426, 'CIDEr': 1.1108076569030265}
[INFO: 2023-02-27 23:07:29,496] ######## Epoch (TEST)6 ########
[INFO: 2023-02-27 23:07:29,496] {'Bleu_1': 0.3506684853900374, 'Bleu_2': 0.31871412259902104, 'Bleu_3': 0.2941492294629041, 'Bleu_4': 0.27444127859424816, 'METEOR': 0.20709290575899517, 'ROUGE_L': 0.47232310699878466, 'CIDEr': 1.2535700642289267}
[INFO: 2023-02-27 23:08:38,618] ######## Epoch (VAL)7 ########
[INFO: 2023-02-27 23:08:38,619] {'Bleu_1': 0.706696140531659, 'Bleu_2': 0.6368956359770076, 'Bleu_3': 0.5675039035198356, 'Bleu_4': 0.5034553217609263, 'METEOR': 0.32359816394613394, 'ROUGE_L': 0.6193065845430578, 'CIDEr': 1.6770925863533004}
[INFO: 2023-02-27 23:08:53,119] ######## Epoch (TEST)7 ########
[INFO: 2023-02-27 23:08:53,119] {'Bleu_1': 0.6985525116927782, 'Bleu_2': 0.6226979903669413, 'Bleu_3': 0.5551431903261224, 'Bleu_4': 0.4938475906375422, 'METEOR': 0.3362808059625514, 'ROUGE_L': 0.6254736709669195, 'CIDEr': 1.7543642054743733}
[INFO: 2023-02-27 23:10:02,630] ######## Epoch (VAL)8 ########
[INFO: 2023-02-27 23:10:02,630] {'Bleu_1': 0.6873011700498369, 'Bleu_2': 0.6289613007505768, 'Bleu_3': 0.5665312842951579, 'Bleu_4': 0.49855137298473035, 'METEOR': 0.34271539387286565, 'ROUGE_L': 0.6653656330847191, 'CIDEr': 1.8075766507387856}
[INFO: 2023-02-27 23:10:17,172] ######## Epoch (TEST)8 ########
[INFO: 2023-02-27 23:10:17,172] {'Bleu_1': 0.652003618326985, 'Bleu_2': 0.57937192658977, 'Bleu_3': 0.5114077929071802, 'Bleu_4': 0.4451338467245449, 'METEOR': 0.3177692355622838, 'ROUGE_L': 0.6100700708706258, 'CIDEr': 1.631882821960907}
[INFO: 2023-02-27 23:11:26,447] ######## Epoch (VAL)9 ########
[INFO: 2023-02-27 23:11:26,447] {'Bleu_1': 0.7990248615390991, 'Bleu_2': 0.734020936264759, 'Bleu_3': 0.66174994828321, 'Bleu_4': 0.5894347420063868, 'METEOR': 0.38576071806688056, 'ROUGE_L': 0.7015627838331697, 'CIDEr': 2.2249249493359016}
[INFO: 2023-02-27 23:11:41,032] ######## Epoch (TEST)9 ########
[INFO: 2023-02-27 23:11:41,032] {'Bleu_1': 0.7382828384275383, 'Bleu_2': 0.6521204483524474, 'Bleu_3': 0.577742692973715, 'Bleu_4': 0.5067404793337638, 'METEOR': 0.35264259017697175, 'ROUGE_L': 0.6387622662708707, 'CIDEr': 1.9422402941962178}
[INFO: 2023-02-27 23:12:50,207] ######## Epoch (VAL)10 ########
[INFO: 2023-02-27 23:12:50,208] {'Bleu_1': 0.796588564582756, 'Bleu_2': 0.7311764807004149, 'Bleu_3': 0.6586880127323631, 'Bleu_4': 0.586453637325833, 'METEOR': 0.37980667260800494, 'ROUGE_L': 0.6951567709012375, 'CIDEr': 2.184237574297705}
[INFO: 2023-02-27 23:13:04,762] ######## Epoch (TEST)10 ########
[INFO: 2023-02-27 23:13:04,763] {'Bleu_1': 0.7275108530434746, 'Bleu_2': 0.6484528656694893, 'Bleu_3': 0.5736203609587752, 'Bleu_4': 0.501575689109995, 'METEOR': 0.3518692952564976, 'ROUGE_L': 0.6340181064537869, 'CIDEr': 1.9367930365631219}
[INFO: 2023-02-27 23:14:13,930] ######## Epoch (VAL)11 ########
[INFO: 2023-02-27 23:14:13,931] {'Bleu_1': 0.750260323437908, 'Bleu_2': 0.6861422261546707, 'Bleu_3': 0.6147583420148562, 'Bleu_4': 0.5415367771525637, 'METEOR': 0.366199327778178, 'ROUGE_L': 0.6861307298156101, 'CIDEr': 2.0576477712394605}
[INFO: 2023-02-27 23:14:28,695] ######## Epoch (TEST)11 ########
[INFO: 2023-02-27 23:14:28,696] {'Bleu_1': 0.6998881148914912, 'Bleu_2': 0.6224731946044919, 'Bleu_3': 0.5478374754156206, 'Bleu_4': 0.4743871805819398, 'METEOR': 0.341118016332412, 'ROUGE_L': 0.6367304322771123, 'CIDEr': 1.8616253834203937}
[INFO: 2023-02-27 23:15:38,049] ######## Epoch (VAL)12 ########
[INFO: 2023-02-27 23:15:38,050] {'Bleu_1': 0.8189772277940737, 'Bleu_2': 0.739840823022327, 'Bleu_3': 0.6542274577611741, 'Bleu_4': 0.571812902979059, 'METEOR': 0.3959815227653633, 'ROUGE_L': 0.712767692492985, 'CIDEr': 2.1952957138723}
[INFO: 2023-02-27 23:15:52,649] ######## Epoch (TEST)12 ########
[INFO: 2023-02-27 23:15:52,649] {'Bleu_1': 0.7662507832533966, 'Bleu_2': 0.6845882881035353, 'Bleu_3': 0.6126978457497851, 'Bleu_4': 0.5460672300591278, 'METEOR': 0.3734869798188619, 'ROUGE_L': 0.6861941763175896, 'CIDEr': 2.2013853928778055}
[INFO: 2023-02-27 23:17:01,558] ######## Epoch (VAL)13 ########
[INFO: 2023-02-27 23:17:01,558] {'Bleu_1': 0.7673416478498236, 'Bleu_2': 0.6753931009395275, 'Bleu_3': 0.5886782976090322, 'Bleu_4': 0.5057819935093257, 'METEOR': 0.3838763128773308, 'ROUGE_L': 0.6871707097786176, 'CIDEr': 2.088237676480326}
[INFO: 2023-02-27 23:17:16,172] ######## Epoch (TEST)13 ########
[INFO: 2023-02-27 23:17:16,173] {'Bleu_1': 0.7398839633143828, 'Bleu_2': 0.6541752361516334, 'Bleu_3': 0.5843151039849306, 'Bleu_4': 0.5200668029154564, 'METEOR': 0.36837524936010346, 'ROUGE_L': 0.6741345271789034, 'CIDEr': 2.1300538344647646}
[INFO: 2023-02-27 23:18:25,754] ######## Epoch (VAL)14 ########
[INFO: 2023-02-27 23:18:25,754] {'Bleu_1': 0.8145985401447963, 'Bleu_2': 0.7333954544002442, 'Bleu_3': 0.6473642108635363, 'Bleu_4': 0.5665088802196632, 'METEOR': 0.39100382457897254, 'ROUGE_L': 0.7059302227953469, 'CIDEr': 2.170102559200163}
[INFO: 2023-02-27 23:18:40,371] ######## Epoch (TEST)14 ########
[INFO: 2023-02-27 23:18:40,372] {'Bleu_1': 0.776056338027076, 'Bleu_2': 0.6900059295672515, 'Bleu_3': 0.6162647836195213, 'Bleu_4': 0.5509407925725353, 'METEOR': 0.38082859144553804, 'ROUGE_L': 0.6970821076414023, 'CIDEr': 2.260967293240501}
[INFO: 2023-02-27 23:19:50,265] ######## Epoch (VAL)15 ########
[INFO: 2023-02-27 23:19:50,266] {'Bleu_1': 0.8163558106157585, 'Bleu_2': 0.7333821966954781, 'Bleu_3': 0.6451007257650808, 'Bleu_4': 0.5602998843539632, 'METEOR': 0.4040543304404163, 'ROUGE_L': 0.7210836293974331, 'CIDEr': 2.3052210885475204}
[INFO: 2023-02-27 23:20:04,977] ######## Epoch (TEST)15 ########
[INFO: 2023-02-27 23:20:04,978] {'Bleu_1': 0.7656346431860456, 'Bleu_2': 0.6806456138207629, 'Bleu_3': 0.6097619426163546, 'Bleu_4': 0.5471757810369887, 'METEOR': 0.37732751200827763, 'ROUGE_L': 0.681836954636097, 'CIDEr': 2.227081350771291}
[INFO: 2023-02-27 23:21:15,074] ######## Epoch (VAL)16 ########
[INFO: 2023-02-27 23:21:15,075] {'Bleu_1': 0.8041666666655498, 'Bleu_2': 0.7151301475212636, 'Bleu_3': 0.627632410520699, 'Bleu_4': 0.5458142611151361, 'METEOR': 0.4001911667221179, 'ROUGE_L': 0.7171909313677468, 'CIDEr': 2.277236770204201}
[INFO: 2023-02-27 23:21:29,792] ######## Epoch (TEST)16 ########
[INFO: 2023-02-27 23:21:29,793] {'Bleu_1': 0.7766990291251363, 'Bleu_2': 0.691352756056599, 'Bleu_3': 0.618854318200124, 'Bleu_4': 0.55438134919924, 'METEOR': 0.38680338843030915, 'ROUGE_L': 0.7063514537197256, 'CIDEr': 2.3707681849445454}
[INFO: 2023-02-27 23:22:39,423] ######## Epoch (VAL)17 ########
[INFO: 2023-02-27 23:22:39,424] {'Bleu_1': 0.7788732394355228, 'Bleu_2': 0.6912570746193085, 'Bleu_3': 0.6040614192178919, 'Bleu_4': 0.5216002043349389, 'METEOR': 0.3933398856064684, 'ROUGE_L': 0.6937826478862811, 'CIDEr': 2.1938288089078744}
[INFO: 2023-02-27 23:22:54,380] ######## Epoch (TEST)17 ########
[INFO: 2023-02-27 23:22:54,381] {'Bleu_1': 0.7689133425013235, 'Bleu_2': 0.6737894202129907, 'Bleu_3': 0.5918392850043653, 'Bleu_4': 0.5193043872078532, 'METEOR': 0.38100984113968994, 'ROUGE_L': 0.6969484721865548, 'CIDEr': 2.178252703929679}
[INFO: 2023-02-27 23:24:04,196] ######## Epoch (VAL)18 ########
[INFO: 2023-02-27 23:24:04,197] {'Bleu_1': 0.8170391061441102, 'Bleu_2': 0.7324033945173145, 'Bleu_3': 0.6448968175387567, 'Bleu_4': 0.5601845449300404, 'METEOR': 0.4157289007796942, 'ROUGE_L': 0.7428117907244882, 'CIDEr': 2.3953784190299925}
[INFO: 2023-02-27 23:24:18,849] ######## Epoch (TEST)18 ########
[INFO: 2023-02-27 23:24:18,849] {'Bleu_1': 0.7756232686969867, 'Bleu_2': 0.690353381688157, 'Bleu_3': 0.6172301885170105, 'Bleu_4': 0.5511246609858791, 'METEOR': 0.38792431107608577, 'ROUGE_L': 0.7052921956963959, 'CIDEr': 2.370760104072326}
[INFO: 2023-02-27 23:25:28,859] ######## Epoch (VAL)19 ########
[INFO: 2023-02-27 23:25:28,860] {'Bleu_1': 0.8011303697995227, 'Bleu_2': 0.7137994125437612, 'Bleu_3': 0.6264519119175196, 'Bleu_4': 0.5433133933573615, 'METEOR': 0.40131771252160503, 'ROUGE_L': 0.7293997781715352, 'CIDEr': 2.25738298226706}
[INFO: 2023-02-27 23:25:43,752] ######## Epoch (TEST)19 ########
[INFO: 2023-02-27 23:25:43,753] {'Bleu_1': 0.7633654639634206, 'Bleu_2': 0.6830289497888572, 'Bleu_3': 0.6065542581639981, 'Bleu_4': 0.5352571820981543, 'METEOR': 0.3669236682790872, 'ROUGE_L': 0.6978888427353409, 'CIDEr': 2.2068492855883726}
[INFO: 2023-02-27 23:26:53,339] ######## Epoch (VAL)20 ########
[INFO: 2023-02-27 23:26:53,339] {'Bleu_1': 0.8387553041006524, 'Bleu_2': 0.7626083361313318, 'Bleu_3': 0.6824529456910291, 'Bleu_4': 0.6038776384407135, 'METEOR': 0.416793046705433, 'ROUGE_L': 0.7460786670072244, 'CIDEr': 2.5887043502764877}
[INFO: 2023-02-27 23:27:07,892] ######## Epoch (TEST)20 ########
[INFO: 2023-02-27 23:27:07,893] {'Bleu_1': 0.7812030861984446, 'Bleu_2': 0.7002215515135565, 'Bleu_3': 0.6297990098661326, 'Bleu_4': 0.5652078277401271, 'METEOR': 0.3795890236492055, 'ROUGE_L': 0.6940695298758999, 'CIDEr': 2.357937130392219}
[INFO: 2023-03-01 16:59:06,284] Training with config:
[INFO: 2023-03-01 16:59:06,287] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mssydney/sent/sydney_train_input.pkl',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 8,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mssydney/sent/sydney_train_target.pkl',
                 'TEST_4W_ID': './mscoco/misc/ids2path_json/coco_test4w_ids2path.json',
                 'TEST_ATT_FEATS': './mssydney/feature/Sydney',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mssydney/misc/ids2path_json/sydney_test_ids2path.json',
                 'TRAIN_ATT_FEATS': './mssydney/feature/Sydney',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mssydney/misc/ids2path_json/sydney_train_ids2path.json',
                 'VAL_ATT_FEATS': './mssydney/feature/Sydney',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mssydney/misc/ids2path_json/sydney_val_ids2path.json'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 5,
               'CAP_KEY': 'caption',
               'COCO_PATH': './coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mssydney/misc/test_sydney.json',
               'VAL_ANNFILE': './mssydney/misc/val_sydney.json',
               'VOCAB': './mssydney/txt/Sydney_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'CrossEntropy'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 1536,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 512,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 512,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [64, 32, 64],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 3,
                        'DIM': 512,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [64, 32, 64],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.1,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 3,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.1,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.1,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 1536,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 512,
           'SEQ_LEN': 24,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'PureT',
           'VOCAB_SIZE': 181,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 512,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'MAX_LEN': 'MAX_LEN',
           'MULCLASS': 'MULCLASS',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments_PureT/PureT_XE_Sydney/',
 'SCORER': {'CIDER_CACHED': './mssydney/misc/sydney_train_cider.pkl',
            'GT_PATH': './mssydney/misc/sydney_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1234.0,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 0.0005,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 512,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Noam',
                          'WARMUP': 10000},
            'MAX_EPOCH': 40,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2023-03-01 17:00:21,550] ######## Epoch (VAL)1 ########
[INFO: 2023-03-01 17:00:21,551] {'Bleu_1': 8.551566359038922e-12, 'Bleu_2': 1.9533154048782363e-19, 'Bleu_3': 5.624919720916227e-22, 'Bleu_4': 3.0537898816377345e-23, 'METEOR': 0.000630715862503942, 'ROUGE_L': 0.0011382295865054483, 'CIDEr': 6.456111789480353e-06}
[INFO: 2023-03-01 17:00:35,986] ######## Epoch (TEST)1 ########
[INFO: 2023-03-01 17:00:35,986] {'Bleu_1': 0.0, 'Bleu_2': 0.0, 'Bleu_3': 0.0, 'Bleu_4': 0.0, 'METEOR': 0.0, 'ROUGE_L': 0.0, 'CIDEr': 0.0}
[INFO: 2023-03-01 17:01:44,066] ######## Epoch (VAL)2 ########
[INFO: 2023-03-01 17:01:44,067] {'Bleu_1': 0.0, 'Bleu_2': 0.0, 'Bleu_3': 0.0, 'Bleu_4': 0.0, 'METEOR': 0.0, 'ROUGE_L': 0.0, 'CIDEr': 0.0}
[INFO: 2023-03-01 17:01:58,399] ######## Epoch (TEST)2 ########
[INFO: 2023-03-01 17:01:58,400] {'Bleu_1': 0.0, 'Bleu_2': 0.0, 'Bleu_3': 0.0, 'Bleu_4': 0.0, 'METEOR': 0.0, 'ROUGE_L': 0.0, 'CIDEr': 0.0}
[INFO: 2023-03-01 17:03:08,059] ######## Epoch (VAL)3 ########
[INFO: 2023-03-01 17:03:08,060] {'Bleu_1': 9.812000808767361e-13, 'Bleu_2': 9.812000809012661e-16, 'Bleu_3': 9.812000809094432e-17, 'Bleu_4': 3.1028270960282653e-17, 'METEOR': 0.006280667320902846, 'ROUGE_L': 0.050412407693481306, 'CIDEr': 0.004873611275972108}
[INFO: 2023-03-01 17:03:22,437] ######## Epoch (TEST)3 ########
[INFO: 2023-03-01 17:03:22,438] {'Bleu_1': 1.3431462790240985e-14, 'Bleu_2': 1.3431462790636027e-17, 'Bleu_3': 1.3431462790767716e-18, 'Bleu_4': 4.2474014726835765e-19, 'METEOR': 0.005460750853242321, 'ROUGE_L': 0.0469495228924317, 'CIDEr': 0.0021373168721182372}
[INFO: 2023-03-01 17:04:32,374] ######## Epoch (VAL)4 ########
[INFO: 2023-03-01 17:04:32,374] {'Bleu_1': 0.013609579148963229, 'Bleu_2': 0.013854887439049616, 'Bleu_3': 0.014010810431544082, 'Bleu_4': 0.01438621106575846, 'METEOR': 0.07520968915066359, 'ROUGE_L': 0.2398307633001015, 'CIDEr': 0.2304835166913671}
[INFO: 2023-03-01 17:04:47,169] ######## Epoch (TEST)4 ########
[INFO: 2023-03-01 17:04:47,170] {'Bleu_1': 0.011388748414239206, 'Bleu_2': 0.010971960965160185, 'Bleu_3': 0.010845703367169026, 'Bleu_4': 0.0003551319327483157, 'METEOR': 0.0740565105964416, 'ROUGE_L': 0.25069237067271016, 'CIDEr': 0.1876007296843128}
[INFO: 2023-03-01 17:05:57,861] ######## Epoch (VAL)5 ########
[INFO: 2023-03-01 17:05:57,861] {'Bleu_1': 0.12955919175712724, 'Bleu_2': 0.11510695744514275, 'Bleu_3': 0.10784140777407154, 'Bleu_4': 0.10022643129414978, 'METEOR': 0.12974090048039344, 'ROUGE_L': 0.34540320518471435, 'CIDEr': 0.6404665252019391}
[INFO: 2023-03-01 17:06:12,748] ######## Epoch (TEST)5 ########
[INFO: 2023-03-01 17:06:12,749] {'Bleu_1': 0.10736211960739771, 'Bleu_2': 0.09451881229584248, 'Bleu_3': 0.08757483876838287, 'Bleu_4': 0.07772654134268978, 'METEOR': 0.12400929802826326, 'ROUGE_L': 0.3469591296299843, 'CIDEr': 0.5213023358919642}
[INFO: 2023-03-01 17:07:23,296] ######## Epoch (VAL)6 ########
[INFO: 2023-03-01 17:07:23,297] {'Bleu_1': 0.34955351264829154, 'Bleu_2': 0.32002112184747766, 'Bleu_3': 0.2907640179534735, 'Bleu_4': 0.25670626007394703, 'METEOR': 0.20538009407471766, 'ROUGE_L': 0.47166189689285426, 'CIDEr': 1.1108076569030265}
[INFO: 2023-03-01 17:07:38,490] ######## Epoch (TEST)6 ########
[INFO: 2023-03-01 17:07:38,490] {'Bleu_1': 0.3506684853900374, 'Bleu_2': 0.31871412259902104, 'Bleu_3': 0.2941492294629041, 'Bleu_4': 0.27444127859424816, 'METEOR': 0.20709290575899517, 'ROUGE_L': 0.47232310699878466, 'CIDEr': 1.2535700642289267}
[INFO: 2023-03-01 17:08:49,081] ######## Epoch (VAL)7 ########
[INFO: 2023-03-01 17:08:49,082] {'Bleu_1': 0.706696140531659, 'Bleu_2': 0.6368956359770076, 'Bleu_3': 0.5675039035198356, 'Bleu_4': 0.5034553217609263, 'METEOR': 0.32359816394613394, 'ROUGE_L': 0.6193065845430578, 'CIDEr': 1.6770925863533004}
[INFO: 2023-03-01 17:09:04,081] ######## Epoch (TEST)7 ########
[INFO: 2023-03-01 17:09:04,082] {'Bleu_1': 0.6985525116927782, 'Bleu_2': 0.6226979903669413, 'Bleu_3': 0.5551431903261224, 'Bleu_4': 0.4938475906375422, 'METEOR': 0.3362808059625514, 'ROUGE_L': 0.6254736709669195, 'CIDEr': 1.7543642054743733}
[INFO: 2023-03-01 17:10:15,205] ######## Epoch (VAL)8 ########
[INFO: 2023-03-01 17:10:15,205] {'Bleu_1': 0.6873011700498369, 'Bleu_2': 0.6289613007505768, 'Bleu_3': 0.5665312842951579, 'Bleu_4': 0.49855137298473035, 'METEOR': 0.34271539387286565, 'ROUGE_L': 0.6653656330847191, 'CIDEr': 1.8075766507387856}
[INFO: 2023-03-01 17:10:29,977] ######## Epoch (TEST)8 ########
[INFO: 2023-03-01 17:10:29,978] {'Bleu_1': 0.652003618326985, 'Bleu_2': 0.57937192658977, 'Bleu_3': 0.5114077929071802, 'Bleu_4': 0.4451338467245449, 'METEOR': 0.3177692355622838, 'ROUGE_L': 0.6100700708706258, 'CIDEr': 1.631882821960907}
[INFO: 2023-03-01 17:11:40,896] ######## Epoch (VAL)9 ########
[INFO: 2023-03-01 17:11:40,896] {'Bleu_1': 0.7990248615390991, 'Bleu_2': 0.734020936264759, 'Bleu_3': 0.66174994828321, 'Bleu_4': 0.5894347420063868, 'METEOR': 0.38576071806688056, 'ROUGE_L': 0.7015627838331697, 'CIDEr': 2.2249249493359016}
[INFO: 2023-03-01 17:11:55,927] ######## Epoch (TEST)9 ########
[INFO: 2023-03-01 17:11:55,927] {'Bleu_1': 0.7382828384275383, 'Bleu_2': 0.6521204483524474, 'Bleu_3': 0.577742692973715, 'Bleu_4': 0.5067404793337638, 'METEOR': 0.35264259017697175, 'ROUGE_L': 0.6387622662708707, 'CIDEr': 1.9422402941962178}
[INFO: 2023-03-01 17:13:06,912] ######## Epoch (VAL)10 ########
[INFO: 2023-03-01 17:13:06,912] {'Bleu_1': 0.796588564582756, 'Bleu_2': 0.7311764807004149, 'Bleu_3': 0.6586880127323631, 'Bleu_4': 0.586453637325833, 'METEOR': 0.37980667260800494, 'ROUGE_L': 0.6951567709012375, 'CIDEr': 2.184237574297705}
[INFO: 2023-03-01 17:13:21,979] ######## Epoch (TEST)10 ########
[INFO: 2023-03-01 17:13:21,979] {'Bleu_1': 0.7275108530434746, 'Bleu_2': 0.6484528656694893, 'Bleu_3': 0.5736203609587752, 'Bleu_4': 0.501575689109995, 'METEOR': 0.3518692952564976, 'ROUGE_L': 0.6340181064537869, 'CIDEr': 1.9367930365631219}
[INFO: 2023-03-01 17:14:33,275] ######## Epoch (VAL)11 ########
[INFO: 2023-03-01 17:14:33,275] {'Bleu_1': 0.750260323437908, 'Bleu_2': 0.6861422261546707, 'Bleu_3': 0.6147583420148562, 'Bleu_4': 0.5415367771525637, 'METEOR': 0.366199327778178, 'ROUGE_L': 0.6861307298156101, 'CIDEr': 2.0576477712394605}
[INFO: 2023-03-01 17:14:48,303] ######## Epoch (TEST)11 ########
[INFO: 2023-03-01 17:14:48,303] {'Bleu_1': 0.6998881148914912, 'Bleu_2': 0.6224731946044919, 'Bleu_3': 0.5478374754156206, 'Bleu_4': 0.4743871805819398, 'METEOR': 0.341118016332412, 'ROUGE_L': 0.6367304322771123, 'CIDEr': 1.8616253834203937}
[INFO: 2023-03-01 17:15:59,759] ######## Epoch (VAL)12 ########
[INFO: 2023-03-01 17:15:59,759] {'Bleu_1': 0.8189772277940737, 'Bleu_2': 0.739840823022327, 'Bleu_3': 0.6542274577611741, 'Bleu_4': 0.571812902979059, 'METEOR': 0.3959815227653633, 'ROUGE_L': 0.712767692492985, 'CIDEr': 2.1952957138723}
[INFO: 2023-03-01 17:16:15,102] ######## Epoch (TEST)12 ########
[INFO: 2023-03-01 17:16:15,103] {'Bleu_1': 0.7662507832533966, 'Bleu_2': 0.6845882881035353, 'Bleu_3': 0.6126978457497851, 'Bleu_4': 0.5460672300591278, 'METEOR': 0.3734869798188619, 'ROUGE_L': 0.6861941763175896, 'CIDEr': 2.2013853928778055}
[INFO: 2023-03-01 17:17:26,138] ######## Epoch (VAL)13 ########
[INFO: 2023-03-01 17:17:26,139] {'Bleu_1': 0.7673416478498236, 'Bleu_2': 0.6753931009395275, 'Bleu_3': 0.5886782976090322, 'Bleu_4': 0.5057819935093257, 'METEOR': 0.3838763128773308, 'ROUGE_L': 0.6871707097786176, 'CIDEr': 2.088237676480326}
[INFO: 2023-03-01 17:17:41,074] ######## Epoch (TEST)13 ########
[INFO: 2023-03-01 17:17:41,075] {'Bleu_1': 0.7398839633143828, 'Bleu_2': 0.6541752361516334, 'Bleu_3': 0.5843151039849306, 'Bleu_4': 0.5200668029154564, 'METEOR': 0.36837524936010346, 'ROUGE_L': 0.6741345271789034, 'CIDEr': 2.1300538344647646}
[INFO: 2023-03-01 17:18:52,595] ######## Epoch (VAL)14 ########
[INFO: 2023-03-01 17:18:52,595] {'Bleu_1': 0.8145985401447963, 'Bleu_2': 0.7333954544002442, 'Bleu_3': 0.6473642108635363, 'Bleu_4': 0.5665088802196632, 'METEOR': 0.39100382457897254, 'ROUGE_L': 0.7059302227953469, 'CIDEr': 2.170102559200163}
[INFO: 2023-03-01 17:19:07,822] ######## Epoch (TEST)14 ########
[INFO: 2023-03-01 17:19:07,823] {'Bleu_1': 0.776056338027076, 'Bleu_2': 0.6900059295672515, 'Bleu_3': 0.6162647836195213, 'Bleu_4': 0.5509407925725353, 'METEOR': 0.38082859144553804, 'ROUGE_L': 0.6970821076414023, 'CIDEr': 2.260967293240501}
[INFO: 2023-03-01 17:20:18,913] ######## Epoch (VAL)15 ########
[INFO: 2023-03-01 17:20:18,914] {'Bleu_1': 0.8163558106157585, 'Bleu_2': 0.7333821966954781, 'Bleu_3': 0.6451007257650808, 'Bleu_4': 0.5602998843539632, 'METEOR': 0.4040543304404163, 'ROUGE_L': 0.7210836293974331, 'CIDEr': 2.3052210885475204}
[INFO: 2023-03-01 17:20:34,017] ######## Epoch (TEST)15 ########
[INFO: 2023-03-01 17:20:34,017] {'Bleu_1': 0.7656346431860456, 'Bleu_2': 0.6806456138207629, 'Bleu_3': 0.6097619426163546, 'Bleu_4': 0.5471757810369887, 'METEOR': 0.37732751200827763, 'ROUGE_L': 0.681836954636097, 'CIDEr': 2.227081350771291}
[INFO: 2023-03-01 17:21:45,001] ######## Epoch (VAL)16 ########
[INFO: 2023-03-01 17:21:45,002] {'Bleu_1': 0.8041666666655498, 'Bleu_2': 0.7151301475212636, 'Bleu_3': 0.627632410520699, 'Bleu_4': 0.5458142611151361, 'METEOR': 0.4001911667221179, 'ROUGE_L': 0.7171909313677468, 'CIDEr': 2.277236770204201}
[INFO: 2023-03-01 17:22:00,303] ######## Epoch (TEST)16 ########
[INFO: 2023-03-01 17:22:00,303] {'Bleu_1': 0.7766990291251363, 'Bleu_2': 0.691352756056599, 'Bleu_3': 0.618854318200124, 'Bleu_4': 0.55438134919924, 'METEOR': 0.38680338843030915, 'ROUGE_L': 0.7063514537197256, 'CIDEr': 2.3707681849445454}
[INFO: 2023-03-01 17:23:11,020] ######## Epoch (VAL)17 ########
[INFO: 2023-03-01 17:23:11,021] {'Bleu_1': 0.7788732394355228, 'Bleu_2': 0.6912570746193085, 'Bleu_3': 0.6040614192178919, 'Bleu_4': 0.5216002043349389, 'METEOR': 0.3933398856064684, 'ROUGE_L': 0.6937826478862811, 'CIDEr': 2.1938288089078744}
[INFO: 2023-03-01 17:23:26,838] ######## Epoch (TEST)17 ########
[INFO: 2023-03-01 17:23:26,838] {'Bleu_1': 0.7689133425013235, 'Bleu_2': 0.6737894202129907, 'Bleu_3': 0.5918392850043653, 'Bleu_4': 0.5193043872078532, 'METEOR': 0.38100984113968994, 'ROUGE_L': 0.6969484721865548, 'CIDEr': 2.178252703929679}
[INFO: 2023-03-01 17:24:38,068] ######## Epoch (VAL)18 ########
[INFO: 2023-03-01 17:24:38,069] {'Bleu_1': 0.8170391061441102, 'Bleu_2': 0.7324033945173145, 'Bleu_3': 0.6448968175387567, 'Bleu_4': 0.5601845449300404, 'METEOR': 0.4157289007796942, 'ROUGE_L': 0.7428117907244882, 'CIDEr': 2.3953784190299925}
[INFO: 2023-03-01 17:24:53,534] ######## Epoch (TEST)18 ########
[INFO: 2023-03-01 17:24:53,535] {'Bleu_1': 0.7756232686969867, 'Bleu_2': 0.690353381688157, 'Bleu_3': 0.6172301885170105, 'Bleu_4': 0.5511246609858791, 'METEOR': 0.38792431107608577, 'ROUGE_L': 0.7052921956963959, 'CIDEr': 2.370760104072326}
[INFO: 2023-03-01 17:26:04,666] ######## Epoch (VAL)19 ########
[INFO: 2023-03-01 17:26:04,666] {'Bleu_1': 0.8011303697995227, 'Bleu_2': 0.7137994125437612, 'Bleu_3': 0.6264519119175196, 'Bleu_4': 0.5433133933573615, 'METEOR': 0.40131771252160503, 'ROUGE_L': 0.7293997781715352, 'CIDEr': 2.25738298226706}
[INFO: 2023-03-01 17:26:19,820] ######## Epoch (TEST)19 ########
[INFO: 2023-03-01 17:26:19,821] {'Bleu_1': 0.7633654639634206, 'Bleu_2': 0.6830289497888572, 'Bleu_3': 0.6065542581639981, 'Bleu_4': 0.5352571820981543, 'METEOR': 0.3669236682790872, 'ROUGE_L': 0.6978888427353409, 'CIDEr': 2.2068492855883726}
[INFO: 2023-03-01 17:27:31,250] ######## Epoch (VAL)20 ########
[INFO: 2023-03-01 17:27:31,251] {'Bleu_1': 0.8387553041006524, 'Bleu_2': 0.7626083361313318, 'Bleu_3': 0.6824529456910291, 'Bleu_4': 0.6038776384407135, 'METEOR': 0.416793046705433, 'ROUGE_L': 0.7460786670072244, 'CIDEr': 2.5887043502764877}
[INFO: 2023-03-01 17:27:46,292] ######## Epoch (TEST)20 ########
[INFO: 2023-03-01 17:27:46,293] {'Bleu_1': 0.7812030861984446, 'Bleu_2': 0.7002215515135565, 'Bleu_3': 0.6297990098661326, 'Bleu_4': 0.5652078277401271, 'METEOR': 0.3795890236492055, 'ROUGE_L': 0.6940695298758999, 'CIDEr': 2.357937130392219}
[INFO: 2023-03-01 17:28:55,568] ######## Epoch (VAL)21 ########
[INFO: 2023-03-01 17:28:55,568] {'Bleu_1': 0.8113975576651135, 'Bleu_2': 0.7218138410431431, 'Bleu_3': 0.6341774540947371, 'Bleu_4': 0.5540472883445143, 'METEOR': 0.41552156021589043, 'ROUGE_L': 0.7370497342926217, 'CIDEr': 2.379038300139961}
[INFO: 2023-03-01 17:29:10,766] ######## Epoch (TEST)21 ########
[INFO: 2023-03-01 17:29:10,766] {'Bleu_1': 0.7939560439549533, 'Bleu_2': 0.7129999087900202, 'Bleu_3': 0.6389286924786807, 'Bleu_4': 0.5698674573710787, 'METEOR': 0.39696943672239776, 'ROUGE_L': 0.7228022841525681, 'CIDEr': 2.4239807535735367}
[INFO: 2023-03-01 17:30:20,423] ######## Epoch (VAL)22 ########
[INFO: 2023-03-01 17:30:20,423] {'Bleu_1': 0.790712381987464, 'Bleu_2': 0.702547227568534, 'Bleu_3': 0.6215090647088979, 'Bleu_4': 0.5457750763265473, 'METEOR': 0.41141676190515475, 'ROUGE_L': 0.7269274250897321, 'CIDEr': 2.401549442909433}
[INFO: 2023-03-01 17:30:35,536] ######## Epoch (TEST)22 ########
[INFO: 2023-03-01 17:30:35,536] {'Bleu_1': 0.7614636498693952, 'Bleu_2': 0.671019413446036, 'Bleu_3': 0.5974041449780491, 'Bleu_4': 0.5321751647688758, 'METEOR': 0.35940843025790664, 'ROUGE_L': 0.6573809737468728, 'CIDEr': 2.367295429867246}
[INFO: 2023-03-01 17:31:45,116] ######## Epoch (VAL)23 ########
[INFO: 2023-03-01 17:31:45,117] {'Bleu_1': 0.8351063829776129, 'Bleu_2': 0.7694381538873852, 'Bleu_3': 0.7096984358467515, 'Bleu_4': 0.6552054367659373, 'METEOR': 0.45916992941271106, 'ROUGE_L': 0.7778594864752236, 'CIDEr': 3.091739083108256}
[INFO: 2023-03-01 17:31:59,980] ######## Epoch (TEST)23 ########
[INFO: 2023-03-01 17:31:59,981] {'Bleu_1': 0.7661623108655211, 'Bleu_2': 0.6918874835530147, 'Bleu_3': 0.6325245992420895, 'Bleu_4': 0.5815831085785919, 'METEOR': 0.389165996858228, 'ROUGE_L': 0.6979578119035164, 'CIDEr': 2.5690247097955594}
[INFO: 2023-03-01 17:33:09,281] ######## Epoch (VAL)24 ########
[INFO: 2023-03-01 17:33:09,281] {'Bleu_1': 0.8148648648637637, 'Bleu_2': 0.7332580942800483, 'Bleu_3': 0.6575786343218429, 'Bleu_4': 0.5867926473262388, 'METEOR': 0.4260971160732819, 'ROUGE_L': 0.7493985678976548, 'CIDEr': 2.543695185387664}
[INFO: 2023-03-01 17:33:24,798] ######## Epoch (TEST)24 ########
[INFO: 2023-03-01 17:33:24,799] {'Bleu_1': 0.7619699042397238, 'Bleu_2': 0.6763197338067186, 'Bleu_3': 0.6017723206567149, 'Bleu_4': 0.5334613301202097, 'METEOR': 0.38701447966752406, 'ROUGE_L': 0.6870575473856888, 'CIDEr': 2.342866382963205}
[INFO: 2023-03-01 17:34:34,416] ######## Epoch (VAL)25 ########
[INFO: 2023-03-01 17:34:34,417] {'Bleu_1': 0.8299039780509878, 'Bleu_2': 0.7616213054882794, 'Bleu_3': 0.698404021952022, 'Bleu_4': 0.6386297203283006, 'METEOR': 0.44252927283849913, 'ROUGE_L': 0.7524456277158196, 'CIDEr': 2.8393282373241724}
[INFO: 2023-03-01 17:34:50,407] ######## Epoch (TEST)25 ########
[INFO: 2023-03-01 17:34:50,407] {'Bleu_1': 0.7629427792905137, 'Bleu_2': 0.6966375233197635, 'Bleu_3': 0.640113872776556, 'Bleu_4': 0.5907303168656212, 'METEOR': 0.39032391591814747, 'ROUGE_L': 0.7006714566366208, 'CIDEr': 2.607387661627686}
[INFO: 2023-03-01 17:35:59,438] ######## Epoch (VAL)26 ########
[INFO: 2023-03-01 17:35:59,438] {'Bleu_1': 0.8136094674532142, 'Bleu_2': 0.7247699975671636, 'Bleu_3': 0.6381126958464381, 'Bleu_4': 0.5562756397462805, 'METEOR': 0.4072502083215006, 'ROUGE_L': 0.7265110374537538, 'CIDEr': 2.371836432685873}
[INFO: 2023-03-01 17:36:14,586] ######## Epoch (TEST)26 ########
[INFO: 2023-03-01 17:36:14,587] {'Bleu_1': 0.7449856733513682, 'Bleu_2': 0.6562734509376307, 'Bleu_3': 0.5831681903664988, 'Bleu_4': 0.5157900381340429, 'METEOR': 0.36578480379709066, 'ROUGE_L': 0.6608690506121028, 'CIDEr': 2.187525065189603}
[INFO: 2023-03-01 17:37:23,889] ######## Epoch (VAL)27 ########
[INFO: 2023-03-01 17:37:23,889] {'Bleu_1': 0.8260292164663665, 'Bleu_2': 0.7442147277285089, 'Bleu_3': 0.6674638227272571, 'Bleu_4': 0.5943643137509684, 'METEOR': 0.43503599878387017, 'ROUGE_L': 0.7614098841030243, 'CIDEr': 2.6749628271194257}
[INFO: 2023-03-01 17:37:39,157] ######## Epoch (TEST)27 ########
[INFO: 2023-03-01 17:37:39,157] {'Bleu_1': 0.7261580381461497, 'Bleu_2': 0.6405807860440745, 'Bleu_3': 0.5652528338730864, 'Bleu_4': 0.49818815367728136, 'METEOR': 0.36689711273669606, 'ROUGE_L': 0.662407389461618, 'CIDEr': 2.1719061054086044}
[INFO: 2023-03-01 17:38:48,461] ######## Epoch (VAL)28 ########
[INFO: 2023-03-01 17:38:48,461] {'Bleu_1': 0.8076923076911572, 'Bleu_2': 0.7257794794848095, 'Bleu_3': 0.6517596800307013, 'Bleu_4': 0.5886620079856852, 'METEOR': 0.4116592997604266, 'ROUGE_L': 0.730676062067102, 'CIDEr': 2.6121114435272736}
[INFO: 2023-03-01 17:39:04,167] ######## Epoch (TEST)28 ########
[INFO: 2023-03-01 17:39:04,168] {'Bleu_1': 0.7679083094544873, 'Bleu_2': 0.67167412619797, 'Bleu_3': 0.591518735605692, 'Bleu_4': 0.5227078326918473, 'METEOR': 0.3672319785688581, 'ROUGE_L': 0.6659712615052491, 'CIDEr': 2.2155776683739234}
[INFO: 2023-03-01 17:40:13,349] ######## Epoch (VAL)29 ########
[INFO: 2023-03-01 17:40:13,350] {'Bleu_1': 0.7805289866272966, 'Bleu_2': 0.7021263412105416, 'Bleu_3': 0.640732662065839, 'Bleu_4': 0.5877083721175239, 'METEOR': 0.4036817357224576, 'ROUGE_L': 0.7150988288437949, 'CIDEr': 2.5238855516648915}
[INFO: 2023-03-01 17:40:28,783] ######## Epoch (TEST)29 ########
[INFO: 2023-03-01 17:40:28,783] {'Bleu_1': 0.7386439780903835, 'Bleu_2': 0.65670007513434, 'Bleu_3': 0.5930527666815711, 'Bleu_4': 0.5375066427064573, 'METEOR': 0.3756793948842728, 'ROUGE_L': 0.677428233612376, 'CIDEr': 2.1597237484776737}
[INFO: 2023-03-01 17:41:38,433] ######## Epoch (VAL)30 ########
[INFO: 2023-03-01 17:41:38,434] {'Bleu_1': 0.7832071903200278, 'Bleu_2': 0.6866389480715483, 'Bleu_3': 0.6118611764873525, 'Bleu_4': 0.5439923992188332, 'METEOR': 0.38345036418661643, 'ROUGE_L': 0.7098697077736804, 'CIDEr': 2.3852012569650025}
[INFO: 2023-03-01 17:41:54,045] ######## Epoch (TEST)30 ########
[INFO: 2023-03-01 17:41:54,046] {'Bleu_1': 0.7585660252368279, 'Bleu_2': 0.6682972023230034, 'Bleu_3': 0.5888850311686878, 'Bleu_4': 0.5151730659722586, 'METEOR': 0.36890083418524144, 'ROUGE_L': 0.6878552538369193, 'CIDEr': 2.1034508426966174}
[INFO: 2023-03-01 17:43:03,425] ######## Epoch (VAL)31 ########
[INFO: 2023-03-01 17:43:03,426] {'Bleu_1': 0.7924791086339937, 'Bleu_2': 0.6947602613223508, 'Bleu_3': 0.618441305311004, 'Bleu_4': 0.5586452954403839, 'METEOR': 0.40367623946138464, 'ROUGE_L': 0.7186741587870554, 'CIDEr': 2.5814395558151526}
[INFO: 2023-03-01 17:43:19,188] ######## Epoch (TEST)31 ########
[INFO: 2023-03-01 17:43:19,189] {'Bleu_1': 0.7591549295763955, 'Bleu_2': 0.6634180909994803, 'Bleu_3': 0.5898695551236561, 'Bleu_4': 0.5331463036654472, 'METEOR': 0.3697434020091602, 'ROUGE_L': 0.6653729234080106, 'CIDEr': 2.463964510396266}
[INFO: 2023-03-01 17:44:28,590] ######## Epoch (VAL)32 ########
[INFO: 2023-03-01 17:44:28,591] {'Bleu_1': 0.798316184084103, 'Bleu_2': 0.7081695297782051, 'Bleu_3': 0.6417604457344461, 'Bleu_4': 0.5873956515012674, 'METEOR': 0.42539122528212353, 'ROUGE_L': 0.7468189161314797, 'CIDEr': 2.6433215007074025}
[INFO: 2023-03-01 17:44:43,831] ######## Epoch (TEST)32 ########
[INFO: 2023-03-01 17:44:43,831] {'Bleu_1': 0.7521246458912859, 'Bleu_2': 0.6641240464951544, 'Bleu_3': 0.595860063036453, 'Bleu_4': 0.5407417666350423, 'METEOR': 0.37637013901840705, 'ROUGE_L': 0.6737951533801895, 'CIDEr': 2.297654761285124}
[INFO: 2023-03-01 17:45:53,232] ######## Epoch (VAL)33 ########
[INFO: 2023-03-01 17:45:53,232] {'Bleu_1': 0.8143884892074613, 'Bleu_2': 0.7266430481160865, 'Bleu_3': 0.6534740853517095, 'Bleu_4': 0.5872189876019296, 'METEOR': 0.41858537383154226, 'ROUGE_L': 0.7325188314407469, 'CIDEr': 2.528634606021764}
[INFO: 2023-03-01 17:46:09,339] ######## Epoch (TEST)33 ########
[INFO: 2023-03-01 17:46:09,340] {'Bleu_1': 0.7236467236446619, 'Bleu_2': 0.6244319320302677, 'Bleu_3': 0.5417806594819917, 'Bleu_4': 0.4685318708526707, 'METEOR': 0.3578058535325962, 'ROUGE_L': 0.6472690068821438, 'CIDEr': 1.824788749931998}
[INFO: 2023-03-01 17:47:18,845] ######## Epoch (VAL)34 ########
[INFO: 2023-03-01 17:47:18,846] {'Bleu_1': 0.803498057573661, 'Bleu_2': 0.7203020008148758, 'Bleu_3': 0.6466681223484259, 'Bleu_4': 0.5754519143231058, 'METEOR': 0.400966321851613, 'ROUGE_L': 0.7183224052611237, 'CIDEr': 2.474943257910379}
[INFO: 2023-03-01 17:47:34,316] ######## Epoch (TEST)34 ########
[INFO: 2023-03-01 17:47:34,317] {'Bleu_1': 0.7461929849479255, 'Bleu_2': 0.6587376388178148, 'Bleu_3': 0.577846068916732, 'Bleu_4': 0.5043579671815678, 'METEOR': 0.3728155713507265, 'ROUGE_L': 0.6772755927198805, 'CIDEr': 2.122685004988049}
[INFO: 2023-03-01 17:48:43,545] ######## Epoch (VAL)35 ########
[INFO: 2023-03-01 17:48:43,546] {'Bleu_1': 0.792752058182654, 'Bleu_2': 0.7285781380894683, 'Bleu_3': 0.6741270575296158, 'Bleu_4': 0.6218566971077641, 'METEOR': 0.43208805574282005, 'ROUGE_L': 0.7457759478056785, 'CIDEr': 2.7011001603468543}
[INFO: 2023-03-01 17:48:59,314] ######## Epoch (TEST)35 ########
[INFO: 2023-03-01 17:48:59,314] {'Bleu_1': 0.704378004330084, 'Bleu_2': 0.6156484670141136, 'Bleu_3': 0.5438015446093654, 'Bleu_4': 0.4792026480667752, 'METEOR': 0.35516400334322235, 'ROUGE_L': 0.6306521961709994, 'CIDEr': 2.086704465495138}
[INFO: 2023-03-01 17:50:08,998] ######## Epoch (VAL)36 ########
[INFO: 2023-03-01 17:50:08,999] {'Bleu_1': 0.8400556328221974, 'Bleu_2': 0.7587564490454417, 'Bleu_3': 0.6852343515500721, 'Bleu_4': 0.6191987287979214, 'METEOR': 0.43347150654122374, 'ROUGE_L': 0.7541133211818511, 'CIDEr': 2.673921311824269}
[INFO: 2023-03-01 17:50:24,787] ######## Epoch (TEST)36 ########
[INFO: 2023-03-01 17:50:24,787] {'Bleu_1': 0.7802197802187085, 'Bleu_2': 0.6892886992679081, 'Bleu_3': 0.6125114363067241, 'Bleu_4': 0.5439122299045012, 'METEOR': 0.38160097548379013, 'ROUGE_L': 0.6939251817565381, 'CIDEr': 2.3825085518106404}
[INFO: 2023-03-01 17:51:34,342] ######## Epoch (VAL)37 ########
[INFO: 2023-03-01 17:51:34,343] {'Bleu_1': 0.8198581560272059, 'Bleu_2': 0.7390194276519086, 'Bleu_3': 0.6655916199296161, 'Bleu_4': 0.5984601660336787, 'METEOR': 0.41493546980809665, 'ROUGE_L': 0.7466266584524279, 'CIDEr': 2.5651666128588237}
[INFO: 2023-03-01 17:51:49,641] ######## Epoch (TEST)37 ########
[INFO: 2023-03-01 17:51:49,641] {'Bleu_1': 0.7899278186680223, 'Bleu_2': 0.7063558864104484, 'Bleu_3': 0.6252642954179881, 'Bleu_4': 0.5515677691132779, 'METEOR': 0.3817646554502008, 'ROUGE_L': 0.6962942667028562, 'CIDEr': 2.1632676738274332}
[INFO: 2023-03-01 17:52:59,492] ######## Epoch (VAL)38 ########
[INFO: 2023-03-01 17:52:59,492] {'Bleu_1': 0.8047350455384694, 'Bleu_2': 0.7128223769409406, 'Bleu_3': 0.6356167359018594, 'Bleu_4': 0.5654618174158, 'METEOR': 0.3959689420768841, 'ROUGE_L': 0.7230444810981973, 'CIDEr': 2.439286115554531}
[INFO: 2023-03-01 17:53:14,523] ######## Epoch (TEST)38 ########
[INFO: 2023-03-01 17:53:14,524] {'Bleu_1': 0.7510789503292831, 'Bleu_2': 0.6614572776276486, 'Bleu_3': 0.5881125288566363, 'Bleu_4': 0.5270234340743234, 'METEOR': 0.3634553907792332, 'ROUGE_L': 0.6646595404727754, 'CIDEr': 2.1427340937166757}
[INFO: 2023-03-01 17:54:23,781] ######## Epoch (VAL)39 ########
[INFO: 2023-03-01 17:54:23,782] {'Bleu_1': 0.8173913043466414, 'Bleu_2': 0.7156555776959159, 'Bleu_3': 0.6298223769406335, 'Bleu_4': 0.5557349318301216, 'METEOR': 0.412111345016414, 'ROUGE_L': 0.7319220774763893, 'CIDEr': 2.5454528312946576}
[INFO: 2023-03-01 17:54:38,608] ######## Epoch (TEST)39 ########
[INFO: 2023-03-01 17:54:38,608] {'Bleu_1': 0.7558945908449988, 'Bleu_2': 0.6608048799998916, 'Bleu_3': 0.5819038784697596, 'Bleu_4': 0.5154726473200953, 'METEOR': 0.3781470024755602, 'ROUGE_L': 0.6805180121466587, 'CIDEr': 2.209831190508573}
[INFO: 2023-03-01 17:55:47,756] ######## Epoch (VAL)40 ########
[INFO: 2023-03-01 17:55:47,756] {'Bleu_1': 0.8365122615792419, 'Bleu_2': 0.753649040226795, 'Bleu_3': 0.6779273802795642, 'Bleu_4': 0.6106964232340061, 'METEOR': 0.42862253875524986, 'ROUGE_L': 0.7449654020917931, 'CIDEr': 2.58016207444003}
[INFO: 2023-03-01 17:56:02,410] ######## Epoch (TEST)40 ########
[INFO: 2023-03-01 17:56:02,410] {'Bleu_1': 0.7738419618518068, 'Bleu_2': 0.685920370678815, 'Bleu_3': 0.6132918381879363, 'Bleu_4': 0.5492896937082453, 'METEOR': 0.3954068908477449, 'ROUGE_L': 0.6975318479956402, 'CIDEr': 2.378709896445244}
[INFO: 2023-03-01 19:43:06,465] Training with config:
[INFO: 2023-03-01 19:43:06,468] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mssydney/sent/sydney_train_input.pkl',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 8,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mssydney/sent/sydney_train_target.pkl',
                 'TEST_4W_ID': './mscoco/misc/ids2path_json/coco_test4w_ids2path.json',
                 'TEST_ATT_FEATS': './mssydney/feature/Sydney',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mssydney/misc/ids2path_json/sydney_test_ids2path.json',
                 'TRAIN_ATT_FEATS': './mssydney/feature/Sydney',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mssydney/misc/ids2path_json/sydney_train_ids2path.json',
                 'VAL_ATT_FEATS': './mssydney/feature/Sydney',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mssydney/misc/ids2path_json/sydney_val_ids2path.json'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 5,
               'CAP_KEY': 'caption',
               'COCO_PATH': './coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mssydney/misc/test_sydney.json',
               'VAL_ANNFILE': './mssydney/misc/val_sydney.json',
               'VOCAB': './mssydney/txt/Sydney_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'LabelSmoothing'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 1536,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 512,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 512,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [64, 32, 64],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 3,
                        'DIM': 512,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [64, 32, 64],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.1,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 3,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.1,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.1,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 1536,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 512,
           'SEQ_LEN': 24,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'PureT',
           'VOCAB_SIZE': 181,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 512,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'MAX_LEN': 'MAX_LEN',
           'MULCLASS': 'MULCLASS',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments_PureT/PureT_XE_Sydney/',
 'SCORER': {'CIDER_CACHED': './mssydney/misc/sydney_train_cider.pkl',
            'GT_PATH': './mssydney/misc/sydney_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1234.0,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 0.0005,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 512,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Noam',
                          'WARMUP': 10000},
            'MAX_EPOCH': 40,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2023-03-01 19:44:19,495] ######## Epoch (VAL)1 ########
[INFO: 2023-03-01 19:44:19,496] {'Bleu_1': 8.551566359038922e-12, 'Bleu_2': 1.9533154048782363e-19, 'Bleu_3': 5.624919720916227e-22, 'Bleu_4': 3.0537898816377345e-23, 'METEOR': 0.000630715862503942, 'ROUGE_L': 0.0011382295865054483, 'CIDEr': 6.456111789480353e-06}
[INFO: 2023-03-01 19:44:34,094] ######## Epoch (TEST)1 ########
[INFO: 2023-03-01 19:44:34,094] {'Bleu_1': 0.0, 'Bleu_2': 0.0, 'Bleu_3': 0.0, 'Bleu_4': 0.0, 'METEOR': 0.0, 'ROUGE_L': 0.0, 'CIDEr': 0.0}
[INFO: 2023-03-01 19:45:41,373] ######## Epoch (VAL)2 ########
[INFO: 2023-03-01 19:45:41,373] {'Bleu_1': 0.0, 'Bleu_2': 0.0, 'Bleu_3': 0.0, 'Bleu_4': 0.0, 'METEOR': 0.0, 'ROUGE_L': 0.0, 'CIDEr': 0.0}
[INFO: 2023-03-01 19:45:56,027] ######## Epoch (TEST)2 ########
[INFO: 2023-03-01 19:45:56,027] {'Bleu_1': 0.0, 'Bleu_2': 0.0, 'Bleu_3': 0.0, 'Bleu_4': 0.0, 'METEOR': 0.0, 'ROUGE_L': 0.0, 'CIDEr': 0.0}
[INFO: 2023-03-01 19:47:04,325] ######## Epoch (VAL)3 ########
[INFO: 2023-03-01 19:47:04,326] {'Bleu_1': 1.1628233029251956e-10, 'Bleu_2': 1.162823302949421e-13, 'Bleu_3': 1.1628233029574969e-14, 'Bleu_4': 3.677170153678465e-15, 'METEOR': 0.007650621613006058, 'ROUGE_L': 0.06122076533098817, 'CIDEr': 0.005928422479841971}
[INFO: 2023-03-01 19:47:19,336] ######## Epoch (TEST)3 ########
[INFO: 2023-03-01 19:47:19,337] {'Bleu_1': 1.1567144148105545e-09, 'Bleu_2': 1.1796218745773003e-12, 'Bleu_3': 1.1873580671490634e-13, 'Bleu_4': 3.7670479841089986e-14, 'METEOR': 0.0083108248493663, 'ROUGE_L': 0.06880854789152935, 'CIDEr': 0.0032731767006000862}
[INFO: 2023-03-01 19:48:28,556] ######## Epoch (VAL)4 ########
[INFO: 2023-03-01 19:48:28,557] {'Bleu_1': 0.024222777718144697, 'Bleu_2': 0.02353416030418667, 'Bleu_3': 0.02336641084299858, 'Bleu_4': 0.024618759297585766, 'METEOR': 0.08737775306354532, 'ROUGE_L': 0.2603258620366135, 'CIDEr': 0.2955629279821918}
[INFO: 2023-03-01 19:48:44,014] ######## Epoch (TEST)4 ########
[INFO: 2023-03-01 19:48:44,014] {'Bleu_1': 0.021273845791987142, 'Bleu_2': 0.01964003306301326, 'Bleu_3': 0.01939243182988027, 'Bleu_4': 0.02057610373979182, 'METEOR': 0.08361249674387826, 'ROUGE_L': 0.26840363308033, 'CIDEr': 0.2592637636732752}
[INFO: 2023-03-01 19:49:53,790] ######## Epoch (VAL)5 ########
[INFO: 2023-03-01 19:49:53,790] {'Bleu_1': 0.12955919175712724, 'Bleu_2': 0.11510695744514275, 'Bleu_3': 0.10784140777407154, 'Bleu_4': 0.10022643129414978, 'METEOR': 0.12424463248194478, 'ROUGE_L': 0.34372878210680924, 'CIDEr': 0.6240997956091179}
[INFO: 2023-03-01 19:50:09,186] ######## Epoch (TEST)5 ########
[INFO: 2023-03-01 19:50:09,187] {'Bleu_1': 0.13467897585912222, 'Bleu_2': 0.12012980511292642, 'Bleu_3': 0.11353687264123459, 'Bleu_4': 0.10667863833993503, 'METEOR': 0.1329670627572217, 'ROUGE_L': 0.37003267285593966, 'CIDEr': 0.6964069558439243}
[INFO: 2023-03-01 19:51:19,922] ######## Epoch (VAL)6 ########
[INFO: 2023-03-01 19:51:19,923] {'Bleu_1': 0.36619516697919896, 'Bleu_2': 0.33782150935420646, 'Bleu_3': 0.30883530268024967, 'Bleu_4': 0.2717831702236539, 'METEOR': 0.2094371368274008, 'ROUGE_L': 0.4745894833161476, 'CIDEr': 1.1079444757641972}
[INFO: 2023-03-01 19:51:35,200] ######## Epoch (TEST)6 ########
[INFO: 2023-03-01 19:51:35,201] {'Bleu_1': 0.3463738187250861, 'Bleu_2': 0.31289646673887495, 'Bleu_3': 0.2872694888163297, 'Bleu_4': 0.267386514948463, 'METEOR': 0.2021421548898522, 'ROUGE_L': 0.47219461500217896, 'CIDEr': 1.2242385484064782}
[INFO: 2023-03-01 19:52:44,889] ######## Epoch (VAL)7 ########
[INFO: 2023-03-01 19:52:44,890] {'Bleu_1': 0.6550420623109847, 'Bleu_2': 0.5837673416805849, 'Bleu_3': 0.5117525328770663, 'Bleu_4': 0.4440605350355842, 'METEOR': 0.3014431364187135, 'ROUGE_L': 0.6146074492220055, 'CIDEr': 1.546793622272409}
[INFO: 2023-03-01 19:53:00,019] ######## Epoch (TEST)7 ########
[INFO: 2023-03-01 19:53:00,019] {'Bleu_1': 0.6672916476214709, 'Bleu_2': 0.5992022581215526, 'Bleu_3': 0.5363656359214942, 'Bleu_4': 0.47716778880879246, 'METEOR': 0.3164920525979266, 'ROUGE_L': 0.6243247090735186, 'CIDEr': 1.7236997749383598}
[INFO: 2023-03-01 19:54:08,957] ######## Epoch (VAL)8 ########
[INFO: 2023-03-01 19:54:08,958] {'Bleu_1': 0.6470431458773115, 'Bleu_2': 0.5923763396872307, 'Bleu_3': 0.5335117023927679, 'Bleu_4': 0.46780614716977104, 'METEOR': 0.3356634263658048, 'ROUGE_L': 0.6624557592277909, 'CIDEr': 1.779837793374003}
[INFO: 2023-03-01 19:54:24,340] ######## Epoch (TEST)8 ########
[INFO: 2023-03-01 19:54:24,341] {'Bleu_1': 0.601792402724959, 'Bleu_2': 0.530670595669664, 'Bleu_3': 0.46704824011803503, 'Bleu_4': 0.40325536928495836, 'METEOR': 0.3098297004456451, 'ROUGE_L': 0.6097771848955411, 'CIDEr': 1.5704537293506817}
[INFO: 2023-03-01 19:55:33,353] ######## Epoch (VAL)9 ########
[INFO: 2023-03-01 19:55:33,353] {'Bleu_1': 0.7495159022906541, 'Bleu_2': 0.6842698241723087, 'Bleu_3': 0.6136396766872037, 'Bleu_4': 0.5419084020874516, 'METEOR': 0.36185405913714525, 'ROUGE_L': 0.6890304123453359, 'CIDEr': 2.092356993836867}
[INFO: 2023-03-01 19:55:48,945] ######## Epoch (TEST)9 ########
[INFO: 2023-03-01 19:55:48,946] {'Bleu_1': 0.722330448009203, 'Bleu_2': 0.6364403912471701, 'Bleu_3': 0.5609532680596734, 'Bleu_4': 0.487857538095865, 'METEOR': 0.34940068724998274, 'ROUGE_L': 0.6389757014767824, 'CIDEr': 1.9107300801232416}
[INFO: 2023-03-01 19:56:58,243] ######## Epoch (VAL)10 ########
[INFO: 2023-03-01 19:56:58,244] {'Bleu_1': 0.7949923560726462, 'Bleu_2': 0.7296131794389201, 'Bleu_3': 0.6578784636349839, 'Bleu_4': 0.5853318235188437, 'METEOR': 0.38001098876690326, 'ROUGE_L': 0.6958459711884876, 'CIDEr': 2.1738332904206676}
[INFO: 2023-03-01 19:57:13,257] ######## Epoch (TEST)10 ########
[INFO: 2023-03-01 19:57:13,257] {'Bleu_1': 0.7320787180699622, 'Bleu_2': 0.6513734614078323, 'Bleu_3': 0.5767416547007589, 'Bleu_4': 0.5040322951232051, 'METEOR': 0.35174043593841514, 'ROUGE_L': 0.6305589112065796, 'CIDEr': 1.9308410963769516}
[INFO: 2023-03-01 19:58:22,155] ######## Epoch (VAL)11 ########
[INFO: 2023-03-01 19:58:22,156] {'Bleu_1': 0.7281173920629709, 'Bleu_2': 0.6692298701207949, 'Bleu_3': 0.601739695595968, 'Bleu_4': 0.5261174003953905, 'METEOR': 0.35807161868527426, 'ROUGE_L': 0.6876499494653608, 'CIDEr': 2.0140640975453916}
[INFO: 2023-03-01 19:58:37,602] ######## Epoch (TEST)11 ########
[INFO: 2023-03-01 19:58:37,602] {'Bleu_1': 0.6944426346559356, 'Bleu_2': 0.6167181896771251, 'Bleu_3': 0.5430419895257428, 'Bleu_4': 0.4692733057992222, 'METEOR': 0.3478509482215968, 'ROUGE_L': 0.6556585518945952, 'CIDEr': 1.856553312341578}
[INFO: 2023-03-01 19:59:46,162] ######## Epoch (VAL)12 ########
[INFO: 2023-03-01 19:59:46,166] {'Bleu_1': 0.8176555716341278, 'Bleu_2': 0.7383113939401794, 'Bleu_3': 0.6539498395532208, 'Bleu_4': 0.5735129005253254, 'METEOR': 0.40191532176834455, 'ROUGE_L': 0.713430492357902, 'CIDEr': 2.276701108493504}
[INFO: 2023-03-01 20:00:01,947] ######## Epoch (TEST)12 ########
[INFO: 2023-03-01 20:00:01,947] {'Bleu_1': 0.7654044591501814, 'Bleu_2': 0.6816511030306611, 'Bleu_3': 0.6098713584023727, 'Bleu_4': 0.544697245686819, 'METEOR': 0.3762468704374056, 'ROUGE_L': 0.6893811124700913, 'CIDEr': 2.217153717738736}
[INFO: 2023-03-01 20:01:10,272] ######## Epoch (VAL)13 ########
[INFO: 2023-03-01 20:01:10,273] {'Bleu_1': 0.7295397520095366, 'Bleu_2': 0.6249718190484619, 'Bleu_3': 0.5350237024646972, 'Bleu_4': 0.4481353326754407, 'METEOR': 0.36692153146856477, 'ROUGE_L': 0.6481953800618249, 'CIDEr': 1.9721634310805713}
[INFO: 2023-03-01 20:01:25,766] ######## Epoch (TEST)13 ########
[INFO: 2023-03-01 20:01:25,767] {'Bleu_1': 0.6973789336387717, 'Bleu_2': 0.5994477056620446, 'Bleu_3': 0.52497835616025, 'Bleu_4': 0.4552252738405289, 'METEOR': 0.3563228542626439, 'ROUGE_L': 0.6415864964862771, 'CIDEr': 1.9045647573024478}
[INFO: 2023-03-01 20:02:34,287] ######## Epoch (VAL)14 ########
[INFO: 2023-03-01 20:02:34,288] {'Bleu_1': 0.8229317851947417, 'Bleu_2': 0.7418625779421147, 'Bleu_3': 0.6568075064701848, 'Bleu_4': 0.5737772569755313, 'METEOR': 0.40260028873501447, 'ROUGE_L': 0.7202353780505494, 'CIDEr': 2.3056883703106283}
[INFO: 2023-03-01 20:02:50,438] ######## Epoch (TEST)14 ########
[INFO: 2023-03-01 20:02:50,439] {'Bleu_1': 0.7805782710951298, 'Bleu_2': 0.6942403435429622, 'Bleu_3': 0.6207723618693199, 'Bleu_4': 0.5532966276973885, 'METEOR': 0.3851110221872216, 'ROUGE_L': 0.7052605437252936, 'CIDEr': 2.2983631101759214}
[INFO: 2023-03-01 20:03:59,130] ######## Epoch (VAL)15 ########
[INFO: 2023-03-01 20:03:59,130] {'Bleu_1': 0.8219971056416149, 'Bleu_2': 0.7393913015443733, 'Bleu_3': 0.6538468763290534, 'Bleu_4': 0.5712825528011211, 'METEOR': 0.4069820291351655, 'ROUGE_L': 0.7217791319232888, 'CIDEr': 2.3047973330096783}
[INFO: 2023-03-01 20:04:14,910] ######## Epoch (TEST)15 ########
[INFO: 2023-03-01 20:04:14,911] {'Bleu_1': 0.7831669044200193, 'Bleu_2': 0.6962468010857525, 'Bleu_3': 0.6245577905458618, 'Bleu_4': 0.5588528016831696, 'METEOR': 0.3842750149147231, 'ROUGE_L': 0.6965960475394818, 'CIDEr': 2.320528245942842}
[INFO: 2023-03-01 20:05:23,663] ######## Epoch (VAL)16 ########
[INFO: 2023-03-01 20:05:23,663] {'Bleu_1': 0.8067226890745004, 'Bleu_2': 0.7143881869506132, 'Bleu_3': 0.6249488300624598, 'Bleu_4': 0.5413439715611538, 'METEOR': 0.4017195219618353, 'ROUGE_L': 0.7201117188481732, 'CIDEr': 2.284302055951803}
[INFO: 2023-03-01 20:05:39,285] ######## Epoch (TEST)16 ########
[INFO: 2023-03-01 20:05:39,286] {'Bleu_1': 0.759336099584012, 'Bleu_2': 0.6698884287487961, 'Bleu_3': 0.5950503391448485, 'Bleu_4': 0.5289684091422641, 'METEOR': 0.38709136807460226, 'ROUGE_L': 0.6970583430510986, 'CIDEr': 2.2863966348273768}
[INFO: 2023-03-01 20:06:48,012] ######## Epoch (VAL)17 ########
[INFO: 2023-03-01 20:06:48,013] {'Bleu_1': 0.7679083094533872, 'Bleu_2': 0.6761252956886766, 'Bleu_3': 0.5903971129883885, 'Bleu_4': 0.5060628592207047, 'METEOR': 0.389457407323181, 'ROUGE_L': 0.6888263203373022, 'CIDEr': 2.1987092151802243}
[INFO: 2023-03-01 20:07:03,764] ######## Epoch (TEST)17 ########
[INFO: 2023-03-01 20:07:03,765] {'Bleu_1': 0.7441284332185639, 'Bleu_2': 0.6460643374118396, 'Bleu_3': 0.5667017661368501, 'Bleu_4': 0.4963865706543027, 'METEOR': 0.3748981486928389, 'ROUGE_L': 0.6743551481602592, 'CIDEr': 2.0644515543805957}
[INFO: 2023-03-01 20:08:12,556] ######## Epoch (VAL)18 ########
[INFO: 2023-03-01 20:08:12,556] {'Bleu_1': 0.831241283122969, 'Bleu_2': 0.746675634052905, 'Bleu_3': 0.6600604739207292, 'Bleu_4': 0.5767988811612095, 'METEOR': 0.421758106020975, 'ROUGE_L': 0.7604049599578772, 'CIDEr': 2.4765680030805175}
[INFO: 2023-03-01 20:08:28,051] ######## Epoch (TEST)18 ########
[INFO: 2023-03-01 20:08:28,051] {'Bleu_1': 0.7674087250655375, 'Bleu_2': 0.6768865968355376, 'Bleu_3': 0.6008953393539005, 'Bleu_4': 0.5341402231125081, 'METEOR': 0.3795221122175463, 'ROUGE_L': 0.69566312792307, 'CIDEr': 2.262757683313067}
[INFO: 2023-03-01 20:09:37,286] ######## Epoch (VAL)19 ########
[INFO: 2023-03-01 20:09:37,287] {'Bleu_1': 0.8221288515394648, 'Bleu_2': 0.7417375836684654, 'Bleu_3': 0.6582441782347078, 'Bleu_4': 0.5770941259254573, 'METEOR': 0.4185862674142304, 'ROUGE_L': 0.7499315257656494, 'CIDEr': 2.420547319832026}
[INFO: 2023-03-01 20:09:52,418] ######## Epoch (TEST)19 ########
[INFO: 2023-03-01 20:09:52,418] {'Bleu_1': 0.7780898876393566, 'Bleu_2': 0.6967164953242014, 'Bleu_3': 0.6195593648250033, 'Bleu_4': 0.5479919355951169, 'METEOR': 0.37916544993815127, 'ROUGE_L': 0.7051498881004714, 'CIDEr': 2.3162406850444923}
[INFO: 2023-03-01 20:11:01,107] ######## Epoch (VAL)20 ########
[INFO: 2023-03-01 20:11:01,108] {'Bleu_1': 0.8493543758954816, 'Bleu_2': 0.7725332946585441, 'Bleu_3': 0.693714139769685, 'Bleu_4': 0.6210105354560261, 'METEOR': 0.4285711510115584, 'ROUGE_L': 0.7682163188705884, 'CIDEr': 2.6522581689224687}
[INFO: 2023-03-01 20:11:16,456] ######## Epoch (TEST)20 ########
[INFO: 2023-03-01 20:11:16,457] {'Bleu_1': 0.7763433503726325, 'Bleu_2': 0.6924353637337426, 'Bleu_3': 0.6198068322132512, 'Bleu_4': 0.5527763221462847, 'METEOR': 0.3776998738518981, 'ROUGE_L': 0.6937648570571187, 'CIDEr': 2.2846877383209123}
[INFO: 2023-03-01 20:12:24,655] ######## Epoch (VAL)21 ########
[INFO: 2023-03-01 20:12:24,656] {'Bleu_1': 0.8175582990386591, 'Bleu_2': 0.7330226602096226, 'Bleu_3': 0.6497897972178301, 'Bleu_4': 0.5736109706331709, 'METEOR': 0.42210613757357507, 'ROUGE_L': 0.751629145858953, 'CIDEr': 2.4582183525644252}
[INFO: 2023-03-01 20:12:40,426] ######## Epoch (TEST)21 ########
[INFO: 2023-03-01 20:12:40,426] {'Bleu_1': 0.7818930041141537, 'Bleu_2': 0.6995794582259875, 'Bleu_3': 0.626500535469065, 'Bleu_4': 0.5593915574290147, 'METEOR': 0.3902653578050853, 'ROUGE_L': 0.7169715362930438, 'CIDEr': 2.394790506595597}
[INFO: 2023-03-01 20:13:48,327] ######## Epoch (VAL)22 ########
[INFO: 2023-03-01 20:13:48,328] {'Bleu_1': 0.7798223457379329, 'Bleu_2': 0.6905183461500228, 'Bleu_3': 0.6042168379594753, 'Bleu_4': 0.521988066828246, 'METEOR': 0.3948712123602885, 'ROUGE_L': 0.7147346730168976, 'CIDEr': 2.2908999617049197}
[INFO: 2023-03-01 20:14:04,377] ######## Epoch (TEST)22 ########
[INFO: 2023-03-01 20:14:04,377] {'Bleu_1': 0.7551499360398922, 'Bleu_2': 0.6645028659744723, 'Bleu_3': 0.5877202649979048, 'Bleu_4': 0.520609001612618, 'METEOR': 0.3561222463142943, 'ROUGE_L': 0.6587389065118, 'CIDEr': 2.288552868481502}
[INFO: 2023-03-01 20:15:11,987] ######## Epoch (VAL)23 ########
[INFO: 2023-03-01 20:15:11,988] {'Bleu_1': 0.8259668508275885, 'Bleu_2': 0.746220824924564, 'Bleu_3': 0.6758033657749314, 'Bleu_4': 0.6107838014377752, 'METEOR': 0.4381989537329128, 'ROUGE_L': 0.7596806975900798, 'CIDEr': 2.727632389766694}
[INFO: 2023-03-01 20:15:27,151] ######## Epoch (TEST)23 ########
[INFO: 2023-03-01 20:15:27,151] {'Bleu_1': 0.761570827488413, 'Bleu_2': 0.6725263431856685, 'Bleu_3': 0.6041049852127375, 'Bleu_4': 0.5458232825150181, 'METEOR': 0.379196304760241, 'ROUGE_L': 0.6882888410410664, 'CIDEr': 2.415083617490087}
[INFO: 2023-03-01 20:16:34,776] ######## Epoch (VAL)24 ########
[INFO: 2023-03-01 20:16:34,777] {'Bleu_1': 0.8014084507030966, 'Bleu_2': 0.7090303327692742, 'Bleu_3': 0.628970348176219, 'Bleu_4': 0.5540582690566781, 'METEOR': 0.42119176224674704, 'ROUGE_L': 0.7331290366626261, 'CIDEr': 2.395873402215345}
[INFO: 2023-03-01 20:16:50,072] ######## Epoch (TEST)24 ########
[INFO: 2023-03-01 20:16:50,073] {'Bleu_1': 0.7257617728521804, 'Bleu_2': 0.6333532991630869, 'Bleu_3': 0.5562426251849815, 'Bleu_4': 0.4848766012931625, 'METEOR': 0.37175284952367793, 'ROUGE_L': 0.6532145552306742, 'CIDEr': 2.1050140382649025}
[INFO: 2023-03-01 20:17:57,813] ######## Epoch (VAL)25 ########
[INFO: 2023-03-01 20:17:57,814] {'Bleu_1': 0.8119777158763064, 'Bleu_2': 0.734069437258558, 'Bleu_3': 0.6612415047546091, 'Bleu_4': 0.59129242213318, 'METEOR': 0.4241848137634619, 'ROUGE_L': 0.7278927304848686, 'CIDEr': 2.544506506554105}
[INFO: 2023-03-01 20:18:12,727] ######## Epoch (TEST)25 ########
[INFO: 2023-03-01 20:18:12,727] {'Bleu_1': 0.7616438356153951, 'Bleu_2': 0.6841736675030677, 'Bleu_3': 0.6182659715853769, 'Bleu_4': 0.5597779731075384, 'METEOR': 0.38192196967626885, 'ROUGE_L': 0.6978578550523743, 'CIDEr': 2.4140198199067786}
[INFO: 2023-03-01 20:19:20,413] ######## Epoch (VAL)26 ########
[INFO: 2023-03-01 20:19:20,413] {'Bleu_1': 0.816528351500615, 'Bleu_2': 0.735325995321117, 'Bleu_3': 0.6621650206090611, 'Bleu_4': 0.593247987171916, 'METEOR': 0.41693531962073577, 'ROUGE_L': 0.7373393288684731, 'CIDEr': 2.536500887100135}
[INFO: 2023-03-01 20:19:35,271] ######## Epoch (TEST)26 ########
[INFO: 2023-03-01 20:19:35,271] {'Bleu_1': 0.7637444279334863, 'Bleu_2': 0.6741817812608609, 'Bleu_3': 0.5979525287231712, 'Bleu_4': 0.5277090441996449, 'METEOR': 0.3650517166833767, 'ROUGE_L': 0.6611794691305427, 'CIDEr': 2.1883297504978487}
[INFO: 2023-03-01 20:20:42,816] ######## Epoch (VAL)27 ########
[INFO: 2023-03-01 20:20:42,817] {'Bleu_1': 0.823293172689661, 'Bleu_2': 0.7405834265657903, 'Bleu_3': 0.6634669573656152, 'Bleu_4': 0.5907793323538413, 'METEOR': 0.43590738783475175, 'ROUGE_L': 0.7517783881337521, 'CIDEr': 2.707337451709942}
[INFO: 2023-03-01 20:20:58,171] ######## Epoch (TEST)27 ########
[INFO: 2023-03-01 20:20:58,172] {'Bleu_1': 0.7426981919322077, 'Bleu_2': 0.659418209946213, 'Bleu_3': 0.5831483949571189, 'Bleu_4': 0.5147833777151701, 'METEOR': 0.3672547941317518, 'ROUGE_L': 0.6713110445507596, 'CIDEr': 2.226775277522724}
[INFO: 2023-03-01 20:22:05,711] ######## Epoch (VAL)28 ########
[INFO: 2023-03-01 20:22:05,711] {'Bleu_1': 0.77211064067851, 'Bleu_2': 0.6724245729805062, 'Bleu_3': 0.590664732870076, 'Bleu_4': 0.5223944707213374, 'METEOR': 0.3705961299602591, 'ROUGE_L': 0.6714624440521647, 'CIDEr': 2.3534707620938073}
[INFO: 2023-03-01 20:22:20,795] ######## Epoch (TEST)28 ########
[INFO: 2023-03-01 20:22:20,795] {'Bleu_1': 0.741570681744442, 'Bleu_2': 0.6496036223102624, 'Bleu_3': 0.573835598122413, 'Bleu_4': 0.5096754096773694, 'METEOR': 0.34271756885230426, 'ROUGE_L': 0.626002666848002, 'CIDEr': 2.1146534145230724}
[INFO: 2023-03-01 20:23:28,161] ######## Epoch (VAL)29 ########
[INFO: 2023-03-01 20:23:28,161] {'Bleu_1': 0.7764213206564581, 'Bleu_2': 0.7138836009322199, 'Bleu_3': 0.6579848947883786, 'Bleu_4': 0.6096755245076284, 'METEOR': 0.40254885002598395, 'ROUGE_L': 0.7242448557117773, 'CIDEr': 2.480225174258028}
[INFO: 2023-03-01 20:23:42,974] ######## Epoch (TEST)29 ########
[INFO: 2023-03-01 20:23:42,974] {'Bleu_1': 0.7310518513415964, 'Bleu_2': 0.6675488323967125, 'Bleu_3': 0.6154541281104918, 'Bleu_4': 0.5700006028881467, 'METEOR': 0.3801532223293262, 'ROUGE_L': 0.7008552848745209, 'CIDEr': 2.2591306736189614}
[INFO: 2023-03-01 20:24:50,429] ######## Epoch (VAL)30 ########
[INFO: 2023-03-01 20:24:50,430] {'Bleu_1': 0.7761485599753515, 'Bleu_2': 0.6827954210676407, 'Bleu_3': 0.6091739078136486, 'Bleu_4': 0.5405779990982542, 'METEOR': 0.39074011230215777, 'ROUGE_L': 0.6978541077449543, 'CIDEr': 2.4485945478022484}
[INFO: 2023-03-01 20:25:05,363] ######## Epoch (TEST)30 ########
[INFO: 2023-03-01 20:25:05,363] {'Bleu_1': 0.6980808261366965, 'Bleu_2': 0.591603735162834, 'Bleu_3': 0.505708602069828, 'Bleu_4': 0.4279445400817588, 'METEOR': 0.33888616402810046, 'ROUGE_L': 0.625206920997949, 'CIDEr': 1.7525349561141699}
[INFO: 2023-03-01 20:26:12,726] ######## Epoch (VAL)31 ########
[INFO: 2023-03-01 20:26:12,727] {'Bleu_1': 0.8156748911454054, 'Bleu_2': 0.7253390711514943, 'Bleu_3': 0.6506532330870599, 'Bleu_4': 0.5902919370700065, 'METEOR': 0.41847375289173877, 'ROUGE_L': 0.7429609903252257, 'CIDEr': 2.7074320435046806}
[INFO: 2023-03-01 20:26:27,546] ######## Epoch (TEST)31 ########
[INFO: 2023-03-01 20:26:27,546] {'Bleu_1': 0.7879234167882357, 'Bleu_2': 0.6961901673642453, 'Bleu_3': 0.6186238932113088, 'Bleu_4': 0.5540464636089474, 'METEOR': 0.3693465421690766, 'ROUGE_L': 0.6832356935754301, 'CIDEr': 2.365573465809891}
[INFO: 2023-03-01 20:27:34,862] ######## Epoch (VAL)32 ########
[INFO: 2023-03-01 20:27:34,862] {'Bleu_1': 0.8053093963941976, 'Bleu_2': 0.7182222677244884, 'Bleu_3': 0.654048352150698, 'Bleu_4': 0.6013878466428207, 'METEOR': 0.4240414755726532, 'ROUGE_L': 0.7382153058780997, 'CIDEr': 2.745328019161514}
[INFO: 2023-03-01 20:27:49,713] ######## Epoch (TEST)32 ########
[INFO: 2023-03-01 20:27:49,714] {'Bleu_1': 0.7456395348826371, 'Bleu_2': 0.6481990127511864, 'Bleu_3': 0.5751398881011616, 'Bleu_4': 0.516314882897472, 'METEOR': 0.3693696747271469, 'ROUGE_L': 0.6570887149033678, 'CIDEr': 2.190339255956331}
[INFO: 2023-03-01 20:28:57,052] ######## Epoch (VAL)33 ########
[INFO: 2023-03-01 20:28:57,053] {'Bleu_1': 0.7617975020993276, 'Bleu_2': 0.6653424679538098, 'Bleu_3': 0.5892539490061373, 'Bleu_4': 0.5218893451359137, 'METEOR': 0.39280387211030815, 'ROUGE_L': 0.6919156806852962, 'CIDEr': 2.2187348597611893}
[INFO: 2023-03-01 20:29:11,794] ######## Epoch (TEST)33 ########
[INFO: 2023-03-01 20:29:11,794] {'Bleu_1': 0.7049418604640917, 'Bleu_2': 0.588961928787545, 'Bleu_3': 0.49908834222012216, 'Bleu_4': 0.4202809614338784, 'METEOR': 0.35197945377721107, 'ROUGE_L': 0.6322667811420885, 'CIDEr': 1.7112980432872607}
[INFO: 2023-03-01 20:30:19,432] ######## Epoch (VAL)34 ########
[INFO: 2023-03-01 20:30:19,433] {'Bleu_1': 0.8021890347814072, 'Bleu_2': 0.733600503962971, 'Bleu_3': 0.6688926839702899, 'Bleu_4': 0.6049349304701614, 'METEOR': 0.41420705529013063, 'ROUGE_L': 0.7404563647698856, 'CIDEr': 2.5077989810227086}
[INFO: 2023-03-01 20:30:34,570] ######## Epoch (TEST)34 ########
[INFO: 2023-03-01 20:30:34,571] {'Bleu_1': 0.7467005645142383, 'Bleu_2': 0.6728329600336935, 'Bleu_3': 0.5989675309289999, 'Bleu_4': 0.5296083896453163, 'METEOR': 0.3707951377625038, 'ROUGE_L': 0.6838993668410832, 'CIDEr': 2.149468580008561}
[INFO: 2023-03-01 20:31:42,192] ######## Epoch (VAL)35 ########
[INFO: 2023-03-01 20:31:42,193] {'Bleu_1': 0.8153832821121312, 'Bleu_2': 0.7458338844086722, 'Bleu_3': 0.6889594319812232, 'Bleu_4': 0.6355718385866373, 'METEOR': 0.4352030939033048, 'ROUGE_L': 0.7668207774052644, 'CIDEr': 2.827368976796584}
[INFO: 2023-03-01 20:31:57,329] ######## Epoch (TEST)35 ########
[INFO: 2023-03-01 20:31:57,329] {'Bleu_1': 0.7097289442107731, 'Bleu_2': 0.626122063052976, 'Bleu_3': 0.5595930989086769, 'Bleu_4': 0.5025229375876872, 'METEOR': 0.35524613878682454, 'ROUGE_L': 0.6322841868005924, 'CIDEr': 2.1528722760639205}
[INFO: 2023-03-01 20:33:04,928] ######## Epoch (VAL)36 ########
[INFO: 2023-03-01 20:33:04,929] {'Bleu_1': 0.8536931818169692, 'Bleu_2': 0.780521930657213, 'Bleu_3': 0.7117443790796223, 'Bleu_4': 0.650991096521849, 'METEOR': 0.45127266378096936, 'ROUGE_L': 0.7833023074223938, 'CIDEr': 2.832201577338291}
[INFO: 2023-03-01 20:33:19,597] ######## Epoch (TEST)36 ########
[INFO: 2023-03-01 20:33:19,598] {'Bleu_1': 0.7424892703852038, 'Bleu_2': 0.6537764300957124, 'Bleu_3': 0.5747732873134281, 'Bleu_4': 0.5022972183639121, 'METEOR': 0.36812257848831087, 'ROUGE_L': 0.6587851062813194, 'CIDEr': 2.1520413001496435}
[INFO: 2023-03-01 20:34:27,494] ######## Epoch (VAL)37 ########
[INFO: 2023-03-01 20:34:27,494] {'Bleu_1': 0.846924265235894, 'Bleu_2': 0.7757536571585685, 'Bleu_3': 0.7130599704322309, 'Bleu_4': 0.6547368130668129, 'METEOR': 0.4323619448734656, 'ROUGE_L': 0.7582185871946635, 'CIDEr': 2.727793803118871}
[INFO: 2023-03-01 20:34:42,845] ######## Epoch (TEST)37 ########
[INFO: 2023-03-01 20:34:42,845] {'Bleu_1': 0.7975637622377227, 'Bleu_2': 0.7076117242207588, 'Bleu_3': 0.6252389968089527, 'Bleu_4': 0.5532229742104806, 'METEOR': 0.3647870917863142, 'ROUGE_L': 0.6754525012663627, 'CIDEr': 2.1168868743573115}
[INFO: 2023-03-01 20:35:50,447] ######## Epoch (VAL)38 ########
[INFO: 2023-03-01 20:35:50,448] {'Bleu_1': 0.8176241816705062, 'Bleu_2': 0.7273380337272873, 'Bleu_3': 0.6497031283966883, 'Bleu_4': 0.5753406503907267, 'METEOR': 0.3972161434771069, 'ROUGE_L': 0.7303999387879735, 'CIDEr': 2.529803028337614}
[INFO: 2023-03-01 20:36:05,674] ######## Epoch (TEST)38 ########
[INFO: 2023-03-01 20:36:05,675] {'Bleu_1': 0.7495891867662735, 'Bleu_2': 0.6543423152504495, 'Bleu_3': 0.5760854140383165, 'Bleu_4': 0.5136435448003683, 'METEOR': 0.35226892705140367, 'ROUGE_L': 0.6492251968649349, 'CIDEr': 2.1288111409047663}
[INFO: 2023-03-01 20:37:13,512] ######## Epoch (VAL)39 ########
[INFO: 2023-03-01 20:37:13,513] {'Bleu_1': 0.8199718706036287, 'Bleu_2': 0.7331026187679556, 'Bleu_3': 0.6563250362114027, 'Bleu_4': 0.5886123482243196, 'METEOR': 0.42261074741769766, 'ROUGE_L': 0.733737128545832, 'CIDEr': 2.6379556644945352}
[INFO: 2023-03-01 20:37:28,460] ######## Epoch (TEST)39 ########
[INFO: 2023-03-01 20:37:28,461] {'Bleu_1': 0.7395079594779457, 'Bleu_2': 0.6494162810674738, 'Bleu_3': 0.5785321196000391, 'Bleu_4': 0.5205194818204397, 'METEOR': 0.3587856897156806, 'ROUGE_L': 0.6486555546137864, 'CIDEr': 2.1524739653813105}
[INFO: 2023-03-01 20:38:36,329] ######## Epoch (VAL)40 ########
[INFO: 2023-03-01 20:38:36,329] {'Bleu_1': 0.8345221112684243, 'Bleu_2': 0.7496479984527666, 'Bleu_3': 0.6720712684133295, 'Bleu_4': 0.6039650922972992, 'METEOR': 0.41759170705480925, 'ROUGE_L': 0.7335065352299599, 'CIDEr': 2.3983617578842416}
[INFO: 2023-03-01 20:38:51,327] ######## Epoch (TEST)40 ########
[INFO: 2023-03-01 20:38:51,327] {'Bleu_1': 0.767045454544365, 'Bleu_2': 0.6839784241183792, 'Bleu_3': 0.6069290608413261, 'Bleu_4': 0.5382669954411696, 'METEOR': 0.3780705507204484, 'ROUGE_L': 0.6779484890149129, 'CIDEr': 2.2180305255175896}
[INFO: 2023-03-03 18:54:40,102] Training with config:
[INFO: 2023-03-03 18:54:40,105] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mssydney/sent/sydney_train_input.pkl',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 8,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mssydney/sent/sydney_train_target.pkl',
                 'TEST_4W_ID': './mscoco/misc/ids2path_json/coco_test4w_ids2path.json',
                 'TEST_ATT_FEATS': './mssydney/feature/Sydney',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mssydney/misc/ids2path_json/sydney_test_ids2path.json',
                 'TRAIN_ATT_FEATS': './mssydney/feature/Sydney',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mssydney/misc/ids2path_json/sydney_train_ids2path.json',
                 'VAL_ATT_FEATS': './mssydney/feature/Sydney',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mssydney/misc/ids2path_json/sydney_val_ids2path.json'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 5,
               'CAP_KEY': 'caption',
               'COCO_PATH': './coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mssydney/misc/test_sydney.json',
               'VAL_ANNFILE': './mssydney/misc/val_sydney.json',
               'VOCAB': './mssydney/txt/Sydney_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'LabelSmoothing'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 1536,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 512,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 512,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [64, 32, 64],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 3,
                        'DIM': 512,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [64, 32, 64],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.1,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 3,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.1,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.1,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 1536,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 512,
           'SEQ_LEN': 24,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'PureT',
           'VOCAB_SIZE': 181,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 512,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'MAX_LEN': 'MAX_LEN',
           'MULCLASS': 'MULCLASS',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments_PureT/PureT_XE_Sydney/',
 'SCORER': {'CIDER_CACHED': './mssydney/misc/sydney_train_cider.pkl',
            'GT_PATH': './mssydney/misc/sydney_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1234.0,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 0.0005,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 512,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Noam',
                          'WARMUP': 10000},
            'MAX_EPOCH': 40,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2023-03-03 18:55:59,168] ######## Epoch (VAL)1 ########
[INFO: 2023-03-03 18:55:59,169] {'Bleu_1': 0.0, 'Bleu_2': 0.0, 'Bleu_3': 0.0, 'Bleu_4': 0.0, 'METEOR': 0.0, 'ROUGE_L': 0.0, 'CIDEr': 0.0}
[INFO: 2023-03-03 18:56:15,462] ######## Epoch (TEST)1 ########
[INFO: 2023-03-03 18:56:15,463] {'Bleu_1': 0.0, 'Bleu_2': 0.0, 'Bleu_3': 0.0, 'Bleu_4': 0.0, 'METEOR': 0.0, 'ROUGE_L': 0.0, 'CIDEr': 0.0}
[INFO: 2023-03-03 18:57:23,798] ######## Epoch (VAL)2 ########
[INFO: 2023-03-03 18:57:23,798] {'Bleu_1': 0.0, 'Bleu_2': 0.0, 'Bleu_3': 0.0, 'Bleu_4': 0.0, 'METEOR': 0.0, 'ROUGE_L': 0.0, 'CIDEr': 0.0}
[INFO: 2023-03-03 18:57:38,911] ######## Epoch (TEST)2 ########
[INFO: 2023-03-03 18:57:38,911] {'Bleu_1': 0.0, 'Bleu_2': 0.0, 'Bleu_3': 0.0, 'Bleu_4': 0.0, 'METEOR': 0.0, 'ROUGE_L': 0.0, 'CIDEr': 0.0}
[INFO: 2023-03-03 18:58:47,399] ######## Epoch (VAL)3 ########
[INFO: 2023-03-03 18:58:47,399] {'Bleu_1': 8.70087585978546e-07, 'Bleu_2': 9.920524832292901e-10, 'Bleu_3': 1.0363947569631677e-10, 'Bleu_4': 3.34981240581449e-11, 'METEOR': 0.009611148932762005, 'ROUGE_L': 0.07711552938634265, 'CIDEr': 0.007321191609686478}
[INFO: 2023-03-03 18:59:03,014] ######## Epoch (TEST)3 ########
[INFO: 2023-03-03 18:59:03,014] {'Bleu_1': 5.723764366549545e-06, 'Bleu_2': 5.861706187466283e-09, 'Bleu_3': 5.908421627535237e-10, 'Bleu_4': 1.8758374228546816e-10, 'METEOR': 0.014823518777963576, 'ROUGE_L': 0.11251442742910024, 'CIDEr': 0.005290302634325542}
[INFO: 2023-03-03 19:00:11,929] ######## Epoch (VAL)4 ########
[INFO: 2023-03-03 19:00:11,929] {'Bleu_1': 0.029021657324248287, 'Bleu_2': 0.026864135726925576, 'Bleu_3': 0.026039306426598123, 'Bleu_4': 0.0008818397898970101, 'METEOR': 0.09659883466180857, 'ROUGE_L': 0.26867324421857974, 'CIDEr': 0.19436781948017676}
[INFO: 2023-03-03 19:00:27,833] ######## Epoch (TEST)4 ########
[INFO: 2023-03-03 19:00:27,834] {'Bleu_1': 0.03209585741171303, 'Bleu_2': 0.029682389802649995, 'Bleu_3': 0.02872866428295688, 'Bleu_4': 0.0009651802941416729, 'METEOR': 0.09909837778776165, 'ROUGE_L': 0.2948192422995547, 'CIDEr': 0.23927365068026807}
[INFO: 2023-03-03 19:01:36,658] ######## Epoch (VAL)5 ########
[INFO: 2023-03-03 19:01:36,659] {'Bleu_1': 0.12015208302506684, 'Bleu_2': 0.10587229214234713, 'Bleu_3': 0.09808560501040599, 'Bleu_4': 0.087184861197147, 'METEOR': 0.11830401478620152, 'ROUGE_L': 0.3341852479488111, 'CIDEr': 0.5259601694989299}
[INFO: 2023-03-03 19:01:53,221] ######## Epoch (TEST)5 ########
[INFO: 2023-03-03 19:01:53,221] {'Bleu_1': 0.13782272823792296, 'Bleu_2': 0.12299410870814315, 'Bleu_3': 0.11549494585805674, 'Bleu_4': 0.10620976512178892, 'METEOR': 0.12648589486432663, 'ROUGE_L': 0.36751113258625157, 'CIDEr': 0.6407299631209031}
[INFO: 2023-03-03 19:03:02,098] ######## Epoch (VAL)6 ########
[INFO: 2023-03-03 19:03:02,099] {'Bleu_1': 0.3894975013135832, 'Bleu_2': 0.3609983195060571, 'Bleu_3': 0.32536548996808223, 'Bleu_4': 0.278389070304643, 'METEOR': 0.2172217950789832, 'ROUGE_L': 0.4863672619934499, 'CIDEr': 1.110515262008851}
[INFO: 2023-03-03 19:03:17,962] ######## Epoch (TEST)6 ########
[INFO: 2023-03-03 19:03:17,962] {'Bleu_1': 0.4449370205159174, 'Bleu_2': 0.39876361979857666, 'Bleu_3': 0.3563170526605355, 'Bleu_4': 0.3215109556912638, 'METEOR': 0.22822912847346308, 'ROUGE_L': 0.5079109162773157, 'CIDEr': 1.3107902843515036}
[INFO: 2023-03-03 19:04:27,335] ######## Epoch (VAL)7 ########
[INFO: 2023-03-03 19:04:27,336] {'Bleu_1': 0.659832674624553, 'Bleu_2': 0.5984336417491607, 'Bleu_3': 0.5262964999779138, 'Bleu_4': 0.4576336956189581, 'METEOR': 0.3136820349549572, 'ROUGE_L': 0.6354398116210449, 'CIDEr': 1.526289237731584}
[INFO: 2023-03-03 19:04:43,931] ######## Epoch (TEST)7 ########
[INFO: 2023-03-03 19:04:43,931] {'Bleu_1': 0.6371645327594927, 'Bleu_2': 0.5759264088350993, 'Bleu_3': 0.5157982561866918, 'Bleu_4': 0.4595418953657168, 'METEOR': 0.3179557194910335, 'ROUGE_L': 0.6441596842022461, 'CIDEr': 1.680567768109357}
[INFO: 2023-03-03 19:05:54,469] ######## Epoch (VAL)8 ########
[INFO: 2023-03-03 19:05:54,470] {'Bleu_1': 0.6680144569353802, 'Bleu_2': 0.6125959759508474, 'Bleu_3': 0.5479718607478103, 'Bleu_4': 0.4728416759848831, 'METEOR': 0.33088565433700884, 'ROUGE_L': 0.6612082253507017, 'CIDEr': 1.7949386866008432}
[INFO: 2023-03-03 19:06:10,212] ######## Epoch (TEST)8 ########
[INFO: 2023-03-03 19:06:10,212] {'Bleu_1': 0.5806311733495487, 'Bleu_2': 0.5057594688744027, 'Bleu_3': 0.4381775405324671, 'Bleu_4': 0.3719812842914151, 'METEOR': 0.2929441470066759, 'ROUGE_L': 0.6022962426069551, 'CIDEr': 1.5104836288810477}
[INFO: 2023-03-03 19:07:20,757] ######## Epoch (VAL)9 ########
[INFO: 2023-03-03 19:07:20,758] {'Bleu_1': 0.7910610034419034, 'Bleu_2': 0.7174677081831872, 'Bleu_3': 0.6383924722160429, 'Bleu_4': 0.562153021970687, 'METEOR': 0.3735234060863569, 'ROUGE_L': 0.6810891831539886, 'CIDEr': 2.1267492628427136}
[INFO: 2023-03-03 19:07:36,987] ######## Epoch (TEST)9 ########
[INFO: 2023-03-03 19:07:36,987] {'Bleu_1': 0.7525132111380178, 'Bleu_2': 0.6715545390794767, 'Bleu_3': 0.5969145479459691, 'Bleu_4': 0.5245835849024542, 'METEOR': 0.3579403880210596, 'ROUGE_L': 0.6532303474438178, 'CIDEr': 2.0388109177507134}
[INFO: 2023-03-03 19:08:46,297] ######## Epoch (VAL)10 ########
[INFO: 2023-03-03 19:08:46,298] {'Bleu_1': 0.8108365575792504, 'Bleu_2': 0.7443920259334414, 'Bleu_3': 0.6684850287828673, 'Bleu_4': 0.5928399830149335, 'METEOR': 0.38253429566692004, 'ROUGE_L': 0.6944059434571577, 'CIDEr': 2.1950004315499276}
[INFO: 2023-03-03 19:09:02,058] ######## Epoch (TEST)10 ########
[INFO: 2023-03-03 19:09:02,058] {'Bleu_1': 0.7379213135610337, 'Bleu_2': 0.6549688832552457, 'Bleu_3': 0.5786193547945937, 'Bleu_4': 0.50578311887437, 'METEOR': 0.35237894849550383, 'ROUGE_L': 0.6402597722359049, 'CIDEr': 1.971806636288328}
[INFO: 2023-03-03 19:10:11,500] ######## Epoch (VAL)11 ########
[INFO: 2023-03-03 19:10:11,501] {'Bleu_1': 0.816528351500615, 'Bleu_2': 0.7454182776297487, 'Bleu_3': 0.6704984231898435, 'Bleu_4': 0.5951715003972958, 'METEOR': 0.38796327059428337, 'ROUGE_L': 0.7032602598905188, 'CIDEr': 2.252523567260122}
[INFO: 2023-03-03 19:10:27,499] ######## Epoch (TEST)11 ########
[INFO: 2023-03-03 19:10:27,499] {'Bleu_1': 0.7579664778285644, 'Bleu_2': 0.6738551066931664, 'Bleu_3': 0.6002377760303242, 'Bleu_4': 0.530835804115459, 'METEOR': 0.3616019975611063, 'ROUGE_L': 0.6581973220256425, 'CIDEr': 2.1104562562878084}
[INFO: 2023-03-03 19:11:37,264] ######## Epoch (VAL)12 ########
[INFO: 2023-03-03 19:11:37,264] {'Bleu_1': 0.8134110787160155, 'Bleu_2': 0.7313920671612024, 'Bleu_3': 0.6473033074351194, 'Bleu_4': 0.5683684153386946, 'METEOR': 0.3952298831001353, 'ROUGE_L': 0.7093301150683085, 'CIDEr': 2.1800374385787444}
[INFO: 2023-03-03 19:11:53,524] ######## Epoch (TEST)12 ########
[INFO: 2023-03-03 19:11:53,524] {'Bleu_1': 0.7703467670879339, 'Bleu_2': 0.6878985451460529, 'Bleu_3': 0.6180675666844184, 'Bleu_4': 0.5536191261898377, 'METEOR': 0.3711643824608037, 'ROUGE_L': 0.6885782909955217, 'CIDEr': 2.284017704771573}
[INFO: 2023-03-03 19:13:03,858] ######## Epoch (VAL)13 ########
[INFO: 2023-03-03 19:13:03,859] {'Bleu_1': 0.7369207772773186, 'Bleu_2': 0.6222176293235712, 'Bleu_3': 0.52862453470195, 'Bleu_4': 0.43681661074792466, 'METEOR': 0.36832750822777605, 'ROUGE_L': 0.6501879282173123, 'CIDEr': 1.897660368106393}
[INFO: 2023-03-03 19:13:19,540] ######## Epoch (TEST)13 ########
[INFO: 2023-03-03 19:13:19,540] {'Bleu_1': 0.6776950674262142, 'Bleu_2': 0.5617502944727694, 'Bleu_3': 0.4843346917522143, 'Bleu_4': 0.4158584760427885, 'METEOR': 0.3402823453287062, 'ROUGE_L': 0.6168842321293604, 'CIDEr': 1.7843285131823006}
[INFO: 2023-03-03 19:14:29,715] ######## Epoch (VAL)14 ########
[INFO: 2023-03-03 19:14:29,715] {'Bleu_1': 0.7495706346167547, 'Bleu_2': 0.6452687980455895, 'Bleu_3': 0.5519536716959552, 'Bleu_4': 0.46335099725842677, 'METEOR': 0.37271572337783293, 'ROUGE_L': 0.6725616807200867, 'CIDEr': 1.9819012381093746}
[INFO: 2023-03-03 19:14:45,723] ######## Epoch (TEST)14 ########
[INFO: 2023-03-03 19:14:45,724] {'Bleu_1': 0.75609756097344, 'Bleu_2': 0.6661225307119174, 'Bleu_3': 0.5979938467664487, 'Bleu_4': 0.5367488512956478, 'METEOR': 0.37833494145751406, 'ROUGE_L': 0.6801860223745637, 'CIDEr': 2.2232629514602404}
[INFO: 2023-03-03 19:15:56,231] ######## Epoch (VAL)15 ########
[INFO: 2023-03-03 19:15:56,231] {'Bleu_1': 0.8163186789129867, 'Bleu_2': 0.7363835719833715, 'Bleu_3': 0.6504368317318359, 'Bleu_4': 0.569916878653043, 'METEOR': 0.40428022317334356, 'ROUGE_L': 0.725085655089561, 'CIDEr': 2.2402558177440275}
[INFO: 2023-03-03 19:16:12,081] ######## Epoch (TEST)15 ########
[INFO: 2023-03-03 19:16:12,081] {'Bleu_1': 0.7631884060951446, 'Bleu_2': 0.6804949412295399, 'Bleu_3': 0.6117669649692702, 'Bleu_4': 0.5504408534152411, 'METEOR': 0.3681511824432347, 'ROUGE_L': 0.6822409689190693, 'CIDEr': 2.26163774535976}
[INFO: 2023-03-03 19:17:22,273] ######## Epoch (VAL)16 ########
[INFO: 2023-03-03 19:17:22,274] {'Bleu_1': 0.7904360056247673, 'Bleu_2': 0.6975732099554715, 'Bleu_3': 0.6096035161624646, 'Bleu_4': 0.5271143002700153, 'METEOR': 0.40408709717690616, 'ROUGE_L': 0.7143889082185415, 'CIDEr': 2.2665039965509157}
[INFO: 2023-03-03 19:17:38,811] ######## Epoch (TEST)16 ########
[INFO: 2023-03-03 19:17:38,811] {'Bleu_1': 0.7627586206886031, 'Bleu_2': 0.6754871523833205, 'Bleu_3': 0.6039320458517778, 'Bleu_4': 0.5401918868397132, 'METEOR': 0.3862437646326218, 'ROUGE_L': 0.6997713305765941, 'CIDEr': 2.369573823685525}
[INFO: 2023-03-03 19:18:48,825] ######## Epoch (VAL)17 ########
[INFO: 2023-03-03 19:18:48,826] {'Bleu_1': 0.7687943262400443, 'Bleu_2': 0.6737280449500028, 'Bleu_3': 0.5859107794275347, 'Bleu_4': 0.5000011139132454, 'METEOR': 0.39573769641360146, 'ROUGE_L': 0.6980900958162554, 'CIDEr': 2.3412583421837603}
[INFO: 2023-03-03 19:19:04,813] ######## Epoch (TEST)17 ########
[INFO: 2023-03-03 19:19:04,814] {'Bleu_1': 0.7318407096496367, 'Bleu_2': 0.6319683534852967, 'Bleu_3': 0.5595122144080933, 'Bleu_4': 0.49392279175632253, 'METEOR': 0.37167812743037265, 'ROUGE_L': 0.6736144826773153, 'CIDEr': 2.064883409612514}
[INFO: 2023-03-03 19:20:15,197] ######## Epoch (VAL)18 ########
[INFO: 2023-03-03 19:20:15,197] {'Bleu_1': 0.8101265822773416, 'Bleu_2': 0.7252751190359411, 'Bleu_3': 0.6381831121858061, 'Bleu_4': 0.5577928052392431, 'METEOR': 0.4193856997009245, 'ROUGE_L': 0.7426357067759042, 'CIDEr': 2.3749994811092874}
[INFO: 2023-03-03 19:20:31,754] ######## Epoch (TEST)18 ########
[INFO: 2023-03-03 19:20:31,754] {'Bleu_1': 0.7670850767074379, 'Bleu_2': 0.6849069649974482, 'Bleu_3': 0.6149903754408393, 'Bleu_4': 0.5534295071663154, 'METEOR': 0.3897994178977781, 'ROUGE_L': 0.7070398406136095, 'CIDEr': 2.4075192636423552}
[INFO: 2023-03-03 19:21:41,905] ######## Epoch (VAL)19 ########
[INFO: 2023-03-03 19:21:41,905] {'Bleu_1': 0.8281249999988237, 'Bleu_2': 0.7501773526105987, 'Bleu_3': 0.66480812069054, 'Bleu_4': 0.5813264379086218, 'METEOR': 0.4276142026056152, 'ROUGE_L': 0.7636772725101497, 'CIDEr': 2.6069139558057617}
[INFO: 2023-03-03 19:21:57,765] ######## Epoch (TEST)19 ########
[INFO: 2023-03-03 19:21:57,766] {'Bleu_1': 0.7613356680731017, 'Bleu_2': 0.679946182266993, 'Bleu_3': 0.6119678840965015, 'Bleu_4': 0.5512838308772247, 'METEOR': 0.38448354999932005, 'ROUGE_L': 0.7102129350056635, 'CIDEr': 2.4216399507104676}
[INFO: 2023-03-03 19:23:07,984] ######## Epoch (VAL)20 ########
[INFO: 2023-03-03 19:23:07,985] {'Bleu_1': 0.8207282913153772, 'Bleu_2': 0.7394154160389315, 'Bleu_3': 0.6561625389824828, 'Bleu_4': 0.5797938069622497, 'METEOR': 0.42194228410346185, 'ROUGE_L': 0.7434772832955142, 'CIDEr': 2.471934157530248}
[INFO: 2023-03-03 19:23:24,424] ######## Epoch (TEST)20 ########
[INFO: 2023-03-03 19:23:24,424] {'Bleu_1': 0.7754411200886435, 'Bleu_2': 0.6947482708594641, 'Bleu_3': 0.6265973251155463, 'Bleu_4': 0.564673110176772, 'METEOR': 0.38650481907097795, 'ROUGE_L': 0.710153744665384, 'CIDEr': 2.4156601009930045}
[INFO: 2023-03-03 19:24:34,829] ######## Epoch (VAL)21 ########
[INFO: 2023-03-03 19:24:34,829] {'Bleu_1': 0.8287292817668112, 'Bleu_2': 0.747467644214957, 'Bleu_3': 0.666365283240183, 'Bleu_4': 0.5911532261435917, 'METEOR': 0.4325552536210441, 'ROUGE_L': 0.7587876754596533, 'CIDEr': 2.6421681123619236}
[INFO: 2023-03-03 19:24:51,563] ######## Epoch (TEST)21 ########
[INFO: 2023-03-03 19:24:51,563] {'Bleu_1': 0.7773224043705228, 'Bleu_2': 0.6934875550818865, 'Bleu_3': 0.6225176992423883, 'Bleu_4': 0.5559724818046304, 'METEOR': 0.3930943151331695, 'ROUGE_L': 0.7159041536497809, 'CIDEr': 2.481364404990416}
[INFO: 2023-03-03 19:26:02,638] ######## Epoch (VAL)22 ########
[INFO: 2023-03-03 19:26:02,639] {'Bleu_1': 0.8351851668361319, 'Bleu_2': 0.7491050929332488, 'Bleu_3': 0.6700733692925441, 'Bleu_4': 0.5966979673869602, 'METEOR': 0.42187627465182553, 'ROUGE_L': 0.7487003581377176, 'CIDEr': 2.505893788096504}
[INFO: 2023-03-03 19:26:18,757] ######## Epoch (TEST)22 ########
[INFO: 2023-03-03 19:26:18,757] {'Bleu_1': 0.7431610942237946, 'Bleu_2': 0.6546420632694434, 'Bleu_3': 0.584848009550287, 'Bleu_4': 0.5251403357295391, 'METEOR': 0.35379740733458087, 'ROUGE_L': 0.6312231368648985, 'CIDEr': 2.213949297769269}
[INFO: 2023-03-03 19:27:29,439] ######## Epoch (VAL)23 ########
[INFO: 2023-03-03 19:27:29,440] {'Bleu_1': 0.8402203856737738, 'Bleu_2': 0.7786313667139075, 'Bleu_3': 0.7183690211792036, 'Bleu_4': 0.6614349547654479, 'METEOR': 0.4632431333367914, 'ROUGE_L': 0.7805835437377631, 'CIDEr': 3.009183980860249}
[INFO: 2023-03-03 19:27:45,948] ######## Epoch (TEST)23 ########
[INFO: 2023-03-03 19:27:45,949] {'Bleu_1': 0.7729072112965081, 'Bleu_2': 0.7054829296460475, 'Bleu_3': 0.6474387987641306, 'Bleu_4': 0.5976237120729229, 'METEOR': 0.3943926818433875, 'ROUGE_L': 0.7166935957531668, 'CIDEr': 2.5743225833887786}
[INFO: 2023-03-03 19:28:56,309] ######## Epoch (VAL)24 ########
[INFO: 2023-03-03 19:28:56,309] {'Bleu_1': 0.7944444444433411, 'Bleu_2': 0.7107941083864088, 'Bleu_3': 0.6307500858271698, 'Bleu_4': 0.5560459242595777, 'METEOR': 0.4296952251120093, 'ROUGE_L': 0.7477913276433024, 'CIDEr': 2.4683825153116925}
[INFO: 2023-03-03 19:29:13,436] ######## Epoch (TEST)24 ########
[INFO: 2023-03-03 19:29:13,437] {'Bleu_1': 0.7286931818171467, 'Bleu_2': 0.6390140090343117, 'Bleu_3': 0.5637515030666096, 'Bleu_4': 0.49597532987061765, 'METEOR': 0.37631478294695414, 'ROUGE_L': 0.6667262954765065, 'CIDEr': 2.157748620171949}
[INFO: 2023-03-03 19:30:23,610] ######## Epoch (VAL)25 ########
[INFO: 2023-03-03 19:30:23,611] {'Bleu_1': 0.8565517241367496, 'Bleu_2': 0.7834798439476236, 'Bleu_3': 0.7052436793462169, 'Bleu_4': 0.6284316120655146, 'METEOR': 0.4378331722066884, 'ROUGE_L': 0.7685114281427396, 'CIDEr': 2.7162207540363243}
[INFO: 2023-03-03 19:30:39,835] ######## Epoch (TEST)25 ########
[INFO: 2023-03-03 19:30:39,836] {'Bleu_1': 0.774147727270528, 'Bleu_2': 0.6940786555763471, 'Bleu_3': 0.623606434577807, 'Bleu_4': 0.5593935013603506, 'METEOR': 0.38670635538661174, 'ROUGE_L': 0.7046142523577451, 'CIDEr': 2.3800432883296994}
[INFO: 2023-03-03 19:31:49,319] ######## Epoch (VAL)26 ########
[INFO: 2023-03-03 19:31:49,320] {'Bleu_1': 0.8110718218700484, 'Bleu_2': 0.730105282739146, 'Bleu_3': 0.651652385480402, 'Bleu_4': 0.5784554235425288, 'METEOR': 0.42402352433321483, 'ROUGE_L': 0.7517369899198897, 'CIDEr': 2.48112095605626}
[INFO: 2023-03-03 19:32:05,598] ######## Epoch (TEST)26 ########
[INFO: 2023-03-03 19:32:05,598] {'Bleu_1': 0.8098802395197457, 'Bleu_2': 0.7341900603134575, 'Bleu_3': 0.6670890864818997, 'Bleu_4': 0.6036764138889629, 'METEOR': 0.3901329468083506, 'ROUGE_L': 0.7069593242401692, 'CIDEr': 2.414264136541892}
[INFO: 2023-03-03 19:33:15,297] ######## Epoch (VAL)27 ########
[INFO: 2023-03-03 19:33:15,298] {'Bleu_1': 0.8256130790179488, 'Bleu_2': 0.7519785102375532, 'Bleu_3': 0.6795772547927181, 'Bleu_4': 0.6148471501897704, 'METEOR': 0.45134606841750674, 'ROUGE_L': 0.7697220957549393, 'CIDEr': 2.8164445261863658}
[INFO: 2023-03-03 19:33:32,932] ######## Epoch (TEST)27 ########
[INFO: 2023-03-03 19:33:32,933] {'Bleu_1': 0.7302259886995336, 'Bleu_2': 0.6385946516164319, 'Bleu_3': 0.5644036124790384, 'Bleu_4': 0.4995741480753939, 'METEOR': 0.37005179214862577, 'ROUGE_L': 0.6593019795344893, 'CIDEr': 2.1416778094208406}
[INFO: 2023-03-03 19:34:43,330] ######## Epoch (VAL)28 ########
[INFO: 2023-03-03 19:34:43,331] {'Bleu_1': 0.7669491525412896, 'Bleu_2': 0.6704850449978867, 'Bleu_3': 0.5874748087124948, 'Bleu_4': 0.5112987705169348, 'METEOR': 0.40905478590331096, 'ROUGE_L': 0.7056998651988521, 'CIDEr': 2.210996658172405}
[INFO: 2023-03-03 19:34:59,907] ######## Epoch (TEST)28 ########
[INFO: 2023-03-03 19:34:59,908] {'Bleu_1': 0.6695035460983412, 'Bleu_2': 0.5580942503142564, 'Bleu_3': 0.4775904940820418, 'Bleu_4': 0.4124040327397478, 'METEOR': 0.35019633880611667, 'ROUGE_L': 0.6131121859886931, 'CIDEr': 1.9205999516848846}
[INFO: 2023-03-03 19:36:10,607] ######## Epoch (VAL)29 ########
[INFO: 2023-03-03 19:36:10,607] {'Bleu_1': 0.7823203583508441, 'Bleu_2': 0.6948612510873025, 'Bleu_3': 0.6211477114054648, 'Bleu_4': 0.5503442021737417, 'METEOR': 0.40831926545426095, 'ROUGE_L': 0.7064704147010299, 'CIDEr': 2.4132940976291493}
[INFO: 2023-03-03 19:36:27,637] ######## Epoch (TEST)29 ########
[INFO: 2023-03-03 19:36:27,638] {'Bleu_1': 0.7484487663686727, 'Bleu_2': 0.6471110322621707, 'Bleu_3': 0.5736193532581072, 'Bleu_4': 0.5112162633458293, 'METEOR': 0.3825256256100463, 'ROUGE_L': 0.6873676671014407, 'CIDEr': 2.319632629318164}
[INFO: 2023-03-03 19:37:37,630] ######## Epoch (VAL)30 ########
[INFO: 2023-03-03 19:37:37,631] {'Bleu_1': 0.7639254633983787, 'Bleu_2': 0.665037435702025, 'Bleu_3': 0.583812867139181, 'Bleu_4': 0.5071239118571406, 'METEOR': 0.3974237978715685, 'ROUGE_L': 0.701567032424137, 'CIDEr': 2.388063347882857}
[INFO: 2023-03-03 19:37:53,959] ######## Epoch (TEST)30 ########
[INFO: 2023-03-03 19:37:53,959] {'Bleu_1': 0.7236255572043875, 'Bleu_2': 0.621235567645483, 'Bleu_3': 0.5468352189731674, 'Bleu_4': 0.48074427697083233, 'METEOR': 0.3684744001356114, 'ROUGE_L': 0.6513807270589947, 'CIDEr': 2.0159629293616406}
[INFO: 2023-03-03 19:39:03,841] ######## Epoch (VAL)31 ########
[INFO: 2023-03-03 19:39:03,841] {'Bleu_1': 0.8070175438584692, 'Bleu_2': 0.7349559884197088, 'Bleu_3': 0.6662617886065585, 'Bleu_4': 0.6056380214142486, 'METEOR': 0.4199857818701747, 'ROUGE_L': 0.730255438202695, 'CIDEr': 2.732586650256683}
[INFO: 2023-03-03 19:39:20,232] ######## Epoch (TEST)31 ########
[INFO: 2023-03-03 19:39:20,233] {'Bleu_1': 0.7234968592417292, 'Bleu_2': 0.6395053627306914, 'Bleu_3': 0.5718857216769849, 'Bleu_4': 0.5152457447788693, 'METEOR': 0.34008438148564574, 'ROUGE_L': 0.6363615339416699, 'CIDEr': 2.196099472595581}
[INFO: 2023-03-03 19:40:29,533] ######## Epoch (VAL)32 ########
[INFO: 2023-03-03 19:40:29,534] {'Bleu_1': 0.8249856140731845, 'Bleu_2': 0.7536434687174114, 'Bleu_3': 0.6929405889801171, 'Bleu_4': 0.6445831474339756, 'METEOR': 0.44359952298958355, 'ROUGE_L': 0.7568667665097613, 'CIDEr': 2.9794895034669704}
[INFO: 2023-03-03 19:40:46,170] ######## Epoch (TEST)32 ########
[INFO: 2023-03-03 19:40:46,170] {'Bleu_1': 0.723810533446502, 'Bleu_2': 0.6200040628941011, 'Bleu_3': 0.543107151612502, 'Bleu_4': 0.47972772975248223, 'METEOR': 0.35284850177414206, 'ROUGE_L': 0.6304620983320797, 'CIDEr': 2.1328760097241046}
[INFO: 2023-03-03 19:41:56,055] ######## Epoch (VAL)33 ########
[INFO: 2023-03-03 19:41:56,055] {'Bleu_1': 0.8163109286548617, 'Bleu_2': 0.734776996218607, 'Bleu_3': 0.6635516283272928, 'Bleu_4': 0.5985286440143158, 'METEOR': 0.42097512905305307, 'ROUGE_L': 0.7394314817368048, 'CIDEr': 2.5145931473884273}
[INFO: 2023-03-03 19:42:11,618] ######## Epoch (TEST)33 ########
[INFO: 2023-03-03 19:42:11,618] {'Bleu_1': 0.7275460825281186, 'Bleu_2': 0.6225516439016663, 'Bleu_3': 0.5419130745950627, 'Bleu_4': 0.47163089340641706, 'METEOR': 0.3590915542760716, 'ROUGE_L': 0.643741702447637, 'CIDEr': 1.9986294248777634}
[INFO: 2023-03-03 19:43:21,322] ######## Epoch (VAL)34 ########
[INFO: 2023-03-03 19:43:21,323] {'Bleu_1': 0.8134895860281457, 'Bleu_2': 0.7491549733052834, 'Bleu_3': 0.6834221395517542, 'Bleu_4': 0.620902201741522, 'METEOR': 0.4222889487720725, 'ROUGE_L': 0.7557541050261778, 'CIDEr': 2.7565355909954747}
[INFO: 2023-03-03 19:43:38,035] ######## Epoch (TEST)34 ########
[INFO: 2023-03-03 19:43:38,035] {'Bleu_1': 0.7821401556386895, 'Bleu_2': 0.7022122991910393, 'Bleu_3': 0.634457019179916, 'Bleu_4': 0.5735378751661944, 'METEOR': 0.38662299082867413, 'ROUGE_L': 0.7056398379942599, 'CIDEr': 2.392204273954676}
[INFO: 2023-03-03 19:44:48,403] ######## Epoch (VAL)35 ########
[INFO: 2023-03-03 19:44:48,403] {'Bleu_1': 0.8153796466908597, 'Bleu_2': 0.7559547349087626, 'Bleu_3': 0.703386357841936, 'Bleu_4': 0.6564486341079541, 'METEOR': 0.44861075441688514, 'ROUGE_L': 0.7681560642638476, 'CIDEr': 3.041515980883197}
[INFO: 2023-03-03 19:45:04,549] ######## Epoch (TEST)35 ########
[INFO: 2023-03-03 19:45:04,549] {'Bleu_1': 0.7472086316298054, 'Bleu_2': 0.6669402680969758, 'Bleu_3': 0.5971535319916513, 'Bleu_4': 0.5330981187061384, 'METEOR': 0.3713460274655159, 'ROUGE_L': 0.6729277698903778, 'CIDEr': 2.247057255811464}
[INFO: 2023-03-03 19:46:15,254] ######## Epoch (VAL)36 ########
[INFO: 2023-03-03 19:46:15,254] {'Bleu_1': 0.8204379562031818, 'Bleu_2': 0.7413337065326561, 'Bleu_3': 0.6609908868397055, 'Bleu_4': 0.5834180268517043, 'METEOR': 0.42414330547587115, 'ROUGE_L': 0.7519943228604105, 'CIDEr': 2.450910759499214}
[INFO: 2023-03-03 19:46:32,133] ######## Epoch (TEST)36 ########
[INFO: 2023-03-03 19:46:32,133] {'Bleu_1': 0.7650513950062188, 'Bleu_2': 0.6902670537964856, 'Bleu_3': 0.62028425780059, 'Bleu_4': 0.5559875787243509, 'METEOR': 0.3886094786898273, 'ROUGE_L': 0.6976506224441937, 'CIDEr': 2.3416146579289676}
[INFO: 2023-03-03 19:47:43,618] ######## Epoch (VAL)37 ########
[INFO: 2023-03-03 19:47:43,619] {'Bleu_1': 0.8554050318702764, 'Bleu_2': 0.7883377745914711, 'Bleu_3': 0.7202103732019761, 'Bleu_4': 0.6582553253886967, 'METEOR': 0.4445061188415424, 'ROUGE_L': 0.7853466817922609, 'CIDEr': 2.6421990083611413}
[INFO: 2023-03-03 19:48:00,061] ######## Epoch (TEST)37 ########
[INFO: 2023-03-03 19:48:00,061] {'Bleu_1': 0.7942942942931017, 'Bleu_2': 0.7219803533538781, 'Bleu_3': 0.6501726389303177, 'Bleu_4': 0.5824344385754412, 'METEOR': 0.39566294684374487, 'ROUGE_L': 0.7067154795886359, 'CIDEr': 2.4262971448569406}
[INFO: 2023-03-03 19:49:10,404] ######## Epoch (VAL)38 ########
[INFO: 2023-03-03 19:49:10,404] {'Bleu_1': 0.7993585704154301, 'Bleu_2': 0.7079046853988838, 'Bleu_3': 0.6293467694336369, 'Bleu_4': 0.5597219361521817, 'METEOR': 0.39667597556153894, 'ROUGE_L': 0.7207424267449103, 'CIDEr': 2.3168611375073747}
[INFO: 2023-03-03 19:49:26,865] ######## Epoch (TEST)38 ########
[INFO: 2023-03-03 19:49:26,865] {'Bleu_1': 0.7727516382589842, 'Bleu_2': 0.6856854599250779, 'Bleu_3': 0.6149265761907494, 'Bleu_4': 0.5504421470080654, 'METEOR': 0.37828360433750613, 'ROUGE_L': 0.6886174735471545, 'CIDEr': 2.3530946938325332}
[INFO: 2023-03-03 19:50:36,581] ######## Epoch (VAL)39 ########
[INFO: 2023-03-03 19:50:36,581] {'Bleu_1': 0.8056737588641054, 'Bleu_2': 0.732598633256712, 'Bleu_3': 0.6672340042774771, 'Bleu_4': 0.6121437623700432, 'METEOR': 0.438711231479196, 'ROUGE_L': 0.7506224510704627, 'CIDEr': 2.8060199403339285}
[INFO: 2023-03-03 19:50:53,180] ######## Epoch (TEST)39 ########
[INFO: 2023-03-03 19:50:53,181] {'Bleu_1': 0.7641099855271142, 'Bleu_2': 0.6790593978664902, 'Bleu_3': 0.609974069184081, 'Bleu_4': 0.5523252008784216, 'METEOR': 0.37745359281313795, 'ROUGE_L': 0.6950615333306798, 'CIDEr': 2.4428767099202484}
[INFO: 2023-03-03 19:52:03,235] ######## Epoch (VAL)40 ########
[INFO: 2023-03-03 19:52:03,235] {'Bleu_1': 0.8400576368863977, 'Bleu_2': 0.7580024560258418, 'Bleu_3': 0.6768971108000641, 'Bleu_4': 0.6004893132645219, 'METEOR': 0.42088217048230486, 'ROUGE_L': 0.7397425193090611, 'CIDEr': 2.5939174613137213}
[INFO: 2023-03-03 19:52:19,149] ######## Epoch (TEST)40 ########
[INFO: 2023-03-03 19:52:19,150] {'Bleu_1': 0.7880911796224183, 'Bleu_2': 0.714859086911232, 'Bleu_3': 0.6488277298530875, 'Bleu_4': 0.5859937629388018, 'METEOR': 0.3945160521667438, 'ROUGE_L': 0.7017966893812564, 'CIDEr': 2.4615435972489763}
[INFO: 2023-03-04 18:45:30,470] Training with config:
[INFO: 2023-03-04 18:45:30,473] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mssydney/sent/sydney_train_input.pkl',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 8,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mssydney/sent/sydney_train_target.pkl',
                 'TEST_4W_ID': './mscoco/misc/ids2path_json/coco_test4w_ids2path.json',
                 'TEST_ATT_FEATS': './mssydney/feature/Sydney',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mssydney/misc/ids2path_json/sydney_test_ids2path.json',
                 'TRAIN_ATT_FEATS': './mssydney/feature/Sydney',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mssydney/misc/ids2path_json/sydney_train_ids2path.json',
                 'VAL_ATT_FEATS': './mssydney/feature/Sydney',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mssydney/misc/ids2path_json/sydney_val_ids2path.json'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 5,
               'CAP_KEY': 'caption',
               'COCO_PATH': './coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mssydney/misc/test_sydney.json',
               'VAL_ANNFILE': './mssydney/misc/val_sydney.json',
               'VOCAB': './mssydney/txt/Sydney_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'LabelSmoothing'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 1536,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 512,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 512,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [64, 32, 64],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 3,
                        'DIM': 512,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [64, 32, 64],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.1,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 3,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.1,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.1,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 1536,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 512,
           'SEQ_LEN': 24,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'PureT',
           'VOCAB_SIZE': 181,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 512,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'MAX_LEN': 'MAX_LEN',
           'MULCLASS': 'MULCLASS',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments_PureT/PureT_XE_Sydney/',
 'SCORER': {'CIDER_CACHED': './mssydney/misc/sydney_train_cider.pkl',
            'GT_PATH': './mssydney/misc/sydney_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1234.0,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 0.0005,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 512,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Noam',
                          'WARMUP': 10000},
            'MAX_EPOCH': 40,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2023-03-08 18:43:31,574] Training with config:
[INFO: 2023-03-08 18:43:31,591] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mssydney/sent/sydney_train_input.pkl',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 8,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mssydney/sent/sydney_train_target.pkl',
                 'TEST_4W_ID': './mscoco/misc/ids2path_json/coco_test4w_ids2path.json',
                 'TEST_ATT_FEATS': './mssydney/feature/Sydney',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mssydney/misc/ids2path_json/sydney_test_ids2path.json',
                 'TRAIN_ATT_FEATS': './mssydney/feature/Sydney',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mssydney/misc/ids2path_json/sydney_train_ids2path.json',
                 'VAL_ATT_FEATS': './mssydney/feature/Sydney',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mssydney/misc/ids2path_json/sydney_val_ids2path.json'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 5,
               'CAP_KEY': 'caption',
               'COCO_PATH': './coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mssydney/misc/test_sydney.json',
               'VAL_ANNFILE': './mssydney/misc/val_sydney.json',
               'VOCAB': './mssydney/txt/Sydney_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'CrossEntropy'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 1536,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 512,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 512,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [64, 32, 64],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 3,
                        'DIM': 512,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [64, 32, 64],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.1,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 3,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.1,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.1,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 1536,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 512,
           'SEQ_LEN': 24,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'PureT',
           'VOCAB_SIZE': 181,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 512,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'MAX_LEN': 'MAX_LEN',
           'MULCLASS': 'MULCLASS',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments_PureT/PureT_XE_Sydney/',
 'SCORER': {'CIDER_CACHED': './mssydney/misc/sydney_train_cider.pkl',
            'GT_PATH': './mssydney/misc/sydney_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1234.0,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 0.0005,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 512,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Noam',
                          'WARMUP': 10000},
            'MAX_EPOCH': 20,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 1},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2023-03-08 18:57:02,146] Training with config:
[INFO: 2023-03-08 18:57:02,153] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mssydney/sent/sydney_train_input.pkl',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 8,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mssydney/sent/sydney_train_target.pkl',
                 'TEST_4W_ID': './mscoco/misc/ids2path_json/coco_test4w_ids2path.json',
                 'TEST_ATT_FEATS': './mssydney/feature/Sydney',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mssydney/misc/ids2path_json/sydney_test_ids2path.json',
                 'TRAIN_ATT_FEATS': './mssydney/feature/Sydney',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mssydney/misc/ids2path_json/sydney_train_ids2path.json',
                 'VAL_ATT_FEATS': './mssydney/feature/Sydney',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mssydney/misc/ids2path_json/sydney_val_ids2path.json'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 5,
               'CAP_KEY': 'caption',
               'COCO_PATH': './coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mssydney/misc/test_sydney.json',
               'VAL_ANNFILE': './mssydney/misc/val_sydney.json',
               'VOCAB': './mssydney/txt/Sydney_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'CrossEntropy'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 1536,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 512,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 512,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [64, 32, 64],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 3,
                        'DIM': 512,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [64, 32, 64],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.1,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 3,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.1,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.1,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 1536,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 512,
           'SEQ_LEN': 24,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'PureT',
           'VOCAB_SIZE': 181,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 512,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'MAX_LEN': 'MAX_LEN',
           'MULCLASS': 'MULCLASS',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments_PureT/PureT_XE_Sydney/',
 'SCORER': {'CIDER_CACHED': './mssydney/misc/sydney_train_cider.pkl',
            'GT_PATH': './mssydney/misc/sydney_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1234.0,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 0.0005,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 512,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Noam',
                          'WARMUP': 10000},
            'MAX_EPOCH': 20,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 1},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2023-03-08 19:01:40,588] Training with config:
[INFO: 2023-03-08 19:01:40,596] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mssydney/sent/sydney_train_input.pkl',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 8,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mssydney/sent/sydney_train_target.pkl',
                 'TEST_4W_ID': './mscoco/misc/ids2path_json/coco_test4w_ids2path.json',
                 'TEST_ATT_FEATS': './mssydney/feature/Sydney',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mssydney/misc/ids2path_json/sydney_test_ids2path.json',
                 'TRAIN_ATT_FEATS': './mssydney/feature/Sydney',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mssydney/misc/ids2path_json/sydney_train_ids2path.json',
                 'VAL_ATT_FEATS': './mssydney/feature/Sydney',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mssydney/misc/ids2path_json/sydney_val_ids2path.json'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 5,
               'CAP_KEY': 'caption',
               'COCO_PATH': './coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mssydney/misc/test_sydney.json',
               'VAL_ANNFILE': './mssydney/misc/val_sydney.json',
               'VOCAB': './mssydney/txt/Sydney_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'CrossEntropy'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 1536,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 512,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 512,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [64, 32, 64],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 3,
                        'DIM': 512,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [64, 32, 64],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.1,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 3,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.1,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.1,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 1536,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 512,
           'SEQ_LEN': 24,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'PureT',
           'VOCAB_SIZE': 181,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 512,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'MAX_LEN': 'MAX_LEN',
           'MULCLASS': 'MULCLASS',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments_PureT/PureT_XE_Sydney/',
 'SCORER': {'CIDER_CACHED': './mssydney/misc/sydney_train_cider.pkl',
            'GT_PATH': './mssydney/misc/sydney_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1234.0,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 0.0005,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 512,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Noam',
                          'WARMUP': 10000},
            'MAX_EPOCH': 20,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 1},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2023-03-08 19:05:10,862] Training with config:
[INFO: 2023-03-08 19:05:10,870] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mssydney/sent/sydney_train_input.pkl',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 8,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mssydney/sent/sydney_train_target.pkl',
                 'TEST_4W_ID': './mscoco/misc/ids2path_json/coco_test4w_ids2path.json',
                 'TEST_ATT_FEATS': './mssydney/feature/Sydney',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mssydney/misc/ids2path_json/sydney_test_ids2path.json',
                 'TRAIN_ATT_FEATS': './mssydney/feature/Sydney',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mssydney/misc/ids2path_json/sydney_train_ids2path.json',
                 'VAL_ATT_FEATS': './mssydney/feature/Sydney',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mssydney/misc/ids2path_json/sydney_val_ids2path.json'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 5,
               'CAP_KEY': 'caption',
               'COCO_PATH': './coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mssydney/misc/test_sydney.json',
               'VAL_ANNFILE': './mssydney/misc/val_sydney.json',
               'VOCAB': './mssydney/txt/Sydney_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'CrossEntropy'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 1536,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 512,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 512,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [64, 32, 64],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 3,
                        'DIM': 512,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [64, 32, 64],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.1,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 3,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.1,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.1,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 1536,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 512,
           'SEQ_LEN': 24,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'PureT',
           'VOCAB_SIZE': 181,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 512,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'MAX_LEN': 'MAX_LEN',
           'MULCLASS': 'MULCLASS',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments_PureT/PureT_XE_Sydney/',
 'SCORER': {'CIDER_CACHED': './mssydney/misc/sydney_train_cider.pkl',
            'GT_PATH': './mssydney/misc/sydney_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1234.0,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 0.0005,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 512,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Noam',
                          'WARMUP': 10000},
            'MAX_EPOCH': 20,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 1},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2023-03-08 19:05:31,969] Training with config:
[INFO: 2023-03-08 19:05:31,971] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mssydney/sent/sydney_train_input.pkl',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 8,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mssydney/sent/sydney_train_target.pkl',
                 'TEST_4W_ID': './mscoco/misc/ids2path_json/coco_test4w_ids2path.json',
                 'TEST_ATT_FEATS': './mssydney/feature/Sydney',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mssydney/misc/ids2path_json/sydney_test_ids2path.json',
                 'TRAIN_ATT_FEATS': './mssydney/feature/Sydney',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mssydney/misc/ids2path_json/sydney_train_ids2path.json',
                 'VAL_ATT_FEATS': './mssydney/feature/Sydney',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mssydney/misc/ids2path_json/sydney_val_ids2path.json'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 5,
               'CAP_KEY': 'caption',
               'COCO_PATH': './coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mssydney/misc/test_sydney.json',
               'VAL_ANNFILE': './mssydney/misc/val_sydney.json',
               'VOCAB': './mssydney/txt/Sydney_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'CrossEntropy'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 1536,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 512,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 512,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [64, 32, 64],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 3,
                        'DIM': 512,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [64, 32, 64],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.1,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 3,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.1,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.1,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 1536,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 512,
           'SEQ_LEN': 24,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'PureT',
           'VOCAB_SIZE': 181,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 512,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'MAX_LEN': 'MAX_LEN',
           'MULCLASS': 'MULCLASS',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments_PureT/PureT_XE_Sydney/',
 'SCORER': {'CIDER_CACHED': './mssydney/misc/sydney_train_cider.pkl',
            'GT_PATH': './mssydney/misc/sydney_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1234.0,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 0.0005,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 512,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Noam',
                          'WARMUP': 10000},
            'MAX_EPOCH': 20,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 1},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2023-03-10 13:43:37,777] Training with config:
[INFO: 2023-03-10 13:43:37,789] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mssydney/sent/sydney_train_input.pkl',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 8,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mssydney/sent/sydney_train_target.pkl',
                 'TEST_4W_ID': './mscoco/misc/ids2path_json/coco_test4w_ids2path.json',
                 'TEST_ATT_FEATS': './mssydney/feature/Sydney',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mssydney/misc/ids2path_json/sydney_test_ids2path.json',
                 'TRAIN_ATT_FEATS': './mssydney/feature/Sydney',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mssydney/misc/ids2path_json/sydney_train_ids2path.json',
                 'VAL_ATT_FEATS': './mssydney/feature/Sydney',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mssydney/misc/ids2path_json/sydney_val_ids2path.json'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 5,
               'CAP_KEY': 'caption',
               'COCO_PATH': './coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mssydney/misc/test_sydney.json',
               'VAL_ANNFILE': './mssydney/misc/val_sydney.json',
               'VOCAB': './mssydney/txt/Sydney_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'CrossEntropy'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 1536,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 512,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 512,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [64, 32, 64],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 3,
                        'DIM': 512,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [64, 32, 64],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.1,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 3,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.1,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.1,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 1536,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 512,
           'SEQ_LEN': 24,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'PureT',
           'VOCAB_SIZE': 181,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 512,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'MAX_LEN': 'MAX_LEN',
           'MULCLASS': 'MULCLASS',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments_PureT/PureT_XE_Sydney/',
 'SCORER': {'CIDER_CACHED': './mssydney/misc/sydney_train_cider.pkl',
            'GT_PATH': './mssydney/misc/sydney_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1234.0,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 0.0005,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 512,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Noam',
                          'WARMUP': 10000},
            'MAX_EPOCH': 20,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 1},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2023-03-10 17:32:20,324] Training with config:
[INFO: 2023-03-10 17:32:20,326] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mssydney/sent/sydney_train_input.pkl',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 8,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mssydney/sent/sydney_train_target.pkl',
                 'TEST_4W_ID': './mscoco/misc/ids2path_json/coco_test4w_ids2path.json',
                 'TEST_ATT_FEATS': './mssydney/feature/Sydney',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mssydney/misc/ids2path_json/sydney_test_ids2path.json',
                 'TRAIN_ATT_FEATS': './mssydney/feature/Sydney',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mssydney/misc/ids2path_json/sydney_train_ids2path.json',
                 'VAL_ATT_FEATS': './mssydney/feature/Sydney',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mssydney/misc/ids2path_json/sydney_val_ids2path.json'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 5,
               'CAP_KEY': 'caption',
               'COCO_PATH': './coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mssydney/misc/test_sydney.json',
               'VAL_ANNFILE': './mssydney/misc/val_sydney.json',
               'VOCAB': './mssydney/txt/Sydney_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'CrossEntropy'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 1536,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 512,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 512,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [64, 32, 64],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 3,
                        'DIM': 512,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [64, 32, 64],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.1,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 3,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.1,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.1,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 1536,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 512,
           'SEQ_LEN': 24,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'PureT',
           'VOCAB_SIZE': 181,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 512,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'MAX_LEN': 'MAX_LEN',
           'MULCLASS': 'MULCLASS',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments_PureT/PureT_XE_Sydney/',
 'SCORER': {'CIDER_CACHED': './mssydney/misc/sydney_train_cider.pkl',
            'GT_PATH': './mssydney/misc/sydney_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1234.0,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 0.0005,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 512,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Noam',
                          'WARMUP': 10000},
            'MAX_EPOCH': 20,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 1},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2023-03-10 17:34:58,251] ######## Epoch (VAL)1 ########
[INFO: 2023-03-10 17:34:58,252] {'Bleu_1': 0.0, 'Bleu_2': 0.0, 'Bleu_3': 0.0, 'Bleu_4': 0.0, 'METEOR': 0.0, 'ROUGE_L': 0.0, 'CIDEr': 0.0}
[INFO: 2023-03-10 17:35:59,447] ######## Epoch (TEST)1 ########
[INFO: 2023-03-10 17:35:59,448] {'Bleu_1': 0.0, 'Bleu_2': 0.0, 'Bleu_3': 0.0, 'Bleu_4': 0.0, 'METEOR': 0.0, 'ROUGE_L': 0.0, 'CIDEr': 0.0}
[INFO: 2023-03-10 17:38:06,083] ######## Epoch (VAL)2 ########
[INFO: 2023-03-10 17:38:06,084] {'Bleu_1': 0.0, 'Bleu_2': 0.0, 'Bleu_3': 0.0, 'Bleu_4': 0.0, 'METEOR': 0.0, 'ROUGE_L': 0.0, 'CIDEr': 0.0}
[INFO: 2023-03-10 17:39:09,014] ######## Epoch (TEST)2 ########
[INFO: 2023-03-10 17:39:09,014] {'Bleu_1': 0.0, 'Bleu_2': 0.0, 'Bleu_3': 0.0, 'Bleu_4': 0.0, 'METEOR': 0.0, 'ROUGE_L': 0.0, 'CIDEr': 0.0}
[INFO: 2023-03-10 17:41:23,234] ######## Epoch (VAL)3 ########
[INFO: 2023-03-10 17:41:23,235] {'Bleu_1': 3.8408725011523674e-14, 'Bleu_2': 3.952225198072185e-17, 'Bleu_3': 3.9900555930339074e-18, 'Bleu_4': 1.2677907497705572e-18, 'METEOR': 0.005404760958550254, 'ROUGE_L': 0.04501499076220347, 'CIDEr': 0.004695664855138386}
[INFO: 2023-03-10 17:42:24,933] ######## Epoch (TEST)3 ########
[INFO: 2023-03-10 17:42:24,946] {'Bleu_1': 4.879432564511341e-10, 'Bleu_2': 4.980050007338246e-13, 'Bleu_3': 5.014048127833361e-14, 'Bleu_4': 1.590984305511095e-14, 'METEOR': 0.007884686460514968, 'ROUGE_L': 0.06422085727783935, 'CIDEr': 0.0028232006407572833}
[INFO: 2023-03-10 17:44:34,112] ######## Epoch (VAL)4 ########
[INFO: 2023-03-10 17:44:34,113] {'Bleu_1': 0.035445433725774245, 'Bleu_2': 0.03158085752743317, 'Bleu_3': 0.03060530419687643, 'Bleu_4': 0.0010757130389251958, 'METEOR': 0.09038351753942532, 'ROUGE_L': 0.2568006479512542, 'CIDEr': 0.18129562886803002}
[INFO: 2023-03-10 17:45:36,946] ######## Epoch (TEST)4 ########
[INFO: 2023-03-10 17:45:36,946] {'Bleu_1': 0.02963597012268737, 'Bleu_2': 0.02663137377419151, 'Bleu_3': 0.025457202563071386, 'Bleu_4': 4.133774534237794e-06, 'METEOR': 0.08909383367996651, 'ROUGE_L': 0.2775375484490965, 'CIDEr': 0.18614604319308253}
[INFO: 2023-03-10 17:47:49,201] ######## Epoch (VAL)5 ########
[INFO: 2023-03-10 17:47:49,201] {'Bleu_1': 0.12283805349904188, 'Bleu_2': 0.10871049501380933, 'Bleu_3': 0.0999103216247639, 'Bleu_4': 0.08916734705270178, 'METEOR': 0.12705433670038907, 'ROUGE_L': 0.3364633357756747, 'CIDEr': 0.5782209013124796}
[INFO: 2023-03-10 17:48:53,629] ######## Epoch (TEST)5 ########
[INFO: 2023-03-10 17:48:53,630] {'Bleu_1': 0.11929960364663439, 'Bleu_2': 0.10400697286358937, 'Bleu_3': 0.0954319777802973, 'Bleu_4': 0.08185369274587138, 'METEOR': 0.12364147496643425, 'ROUGE_L': 0.35102639363827637, 'CIDEr': 0.5080458887416806}
[INFO: 2023-03-10 17:51:03,891] ######## Epoch (VAL)6 ########
[INFO: 2023-03-10 17:51:03,891] {'Bleu_1': 0.44843788192775125, 'Bleu_2': 0.4141034658780511, 'Bleu_3': 0.3747206549788077, 'Bleu_4': 0.3285694293929475, 'METEOR': 0.2288028188217764, 'ROUGE_L': 0.5144750716568006, 'CIDEr': 1.2263154032911547}
[INFO: 2023-03-10 17:52:05,760] ######## Epoch (TEST)6 ########
[INFO: 2023-03-10 17:52:05,760] {'Bleu_1': 0.44484854096958243, 'Bleu_2': 0.3973410780809947, 'Bleu_3': 0.35624789451239797, 'Bleu_4': 0.31767570121181965, 'METEOR': 0.22789253036229298, 'ROUGE_L': 0.5071442877479738, 'CIDEr': 1.3579677690659444}
[INFO: 2023-03-10 17:54:15,768] ######## Epoch (VAL)7 ########
[INFO: 2023-03-10 17:54:15,768] {'Bleu_1': 0.7010408507393375, 'Bleu_2': 0.6287747184204289, 'Bleu_3': 0.5552487529858383, 'Bleu_4': 0.4884825765375466, 'METEOR': 0.3226731402642679, 'ROUGE_L': 0.6222280340301813, 'CIDEr': 1.6324092155932932}
[INFO: 2023-03-10 17:55:17,304] ######## Epoch (TEST)7 ########
[INFO: 2023-03-10 17:55:17,304] {'Bleu_1': 0.7271189567843457, 'Bleu_2': 0.6566013439066037, 'Bleu_3': 0.591065910478874, 'Bleu_4': 0.5302845001662349, 'METEOR': 0.3532733605440025, 'ROUGE_L': 0.6571923892203893, 'CIDEr': 1.9697919670992687}
[INFO: 2023-03-10 17:57:30,221] ######## Epoch (VAL)8 ########
[INFO: 2023-03-10 17:57:30,221] {'Bleu_1': 0.7482922837593928, 'Bleu_2': 0.679693351260865, 'Bleu_3': 0.6047849476013387, 'Bleu_4': 0.5284780996976375, 'METEOR': 0.3591744479480285, 'ROUGE_L': 0.664440807196212, 'CIDEr': 1.8266451740513376}
[INFO: 2023-03-10 17:58:32,607] ######## Epoch (TEST)8 ########
[INFO: 2023-03-10 17:58:32,607] {'Bleu_1': 0.6782327102957116, 'Bleu_2': 0.6040953768164122, 'Bleu_3': 0.5342182465550052, 'Bleu_4': 0.47046294162206864, 'METEOR': 0.3241645979353795, 'ROUGE_L': 0.6073627281875827, 'CIDEr': 1.7098916239710502}
[INFO: 2023-03-10 18:00:43,586] ######## Epoch (VAL)9 ########
[INFO: 2023-03-10 18:00:43,586] {'Bleu_1': 0.7972060293419999, 'Bleu_2': 0.7301658761436531, 'Bleu_3': 0.659083715925687, 'Bleu_4': 0.5872252785768448, 'METEOR': 0.38670841467175676, 'ROUGE_L': 0.7022030495513039, 'CIDEr': 2.2402952183451306}
[INFO: 2023-03-10 18:01:47,058] ######## Epoch (TEST)9 ########
[INFO: 2023-03-10 18:01:47,059] {'Bleu_1': 0.740287325833531, 'Bleu_2': 0.658312742560909, 'Bleu_3': 0.5853749400443887, 'Bleu_4': 0.5167334452301859, 'METEOR': 0.3491442487117913, 'ROUGE_L': 0.6431679531101333, 'CIDEr': 1.9509640637588797}
[INFO: 2023-03-10 18:03:58,964] ######## Epoch (VAL)10 ########
[INFO: 2023-03-10 18:03:58,964] {'Bleu_1': 0.8050885311917393, 'Bleu_2': 0.7378906224034347, 'Bleu_3': 0.6631514304151861, 'Bleu_4': 0.5870613963265454, 'METEOR': 0.3896354356027404, 'ROUGE_L': 0.7030472509210594, 'CIDEr': 2.2726450307374275}
[INFO: 2023-03-10 18:05:01,316] ######## Epoch (TEST)10 ########
[INFO: 2023-03-10 18:05:01,316] {'Bleu_1': 0.735924743557821, 'Bleu_2': 0.6511428315632539, 'Bleu_3': 0.575510344005353, 'Bleu_4': 0.5036395887142856, 'METEOR': 0.34696740293587836, 'ROUGE_L': 0.6398163359609463, 'CIDEr': 1.94266253102409}
[INFO: 2023-03-10 18:07:15,057] ######## Epoch (VAL)11 ########
[INFO: 2023-03-10 18:07:15,057] {'Bleu_1': 0.8196193546396165, 'Bleu_2': 0.7411894747149732, 'Bleu_3': 0.6616407150010978, 'Bleu_4': 0.5853290408787453, 'METEOR': 0.3804223681672249, 'ROUGE_L': 0.698940610947566, 'CIDEr': 2.190585951123799}
[INFO: 2023-03-10 18:08:25,956] ######## Epoch (TEST)11 ########
[INFO: 2023-03-10 18:08:25,957] {'Bleu_1': 0.7496368514865247, 'Bleu_2': 0.6679549793454822, 'Bleu_3': 0.5923676454481411, 'Bleu_4': 0.5194549108910089, 'METEOR': 0.3580314945033148, 'ROUGE_L': 0.6520661050994421, 'CIDEr': 1.9873693242444854}
[INFO: 2023-03-10 18:10:43,289] ######## Epoch (VAL)12 ########
[INFO: 2023-03-10 18:10:43,290] {'Bleu_1': 0.8155197657381911, 'Bleu_2': 0.7429291873730125, 'Bleu_3': 0.6575037155414037, 'Bleu_4': 0.5751858993147091, 'METEOR': 0.39977641203209496, 'ROUGE_L': 0.7131476363808414, 'CIDEr': 2.1994871025524763}
[INFO: 2023-03-10 18:11:52,999] ######## Epoch (TEST)12 ########
[INFO: 2023-03-10 18:11:52,999] {'Bleu_1': 0.7548083924212462, 'Bleu_2': 0.6766812373851027, 'Bleu_3': 0.6069667065002273, 'Bleu_4': 0.5444280753289908, 'METEOR': 0.36858980780184947, 'ROUGE_L': 0.682748630781219, 'CIDEr': 2.224167491576413}
[INFO: 2023-03-10 18:14:06,262] ######## Epoch (VAL)13 ########
[INFO: 2023-03-10 18:14:06,263] {'Bleu_1': 0.7736677908699513, 'Bleu_2': 0.6806343118801591, 'Bleu_3': 0.5922186282187824, 'Bleu_4': 0.5073074759766738, 'METEOR': 0.3734188867625063, 'ROUGE_L': 0.6704530895744605, 'CIDEr': 2.0566955897035126}
[INFO: 2023-03-10 18:15:13,138] ######## Epoch (TEST)13 ########
[INFO: 2023-03-10 18:15:13,138] {'Bleu_1': 0.7358613399010997, 'Bleu_2': 0.6485664099409545, 'Bleu_3': 0.5767867552202881, 'Bleu_4': 0.5130735841521427, 'METEOR': 0.35700336057511545, 'ROUGE_L': 0.6613157874329803, 'CIDEr': 2.101133639295605}
[INFO: 2023-03-10 18:17:29,564] ######## Epoch (VAL)14 ########
[INFO: 2023-03-10 18:17:29,565] {'Bleu_1': 0.8147612156283434, 'Bleu_2': 0.7308653406108446, 'Bleu_3': 0.6443667551511408, 'Bleu_4': 0.5628953240645616, 'METEOR': 0.39617374020304374, 'ROUGE_L': 0.7173352910109757, 'CIDEr': 2.2216536954507067}
[INFO: 2023-03-10 18:18:36,372] ######## Epoch (TEST)14 ########
[INFO: 2023-03-10 18:18:36,372] {'Bleu_1': 0.77227722772168, 'Bleu_2': 0.6950679811278098, 'Bleu_3': 0.6245412329515866, 'Bleu_4': 0.5592325974093609, 'METEOR': 0.3795467114309233, 'ROUGE_L': 0.694390766010859, 'CIDEr': 2.349287943562872}
[INFO: 2023-03-10 18:20:50,402] ######## Epoch (VAL)15 ########
[INFO: 2023-03-10 18:20:50,402] {'Bleu_1': 0.826589595374528, 'Bleu_2': 0.7426266356261682, 'Bleu_3': 0.6553731280938444, 'Bleu_4': 0.5712787247535663, 'METEOR': 0.40569512249522305, 'ROUGE_L': 0.7196646167303873, 'CIDEr': 2.2597566409119705}
[INFO: 2023-03-10 18:21:57,582] ######## Epoch (TEST)15 ########
[INFO: 2023-03-10 18:21:57,583] {'Bleu_1': 0.7774575939944173, 'Bleu_2': 0.7007305447595619, 'Bleu_3': 0.6315931244865687, 'Bleu_4': 0.570263576714161, 'METEOR': 0.37935549960510356, 'ROUGE_L': 0.7030080989174428, 'CIDEr': 2.4169615663285935}
[INFO: 2023-03-10 18:24:12,011] ######## Epoch (VAL)16 ########
[INFO: 2023-03-10 18:24:12,011] {'Bleu_1': 0.8296089385463273, 'Bleu_2': 0.7405738843744648, 'Bleu_3': 0.651124683785529, 'Bleu_4': 0.5649445155956297, 'METEOR': 0.41483949954782234, 'ROUGE_L': 0.7336166229317789, 'CIDEr': 2.3215213082122896}
[INFO: 2023-03-10 18:25:20,772] ######## Epoch (TEST)16 ########
[INFO: 2023-03-10 18:25:20,772] {'Bleu_1': 0.7774687065357755, 'Bleu_2': 0.6994994773316717, 'Bleu_3': 0.6319353087989972, 'Bleu_4': 0.5712645831481286, 'METEOR': 0.39569984100259065, 'ROUGE_L': 0.7119555656529402, 'CIDEr': 2.5510543058895356}
[INFO: 2023-03-10 18:27:37,457] ######## Epoch (VAL)17 ########
[INFO: 2023-03-10 18:27:37,457] {'Bleu_1': 0.773743016758696, 'Bleu_2': 0.6875407616946623, 'Bleu_3': 0.6013374401853876, 'Bleu_4': 0.5169444325075717, 'METEOR': 0.40728420068279336, 'ROUGE_L': 0.7038948073355215, 'CIDEr': 2.3554570285726344}
[INFO: 2023-03-10 18:28:46,163] ######## Epoch (TEST)17 ########
[INFO: 2023-03-10 18:28:46,163] {'Bleu_1': 0.7441217150750428, 'Bleu_2': 0.6563591309085358, 'Bleu_3': 0.5863238636320346, 'Bleu_4': 0.5256854122309844, 'METEOR': 0.37995429760696897, 'ROUGE_L': 0.6867142735347471, 'CIDEr': 2.262611595841149}
[INFO: 2023-03-10 18:31:00,610] ######## Epoch (VAL)18 ########
[INFO: 2023-03-10 18:31:00,610] {'Bleu_1': 0.8033472803336076, 'Bleu_2': 0.7121239988296032, 'Bleu_3': 0.6269119395684176, 'Bleu_4': 0.5460959632675272, 'METEOR': 0.4121706111235263, 'ROUGE_L': 0.7264020053429583, 'CIDEr': 2.3419937498920094}
[INFO: 2023-03-10 18:32:08,888] ######## Epoch (TEST)18 ########
[INFO: 2023-03-10 18:32:08,888] {'Bleu_1': 0.7569060773470209, 'Bleu_2': 0.6717058566197643, 'Bleu_3': 0.6020057975080545, 'Bleu_4': 0.5404051110680325, 'METEOR': 0.3933329681578158, 'ROUGE_L': 0.6999069323159426, 'CIDEr': 2.466505596522842}
[INFO: 2023-03-10 18:34:23,858] ######## Epoch (VAL)19 ########
[INFO: 2023-03-10 18:34:23,859] {'Bleu_1': 0.8326300984517122, 'Bleu_2': 0.7532679124644919, 'Bleu_3': 0.6767398908321093, 'Bleu_4': 0.6042626574109913, 'METEOR': 0.42729459643376255, 'ROUGE_L': 0.7588237490118366, 'CIDEr': 2.61680931712239}
[INFO: 2023-03-10 18:35:31,115] ######## Epoch (TEST)19 ########
[INFO: 2023-03-10 18:35:31,115] {'Bleu_1': 0.7682515688848351, 'Bleu_2': 0.6932726541432243, 'Bleu_3': 0.6274017791471932, 'Bleu_4': 0.5683526894134348, 'METEOR': 0.3920425427813184, 'ROUGE_L': 0.7072327071647584, 'CIDEr': 2.5454761549232745}
[INFO: 2023-03-10 18:37:46,271] ######## Epoch (VAL)20 ########
[INFO: 2023-03-10 18:37:46,271] {'Bleu_1': 0.8319209039536273, 'Bleu_2': 0.7546826151627681, 'Bleu_3': 0.6794250081504988, 'Bleu_4': 0.6095197711502899, 'METEOR': 0.4320854658004955, 'ROUGE_L': 0.7568502633681391, 'CIDEr': 2.7152792814395452}
[INFO: 2023-03-10 18:38:53,198] ######## Epoch (TEST)20 ########
[INFO: 2023-03-10 18:38:53,199] {'Bleu_1': 0.7615678201180528, 'Bleu_2': 0.6829030713980295, 'Bleu_3': 0.616642696771087, 'Bleu_4': 0.5594636073575157, 'METEOR': 0.3802212474964583, 'ROUGE_L': 0.6933175917831844, 'CIDEr': 2.4780984362028495}
[INFO: 2023-03-10 18:53:03,000] Training with config:
[INFO: 2023-03-10 18:53:03,014] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mssydney/sent/sydney_train_input.pkl',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 8,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mssydney/sent/sydney_train_target.pkl',
                 'TEST_4W_ID': './mscoco/misc/ids2path_json/coco_test4w_ids2path.json',
                 'TEST_ATT_FEATS': './mssydney/feature/Sydney',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mssydney/misc/ids2path_json/sydney_test_ids2path.json',
                 'TRAIN_ATT_FEATS': './mssydney/feature/Sydney',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mssydney/misc/ids2path_json/sydney_train_ids2path.json',
                 'VAL_ATT_FEATS': './mssydney/feature/Sydney',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mssydney/misc/ids2path_json/sydney_val_ids2path.json'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 5,
               'CAP_KEY': 'caption',
               'COCO_PATH': './coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mssydney/misc/test_sydney.json',
               'VAL_ANNFILE': './mssydney/misc/val_sydney.json',
               'VOCAB': './mssydney/txt/Sydney_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'CrossEntropy'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 1536,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 512,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 512,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [64, 32, 64],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 3,
                        'DIM': 512,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [64, 32, 64],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.1,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 3,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.1,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.1,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 1536,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 512,
           'SEQ_LEN': 24,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'PureT',
           'VOCAB_SIZE': 181,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 512,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'MAX_LEN': 'MAX_LEN',
           'MULCLASS': 'MULCLASS',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments_PureT/PureT_XE_Sydney/',
 'SCORER': {'CIDER_CACHED': './mssydney/misc/sydney_train_cider.pkl',
            'GT_PATH': './mssydney/misc/sydney_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1234.0,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 0.0005,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 512,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Noam',
                          'WARMUP': 10000},
            'MAX_EPOCH': 20,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 1},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2023-03-10 18:55:54,867] ######## Epoch (VAL)1 ########
[INFO: 2023-03-10 18:55:54,867] {'Bleu_1': 0.0, 'Bleu_2': 0.0, 'Bleu_3': 0.0, 'Bleu_4': 0.0, 'METEOR': 0.0, 'ROUGE_L': 0.0, 'CIDEr': 0.0}
[INFO: 2023-03-10 18:57:00,090] ######## Epoch (TEST)1 ########
[INFO: 2023-03-10 18:57:00,090] {'Bleu_1': 0.0, 'Bleu_2': 0.0, 'Bleu_3': 0.0, 'Bleu_4': 0.0, 'METEOR': 0.0, 'ROUGE_L': 0.0, 'CIDEr': 0.0}
[INFO: 2023-03-10 18:59:16,637] ######## Epoch (VAL)2 ########
[INFO: 2023-03-10 18:59:16,637] {'Bleu_1': 0.0, 'Bleu_2': 0.0, 'Bleu_3': 0.0, 'Bleu_4': 0.0, 'METEOR': 0.0, 'ROUGE_L': 0.0, 'CIDEr': 0.0}
[INFO: 2023-03-10 19:00:22,036] ######## Epoch (TEST)2 ########
[INFO: 2023-03-10 19:00:22,036] {'Bleu_1': 0.0, 'Bleu_2': 0.0, 'Bleu_3': 0.0, 'Bleu_4': 0.0, 'METEOR': 0.0, 'ROUGE_L': 0.0, 'CIDEr': 0.0}
[INFO: 2023-03-10 19:02:32,493] ######## Epoch (VAL)3 ########
[INFO: 2023-03-10 19:02:32,494] {'Bleu_1': 2.5860058847225805e-07, 'Bleu_2': 2.932255054294517e-10, 'Bleu_3': 3.057683209610186e-11, 'Bleu_4': 9.873880365830566e-12, 'METEOR': 0.0089736399326977, 'ROUGE_L': 0.07196867849310419, 'CIDEr': 0.006777861339687995}
[INFO: 2023-03-10 19:03:40,763] ######## Epoch (TEST)3 ########
[INFO: 2023-03-10 19:03:40,763] {'Bleu_1': 4.5058731105610656e-07, 'Bleu_2': 4.636505179821784e-10, 'Bleu_3': 4.680885450003411e-11, 'Bleu_4': 1.487293381224263e-11, 'METEOR': 0.012136355523826522, 'ROUGE_L': 0.0935045050205347, 'CIDEr': 0.004424682133700349}
[INFO: 2023-03-10 19:05:54,498] ######## Epoch (VAL)4 ########
[INFO: 2023-03-10 19:05:54,498] {'Bleu_1': 0.018887088655865296, 'Bleu_2': 0.01790698315921378, 'Bleu_3': 0.01750090257932523, 'Bleu_4': 0.0005862370841986517, 'METEOR': 0.0838069474616802, 'ROUGE_L': 0.24968570530556847, 'CIDEr': 0.1860041382152481}
[INFO: 2023-03-10 19:07:02,646] ######## Epoch (TEST)4 ########
[INFO: 2023-03-10 19:07:02,647] {'Bleu_1': 0.02112811124083576, 'Bleu_2': 0.02035164127073676, 'Bleu_3': 0.020042753054882324, 'Bleu_4': 0.0006536918063216347, 'METEOR': 0.09298350475097156, 'ROUGE_L': 0.2834986729741967, 'CIDEr': 0.21381164676853157}
[INFO: 2023-03-10 19:09:14,677] ######## Epoch (VAL)5 ########
[INFO: 2023-03-10 19:09:14,677] {'Bleu_1': 0.11726289470302859, 'Bleu_2': 0.10387947950797383, 'Bleu_3': 0.0974071576097361, 'Bleu_4': 0.09021882111498346, 'METEOR': 0.12322203211314331, 'ROUGE_L': 0.3346125968344217, 'CIDEr': 0.5465670564052876}
[INFO: 2023-03-10 19:10:20,228] ######## Epoch (TEST)5 ########
[INFO: 2023-03-10 19:10:20,228] {'Bleu_1': 0.13984078703337685, 'Bleu_2': 0.12497180720915203, 'Bleu_3': 0.11756911292304925, 'Bleu_4': 0.11059168089777743, 'METEOR': 0.13520703945796, 'ROUGE_L': 0.37337911554520997, 'CIDEr': 0.6785176350471178}
[INFO: 2023-03-10 19:12:33,724] ######## Epoch (VAL)6 ########
[INFO: 2023-03-10 19:12:33,724] {'Bleu_1': 0.46267394220214014, 'Bleu_2': 0.42294102475671874, 'Bleu_3': 0.37569698183790273, 'Bleu_4': 0.318611819151591, 'METEOR': 0.22641594523368755, 'ROUGE_L': 0.5097420102910146, 'CIDEr': 1.1748839735972054}
[INFO: 2023-03-10 19:13:40,181] ######## Epoch (TEST)6 ########
[INFO: 2023-03-10 19:13:40,181] {'Bleu_1': 0.4973285486368347, 'Bleu_2': 0.44171784494734917, 'Bleu_3': 0.3905685518474776, 'Bleu_4': 0.3464540986213764, 'METEOR': 0.23624060043722406, 'ROUGE_L': 0.5208548922569555, 'CIDEr': 1.3290814228157455}
[INFO: 2023-03-10 19:15:48,325] ######## Epoch (VAL)7 ########
[INFO: 2023-03-10 19:15:48,326] {'Bleu_1': 0.6645699369529307, 'Bleu_2': 0.6050577822765476, 'Bleu_3': 0.5343450571669434, 'Bleu_4': 0.46232651363614047, 'METEOR': 0.3175943167681087, 'ROUGE_L': 0.6428107362507973, 'CIDEr': 1.568755349101763}
[INFO: 2023-03-10 19:16:51,595] ######## Epoch (TEST)7 ########
[INFO: 2023-03-10 19:16:51,596] {'Bleu_1': 0.632095314954184, 'Bleu_2': 0.570165831139193, 'Bleu_3': 0.5086639472639359, 'Bleu_4': 0.4507097252239614, 'METEOR': 0.31345691916291574, 'ROUGE_L': 0.6293692635438929, 'CIDEr': 1.6864829136964352}
[INFO: 2023-03-10 19:19:00,707] ######## Epoch (VAL)8 ########
[INFO: 2023-03-10 19:19:00,707] {'Bleu_1': 0.6775732496351069, 'Bleu_2': 0.6219855644053113, 'Bleu_3': 0.553830014698234, 'Bleu_4': 0.4736382501249455, 'METEOR': 0.32677516718803695, 'ROUGE_L': 0.6574700869749798, 'CIDEr': 1.76163276295895}
[INFO: 2023-03-10 19:20:02,792] ######## Epoch (TEST)8 ########
[INFO: 2023-03-10 19:20:02,793] {'Bleu_1': 0.6051704672759997, 'Bleu_2': 0.5316137980302295, 'Bleu_3': 0.4616363044297001, 'Bleu_4': 0.3922729872909749, 'METEOR': 0.30078451859276617, 'ROUGE_L': 0.6143852737182675, 'CIDEr': 1.5860676032979273}
[INFO: 2023-03-10 19:22:14,634] ######## Epoch (VAL)9 ########
[INFO: 2023-03-10 19:22:14,634] {'Bleu_1': 0.7966014146386802, 'Bleu_2': 0.7253829001208746, 'Bleu_3': 0.6464781405650071, 'Bleu_4': 0.5697893003724257, 'METEOR': 0.37877992387454223, 'ROUGE_L': 0.6874041683089377, 'CIDEr': 2.166648571280525}
[INFO: 2023-03-10 19:23:15,910] ######## Epoch (TEST)9 ########
[INFO: 2023-03-10 19:23:15,910] {'Bleu_1': 0.7454785461257191, 'Bleu_2': 0.6580102133501436, 'Bleu_3': 0.581333669656486, 'Bleu_4': 0.5103196975521384, 'METEOR': 0.34945836589584767, 'ROUGE_L': 0.642647530773049, 'CIDEr': 1.9749762134839455}
[INFO: 2023-03-10 19:25:24,121] ######## Epoch (VAL)10 ########
[INFO: 2023-03-10 19:25:24,121] {'Bleu_1': 0.8080019812415343, 'Bleu_2': 0.7416917703933711, 'Bleu_3': 0.6658922860779509, 'Bleu_4': 0.5910456908950805, 'METEOR': 0.38241627287235697, 'ROUGE_L': 0.6968215048328017, 'CIDEr': 2.194395638573505}
[INFO: 2023-03-10 19:26:24,803] ######## Epoch (TEST)10 ########
[INFO: 2023-03-10 19:26:24,803] {'Bleu_1': 0.7373056110233014, 'Bleu_2': 0.6584683150306538, 'Bleu_3': 0.5840298351059964, 'Bleu_4': 0.5126381176744034, 'METEOR': 0.35180850844266065, 'ROUGE_L': 0.6430299484672092, 'CIDEr': 1.992093305824589}
[INFO: 2023-03-10 19:28:32,714] ######## Epoch (VAL)11 ########
[INFO: 2023-03-10 19:28:32,714] {'Bleu_1': 0.8200599634770344, 'Bleu_2': 0.7502532703095163, 'Bleu_3': 0.67401574335145, 'Bleu_4': 0.5961888198900924, 'METEOR': 0.38747408006992595, 'ROUGE_L': 0.7008794930423198, 'CIDEr': 2.2428031038058815}
[INFO: 2023-03-10 19:29:34,856] ######## Epoch (TEST)11 ########
[INFO: 2023-03-10 19:29:34,856] {'Bleu_1': 0.755616196062432, 'Bleu_2': 0.670821480614088, 'Bleu_3': 0.5954621422300965, 'Bleu_4': 0.5234483848976736, 'METEOR': 0.35522337588698183, 'ROUGE_L': 0.6527057320783468, 'CIDEr': 2.0645148399224538}
[INFO: 2023-03-10 19:31:43,296] ######## Epoch (VAL)12 ########
[INFO: 2023-03-10 19:31:43,296] {'Bleu_1': 0.8096632503648468, 'Bleu_2': 0.725229099965082, 'Bleu_3': 0.6410549258889612, 'Bleu_4': 0.5621876655567997, 'METEOR': 0.3928524543166575, 'ROUGE_L': 0.7079893509478379, 'CIDEr': 2.1689957351123046}
[INFO: 2023-03-10 19:32:46,412] ######## Epoch (TEST)12 ########
[INFO: 2023-03-10 19:32:46,413] {'Bleu_1': 0.7638456030704154, 'Bleu_2': 0.6835847840425953, 'Bleu_3': 0.6135597121240216, 'Bleu_4': 0.5480217977968014, 'METEOR': 0.3668383524043056, 'ROUGE_L': 0.6852190768563993, 'CIDEr': 2.2346129088096394}
[INFO: 2023-03-10 19:34:54,501] ######## Epoch (VAL)13 ########
[INFO: 2023-03-10 19:34:54,502] {'Bleu_1': 0.7573529411742431, 'Bleu_2': 0.6565315434034321, 'Bleu_3': 0.561789164102946, 'Bleu_4': 0.4706243550179949, 'METEOR': 0.372406031383835, 'ROUGE_L': 0.6689145945665157, 'CIDEr': 1.9987858623228896}
[INFO: 2023-03-10 19:35:53,034] ######## Epoch (TEST)13 ########
[INFO: 2023-03-10 19:35:53,034] {'Bleu_1': 0.7320297746463501, 'Bleu_2': 0.6366706918191721, 'Bleu_3': 0.5662286457490783, 'Bleu_4': 0.503011938770026, 'METEOR': 0.3595863833354733, 'ROUGE_L': 0.6582342920449902, 'CIDEr': 2.0949921251025665}
[INFO: 2023-03-10 19:38:00,075] ######## Epoch (VAL)14 ########
[INFO: 2023-03-10 19:38:00,075] {'Bleu_1': 0.8014285714274265, 'Bleu_2': 0.7127908255674795, 'Bleu_3': 0.6252771502795685, 'Bleu_4': 0.5422333419030183, 'METEOR': 0.39620149459814985, 'ROUGE_L': 0.7100546783631946, 'CIDEr': 2.1898899415501742}
[INFO: 2023-03-10 19:39:00,977] ######## Epoch (TEST)14 ########
[INFO: 2023-03-10 19:39:00,977] {'Bleu_1': 0.7815602836868347, 'Bleu_2': 0.6985858475611021, 'Bleu_3': 0.6294534076843273, 'Bleu_4': 0.5656700496608303, 'METEOR': 0.3793655772363216, 'ROUGE_L': 0.6963686896423235, 'CIDEr': 2.38296926148089}
[INFO: 2023-03-10 19:41:12,987] ######## Epoch (VAL)15 ########
[INFO: 2023-03-10 19:41:12,987] {'Bleu_1': 0.8168604651150918, 'Bleu_2': 0.7335466064571504, 'Bleu_3': 0.6470690504461909, 'Bleu_4': 0.564756864513121, 'METEOR': 0.4002997624177624, 'ROUGE_L': 0.7203979559540341, 'CIDEr': 2.2070867494220847}
[INFO: 2023-03-10 19:42:14,479] ######## Epoch (TEST)15 ########
[INFO: 2023-03-10 19:42:14,479] {'Bleu_1': 0.7624458843355577, 'Bleu_2': 0.6807619686203911, 'Bleu_3': 0.6132238692936324, 'Bleu_4': 0.5520724120430229, 'METEOR': 0.37060652375726005, 'ROUGE_L': 0.6849316051541843, 'CIDEr': 2.264000665383412}
[INFO: 2023-03-10 19:44:24,557] ######## Epoch (VAL)16 ########
[INFO: 2023-03-10 19:44:24,557] {'Bleu_1': 0.811715481170416, 'Bleu_2': 0.7218207972413542, 'Bleu_3': 0.6354655433864906, 'Bleu_4': 0.5572198636528749, 'METEOR': 0.40686812884013823, 'ROUGE_L': 0.7206075843358597, 'CIDEr': 2.3491571386613344}
[INFO: 2023-03-10 19:45:22,810] ######## Epoch (TEST)16 ########
[INFO: 2023-03-10 19:45:22,810] {'Bleu_1': 0.7753424657523625, 'Bleu_2': 0.6928014920377957, 'Bleu_3': 0.6221092488303415, 'Bleu_4': 0.5586977535613452, 'METEOR': 0.39129482560050804, 'ROUGE_L': 0.7082624771372652, 'CIDEr': 2.4373569901939907}
[INFO: 2023-03-10 19:47:33,484] ######## Epoch (VAL)17 ########
[INFO: 2023-03-10 19:47:33,484] {'Bleu_1': 0.8199718706036287, 'Bleu_2': 0.7365203651218628, 'Bleu_3': 0.6527057887338531, 'Bleu_4': 0.5742478138962225, 'METEOR': 0.42208540159352054, 'ROUGE_L': 0.7397504840681021, 'CIDEr': 2.5412517112689894}
[INFO: 2023-03-10 19:48:35,696] ######## Epoch (TEST)17 ########
[INFO: 2023-03-10 19:48:35,697] {'Bleu_1': 0.7824897400810089, 'Bleu_2': 0.6954700932670289, 'Bleu_3': 0.6247138945991892, 'Bleu_4': 0.5601994844502227, 'METEOR': 0.39499095277564755, 'ROUGE_L': 0.7141498181911289, 'CIDEr': 2.4903188266889744}
[INFO: 2023-03-10 19:50:43,945] ######## Epoch (VAL)18 ########
[INFO: 2023-03-10 19:50:43,945] {'Bleu_1': 0.830555555554402, 'Bleu_2': 0.7530513067241478, 'Bleu_3': 0.671154781644508, 'Bleu_4': 0.5934455265117707, 'METEOR': 0.43060764790518175, 'ROUGE_L': 0.7618091339688617, 'CIDEr': 2.5676072841032247}
[INFO: 2023-03-10 19:51:46,343] ######## Epoch (TEST)18 ########
[INFO: 2023-03-10 19:51:46,343] {'Bleu_1': 0.784827586205814, 'Bleu_2': 0.7046613287767385, 'Bleu_3': 0.6329479405010958, 'Bleu_4': 0.5691435328564675, 'METEOR': 0.3961296657521549, 'ROUGE_L': 0.7191978246061127, 'CIDEr': 2.472488466662234}
[INFO: 2023-03-10 19:53:57,991] ######## Epoch (VAL)19 ########
[INFO: 2023-03-10 19:53:57,992] {'Bleu_1': 0.8448519040890764, 'Bleu_2': 0.7734820899333871, 'Bleu_3': 0.6937845242895903, 'Bleu_4': 0.6168818702818681, 'METEOR': 0.4362157190830804, 'ROUGE_L': 0.7735666195509647, 'CIDEr': 2.670841082419067}
[INFO: 2023-03-10 19:54:58,484] ######## Epoch (TEST)19 ########
[INFO: 2023-03-10 19:54:58,484] {'Bleu_1': 0.7885952712089171, 'Bleu_2': 0.7087081097594464, 'Bleu_3': 0.6395125136247201, 'Bleu_4': 0.5757666824580896, 'METEOR': 0.3971212842745052, 'ROUGE_L': 0.7286429731860705, 'CIDEr': 2.4963206056789127}
[INFO: 2023-03-10 19:57:07,468] ######## Epoch (VAL)20 ########
[INFO: 2023-03-10 19:57:07,469] {'Bleu_1': 0.823119777157628, 'Bleu_2': 0.7432953461691946, 'Bleu_3': 0.6598170866598616, 'Bleu_4': 0.5818122713060884, 'METEOR': 0.4249054768842625, 'ROUGE_L': 0.7466062158804321, 'CIDEr': 2.508197240282275}
[INFO: 2023-03-10 19:58:07,404] ######## Epoch (TEST)20 ########
[INFO: 2023-03-10 19:58:07,404] {'Bleu_1': 0.77146740270475, 'Bleu_2': 0.6885427858821865, 'Bleu_3': 0.6196206854619399, 'Bleu_4': 0.5572309822640091, 'METEOR': 0.38847646018752696, 'ROUGE_L': 0.7049152546802221, 'CIDEr': 2.3830709261131564}
[INFO: 2023-03-10 20:42:32,870] Training with config:
[INFO: 2023-03-10 20:42:32,873] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mssydney/sent/sydney_train_input.pkl',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 8,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mssydney/sent/sydney_train_target.pkl',
                 'TEST_4W_ID': './mscoco/misc/ids2path_json/coco_test4w_ids2path.json',
                 'TEST_ATT_FEATS': './mssydney/feature/Sydney',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mssydney/misc/ids2path_json/sydney_test_ids2path.json',
                 'TRAIN_ATT_FEATS': './mssydney/feature/Sydney',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mssydney/misc/ids2path_json/sydney_train_ids2path.json',
                 'VAL_ATT_FEATS': './mssydney/feature/Sydney',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mssydney/misc/ids2path_json/sydney_val_ids2path.json'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 5,
               'CAP_KEY': 'caption',
               'COCO_PATH': './coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mssydney/misc/test_sydney.json',
               'VAL_ANNFILE': './mssydney/misc/val_sydney.json',
               'VOCAB': './mssydney/txt/Sydney_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'CrossEntropy'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 1536,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 512,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 512,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [64, 32, 64],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 3,
                        'DIM': 512,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [64, 32, 64],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.1,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 3,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.1,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.1,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 1536,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 512,
           'SEQ_LEN': 24,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'PureT',
           'VOCAB_SIZE': 181,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 512,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'MAX_LEN': 'MAX_LEN',
           'MULCLASS': 'MULCLASS',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments_PureT/PureT_XE_Sydney/',
 'SCORER': {'CIDER_CACHED': './mssydney/misc/sydney_train_cider.pkl',
            'GT_PATH': './mssydney/misc/sydney_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1234.0,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 0.0005,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 512,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Noam',
                          'WARMUP': 10000},
            'MAX_EPOCH': 20,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 1},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2023-03-10 20:44:23,307] Training with config:
[INFO: 2023-03-10 20:44:23,308] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mssydney/sent/sydney_train_input.pkl',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 8,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mssydney/sent/sydney_train_target.pkl',
                 'TEST_4W_ID': './mscoco/misc/ids2path_json/coco_test4w_ids2path.json',
                 'TEST_ATT_FEATS': './mssydney/feature/Sydney',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mssydney/misc/ids2path_json/sydney_test_ids2path.json',
                 'TRAIN_ATT_FEATS': './mssydney/feature/Sydney',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mssydney/misc/ids2path_json/sydney_train_ids2path.json',
                 'VAL_ATT_FEATS': './mssydney/feature/Sydney',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mssydney/misc/ids2path_json/sydney_val_ids2path.json'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 5,
               'CAP_KEY': 'caption',
               'COCO_PATH': './coco-caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mssydney/misc/test_sydney.json',
               'VAL_ANNFILE': './mssydney/misc/val_sydney.json',
               'VOCAB': './mssydney/txt/Sydney_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'CrossEntropy'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 1536,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 512,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 512,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [64, 32, 64],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 3,
                        'DIM': 512,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [64, 32, 64],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.1,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 3,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.1,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.1,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 1536,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 512,
           'SEQ_LEN': 24,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'PureT',
           'VOCAB_SIZE': 181,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 512,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'MAX_LEN': 'MAX_LEN',
           'MULCLASS': 'MULCLASS',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments_PureT/PureT_XE_Sydney/',
 'SCORER': {'CIDER_CACHED': './mssydney/misc/sydney_train_cider.pkl',
            'GT_PATH': './mssydney/misc/sydney_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1234.0,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 0.0005,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 512,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Noam',
                          'WARMUP': 10000},
            'MAX_EPOCH': 30,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 1},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2023-03-10 20:46:09,810] ######## Epoch (VAL)1 ########
[INFO: 2023-03-10 20:46:09,811] {'Bleu_1': 8.551566359038922e-12, 'Bleu_2': 1.9533154048782363e-19, 'Bleu_3': 5.624919720916227e-22, 'Bleu_4': 3.0537898816377345e-23, 'METEOR': 0.000630715862503942, 'ROUGE_L': 0.0011382295865054483, 'CIDEr': 6.456111789480353e-06}
[INFO: 2023-03-10 20:46:27,537] ######## Epoch (TEST)1 ########
[INFO: 2023-03-10 20:46:27,537] {'Bleu_1': 0.0, 'Bleu_2': 0.0, 'Bleu_3': 0.0, 'Bleu_4': 0.0, 'METEOR': 0.0, 'ROUGE_L': 0.0, 'CIDEr': 0.0}
[INFO: 2023-03-10 20:48:09,306] ######## Epoch (VAL)2 ########
[INFO: 2023-03-10 20:48:09,306] {'Bleu_1': 0.0, 'Bleu_2': 0.0, 'Bleu_3': 0.0, 'Bleu_4': 0.0, 'METEOR': 0.0, 'ROUGE_L': 0.0, 'CIDEr': 0.0}
[INFO: 2023-03-10 20:48:50,270] ######## Epoch (TEST)2 ########
[INFO: 2023-03-10 20:48:50,271] {'Bleu_1': 0.0, 'Bleu_2': 0.0, 'Bleu_3': 0.0, 'Bleu_4': 0.0, 'METEOR': 0.0, 'ROUGE_L': 0.0, 'CIDEr': 0.0}
[INFO: 2023-03-10 20:50:29,914] ######## Epoch (VAL)3 ########
[INFO: 2023-03-10 20:50:29,914] {'Bleu_1': 9.812000808767361e-13, 'Bleu_2': 9.812000809012661e-16, 'Bleu_3': 9.812000809094432e-17, 'Bleu_4': 3.1028270960282653e-17, 'METEOR': 0.006280667320902846, 'ROUGE_L': 0.050412407693481306, 'CIDEr': 0.004873611275972108}
[INFO: 2023-03-10 20:51:09,334] ######## Epoch (TEST)3 ########
[INFO: 2023-03-10 20:51:09,334] {'Bleu_1': 1.3431462790240985e-14, 'Bleu_2': 1.3431462790636027e-17, 'Bleu_3': 1.3431462790767716e-18, 'Bleu_4': 4.2474014726835765e-19, 'METEOR': 0.005460750853242321, 'ROUGE_L': 0.0469495228924317, 'CIDEr': 0.0021373168721182372}
[INFO: 2023-03-10 20:52:49,492] ######## Epoch (VAL)4 ########
[INFO: 2023-03-10 20:52:49,492] {'Bleu_1': 0.014269900485356656, 'Bleu_2': 0.014531755362960091, 'Bleu_3': 0.014687423749589004, 'Bleu_4': 0.015076913440686159, 'METEOR': 0.07653445195930884, 'ROUGE_L': 0.24244142033923283, 'CIDEr': 0.24584643490481453}
[INFO: 2023-03-10 20:53:29,207] ######## Epoch (TEST)4 ########
[INFO: 2023-03-10 20:53:29,207] {'Bleu_1': 0.011388748414239206, 'Bleu_2': 0.010971960965160185, 'Bleu_3': 0.010845703367169026, 'Bleu_4': 0.0003551319327483157, 'METEOR': 0.0740565105964416, 'ROUGE_L': 0.25069237067271016, 'CIDEr': 0.1876007296843128}
[INFO: 2023-03-10 20:55:09,973] ######## Epoch (VAL)5 ########
[INFO: 2023-03-10 20:55:09,973] {'Bleu_1': 0.12955919175712724, 'Bleu_2': 0.11510695744514275, 'Bleu_3': 0.10784140777407154, 'Bleu_4': 0.10022643129414978, 'METEOR': 0.12974090048039344, 'ROUGE_L': 0.34540320518471435, 'CIDEr': 0.6404665252019391}
[INFO: 2023-03-10 20:55:49,208] ######## Epoch (TEST)5 ########
[INFO: 2023-03-10 20:55:49,208] {'Bleu_1': 0.10736211960739771, 'Bleu_2': 0.09451881229584248, 'Bleu_3': 0.08757483876838287, 'Bleu_4': 0.07772654134268978, 'METEOR': 0.12400929802826326, 'ROUGE_L': 0.3469591296299843, 'CIDEr': 0.5213023358919642}
[INFO: 2023-03-10 20:57:27,827] ######## Epoch (VAL)6 ########
[INFO: 2023-03-10 20:57:27,827] {'Bleu_1': 0.35745993403422094, 'Bleu_2': 0.32859519414062005, 'Bleu_3': 0.2980357738281984, 'Bleu_4': 0.2611689914988486, 'METEOR': 0.20429428131876198, 'ROUGE_L': 0.4734023575293359, 'CIDEr': 1.0867888278538083}
[INFO: 2023-03-10 20:58:07,296] ######## Epoch (TEST)6 ########
[INFO: 2023-03-10 20:58:07,296] {'Bleu_1': 0.35393513212762123, 'Bleu_2': 0.32080677555981973, 'Bleu_3': 0.29558181856678334, 'Bleu_4': 0.27525021693767066, 'METEOR': 0.20723980697632244, 'ROUGE_L': 0.47526920857486227, 'CIDEr': 1.2534716359027949}
[INFO: 2023-03-10 20:59:48,205] ######## Epoch (VAL)7 ########
[INFO: 2023-03-10 20:59:48,206] {'Bleu_1': 0.6837128229809704, 'Bleu_2': 0.6113430970005717, 'Bleu_3': 0.5430241184130556, 'Bleu_4': 0.4805917615936712, 'METEOR': 0.3177674714693214, 'ROUGE_L': 0.615376247518517, 'CIDEr': 1.623830433241814}
[INFO: 2023-03-10 21:00:27,883] ######## Epoch (TEST)7 ########
[INFO: 2023-03-10 21:00:27,883] {'Bleu_1': 0.7029345260786235, 'Bleu_2': 0.6305552067303786, 'Bleu_3': 0.5643806729615701, 'Bleu_4': 0.5041594439457168, 'METEOR': 0.3347681148901291, 'ROUGE_L': 0.6262545597008289, 'CIDEr': 1.7754534565896447}
[INFO: 2023-03-10 21:02:06,161] ######## Epoch (VAL)8 ########
[INFO: 2023-03-10 21:02:06,161] {'Bleu_1': 0.6792187570416124, 'Bleu_2': 0.6233337296971198, 'Bleu_3': 0.5621135230633146, 'Bleu_4': 0.4948554910648422, 'METEOR': 0.34043077596574917, 'ROUGE_L': 0.6648366548211356, 'CIDEr': 1.7867225892175602}
[INFO: 2023-03-10 21:02:42,143] ######## Epoch (TEST)8 ########
[INFO: 2023-03-10 21:02:42,143] {'Bleu_1': 0.6460324979953174, 'Bleu_2': 0.5730956892842669, 'Bleu_3': 0.5065028385089064, 'Bleu_4': 0.44179828007037136, 'METEOR': 0.3172484447806175, 'ROUGE_L': 0.6065394334814435, 'CIDEr': 1.6194124449117795}
[INFO: 2023-03-10 21:04:21,583] ######## Epoch (VAL)9 ########
[INFO: 2023-03-10 21:04:21,584] {'Bleu_1': 0.7849668861617712, 'Bleu_2': 0.71713175748955, 'Bleu_3': 0.6451148543259484, 'Bleu_4': 0.5735606832053424, 'METEOR': 0.37791928162737515, 'ROUGE_L': 0.6885979561234863, 'CIDEr': 2.1488772586528566}
[INFO: 2023-03-10 21:05:02,603] ######## Epoch (TEST)9 ########
[INFO: 2023-03-10 21:05:02,603] {'Bleu_1': 0.7395478769207309, 'Bleu_2': 0.6554061455550573, 'Bleu_3': 0.5825342039703224, 'Bleu_4': 0.5115921967444449, 'METEOR': 0.355011180657306, 'ROUGE_L': 0.6370940667466364, 'CIDEr': 1.958538466086885}
[INFO: 2023-03-10 21:06:42,031] ######## Epoch (VAL)10 ########
[INFO: 2023-03-10 21:06:42,031] {'Bleu_1': 0.7919199686936136, 'Bleu_2': 0.7264251631593676, 'Bleu_3': 0.6545080464164419, 'Bleu_4': 0.5831590929012812, 'METEOR': 0.37907861969253825, 'ROUGE_L': 0.6929989897417383, 'CIDEr': 2.163098830083111}
[INFO: 2023-03-10 21:07:22,360] ######## Epoch (TEST)10 ########
[INFO: 2023-03-10 21:07:22,361] {'Bleu_1': 0.7321650563206719, 'Bleu_2': 0.6532118421337566, 'Bleu_3': 0.5784997977987412, 'Bleu_4': 0.5058282735377955, 'METEOR': 0.3529737467958389, 'ROUGE_L': 0.6372880044649851, 'CIDEr': 1.9404316786054934}
[INFO: 2023-03-10 21:09:02,506] ######## Epoch (VAL)11 ########
[INFO: 2023-03-10 21:09:02,507] {'Bleu_1': 0.7991395233899399, 'Bleu_2': 0.7331093893867895, 'Bleu_3': 0.6605178972190439, 'Bleu_4': 0.5875582633854749, 'METEOR': 0.38369962588718687, 'ROUGE_L': 0.6949351800356492, 'CIDEr': 2.18765581670772}
[INFO: 2023-03-10 21:09:42,594] ######## Epoch (TEST)11 ########
[INFO: 2023-03-10 21:09:42,595] {'Bleu_1': 0.7374348217085656, 'Bleu_2': 0.6570316204068507, 'Bleu_3': 0.5811201906110082, 'Bleu_4': 0.5084730856843127, 'METEOR': 0.3547727317407975, 'ROUGE_L': 0.6485653116574512, 'CIDEr': 1.966386063572827}
[INFO: 2023-03-10 21:11:21,883] ######## Epoch (VAL)12 ########
[INFO: 2023-03-10 21:11:21,883] {'Bleu_1': 0.8127721335256709, 'Bleu_2': 0.7346436590478851, 'Bleu_3': 0.6495769593028604, 'Bleu_4': 0.5668544811115372, 'METEOR': 0.39676944926765806, 'ROUGE_L': 0.7119143151671885, 'CIDEr': 2.2014109412805816}
[INFO: 2023-03-10 21:12:02,898] ######## Epoch (TEST)12 ########
[INFO: 2023-03-10 21:12:02,898] {'Bleu_1': 0.7616640791145467, 'Bleu_2': 0.6796058197645127, 'Bleu_3': 0.6093630237424462, 'Bleu_4': 0.5440939157953619, 'METEOR': 0.37366023541097454, 'ROUGE_L': 0.6795129544606232, 'CIDEr': 2.2017619099855863}
[INFO: 2023-03-10 21:13:42,771] ######## Epoch (VAL)13 ########
[INFO: 2023-03-10 21:13:42,771] {'Bleu_1': 0.7880116959052808, 'Bleu_2': 0.6961607436700478, 'Bleu_3': 0.6099826095493172, 'Bleu_4': 0.528268917588875, 'METEOR': 0.389800788438924, 'ROUGE_L': 0.6931553744712273, 'CIDEr': 2.1645435525540138}
[INFO: 2023-03-10 21:14:22,352] ######## Epoch (TEST)13 ########
[INFO: 2023-03-10 21:14:22,353] {'Bleu_1': 0.7484275270001668, 'Bleu_2': 0.6614257921164133, 'Bleu_3': 0.5907211991126836, 'Bleu_4': 0.5242770852331937, 'METEOR': 0.37371076865701486, 'ROUGE_L': 0.6790074111250992, 'CIDEr': 2.143705435369752}
[INFO: 2023-03-10 21:16:02,331] ######## Epoch (VAL)14 ########
[INFO: 2023-03-10 21:16:02,332] {'Bleu_1': 0.8043478260857908, 'Bleu_2': 0.7250007116680335, 'Bleu_3': 0.6397991648194823, 'Bleu_4': 0.5594479070734686, 'METEOR': 0.3906381233714564, 'ROUGE_L': 0.7011457483383461, 'CIDEr': 2.1742020888210236}
[INFO: 2023-03-10 21:16:41,528] ######## Epoch (TEST)14 ########
[INFO: 2023-03-10 21:16:41,529] {'Bleu_1': 0.7661849318259305, 'Bleu_2': 0.6806081030588164, 'Bleu_3': 0.6080762458411801, 'Bleu_4': 0.5417687340488463, 'METEOR': 0.37801487352660657, 'ROUGE_L': 0.6904291559102498, 'CIDEr': 2.232600793947562}
[INFO: 2023-03-10 21:18:20,363] ######## Epoch (VAL)15 ########
[INFO: 2023-03-10 21:18:20,364] {'Bleu_1': 0.8184397163108958, 'Bleu_2': 0.7332223131367436, 'Bleu_3': 0.6457424774483903, 'Bleu_4': 0.5629076929679532, 'METEOR': 0.4043811225654008, 'ROUGE_L': 0.7258158280766126, 'CIDEr': 2.3257269571678627}
